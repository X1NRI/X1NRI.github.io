<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Basic Pentesting | X1NRI</title>
  <meta name="author" content="X1NRI">
  
  <meta name="description" content="再见，2023">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Basic Pentesting"/>
  <meta property="og:site_name" content="X1NRI"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="X1NRI" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">X1NRI</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/links" title="Subscribe me.">
			  <i class="fa fa-chain"></i>Links
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> Basic Pentesting</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> 再见，2023
		 </div> <!-- alert -->
	  		

	  <h1 id="探测"><a href="#探测" class="headerlink" title="探测"></a>探测</h1><p>nmap探测服务，是Linux ubuntu服务器，80端口运行web服务。同时注意到在139&#x2F;445端口运行了SMB服务，在22开启了ssh服务<br><img src="/Red_FILE/37977293cad8d613d38f9e628a3f706c_MD5.jpeg"><br>爆一下目录看看<br><img src="/Red_FILE/dc85e7a63f38695808d8ff0a062fbbd2_MD5.jpeg"><br>发现可疑目录<br><img src="/Red_FILE/Pasted%20image%2020240629235050.png"><br>看一下其中的内容：</p>
<pre class="line-numbers language-text" data-language="text"><div class="caption"><span>TI:"dev.txt"</span></div><code class="language-text">
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J


2018年4月23日：我一直在搞那个struts的东西，它非常酷！我认为在这个服务器上托管它可能会很有趣。我还没有制作过真正的Web应用程序，但我已经尝试过你可以展示它如何工作的示例（它是示例的REST版本！）。哦，现在我正在使用2.5.12版本，因为其他版本给我带来了麻烦。-K

2018年4月22日：SMB已配置。-K

2018年4月21日：我已经设置好了Apache。稍后将放入我们的内容。-J<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-text" data-language="text"><div class="caption"><span>TI:"j.txt"</span></div><code class="language-text">For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K


对J：

我一直在审计/etc/shadow的内容，以确保我们没有任何弱凭据，我很容易破解了你的哈希。你知道我们的密码策略，请遵循它？尽快更改密码。

-K<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>从信息中可见配置了SMB服务，并且存在弱口令问题</p>
<h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><p>先上enum4linux探测，发现了以下有效的信息<br><img src="/Red_FILE/ec82945198d0f9add9dbe2ae6de13b57_MD5.jpeg"><br>尝试匿名登录，成功<br><img src="/Red_FILE/368e4912caaf68395bd2a129b777a0d9_MD5.jpeg"><br>看一下staff.txt</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay


请不要上传与工作无关的内容到此共享文件夹。我知道这很有趣，但这就是错误发生的原因。 （这也适用于你，Jan！）

-Kay<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们得知了该用户是Jan</p>
<p>从前面得知，J的密码存在弱口令问题，我们可能通过爆破ssh密码来登录服务器<br><code>hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.76.117</code><br>爆了6分钟，成功爆破出密码：jan : armando</p>
<p><img src="/Red_FILE/7296a83bf6f275e3a539d1a074951844_MD5.jpeg">接着ssh登录Jan的账户，可见还有另一个用户是kay，其下有一个可疑备份文件，需要root打开<br><img src="/Red_FILE/1660569a7ec2c28bd82f3988bc41bbeb_MD5.jpeg"><br><img src="/Red_FILE/13e2bdf6e29c8af38282786c907fd7fd_MD5.jpeg"></p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><h2 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h2><p>使用python作为一个简单的服务器上传LinEnum.sh，以寻找我们可用的信息</p>
<p>注意：我们事先转入&#x2F;tmp，因为任何用户都可以写入此文件夹<br><img src="/Red_FILE/719e77b065f8d94cf2787df19d8135de_MD5.jpeg"><br>chmod +x后运行</p>
<p>搜集到一些有用的信息：</p>
<ul>
<li>kay是管理员<br><img src="/Red_FILE/042d873aa66ff957676685fc95f18c88_MD5.jpeg"></li>
<li>我们能够查看&#x2F;etc&#x2F;passwd，不能查看&#x2F;etc&#x2F;shadow<br><img src="/Red_FILE/65d2cb63296e2d024008929746d8e1a4_MD5.jpeg"></li>
<li>可疑SUID文件：&#x2F;usr&#x2F;bin&#x2F;vim.basic<br><img src="/Red_FILE/67b26098cfaf5890c4e2680a083908e0_MD5.jpeg"></li>
<li>我们可以直接利用vim.basic以root打开备份文件！</li>
</ul>
<p>得到这样一串密码：<code>heresareallystrongpasswordthatfollowsthepasswordpolicy$$</code></p>
<p>成功登录kay账户！<br><img src="/Red_FILE/97d5da5de4c045b1c9aad9ee61a98822_MD5.jpeg"></p>
<h2 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h2><p>我们注意到&#x2F;home&#x2F;kay目录下有一个.ssh文件夹，其下存放着 kay 账户的ssh公钥和私钥<br><img src="/Red_FILE/97d5da5de4c045b1c9aad9ee61a98822_MD5.jpeg"><br>将其复制到本地，chmod 600</p>
<p>尝试使用私钥来ssh连接kay账户，但不幸的是需要输入key passphrase：<br><img src="/Red_FILE/ecb9eb5a3fdddf886c2a91b41c1a2508_MD5.jpeg"></p>
<blockquote>
<p>密钥登录简单说是我们生成一个密钥对（公钥与私钥），接着我们把公钥放到目标服务器上，然后用密钥去登录目标服务器。<br>私钥的密码（passphrase）是我们在生成密钥对的时候有机会去设置，这个设置是可选项来着。一般基于安全考虑最好是设置，当给私钥设置了密码，然后用该私钥ssh到目标服务器时，终端会提示你输入私钥的密码。如果不想每次都输入私钥的密码，最简单是不用设置密码</p>
</blockquote>
<p><del>到这里卡住了，看wp是使用了ssh2john来进行爆破，等后面学到了再补叭</del></p>
<p>用ssh2john转一下格式，尝试破解一下hash<br><img src="/Red_FILE/f23acf630072bbb7893451cc095d97e5_MD5.jpeg"><br>破解成功！账户kay : beeswax<br><img src="/Red_FILE/99c8a037aff919998693d1d9afd71550_MD5.jpeg"></p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	<span id="/2023/12/31/Basic%20Pentesting/" class="leancloud-visitors view" data-flag-title="Basic Pentesting">
		<em class="post-meta-item-text"> Page View </em> <i class="leancloud-visitors-count"></i>
	</span>
	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2024/01/15/Shell与Linux常见权限提升技术/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/12/29/2023-线上-第六届安洵杯/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
		<section id="comments" class="comments">
			<style>
			.comments{margin:30px;padding:10px;background:rgb(0, 0, 0)}
			@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#000}}
			</style>
			<div id="vcomment" class="comment"></div>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
var valineConfig = {"enable":true,"appId":"QrmzEeS3e4xvmJxO1dSPlkW4-gzGzoHsz","appKey":"ov6uvwKnDQmJxtpeS0wvBIwL","placeholder":"","visitor":true,"avatar":"monsterid","requiredFields":["nick","mail"],"pageView":true}
valineConfig.el='#vcomment';
new Valine(valineConfig);
    // new Valine({
    //     el: '#vcomment',
    //     appId: "",
    //     appKey: "",
    //     placeholder: "",
    //     avatar:"monsterid",
    //     visitor: "true",
    //     requiredFields: "nick,mail".split(','),
    // });
</script>

		</section>
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-12-31 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/进攻性渗透测试/">进攻性渗透测试<span>6</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/渗透打靶/">渗透打靶<span>4</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E6%8E%A2%E6%B5%8B"><span class="toc-article-text">探测</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%85%A5%E4%BE%B5"><span class="toc-article-text">入侵</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-article-text">提权</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%B3%95%E4%B8%80"><span class="toc-article-text">法一</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%B3%95%E4%BA%8C"><span class="toc-article-text">法二</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2024 X1NRI's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
